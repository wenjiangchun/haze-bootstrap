// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.3/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators dojo/_base/lang ../../../core/Accessor ../../../core/arrayUtils ../../../core/HandleRegistry ../../../geometry/support/webMercatorUtils ../../../views/3d/support/aaBoundingRect ./terrainUtils ./TerrainConst".split(" "),function(a,k,h,e,d,q,f,l,r,m,g,n,p){a=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}h(c,a);Object.defineProperty(c.prototype,
"layerViewsExtent",{get:function(){return this._computeLayerViewsExtent()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"tiledLayersExtent",{get:function(){return this._computeTiledLayersExtent()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"spatialReference",{set:function(b){this.tilingScheme||this._set("spatialReference",b)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"tilingScheme",{set:function(b){this._set("tilingScheme",b);this._set("spatialReference",
b.spatialReference)},enumerable:!0,configurable:!0});c.prototype.normalizeCtorArgs=function(b){b=q.mixin({},b);this._layers=b.layers;delete b.layers;this._layerViews=b.layerViews;delete b.layerViews;return b};return c}(d.declared(f));e([d.property({readOnly:!0})],a.prototype,"layerViewsExtent",null);e([d.property({readOnly:!0,dependsOn:["spatialReference","tilingScheme"]})],a.prototype,"tiledLayersExtent",null);e([d.property()],a.prototype,"spatialReference",null);e([d.property()],a.prototype,"tilingScheme",
null);e([d.property()],a.prototype,"defaultTiledLayersExtent",void 0);a=e([d.subclass()],a);f=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}h(c,a);c.prototype._computeLayerViewsExtent=function(){return this._getGlobalExtent()};c.prototype._computeTiledLayersExtent=function(){return this._getGlobalExtent()};c.prototype._getGlobalExtent=function(){return this.spatialReference.isWebMercator?p.WEBMERCATOR_WORLD_EXTENT:p.GEOGRAPHIC_WORLD_EXTENT};return c}(d.declared(a));e([d.property({dependsOn:["spatialReference"]})],
f.prototype,"layerViewsExtent",void 0);f=e([d.subclass()],f);k.SurfaceExtentHelperGlobal=f;a=function(a){function c(){var b=a.call(this)||this;b._changeListeners=new r;return b}h(c,a);c.prototype.initialize=function(){this._changeListeners.add(this._layers.on("change",this.notifyChange.bind(this,"tiledLayersExtent")));this._changeListeners.add(this._layerViews.on("change",this.notifyChange.bind(this,"layerViewsExtent")))};c.prototype.destroy=function(){this._changeListeners.destroy();this._changeListeners=
null};c.prototype._computeLayerViewsExtent=function(){var a=g.create(g.NEGATIVE_INFINITY),c=this.spatialReference;this._layerViews.forEach(function(b){b.isResolved()&&((b=b.fullExtentInViewSpatialReference||b.layer.fullExtent)&&!b.spatialReference.equals(c)&&(b=m.canProject(b.spatialReference,c)?m.project(b,c):null),b&&g.expand(a,b))});var d=g.allFinite(a)?a:null,e=this._get("layerViewsExtent");return l.equals(d,e)?e:d};c.prototype._computeTiledLayersExtent=function(){var a=this.tilingScheme;if(!a)return null;
var c=this.spatialReference,d=g.create(g.NEGATIVE_INFINITY);this._layers.forEach(function(b){n.isTiledLayer(b)&&a.compatibleWith(n.getTileInfo(b))&&b.fullExtent&&b.fullExtent.spatialReference.equals(c)&&g.expand(d,b.fullExtent)});this.defaultTiledLayersExtent&&g.expand(d,this.defaultTiledLayersExtent);var e=g.allFinite(d)?d:null,f=this._get("tiledLayersExtent");return l.equals(e,f)?f:e};return c}(d.declared(a));a=e([d.subclass()],a);k.SurfaceExtentHelperLocal=a});