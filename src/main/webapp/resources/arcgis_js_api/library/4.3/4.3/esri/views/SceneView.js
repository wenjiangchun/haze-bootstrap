// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.3/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/DOMContainer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/_base/lang dojo/on dojo/dom dojo/dom-construct ../core/Accessor ../core/HandleRegistry ../core/Scheduler ../core/watchUtils ../widgets/Popup ./PopupManager ./ui/DefaultUI ../core/accessorSupport/decorators".split(" "),function(m,k,b,a,c,h,g,d,e,l,f,n,u,t,r,w){var q=[0,0];m=function(a){function e(){var b=a.call(this)||this;b.height=0;b.position=null;
b.resizing=!1;b.root=null;b.surface=null;b.suspended=!0;b.width=0;Object.defineProperty(b,"_measureInfo",{enumerable:!1,writable:!1,value:{task:null,freq:16,time:750}});b._domHandles=new l;b.watch("interacting",function(a){var c=b.surface;c&&c.setAttribute("data-interacting",a.toString())});return b}b(e,a);e.prototype.getDefaults=function(){return c.mixin(this.inherited(arguments),{popup:{},ui:{}})};e.prototype.initialize=function(){var a=this,b=this._measureInfo,c=null;n.init(this,"container",function(d,
e,l,g){if(null!=d||null!=e)c&&(c.remove(),c=null,b.freq=16,b.time=750),b.task&&(b.task.remove(),b.task=null),d?(c=h(window,"resize",function(){b.freq=16;b.time=750}),b.task=f.addFrameTask({prepare:function(b){var c=a._measureInfo;c.time+=b.deltaTime;c.time<c.freq||(c.time=0,a._measure()?(c.freq=16,a._set("resizing",!0)):(c.freq=Math.min(750,2*c.freq),512<=c.freq&&a._set("resizing",!1)))}})):a._set("resizing",!1),a._measure(),d=a.root,e=a.surface,l=a.width,g=a.height,d&&e&&l&&g&&(d.style.width=e.style.width=
l+"px",d.style.height=e.style.height=g+"px")})};e.prototype.destroy=function(){this.ui.destroy();this.popup&&this.popup.destroy();this.container=null};Object.defineProperty(e.prototype,"container",{set:function(a){var b=this._get("container");if(b!==a){b&&(b.classList.remove("esri-view"),this.popupManager.destroy(),this.popupManager=null,d.destroy(this.root),this._set("root",null));if(a){a.classList.add("esri-view");b=document.createElement("div");b.className="esri-view-root";a.insertBefore(b,a.firstChild);
this._set("root",b);var c=document.createElement("div");c.className="esri-view-surface";g.setSelectable(c,!1);b.appendChild(c);this._set("surface",c);this._forceReadyCycle();this.popupManager=new t({enabled:!0,view:this})}else this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null);this._set("container",a)}},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"popup",{set:function(a){var b=this._get("popup");a!==b&&(this._domHandles.remove("view-popup"),
b&&b.destroy(),a&&(a.viewModel.view=this,a._started||a.startup(),this._domHandles.add([n.init(this,"root",function(b,c){var d=a.domNode;g.isDescendant(d.parentNode,c)&&d.parentNode.removeChild(d);b&&!d.parentNode&&a.placeAt(b)})],"view-popup")),this._set("popup",a))},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"size",{get:function(){return[this.width,this.height]},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"ui",{set:function(a){var b=this._get("ui");a!==
b&&(this._domHandles.remove("ui"),b&&b.destroy(),a&&(a.view=this,this._domHandles.add([n.init(this,"root",function(b){a.container=b?d.create("div",null,b):null})],"ui")),this._set("ui",a))},enumerable:!0,configurable:!0});e.prototype.pageToContainer=function(a,b,c){var d=this.position;a-=d[0];b-=d[1];c?(c[0]=a,c[1]=b):c=[a,b];return c};e.prototype.containerToPage=function(a,b,c){var d=this.position;a+=d[0];b+=d[1];c?(c[0]=a,c[1]=b):c=[a,b];return c};e.prototype._measure=function(){var a=this.container,
b=a?a.clientWidth:0,c=a?a.clientHeight:0;if(0===b||0===c||"hidden"===window.getComputedStyle(a).visibility)return this._set("suspended",!0),!1;var d=this.root,e=this.surface,f=this.width,l=this.height,h=this.position;if(b===f&&c===l)return this._set("suspended",!1),!1;d&&e&&(d.style.width=e.style.width=b+"px",d.style.height=e.style.height=c+"px");this._set("width",b);this._set("height",c);this._set("suspended",!1);d=(a.ownerDocument||window.document).defaultView;a=a.getBoundingClientRect();q[0]=a.left+
d.pageXOffset;q[1]=a.top+d.pageYOffset;h&&q[0]===h[0]&&q[1]===h[1]||this._set("position",q.slice());this.emit("resize",{oldWidth:f,oldHeight:l,width:b,height:c});return!0};return e}(w.declared(e));a([w.property({value:null,cast:function(a){return g.byId(a)}})],m.prototype,"container",null);a([w.property({readOnly:!0})],m.prototype,"height",void 0);a([w.property({type:u})],m.prototype,"popup",null);a([w.property({readOnly:!0})],m.prototype,"position",void 0);a([w.property({readOnly:!0})],m.prototype,
"resizing",void 0);a([w.property({readOnly:!0})],m.prototype,"root",void 0);a([w.property({value:null,dependsOn:["width","height"],readOnly:!0})],m.prototype,"size",null);a([w.property({readOnly:!0})],m.prototype,"surface",void 0);a([w.property({readOnly:!0})],m.prototype,"suspended",void 0);a([w.property({type:r})],m.prototype,"ui",null);a([w.property({readOnly:!0})],m.prototype,"width",void 0);return m=a([w.subclass("esri.views.DOMContainer")],m)})},"esri/widgets/Popup":function(){define("./support/viewModelWiring ./Widgette ./Popup/PopupViewModel ../core/HandleRegistry ../core/watchUtils ../views/2d/viewpointUtils dijit/a11yclick dijit/_TemplatedMixin dojo/keys dojo/on dojo/query dojo/Deferred dojo/i18n!./Popup/nls/Popup dojo/text!./Popup/templates/Popup.html ../core/lang dojo/_base/lang dojo/dom-class dojo/dom-attr dojo/dom-construct dojo/dom-geometry dojo/dom-style ./Popup/PopupRenderer ./Popup/PopupRendererViewModel ./Spinner ./Message require".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f,n,u,t,r,w,q,x,y,z,A,C,B,D,H,K){var E=K.toUrl("./Popup/images/default-action.svg"),F={hidden:"esri-hidden",invisible:"esri-invisible",iconText:"esri-icon-font-fallback-text",iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconRightTriangleArrow:"esri-icon-right-triangle-arrow",iconDockToTop:"esri-icon-maximize",iconDockToBottom:"esri-icon-dock-bottom",iconDockToLeft:"esri-icon-dock-left",iconDockToRight:"esri-icon-dock-right",iconClose:"esri-icon-close",iconUndock:"esri-icon-minimize",
iconPaginationMenu:"esri-icon-layer-list",iconCheckMark:"esri-icon-check-mark",iconLoading:"esri-rotating esri-icon-loading-indicator",iconZoom:"esri-icon-zoom-in-magnifying-glass",base:"esri-popup",container:"esri-popup__position-container",main:"esri-popup__main-container",loadingContainer:"esri-popup__loading-container",shadow:"esri-popup--shadow",showDock:"esri-popup--dock-button-visible",showContent:"esri-popup--content-visible",showFooter:"esri-popup--footer-visible",showTitle:"esri-popup--title-visible",
showPagination:"esri-popup--pagination-visible",hasPopupRenderer:"esri-popup--has-popup-renderer",hasPromiseFeatures:"esri-popup--has-promise-features",isDocked:"esri-popup--is-docked",isDockedTopLeft:"esri-popup--is-docked-top-left",isDockedTopCenter:"esri-popup--is-docked-top-center",isDockedTopRight:"esri-popup--is-docked-top-right",isDockedBottomLeft:"esri-popup--is-docked-bottom-left",isDockedBottomCenter:"esri-popup--is-docked-bottom-center",isDockedBottomRight:"esri-popup--is-docked-bottom-right",
canDockToLeft:"esri-popup--can-dock-to-left",canDockToRight:"esri-popup--can-dock-to-right",canDockToTop:"esri-popup--can-dock-to-top",canDockToBottom:"esri-popup--can-dock-to-bottom",hasPaginationMenuOpen:"esri-popup--feature-menu-open",alignTop:"esri-popup--top-aligned",alignBottom:"esri-popup--bottom-aligned",alignLeftTop:"esri-popup--left-top-aligned",alignLeftBottom:"esri-popup--left-bottom-aligned",alignRightTop:"esri-popup--right-top-aligned",alignRightBottom:"esri-popup--right-bottom-aligned",
hasPendingPromises:"esri-popup--has-pending-promises",isPendingPromisesResult:"esri-popup--is-pending-promises-result",hasFeatureUpdated:"esri-popup--feature-updated",header:"esri-popup__header",headerButtons:"esri-popup__header-buttons",headerTitle:"esri-popup__header-title",content:"esri-popup__content",footer:"esri-popup__footer",button:"esri-popup__button",buttonDock:"esri-popup__button--dock",icon:"esri-popup__icon",iconDock:"esri-popup__icon--dock-icon",actions:"esri-popup__actions",action:"esri-popup__action",
actionImage:"esri-popup__action-image",actionText:"esri-popup__action-text",pointer:"esri-popup__pointer",pointerDirection:"esri-popup__pointer-direction",pagination:"esri-popup__pagination",paginationPrevious:"esri-popup__pagination-previous",paginationNext:"esri-popup__pagination-next",paginationPreviousIconLTR:"esri-popup__pagination-previous-icon",paginationPreviousIconRTL:"esri-popup__pagination-previous-icon--rtl",paginationNextIconLTR:"esri-popup__pagination-next-icon",paginationNextIconRTL:"esri-popup__pagination-next-icon--rtl",
paginationText:"esri-popup__pagination-page-text",paginationDocked:"esri-popup__pagination-docked",paginationDockedButtons:"esri-popup__pagination-docked-buttons",featureMenu:"esri-popup__feature-menu",featureMenuList:"esri-popup__feature-menu-list",featureMenuItem:"esri-popup__feature-menu-item",featureMenuViewport:"esri-popup__feature-menu-viewport",featureMenuHeader:"esri-popup__feature-menu-header",featureMenuNote:"esri-popup__feature-menu-note",featureMenuSelected:"esri-popup__feature-menu-item--selected",
featureMenuButton:"esri-popup__feature-menu-button",featureMenuTitle:"esri-popup__feature-menu-title"},L={auto:"auto",topLeft:"top-left",topCenter:"top-center",topRight:"top-right",bottomLeft:"bottom-left",bottomCenter:"bottom-center",bottomRight:"bottom-right"},Q={buttonEnabled:!0,position:L.auto,breakpoint:{width:544}},N={popupRenderer:"popup-renderer",acions:"actions",actionsChange:"actions-change",paginationTitles:"pagination-titles",view:"view"};return k.createSubclass([d],{declaredClass:"esri.widgets.Popup",
baseClass:F.base,templateString:t,constructor:function(){this._handleRegistry=new a;this._contentStorage=y.create("div")},postCreate:function(){var a=this;this.inherited(arguments);var b=this.viewModel;this.own(c.whenTrue(b,"view.ready",function(){this._wireUpView(this.viewModel.view)}.bind(this)),c.init(b,"pendingPromisesCount,featureCount,promises,location",function(){var a=this.viewModel;this._displayPendingFeaturesStatus(a.pendingPromisesCount,a.featureCount,a.promises,a.location)}.bind(this)),
c.init(b,"features",this._updateFeatures.bind(this)),c.init(b,"selectedFeatureIndex,selectedFeature",function(){var a=this.viewModel;this._updateSelectedFeature(a.selectedFeature);this._updateActions(a.actions,a.features,a.selectedFeature);this._updatePageText(a.features,a.selectedFeatureIndex);this._createPaginationNodes(a.features,a.selectedFeatureIndex);this._bodyContentNode.scrollTop=0}.bind(this)),c.init(b,"title",function(a){this._updateTitle(a);this.reposition()}.bind(this)),c.init(b,"actions",
function(a){var b=this.viewModel;this._updateActions(a,b.features,b.selectedFeature);this._actionChangeListener(a)}.bind(this)),c.init(b,"content",function(a){this._updateContent(a);this.reposition()}.bind(this)),c.init(b,"location",function(a){this._togglePopupLocationRepositioning(this.visible);this._autoAlign();this.reposition()}.bind(this)),l(this._dockNode,g,this._toggleDock.bind(this)),l(this._closeNode,g,this.close.bind(this)),l(this._previousNode,g,b.previous.bind(b)),l(this._previousDockedNode,
g,b.previous.bind(b)),l(this._nextNode,g,b.next.bind(b)),l(this._nextDockedNode,g,b.next.bind(b)),l(this._pageMenuNode,g,this._togglePageMenu.bind(this)),l(this._pageMenuDockedNode,g,this._togglePageMenu.bind(this)),l(this._pageMenuInfoNode,g,this._togglePageMenu.bind(this)),l(this._paginationNode,l.selector("li",g),function(){a._selectFeature(this)}),l(this._paginationNode,l.selector("li","keyup"),function(b){a._keyupFeature(b,this)}),l(this._actionsNode,l.selector("[data-action-index]",g),function(){a._actionEvent(this)}),
l(b,"trigger-action",function(a){a.action&&"zoom-to"===a.action.id&&this.viewModel.zoomToLocation()}.bind(this)));m.setUpEventDelegates(this,"trigger-action")},destroy:function(){this._destroyPopupRendererVMs();this._destroyMessage();this._destroySpinner();this._destroyPopupRenderer();this._handleRegistry.destroy();this._handleRegistry=null},properties:{_popupRenderer:{readOnly:!0,value:null},actions:{aliasOf:"viewModel.actions"},alignment:{value:"top",set:function(a){this._set("alignment",a);this.reposition()}},
autoPanEnabled:!0,autoAlignmentEnabled:!1,content:{aliasOf:"viewModel.content"},closeOnViewChangeEnabled:!1,currentDockPosition:{readOnly:!0,value:null},dockOptions:{value:Q,set:function(a){var b=w.clone(Q),c=this.viewModel.get("view.breakpoints"),d={};c&&(d.width=c.xsmall,d.height=c.xsmall);a=w.mixin({},b,a);b=w.mixin({},b.breakpoint,d);!0===a.breakpoint?a.breakpoint=b:"object"===typeof a.breakpoint&&(a.breakpoint=w.mixin({},b,a.breakpoint));this._set("dockOptions",a);this._toggleDockButton(a)}},
dockEnabled:{value:!1,set:function(a){this._set("dockEnabled",a);this._togglePopupDocking(a);this._togglePopupLocationRepositioning(this.visible);this._autoAlign();this.reposition()}},featureCount:{aliasOf:"viewModel.featureCount"},features:{aliasOf:"viewModel.features"},location:{aliasOf:"viewModel.location"},messageEnabled:{value:!1,set:function(a){this._set("messageEnabled",a);this._createMessage(a,this.viewModel.view)}},paginationEnabled:{value:!0,set:function(a){var b=this.viewModel;this._set("paginationEnabled",
a);this._updatePagination(b.features,b.selectedFeatureIndex);this._updateFooterVisibility(b.features,b.actions);this.reposition()}},promises:{aliasOf:"viewModel.promises"},rendered:{dependsOn:["viewModel.content","_popupRenderer.rendered"],get:function(){var a=this._contentIsPopupRenderer()&&this.get("_popupRenderer.rendered");return this._popupRenderer?a:!0},readOnly:!0},selectedFeature:{aliasOf:"viewModel.selectedFeature"},selectedFeatureIndex:{aliasOf:"viewModel.selectedFeatureIndex"},spinnerEnabled:{value:!0,
set:function(a){this._set("spinnerEnabled",a);this._createSpinner(a,this.viewModel.view)}},title:{aliasOf:"viewModel.title"},view:{aliasOf:"viewModel.view"},viewModel:{type:b},visible:{value:!1,set:function(a){this._set("visible",a);q.remove(this._containerNode,F.hasPaginationMenuOpen);q.toggle(this.domNode,F.invisible,!a);this._togglePopupLocationRepositioning(a);this._toggleContentVisibility(a);this._autoAlign();this.reposition()}}},_css:F,_i18n:u,_hideActionsTextNum:3,_animationDelay:10,_pointerOffset:16,
_popupRendererVMs:[],clear:m.createMethodDelegate("clear"),close:function(){this.set("visible",!1)},next:m.createMethodDelegate("next"),previous:m.createMethodDelegate("previous"),reposition:function(){this._positionPopup();return this._moveIntoView()},open:function(a){var b=w.mixin({updateLocationEnabled:!1},a);this.viewModel.set(b);a&&a.promises?this.set("visible",!1):this.set("visible",!0)},triggerAction:m.createMethodDelegate("triggerAction"),_actionChangeListener:function(a){this._handleRegistry.remove(N.actionsChange);
a&&this._handleRegistry.add([a.on("change",function(){var a=this.viewModel;this._updateActions(a.actions,a.features,a.selectedFeature)}.bind(this))],N.actionsChange)},_actionEvent:function(a){var b=this.viewModel;if(a=x.get(a,"data-action-index"))a=parseInt(a,10),b.triggerAction(a)},_addContent:function(){var a=this.viewModel;this._updateSelectedFeature(a.selectedFeature);this._updateContent(a.content);this._updateTitle(a.title);this._updatePageText(a.features,a.selectedFeatureIndex)},_updateActions:function(a,
b,c){this._updateActionButtons(a,c);this._updateFooterVisibility(b,a);this.reposition()},_contentIsPopupRenderer:function(){var a=this.get("viewModel.content"),b=this.get("_popupRenderer.domNode");return!(!a||!b||a!==b)},_updateActionButtons:function(a,b){this._handleRegistry.remove(N.actions);if(this._actionsNode){var d=document.createDocumentFragment(),e=a.length;e&&a.forEach(function(a,f){"zoom-to"===a.id&&(a.title=this._i18n.zoom,a.className=F.iconZoom);var l=a.title,h=a.className,g=a.image;g||
h||(g=E);var n=b&&b.attributes;n&&(l=l?r.substitute(n,l):"",h=h?r.substitute(n,h):null,g=g?r.substitute(n,g):null);var t=y.create("div",{tabindex:"0",title:l},d);x.set(t,"data-action-index",f);q.add(t,[F.button,F.action]);var u=y.create("span",{"aria-hidden":!0},t);q.add(u,F.icon);h&&q.add(u,h);g&&(q.add(u,F.actionImage),A.set(u,"background-image","url("+g+")"));f={className:F.actionText,textContent:l};e>=this._hideActionsTextNum&&(f.className=F.iconText);var w=y.create("span",f,t);this._handleRegistry.add([c.init(a,
"visible",function(a){q.toggle(t,F.hidden,!a)}),c.init(a,"className",function(a,b){n&&(a=r.substitute(n,a),b=r.substitute(n,b));q.remove(u,b);q.add(u,a)}),c.init(a,"image",function(a){n&&(a=r.substitute(n,a));q.toggle(u,F.actionImage,!!a);A.set(u,"background-image",a?"url("+a+")":"")}),c.init(a,"title",function(a){n&&(a=r.substitute(n,a));a=a||"";x.set(t,"title",a);x.set(w,"textContent",a)})],N.actions)},this);y.place(d,this._actionsNode,"only")}},_getLocationScreenPoint:function(){var a=this.viewModel,
b;if(a.location&&this.visible){var c=a.location;c&&a.get("view.ready")&&(b=a.view.toScreen(c))}return b},_calculatePosition:function(a,b,c){var d=this.alignment,e,f=this._pointerOffset,l=null,h=null,g=null,n=null;if(a&&b&&c){e=b.h;if("top"===d||"bottom"===d)e+=f;b=b.w;if("left-top"===d||"left-bottom"===d||"right-top"===d||"right-bottom"===d)b+=f,e+=f;var q=b/2,x=a.y,t=a.x,u=c.height-x,y=c.width-t,r=b;switch(d){case "bottom":l=x+f;h=t-q;r=q;break;case "left-top":g=u+f;n=y+f;break;case "left-bottom":l=
x+f;n=y+f;break;case "right-top":g=u+f;h=t+f;break;case "right-bottom":l=x+f;h=t+f;break;default:g=u+f,h=t-q,r=q}c=c.padding;c=this.dockEnabled?{left:c.left?c.left+"px":"",top:c.top?c.top+"px":"",right:c.right?c.right+"px":"",bottom:c.bottom?c.bottom+"px":""}:{top:null!==l?l+"px":"auto",left:null!==h?h+"px":"auto",bottom:null!==g?g+"px":"auto",right:null!==n?n+"px":"auto"};return{height:e,width:b,box:{top:null!==l?l:a.y-e,left:null!==h?h:a.x-r,bottom:null!==g?g:a.y+e,right:null!==n?n:a.x+r},style:c}}},
_createPopupRendererVMs:function(a){this._destroyPopupRendererVMs();a&&1<a.length&&a.forEach(function(a,b){a=new B({contentEnabled:!1,graphic:a});this._popupRendererVMs.push(a)},this)},_destroyPopupRendererVMs:function(){this._handleRegistry.remove(N.paginationTitles);this._popupRendererVMs.forEach(function(a){a.destroy()});this._popupRendererVMs.length=0},_createPaginationNodes:function(a,b){this._handleRegistry.remove(N.paginationTitles);if(a){var d=a.length;this._paginationNode&&x.set(this._paginationNode,
"innerHTML","");1<d&&(d=r.substitute({total:d},this._i18n.selectedFeatures),x.set(this._pageMenuInfoNode,"textContent",d),a.forEach(function(a,d){a=this._i18n.untitled;var f=y.create("li",{role:"menuitem",className:F.featureMenuItem},this._paginationNode);d===b?(x.set(f,"aria-label",u.selectedFeature),q.add(f,F.featureMenuSelected)):x.set(f,"data-feature-index",d);var e=y.create("span",{className:F.featureMenuTitle,innerHTML:a},f);if(a=this._popupRendererVMs[d])a=c.init(a,"title",function(a){x.set(e,
"innerHTML",a)}),this._handleRegistry.add(a,N.paginationTitles);d===b&&y.create("span",{className:F.iconCheckMark},e)},this))}},_createMessage:function(a,b){this._destroyMessage();a&&b&&(this._message=new H({visible:!1,text:this._i18n.noFeaturesFound,viewModel:{view:b}}),this._message.startup(),y.place(this._message.domNode,b.root))},_createSpinner:function(a,b){this._destroySpinner();a&&b&&(this._spinner=new D({visible:!1,viewModel:{view:b}}),this._spinner.startup(),y.place(this._spinner.domNode,
b.root))},_updateContent:function(a){a&&a.nodeName?(y.place(a,this._contentStorage),y.place(a,this._bodyContentNode,"only")):"string"===typeof a&&(this._destroyPopupRenderer(),x.set(this._bodyContentNode,"innerHTML",a));this._bodyContentNode.scrollTop=0;q.toggle(this._containerNode,F.hasPopupRenderer,this._contentIsPopupRenderer());q.toggle(this._containerNode,F.showContent,!!a);q.remove(this._containerNode,F.hasPaginationMenuOpen);this._autoAlign()},_destroyPopupRenderer:function(){this._popupRenderer&&
!this._popupRenderer._destroyed&&(this._handleRegistry.remove(N.popupRenderer),this._popupRenderer.destroy(),this._set("_popupRenderer",null))},_destroyMessage:function(){this._message&&(this._message.destroyRendering(),this._message.destroy(),this._message=null)},_destroySpinner:function(){this._spinner&&(this._spinner.destroyRendering(),this._spinner.destroy(),this._spinner=null)},_setDockEnabledForViewSize:function(a){a.breakpoint&&this.set("dockEnabled",this._shouldDockAtCurrentViewSize(a))},
_togglePopupDocking:function(a){q.remove(this._containerNode,F.hasPaginationMenuOpen);q.toggle(this._containerNode,F.isDocked,!!a);x.set(this._dockNode,"title",a?this._i18n.undock:this._i18n.dock);this._updateDockPosition(this.dockOptions)},_dockingThresholdCrossed:function(a,b,c){var d=a[0];a=a[1];var f=b[0];b=b[1];var e=c.width;c=c.height;return d<=e&&f>e||d>e&&f<=e||a<=c&&b>c||a>c&&b<=c},_determineDockPosition:function(a){var b=this.viewModel,c=b.view,d=c&&c.padding,d=c&&c.width-d.left-d.right;
return(b=c&&b.get("view.breakpoints"))&&d<=b.xsmall?a.bottomCenter:this.isLeftToRight()?a.topRight:a.topLeft},_updateDockPosition:function(a){q.remove(this._containerNode,[F.isDockedTopLeft,F.isDockedTopCenter,F.isDockedTopRight,F.isDockedBottomLeft,F.isDockedBottomCenter,F.isDockedBottomRight,F.canDockToTop,F.canDockToBottom,F.canDockToLeft,F.canDockToRight]);var b,c,d;b=a.position;b=b===L.auto?this._determineDockPosition(L):"function"===typeof b?b.call(this):b;switch(b){case L.topLeft:c=F.isDockedTopLeft;
d=F.canDockToLeft;break;case L.topCenter:c=F.isDockedTopCenter;d=F.canDockToTop;break;case L.bottomLeft:c=F.isDockedBottomLeft;d=F.canDockToLeft;break;case L.bottomCenter:c=F.isDockedBottomCenter;d=F.canDockToBottom;break;case L.bottomRight:c=F.isDockedBottomRight;d=F.canDockToRight;break;default:c=F.isDockedTopRight,d=F.canDockToRight}q.toggle(this._containerNode,d,!!a.buttonEnabled);this.dockEnabled?(q.add(this._containerNode,c),this._set("currentDockPosition",b)):this._set("currentDockPosition",
null);this._popupRenderer&&this._popupRenderer.resize();this.reposition()},_toggleDockButton:function(a){var b=this._containerNode;q.toggle(b,F.showDock,!!a.buttonEnabled);q.toggle(b,F.isDocked,!!this.dockEnabled);this._updateDockPosition(a)},_updateFooterVisibility:function(a,b){a=this._isPaginationEnabled(a)||b&&b.length;q.toggle(this._containerNode,F.showFooter,!!a)},_isPaginationEnabled:function(a){return this.paginationEnabled&&a&&1<a.length},_updatePagination:function(a,b){this._updatePageText(a,
b);this._createPaginationNodes(a,b);q.toggle(this._containerNode,F.showPagination,this._isPaginationEnabled(a))},_displayPendingFeaturesStatus:function(a,b,c,d){var f=0<a&&0===b;c=c&&c.length;a&&c&&a===c&&this.set("visible",!1);q.toggle(this._containerNode,F.hasPendingPromises,!!a);q.toggle(this._containerNode,F.isPendingPromisesResult,!!f);q.toggle(this._containerNode,F.hasPromiseFeatures,!!b);this._message&&this._message.set({visible:!1});f?this._spinner&&(this._spinner.set({visible:!0}),this._spinner.viewModel.point=
d):(this._spinner&&(this._spinner.viewModel.point=null),c&&b&&!this.visible?this.set("visible",!0):c&&!b&&this.visible&&this.set("visible",!1),!b&&c&&this._message&&(this._message.set({visible:!0}),this._message.viewModel.point=d))},_moveIntoView:function(){var a=new n;setTimeout(a.resolve.bind(this),this._animationDelay);return a.then(function(){if(!this._destroyed){var a=this.viewModel,b=this.get("viewModel.view");if(a&&b&&b.stationary){var c=this._getLocationScreenPoint();if(c){var d=this._sizePopup(),
d=this._calculatePosition(c,d,b),f=b.width,e=b.height,l=b.padding,g=b.ui.padding;if(this.autoPanEnabled&&!this.autoAlignmentEnabled){if(c.y<l.top||c.y>e-l.bottom||c.x<l.left||c.x>f-l.right)return a.centerAtLocation();if(!this.dockEnabled&&d&&d.width<b.width&&d.height<b.height){var n=c=0;d.box.top<l.top?n=-d.box.top+g.top+l.top:d.box.bottom>e-l.bottom&&(n=-(d.box.bottom-e+l.bottom)-g.bottom);d.box.left<l.left?c=d.box.left-g.left-l.left:d.box.right>f-l.right&&(c=d.box.right-f+l.right+g.right);if(c||
n)return d=h.translateBy(h.create(),b.viewpoint,[c,n]),b.goTo(d,a.animationOptions)}}}}}}.bind(this))},_isScreenPointWithinView:function(a,b){return b&&a&&-1<a.x&&-1<a.y&&a.x<=b.width&&a.y<=b.height},_autoAlign:function(){if(this.autoAlignmentEnabled&&this.visible){var a=this.get("viewModel.view"),b=this._getLocationScreenPoint();if(this._isScreenPointWithinView(b,a)){var c=this._sizePopup(),d=this._pointerOffset,f=c.h+d,c=(c.w+d)/2,e,l,h,g,d=a.padding;b.x-c<0+d.left&&(l=!0);b.x+c>a.width-d.right&&
(e=!0);b.y-f<0+d.top&&(h=!0);b.y+f>a.height-d.bottom&&(g=!0);l?this._set("alignment",h?"right-bottom":"right-top"):e?this._set("alignment",h?"left-bottom":"left-top"):h?this._set("alignment",g?"top":"bottom"):this._set("alignment","top")}}},_positionPopup:function(){var a=this.viewModel.view;if(a){q.remove(this._containerNode,[F.alignTop,F.alignBottom,F.alignLeftTop,F.alignLeftBottom,F.alignRightTop,F.alignRightBottom]);this._triggerOffset();var b;switch(this.alignment){case "bottom":b=F.alignBottom;
break;case "right-top":b=F.alignRightTop;break;case "right-bottom":b=F.alignRightBottom;break;case "left-top":b=F.alignLeftTop;break;case "left-bottom":b=F.alignLeftBottom;break;default:b=F.alignTop}q.add(this._containerNode,b);b=this._getLocationScreenPoint();var c=this._sizePopup();(a=(a=this._calculatePosition(b,c,a))&&a.style)&&A.set(this._containerNode,a)}},_removeContent:function(){this._destroyPopupRenderer();x.set(this._bodyContentNode,"innerHTML","");x.set(this._titleNode,"innerHTML","");
x.set(this._pageTextNode,"innerHTML","");x.set(this._pageTextDockedNode,"innerHTML","");q.remove(this._containerNode,[F.showTitle,F.showContent])},_keyupFeature:function(a,b){var c=a.keyCode;if(c===e.UP_ARROW||c===e.DOWN_ARROW){a.stopPropagation();a.preventDefault();a=f("li",this._paginationNode);var d=a.length;b=a.indexOf(b);var l;c===e.UP_ARROW?l=b-1:c===e.DOWN_ARROW&&(l=b+1);0>l?l=d-1:l>=d&&(l=0);a[l].focus()}},_selectFeature:function(a){var b=this.viewModel,c=-1;(a=x.get(a,"data-feature-index"))&&
(c=parseInt(a,10));-1!==c&&(b.selectedFeatureIndex=c);q.remove(this._containerNode,F.hasPaginationMenuOpen);this._pageMenuNode.focus()},_updateSelectedFeature:function(a){var b=this.viewModel,d,f="",e="";if(a){if(d=a.layer)f=d.id||"",e=d.title||"";if(!this._popupRenderer||this._popupRenderer&&this._popupRenderer._destroyed){this._handleRegistry.remove(N.popupRenderer);this._set("_popupRenderer",new C);d=c.init(this._popupRenderer.viewModel,"title",function(a){b.title=a});var h=c.init(this._popupRenderer.viewModel,
"content",function(a){b.content=a?this._popupRenderer.domNode:null}.bind(this)),g=l(this._popupRenderer,"resize",this.reposition.bind(this));this._handleRegistry.add([d,h,g],N.popupRenderer);this._popupRenderer.startup()}this._popupRenderer.viewModel.graphic=a}this._toggleFeatureUpdatedClass();x.set(this._containerNode,"data-layer-title",e);x.set(this._containerNode,"data-layer-id",f);this.reposition()},_updateFeatures:function(a){var b=this.viewModel;this._createPopupRendererVMs(a);this._updatePagination(a,
b.selectedFeatureIndex);this._updateFooterVisibility(a,b.actions);this.reposition()},_shouldDockAtCurrentViewSize:function(a){var b=this.viewModel;a=a.breakpoint;return b.view&&(a.hasOwnProperty("width")&&b.view.ui.width<=a.width||a.hasOwnProperty("height")&&b.view.ui.height<=a.height)},_sizePopup:function(){return z.getContentBox(this._containerNode)},_updateTitle:function(a){a=a||"";x.set(this._titleNode,"innerHTML",a);q.toggle(this._containerNode,F.showTitle,!!a);q.remove(this._containerNode,F.hasPaginationMenuOpen)},
_toggleDock:function(){this.set("dockEnabled",!this.dockEnabled)},_togglePageMenu:function(){q.toggle(this._containerNode,F.hasPaginationMenuOpen);var a=q.contains(this._containerNode,F.hasPaginationMenuOpen);x.set(this._pageMenuSectionNode,"aria-hidden",!a);var b=f("li",this._paginationNode),c=b[0];b.forEach(function(b){x.set(b,"tabIndex",a?"0":"")});a?c&&c.focus():this._pageMenuNode.focus()},_updatePageText:function(a,b){var c="";this._isPaginationEnabled(a)&&(c=r.substitute({index:b+1,total:a.length},
this._i18n.pageText));this._pageTextNode&&x.set(this._pageTextNode,{textContent:c});this._pageTextDockedNode&&x.set(this._pageTextDockedNode,{textContent:c})},_triggerOffset:function(){this._containerNode.offsetWidth=this._containerNode.offsetWidth},_toggleFeatureUpdatedClass:function(){q.remove(this._containerNode,F.hasFeatureUpdated);this._triggerOffset();q.add(this._containerNode,F.hasFeatureUpdated)},_viewPointChanged:function(){this.closeOnViewChangeEnabled?this.close():this._positionPopup()},
_wireUpView:function(a){this._handleRegistry.remove(N.view);this._viewPointEvent=null;if(a){var b="viewpoint";"3d"===a.type&&(b="camera");this._viewPointEvent=c.pausable(a,b,this._viewPointChanged.bind(this));this._handleRegistry.add([a.watch("padding",this.reposition.bind(this)),a.watch("size",this._updateDockEnabledForViewSize.bind(this)),l(a,"resize",this.reposition.bind(this)),this._viewPointEvent],N.view);this._togglePopupLocationRepositioning(this.visible);this._createMessage(this.messageEnabled,
a);this._createSpinner(this.spinnerEnabled,a);this._setDockEnabledForViewSize(this.dockOptions);this._toggleDockButton(this.dockOptions);this.reposition()}},_updateDockEnabledForViewSize:function(a,b){var c=this.get("viewModel.view.padding"),d=c.left+c.right,f=c.top+c.bottom,c=[],e=[];c[0]=a[0]-d;c[1]=a[1]-f;e[0]=b[0]-d;e[1]=b[1]-f;a=this.dockOptions;this._dockingThresholdCrossed(c,e,a.breakpoint)&&this._setDockEnabledForViewSize(a);this._updateDockPosition(a)},_togglePopupLocationRepositioning:function(a){var b=
this.viewModel;this._viewPointEvent&&(a&&b.location&&!this.dockEnabled?this._viewPointEvent.resume():this._viewPointEvent.pause())},_toggleContentVisibility:function(a){a?this._addContent():this._removeContent()}})})},"esri/widgets/support/viewModelWiring":function(){define(["../../core/watchUtils"],function(m){function k(b,a){Array.isArray(a)||(a=[a]);return a.map(function(a){return b.viewModel.on(a,function(c){b.emit(a,c)})})}return{createGetterDelegate:function(b){var a="viewModel."+b;return function(){return this.get(a)}},
createSetterDelegate:function(b){return function(a){var c=this.get("viewModel");c&&c.set(b,a)}},createMethodDelegate:function(b){var a="viewModel."+b;return function(){var b=this.get(a);if(b)return b.apply(this.viewModel,arguments)}},setUpEventDelegates:function(b,a){var c=k(b,a),h=m.init(b,"viewModel",function(h,d){c.forEach(function(a){a.remove()});c.length=0;h&&(c=k(b,a));b.own.apply(b,c)});b.own(h)}}})},"esri/widgets/Widgette":function(){define("../core/Accessor ../core/declare ../core/accessorSupport/metadata dijit/_WidgetBase dijit/Destroyable dijit/registry dojo/_base/lang dojo/_base/window dojo/aspect dojo/dom dojo/dom-attr dojo/dom-class dojo/on".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f,n,u){function t(a){return function(b){this._set(a,b)}}function r(a,b){return function(c){w.call(this,a,b,c);this._set(a,c)}}function w(a,b,c){(Array.isArray(b)?b:[b]).forEach(function(b){var d=this[b.node||b||"domNode"];switch(b.type||"attribute"){case "attribute":g.isFunction(c)&&(c=c.bind(this));b=b.attribute?b.attribute:/^on[A-Z][a-zA-Z]*$/.test(a)?a.toLowerCase():a;d.tagName?f.set(d,b,c):d.set(b,c);break;case "innerText":d.innerHTML="";d.appendChild(this.ownerDocument.createTextNode(c));
break;case "innerHTML":d.innerHTML=c;break;case "class":b=this._get(a),n.replace(d,c,b)}},this)}k.before(function(a,c){if(c.declaredClass===q||k.hasMixin(a,q)){var d=b.getPropertiesMetadata(c);Object.keys(d).forEach(function(a){var b=d[a];var c=b.set;a="function"===typeof c?c:null===c?t(b.name):"string"===typeof c||"object"===typeof c?r(a,c):void 0;b.set=a})}});var q="esri.widgets._WidgetBase";return m.createSubclass([c],{declaredClass:q,postscript:function(a){var b=this.__accessor__;a=b.ctorArgs||
a;var c;(c=this.getDefaults?a?this.getDefaults(a):this.getDefaults({}):null)&&Object.getOwnPropertyNames(c).forEach(function(a){b.set(a,c[a])},this);this.postMixInProperties();this.ownerDocument=this.ownerDocument||(this.srcNodeRef?this.srcNodeRef.ownerDocument:document);this.ownerDocumentBody=d.body(this.ownerDocument);h.add(this);this.buildRendering();b.initialize();a&&(this.set(a),b.ctorArgs=null);b.initialize();this.initialize();this.postCreate();if(this.domNode){var l;(a=this.srcNodeRef)&&a.parentNode&&
this.domNode!==a&&(a.parentNode.replaceChild(this.domNode,a),l=!0);f.set(this.domNode,{widgetId:this.id,id:this.id});l&&(this.srcNodeRef=null)}this._created=!0;this.notifyChange("container");e.around(this,"startup",function(a){return function(){this._started||a.apply(this)}});this.autoStart&&this.startup()},getDefaults:function(a){var b={};b.id=a.id?a.id:a.srcNodeRef&&a.srcNodeRef.id||h.getUniqueId(this.declaredClass.replace(/\./g,"_"));delete a.id;a.srcNodeRef&&(b.srcNodeRef=a.srcNodeRef,delete a.srcNodeRef);
return g.mixin(this.inherited(arguments),b)},normalizeCtorArgs:function(a,b){a=a||{};if(b=a.container||a.srcNodeRef||b)a.srcNodeRef=l.byId(b);return a},destroy:function(){this._customWidgetBaseDestroy()},postMixInProperties:a.prototype.postMixInProperties,buildRendering:a.prototype.buildRendering,postCreate:a.prototype.postCreate,startup:a.prototype.startup,_beingDestroyed:!1,_destroyed:!1,_created:!1,properties:{autoStart:!0,"class":{value:"",set:{node:"domNode",type:"class"}},domNode:{value:null},
focused:!1,id:{value:""},srcNodeRef:{value:null},style:{value:null,set:a.prototype._setStyleAttr},widgetId:{}},destroyDescendants:a.prototype.destroyDescendants,destroyRecursive:a.prototype.destroyRecursive,destroyRendering:a.prototype.destroyRendering,emit:a.prototype.emit,on:function(a,b){return this.own(u(this.domNode,a,b))[0]},toString:a.prototype.toString,getChildren:a.prototype.getChildren,getParent:a.prototype.getParent,isLeftToRight:a.prototype.isLeftToRight,placeAt:a.prototype.placeAt,onFocus:function(){},
onBlur:function(){},_onFocus:function(){this.onFocus()},_onBlur:function(){this.onBlur()},dojoAttachEvent:"",dojoAttachPoint:"",_customWidgetBaseDestroy:function(a){function b(b){b.destroyRecursive?b.destroyRecursive(a):b.destroy&&b.destroy(a)}this._beingDestroyed=!0;this.domNode&&h.findWidgets(this.domNode,this.containerNode).forEach(b);this.destroyRendering(a);h.remove(this.id);this._destroyed=!0}}).createSubclass({declaredClass:"esri.widgets.Widgette",getDefaults:function(){return g.mixin(this.inherited(arguments),
{viewModel:{}})},buildRendering:function(){this.inherited(arguments);n.add(this.domNode,"esri-widget")},destroy:function(){this.viewModel.destroy&&this.viewModel.destroy();this.viewModel=null},properties:{container:{get:function(){return this._created?this.domNode:this._get("container")},set:function(a){var b=this._get("container");this._created||b||!a||this._set("container",l.byId(a))}},viewModel:{value:null},visible:{value:!0,set:function(a){this._set("visible",a);n.toggle(this.domNode,"esri-hidden",
!a)}}}})})},"esri/widgets/Popup/PopupViewModel":function(){define("../../core/Accessor ../../core/Collection ../../core/Error ../../core/Evented ../../core/HandleRegistry ../../core/promiseUtils ../../core/watchUtils ../../geometry/support/webMercatorUtils ../../geometry/Point ../../support/Action dojo/fx/easing dojo/_base/lang".split(" "),function(m,k,b,a,c,h,g,d,e,l,f,n){var u={id:"zoom-to"};return m.createSubclass([a],{declaredClass:"esri.widgets.Popup.PopupViewModel",properties:{actions:{type:k.ofType(l)},
animationOptions:{},content:{},featureCount:{readOnly:!0},features:{},location:{type:e},pendingPromisesCount:{readOnly:!0},promises:{},selectedFeature:{readOnly:!0},selectedFeatureIndex:{},state:{dependsOn:["view.ready"],readOnly:!0},title:{},updateLocationEnabled:{},view:{},waitingForResult:{dependsOn:["pendingPromisesCount","featureCount"],readOnly:!0},zoomFactor:{},zoomScale:{readOnly:!0}},_handles:null,constructor:function(){this._handles=new c},getDefaults:function(a){return n.mixin(this.inherited(arguments),
{actions:[u],animationOptions:{duration:300,easing:f.quadInOut},promises:[]})},initialize:function(){this._handles.add(g.init(this,"view.scale",this._scaleWatcher))},destroy:function(){this._handles.destroy();this.view=this._handles=null},actions:[u],animationOptions:{duration:300,easing:f.quadInOut},content:null,featureCount:0,features:null,_featuresSetter:function(a){this._set("features",a);this._updateFeatureCount(a);this.pendingPromisesCount||(this.selectedFeatureIndex=-1,a.length&&(this.selectedFeatureIndex=
0))},location:null,_locationSetter:function(a){var b=this.get("view.spatialReference.isWebMercator");a&&a.get("spatialReference.isWGS84")&&b&&(a=d.geographicToWebMercator(a));this._set("location",a)},pendingPromisesCount:0,waitingForResult:!1,_waitingForResultGetter:function(){return 0<this.pendingPromisesCount&&0===this.featureCount},promises:[],_promisesSetter:function(a){var b=this._get("promises");b&&b.forEach(function(a){a.cancel()});this.features=[];this._set("pendingPromisesCount",0);this._set("promises",
a);a&&a.length&&(this._set("pendingPromisesCount",a.length),a=a.slice(0),a.forEach(function(a){a.always(function(b){a.isCanceled()||(this._set("pendingPromisesCount",this.pendingPromisesCount-1),this._updateFeatures(a,b))}.bind(this))},this))},selectedFeature:null,selectedFeatureIndex:-1,_selectedFeatureIndexSetter:function(a){if(isNaN(a)||-1>a)a=-1;var b=null,c=this.features;c&&c.length&&(a=(a+c.length)%c.length,b=c[a]);this._set("selectedFeature",b);this._set("selectedFeatureIndex",a);this._selectedFeatureChange(b,
this.updateLocationEnabled)},state:"disabled",_stateGetter:function(){return this.get("view.ready")?"ready":"disabled"},title:null,updateLocationEnabled:!1,_updateLocationEnabledSetter:function(a){this._selectedFeatureChange(this.selectedFeature,a);this._set("updateLocationEnabled",a)},view:null,zoomFactor:4,_zoomFactorSetter:function(a){var b=this.view;b&&null!=b.scale&&this._setZoomScale(b.scale,a);this._set("zoomFactor",a)},zoomScale:0,centerAtLocation:function(){return this.location&&this.view?
this.view.goTo({target:this.location,scale:this.view.scale},this.animationOptions):h.reject(new b(this.declaredClass+"::Cannot center at location without a location and view."))},clear:function(){this.set({promises:[],features:[],content:null,title:null,location:null})},triggerAction:function(a){(a=this.actions.getItemAt(a))&&this.emit("trigger-action",{action:a})},next:function(){this.selectedFeatureIndex+=1;return this},previous:function(){--this.selectedFeatureIndex;return this},zoomToLocation:function(){var a=
this.view,c=this.location,d=this.zoomScale;if(!c||!a)return h.reject(new b(this.declaredClass+"::Cannot zoom to location without a location and view."));var f=this.selectedFeature,e=f&&f.geometry,l=f&&"3d"===a.type;e||l?(c={target:f},e&&"point"===e.type&&this._isScreenSize(f)&&(c.scale=d,this.location=e)):c={target:c,scale:d};return a.goTo(c,this.animationOptions)},_isScreenSize:function(a){if("3d"!==this.view.type||"esri.Graphic"!==a.declaredClass)return!0;var b=!0,c=this.view.getViewForGraphic(a);
c&&c.whenGraphicBounds&&c.whenGraphicBounds(a).then(function(a){b=!a||a[0]===a[3]&&a[1]===a[4]&&a[2]===a[5]});return b},_getSelectedFeatureActions:function(){this._originalActions&&(this.actions=this._originalActions,this._originalActions=null);var a=this.actions.filter(function(a){return!a.temporary},this),b=a,c=this.selectedFeature.getEffectivePopupTemplate();if(c&&c.actions){for(var b=c.actions,d=0;d<b.length;d++)b.getItemAt(d).temporary=!0;c.overwriteActions?this._originalActions=a:b=a.concat(b)}this.actions=
b},_scaleWatcher:function(a){null!=a&&this._setZoomScale(a,this.zoomFactor)},_getPointFromGeometry:function(a){switch(a&&a.type){case "point":return a;case "extent":return a.center;case "polygon":return a.centroid;case "multipoint":case "polyline":return a.extent.center;default:return null}},_selectedFeatureChange:function(a,b){a&&(b&&(this.location=this._getPointFromGeometry(this.selectedFeature.geometry)),this._getSelectedFeatureActions())},_updateFeatureCount:function(a){var b=0;a&&a.length&&(b=
a.length);this._set("featureCount",b)},_setZoomScale:function(a,b){this._set("zoomScale",a/b)},_updateFeatures:function(a,c){a&&this.promises&&!(!this._validatePromise(a)||c instanceof b||c instanceof Error)&&c&&c.length&&(a={},this.features&&this.features.length?(c=c.filter(function(a){return-1===this.features.indexOf(a)},this),a.features=this.features.concat(c)):(a.features=c,a.selectedFeatureIndex=0),this.set(a))},_validatePromise:function(a){return-1<this.promises.indexOf(a)}})})},"dojo/fx/easing":function(){define(["../_base/lang"],
function(m){var k={linear:function(b){return b},quadIn:function(b){return Math.pow(b,2)},quadOut:function(b){return b*(b-2)*-1},quadInOut:function(b){b*=2;return 1>b?Math.pow(b,2)/2:-1*(--b*(b-2)-1)/2},cubicIn:function(b){return Math.pow(b,3)},cubicOut:function(b){return Math.pow(b-1,3)+1},cubicInOut:function(b){b*=2;return 1>b?Math.pow(b,3)/2:(Math.pow(b-2,3)+2)/2},quartIn:function(b){return Math.pow(b,4)},quartOut:function(b){return-1*(Math.pow(b-1,4)-1)},quartInOut:function(b){b*=2;return 1>b?
Math.pow(b,4)/2:-.5*(Math.pow(b-2,4)-2)},quintIn:function(b){return Math.pow(b,5)},quintOut:function(b){return Math.pow(b-1,5)+1},quintInOut:function(b){b*=2;return 1>b?Math.pow(b,5)/2:(Math.pow(b-2,5)+2)/2},sineIn:function(b){return-1*Math.cos(Math.PI/2*b)+1},sineOut:function(b){return Math.sin(Math.PI/2*b)},sineInOut:function(b){return-1*(Math.cos(Math.PI*b)-1)/2},expoIn:function(b){return 0==b?0:Math.pow(2,10*(b-1))},expoOut:function(b){return 1==b?1:-1*Math.pow(2,-10*b)+1},expoInOut:function(b){if(0==
b)return 0;if(1==b)return 1;b*=2;if(1>b)return Math.pow(2,10*(b-1))/2;--b;return(-1*Math.pow(2,-10*b)+2)/2},circIn:function(b){return-1*(Math.sqrt(1-Math.pow(b,2))-1)},circOut:function(b){return Math.sqrt(1-Math.pow(b-1,2))},circInOut:function(b){b*=2;return 1>b?-.5*(Math.sqrt(1-Math.pow(b,2))-1):.5*(Math.sqrt(1-Math.pow(b-2,2))+1)},backIn:function(b){return Math.pow(b,2)*(2.70158*b-1.70158)},backOut:function(b){--b;return Math.pow(b,2)*(2.70158*b+1.70158)+1},backInOut:function(b){b*=2;if(1>b)return Math.pow(b,
2)*(3.5949095*b-2.5949095)/2;b-=2;return(Math.pow(b,2)*(3.5949095*b+2.5949095)+2)/2},elasticIn:function(b){if(0==b||1==b)return b;--b;return-1*Math.pow(2,10*b)*Math.sin(2*(b-.075)*Math.PI/.3)},elasticOut:function(b){return 0==b||1==b?b:Math.pow(2,-10*b)*Math.sin(2*(b-.075)*Math.PI/.3)+1},elasticInOut:function(b){if(0==b)return 0;b*=2;if(2==b)return 1;var a=.3*1.5,c=a/4;if(1>b)return--b,-.5*Math.pow(2,10*b)*Math.sin(2*(b-c)*Math.PI/a);--b;return.5*Math.pow(2,-10*b)*Math.sin(2*(b-c)*Math.PI/a)+1},bounceIn:function(b){return 1-
k.bounceOut(1-b)},bounceOut:function(b){return b<1/2.75?7.5625*Math.pow(b,2):b<2/2.75?7.5625*Math.pow(b-1.5/2.75,2)+.75:b<2.5/2.75?7.5625*Math.pow(b-2.25/2.75,2)+.9375:7.5625*Math.pow(b-2.625/2.75,2)+.984375},bounceInOut:function(b){return.5>b?k.bounceIn(2*b)/2:k.bounceOut(2*b-1)/2+.5}};m.setObject("dojo.fx.easing",k);return k})},"esri/views/2d/viewpointUtils":function(){define("require exports ./math/common ./math/mat2d ./math/vec2 ../../Viewpoint ../../core/promiseUtils ../../core/Error ../../geometry/SpatialReference ../../geometry/Geometry ../../geometry/Point ../../geometry/Extent ../../geometry/support/webMercatorUtils ../../geometry/support/scaleUtils ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f,n,u,t,r,w){function q(a,d,f,e){return e&&f&&!e.equals(f)&&u.canProject(e,f)&&e.isWebMercator?(e.isWebMercator?(f=d[1],89.99999<f?f=89.99999:-89.99999>f&&(f=-89.99999),f=Math.sin(b.toRadian(f)),a=c.set(a,6378137*b.toRadian(d[0]),3189068.5*Math.log((1+f)/(1-f)))):(f=b.toDegree(d[0]/6378137),a=c.set(a,f-360*Math.floor((f+180)/360),b.toDegree(.5*Math.PI-2*Math.atan(Math.exp(-1*d[1]/6378137))))),a):c.copy(a,d)}function x(a){return a.wkid?a:a.spatialReference||e.WGS84}function y(a,
b){return b.type?c.set(a,b.x,b.y):c.copy(a,b)}function z(a,b){return Math.max(a.width/b[0],a.height/b[1])*F(a.spatialReference)}function A(a,b,c){var d;if(!a)return null;if(Array.isArray(a)&&2===a.length&&"number"===typeof a[0]&&"number"===typeof a[1])return new f(a);if(a.reduce)return a.reduce(function(a,c){return A(c,b,a)},c);a instanceof l?d=a:a.geometry&&(d=a.geometry);if(!d)return null;a="point"===d.type?new n({xmin:d.x,ymin:d.y,xmax:d.x,ymax:d.y,spatialReference:d.spatialReference}):d.extent;
if(!a)return null;d=u.canProject(a,b);if(!a.spatialReference.equals(b)&&d)a=u.project(a,b);else if(!d)return null;return c=c?c.union(a):a.clone()}function C(a,b){if(!a)return new h({targetGeometry:new f,scale:0,rotation:0});var d=b.spatialReference,e=b.size,g=b.currentViewpoint,n=b.constraints,u=null;"esri.Viewpoint"===a.declaredClass?u=a:a.viewpoint?u=a.viewpoint:a.target&&"esri.Viewpoint"===a.target.declaredClass&&(u=a.target);var t=null;if(u&&u.targetGeometry)t=u.targetGeometry;else if(a instanceof
l)t=a;else if(a||a&&(a.hasOwnProperty("center")||a.hasOwnProperty("extent")||a.hasOwnProperty("target")))t=A(a.center,d)||A(a.extent,d)||A(a.target,d)||A(a,d);!t&&g&&g.targetGeometry?t=g.targetGeometry:!t&&b.extent&&(t=b.extent);var r=x(t);d||(d=x(b.spatialReference||b.extent||t));if(!w.canProject(t,d)&&r&&!r.equals(d))return null;var C=y(c.create(),t.center?t.center:t),d=new f(q(C,C,r,d),d),r=null,r=u&&u.targetGeometry&&"point"===u.targetGeometry.type?u.scale:a.hasOwnProperty("scale")&&a.scale?a.scale:
a.hasOwnProperty("zoom")&&-1!==a.zoom&&n&&n.effectiveLODs?n.zoomToScale(a.zoom):Array.isArray(t)||"point"===t.type||"extent"===t.type&&0===t.width&&0===t.height?b.extent?z(b.extent,e):g.scale:z(t.extent,e);b=0;u?b=u.rotation:a.hasOwnProperty("rotation")?b=a.rotation:g&&(b=g.rotation);n&&(n.rotationEnabled||(b=0),n.snapToZoom&&(r=n.snapScale(r)),0!==n.effectiveMinScale&&(r=Math.min(n.effectiveMinScale,r)),0!==n.effectiveMaxScale&&(r=Math.max(n.effectiveMaxScale,r)));return new h({targetGeometry:d,
scale:r,rotation:b})}function B(a,b){var c=a.targetGeometry,d=b.targetGeometry;c.x=d.x;c.y=d.y;c.spatialReference=d.spatialReference;a.scale=b.scale;a.rotation=b.rotation;return a}function D(a,b,d){return d?c.set(a,.5*(b[0]-d.right+d.left),.5*(b[1]-d.bottom+d.top)):c.scale(a,b,.5)}function H(b,c,d){k.getTransform(b,c,d);return a.invert(b,b)}function K(a,d,f){var e=b.toRadian(d.rotation)||0;d=Math.abs(Math.cos(e));e=Math.abs(Math.sin(e));return c.set(a,Math.round(f[1]*e+f[0]*d),Math.round(f[1]*d+f[0]*
e))}function E(a){return a.scale*(1/(39.37*(t.getUnitValueForSR(a.targetGeometry.spatialReference)||N)*96))}function F(a){return 39.37*(t.getUnitValueForSR(a)||N)*96}function L(a){return a.isWrappable?(a=r.getInfo(a),a.valid[1]-a.valid[0]):0}function Q(a,b){return Math.round(L(a)/b)}var N=6370997*Math.PI/180,J=180/Math.PI;k.create=C;k.copy=B;k.getAnchor=D;k.getExtent=function(){var a=c.create();return function(b,c,d){var f=c.targetGeometry;y(a,f);c=.5*E(c);b.xmin=a[0]-c*d[0];b.ymin=a[1]-c*d[1];b.xmax=
a[0]+c*d[0];b.ymax=a[1]+c*d[1];b.spatialReference=f.spatialReference;return b}}();k.setExtent=function(a,b,c,d,f){k.centerAt(a,b,c.center);a.scale=z(c,d);f&&f.constraints&&f.constraints.constrain(a);return a};k.getOuterExtent=function(){var a=c.create(),b=c.create();return function(c,d,f){y(a,d.targetGeometry);K(b,d,f);f=.5*E(d);c.set({xmin:a[0]-f*b[0],ymin:a[1]-f*b[1],xmax:a[0]+f*b[0],ymax:a[1]+f*b[1],spatialReference:d.targetGeometry.spatialReference});return c}}();k.getClippedExtent=function(){var a=
c.create(),b=c.create();return function(c,d,f){var e=E(d),l=d.targetGeometry.spatialReference,h=Q(l,e);y(a,d.targetGeometry);K(b,d,f);l.isWrappable&&b[0]>h&&(b[0]=h);d=.5*e;c.set({xmin:a[0]-d*b[0],ymin:a[1]-d*b[1],xmax:a[0]+d*b[0],ymax:a[1]+d*b[1],spatialReference:l});return c}}();k.getOuterSize=K;k.getPaddingScreenTranslation=function(){var a=c.create();return function(b,d,f){return c.sub(b,c.scale(b,d,.5),D(a,d,f))}}();var P=function(){var d=a.create(),f=c.create();return function(e,l,h,g){var n=
E(l);l=b.toRadian(l.rotation)||0;c.set(f,n,n);a.fromScaling(d,f);a.rotate(d,d,l);a.translate(d,d,k.getPaddingScreenTranslation(f,h,g));a.translate(d,d,[0,g.top-g.bottom]);return c.set(e,d[4],d[5])}}();k.getResolution=E;k.getResolutionToScaleFactor=F;k.getMatrix=function(){var b=c.create(),d=c.create(),f=c.create();return function(e,l,h,g,n){c.negate(b,l);c.scale(d,h,.5);c.set(f,1/g,-1/g);a.identity(e);a.translate(e,e,d);n&&a.rotate(e,e,n);a.scale(e,e,f);a.translate(e,e,b);return e}}();k.getTransform=
function(){var a=c.create();return function(c,d,f){var e=E(d),l=b.toRadian(d.rotation)||0;y(a,d.targetGeometry);return k.getMatrix(c,a,f,e,l)}}();k.getTransformNoRotation=function(){var a=c.create();return function(b,c,d){var f=E(c);y(a,c.targetGeometry);return k.getMatrix(b,a,d,f,0)}}();k.getWorldWidth=L;k.getWorldScreenWidth=Q;k.createAsync=function(a,b){if(a=C(a,b))return g.resolve(a);a=new d("viewpointUtils-createAsync:different-spatialReference","Target spatialReference cannot be projected and is different from out spatialReference");
return g.reject(a)};k.angleBetween=function(){var a=c.create(),b=c.create(),d=c.create();return function(f,e,l){c.subtract(a,f,e);c.normalize(a,a);c.subtract(b,f,l);c.normalize(b,b);c.cross(d,a,b);f=Math.acos(c.dot(a,b)/(c.length(a)*c.length(b)))*J;0>d[2]&&(f=-f);isNaN(f)&&(f=0);return f}}();k.addPadding=function(){var a=c.create();return function(b,c,d,f){var e=b.targetGeometry;B(b,c);P(a,c,d,f);e.x+=a[0];e.y+=a[1];return b}}();k.removePadding=function(){var a=c.create();return function(b,c,d,f){var e=
b.targetGeometry;B(b,c);P(a,c,d,f);e.x-=a[0];e.y-=a[1];return b}}();k.centerAt=function(){var a=c.create();return function(b,c,d){B(b,c);c=b.targetGeometry;var f=x(d),e=x(c);y(a,d);q(a,a,f,e);c.x=a[0];c.y=a[1];return b}}();k.pixelSizeAt=function(a,b,c){return E(b)};k.resize=function(){var a=c.create();return function(b,d,f,e,l){l||(l="center");c.sub(a,f,e);c.scale(a,a,.5);f=a[0];e=a[1];switch(l){case "center":c.set(a,0,0);break;case "left":c.set(a,-f,0);break;case "top":c.set(a,0,e);break;case "right":c.set(a,
f,0);break;case "bottom":c.set(a,0,-e);break;case "top-left":c.set(a,-f,e);break;case "bottom-left":c.set(a,-f,-e);break;case "top-right":c.set(a,f,e);break;case "bottom-right":c.set(a,f,-e)}k.translateBy(b,d,a);return b}}();k.rotateBy=function(a,b,c){B(a,b);a.rotation+=c;return a};k.rotateTo=function(a,b,c){B(a,b);a.rotation=c;return a};k.scaleBy=function(){var a=c.create();return function(b,d,f,e,l){B(b,d);0!==f&&(k.toMap(a,e,d,l),b.scale=d.scale/f,k.toScreen(a,a,b,l),k.translateBy(b,b,c.set(a,
a[0]-e[0],e[1]-a[1])));return b}}();k.scaleTo=function(a,b,c){B(a,b);a.scale=c;return a};k.scaleAndRotateBy=function(){var a=c.create();return function(b,d,f,e,l,h){B(b,d);0!==f&&(k.toMap(a,l,d,h),b.scale=d.scale/f,b.rotation+=e,k.toScreen(a,a,b,h),k.translateBy(b,b,c.set(a,a[0]-l[0],l[1]-a[1])));return b}}();k.toMap=function(){var b=a.create();return function(a,d,f,e){return c.transformMat2d(a,d,H(b,f,e))}}();k.toScreen=function(){var b=a.create();return function(a,d,f,e){return c.transformMat2d(a,
d,k.getTransform(b,f,e))}}();k.translateBy=function(){var d=c.create(),f=a.create();return function(e,l,h){B(e,l);var g=E(l),n=e.targetGeometry;a.fromRotation(f,b.toRadian(l.rotation)||0);a.scale(f,f,c.fromValues(g,g));c.transformMat2d(d,h,f);n.x+=d[0];n.y+=d[1];return e}}()})},"esri/views/2d/math/common":function(){define([],function(){if(!m)var m=1E-6;if(!k)var k="undefined"!==typeof Float32Array?Float32Array:Array;if(!b)var b=Math.random;var a={GLMAT_EPSILON:m,GLMAT_ARRAY_TYPE:k,GLMAT_RANDOM:b,
setMatrixArrayType:function(b){a.GLMAT_ARRAY_TYPE=b}},c=Math.PI/180,h=180/Math.PI;a.toRadian=function(a){return a*c};a.toDegree=function(a){return a*h};a.setMatrixArrayType(Array);return a})},"esri/views/2d/math/mat2d":function(){define(["./common"],function(m){var k=m.GLMAT_ARRAY_TYPE;m={create:function(){var b=new k(6);b[0]=1;b[1]=0;b[2]=0;b[3]=1;b[4]=0;b[5]=0;return b},clone:function(b){var a=new k(6);a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];return a},copy:function(b,a){b[0]=
a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];return b},identity:function(b){b[0]=1;b[1]=0;b[2]=0;b[3]=1;b[4]=0;b[5]=0;return b},invert:function(b,a){var c=a[0],h=a[1],g=a[2],d=a[3],e=a[4];a=a[5];var l=c*d-h*g;if(!l)return null;l=1/l;b[0]=d*l;b[1]=-h*l;b[2]=-g*l;b[3]=c*l;b[4]=(g*a-d*e)*l;b[5]=(h*e-c*a)*l;return b},determinant:function(b){return b[0]*b[3]-b[1]*b[2]},multiply:function(b,a,c){var h=a[0],g=a[1],d=a[2],e=a[3],l=a[4];a=a[5];var f=c[0],n=c[1],u=c[2],t=c[3],r=c[4];c=c[5];b[0]=h*
f+d*n;b[1]=g*f+e*n;b[2]=h*u+d*t;b[3]=g*u+e*t;b[4]=h*r+d*c+l;b[5]=g*r+e*c+a;return b}};m.mul=m.multiply;m.rotate=function(b,a,c){var h=a[0],g=a[1],d=a[2],e=a[3],l=a[4];a=a[5];var f=Math.sin(c);c=Math.cos(c);b[0]=h*c+d*f;b[1]=g*c+e*f;b[2]=h*-f+d*c;b[3]=g*-f+e*c;b[4]=l;b[5]=a;return b};m.scale=function(b,a,c){var h=a[1],g=a[2],d=a[3],e=a[4],l=a[5],f=c[0];c=c[1];b[0]=a[0]*f;b[1]=h*f;b[2]=g*c;b[3]=d*c;b[4]=e;b[5]=l;return b};m.translate=function(b,a,c){var h=a[0],g=a[1],d=a[2],e=a[3],l=a[4];a=a[5];var f=
c[0];c=c[1];b[0]=h;b[1]=g;b[2]=d;b[3]=e;b[4]=h*f+d*c+l;b[5]=g*f+e*c+a;return b};m.fromRotation=function(b,a){var c=Math.sin(a);a=Math.cos(a);b[0]=a;b[1]=c;b[2]=-c;b[3]=a;b[4]=0;b[5]=0;return b};m.fromScaling=function(b,a){b[0]=a[0];b[1]=0;b[2]=0;b[3]=a[1];b[4]=0;b[5]=0;return b};m.fromTranslation=function(b,a){b[0]=1;b[1]=0;b[2]=0;b[3]=1;b[4]=a[0];b[5]=a[1];return b};m.str=function(b){return"mat2d("+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+", "+b[4]+", "+b[5]+")"};m.frob=function(b){return Math.sqrt(Math.pow(b[0],
2)+Math.pow(b[1],2)+Math.pow(b[2],2)+Math.pow(b[3],2)+Math.pow(b[4],2)+Math.pow(b[5],2)+1)};return m})},"esri/views/2d/math/vec2":function(){define(["./common"],function(m){var k=m.GLMAT_ARRAY_TYPE,b=m.GLMAT_RANDOM,a={create:function(){var a=new k(2);a[0]=0;a[1]=0;return a},clone:function(a){var b=new k(2);b[0]=a[0];b[1]=a[1];return b},fromValues:function(a,b){var c=new k(2);c[0]=a;c[1]=b;return c},copy:function(a,b){a[0]=b[0];a[1]=b[1];return a},set:function(a,b,g){a[0]=b;a[1]=g;return a},add:function(a,
b,g){a[0]=b[0]+g[0];a[1]=b[1]+g[1];return a},subtract:function(a,b,g){a[0]=b[0]-g[0];a[1]=b[1]-g[1];return a}};a.sub=a.subtract;a.multiply=function(a,b,g){a[0]=b[0]*g[0];a[1]=b[1]*g[1];return a};a.mul=a.multiply;a.divide=function(a,b,g){a[0]=b[0]/g[0];a[1]=b[1]/g[1];return a};a.div=a.divide;a.min=function(a,b,g){a[0]=Math.min(b[0],g[0]);a[1]=Math.min(b[1],g[1]);return a};a.max=function(a,b,g){a[0]=Math.max(b[0],g[0]);a[1]=Math.max(b[1],g[1]);return a};a.scale=function(a,b,g){a[0]=b[0]*g;a[1]=b[1]*
g;return a};a.scaleAndAdd=function(a,b,g,d){a[0]=b[0]+g[0]*d;a[1]=b[1]+g[1]*d;return a};a.distance=function(a,b){var c=b[0]-a[0];a=b[1]-a[1];return Math.sqrt(c*c+a*a)};a.dist=a.distance;a.squaredDistance=function(a,b){var c=b[0]-a[0];a=b[1]-a[1];return c*c+a*a};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0];a=a[1];return Math.sqrt(b*b+a*a)};a.len=a.length;a.squaredLength=function(a){var b=a[0];a=a[1];return b*b+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];
return a};a.inverse=function(a,b){a[0]=1/b[0];a[1]=1/b[1];return a};a.normalize=function(a,b){var c=b[0],d=b[1],c=c*c+d*d;0<c&&(c=1/Math.sqrt(c),a[0]=b[0]*c,a[1]=b[1]*c);return a};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]};a.cross=function(a,b,g){b=b[0]*g[1]-b[1]*g[0];a[0]=a[1]=0;a[2]=b;return a};a.lerp=function(a,b,g,d){var c=b[0];b=b[1];a[0]=c+d*(g[0]-c);a[1]=b+d*(g[1]-b);return a};a.random=function(a,h){h=h||1;var c=2*b()*Math.PI;a[0]=Math.cos(c)*h;a[1]=Math.sin(c)*h;return a};a.transformMat2=
function(a,b,g){var c=b[0];b=b[1];a[0]=g[0]*c+g[2]*b;a[1]=g[1]*c+g[3]*b;return a};a.transformMat2d=function(a,b,g){var c=b[0];b=b[1];a[0]=g[0]*c+g[2]*b+g[4];a[1]=g[1]*c+g[3]*b+g[5];return a};a.transformMat3=function(a,b,g){var c=b[0];b=b[1];a[0]=g[0]*c+g[3]*b+g[6];a[1]=g[1]*c+g[4]*b+g[7];return a};a.transformMat4=function(a,b,g){var c=b[0];b=b[1];a[0]=g[0]*c+g[4]*b+g[12];a[1]=g[1]*c+g[5]*b+g[13];return a};a.forEach=function(){var b=a.create();return function(a,c,d,e,l,f){c||(c=2);d||(d=0);for(e=e?
Math.min(e*c+d,a.length):a.length;d<e;d+=c)b[0]=a[d],b[1]=a[d+1],l(b,b,f),a[d]=b[0],a[d+1]=b[1];return a}}();a.str=function(a){return"vec2("+a[0]+", "+a[1]+")"};return a})},"esri/widgets/Popup/PopupRenderer":function(){define("require ../Widgette ./PopupRendererViewModel ../../core/requireUtils ../../core/watchUtils dojo/_base/lang dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/on dijit/_TemplatedMixin dijit/a11yclick dojo/i18n!./nls/PopupRenderer dojo/text!./templates/PopupRenderer.html".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f,n,u,t){var r={iconText:"esri-icon-font-fallback-text",iconLoading:"esri-icon-loading-indicator esri-rotating",iconDownload:"esri-icon-download",iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconRightTriangleArrow:"esri-icon-right-triangle-arrow",iconMedia:"esri-icon-media",iconChart:"esri-icon-chart",base:"esri-popup-renderer",container:"esri-popup-renderer__size-container",main:"esri-popup-renderer__main-container",btn:"esri-popup-renderer__button",icon:"esri-popup-renderer__icon",
content:"esri-popup-renderer__content",contentElement:"esri-popup-renderer__content-element",text:"esri-popup-renderer__text",showMediaPagination:"esri-popup-renderer--media-pagination-visible",attachments:"esri-popup-renderer__attachments",attachmentsTitle:"esri-popup-renderer__attachments-title",attachmentsItem:"esri-popup-renderer__attachments-item",attachmentsItemIcon:"esri-popup-renderer__attachments-item-icon",fields:"esri-popup-renderer__fields",fieldHeader:"esri-popup-renderer__field-header",
fieldData:"esri-popup-renderer__field-data",fieldDataDate:"esri-popup-renderer__field-data--date",media:"esri-popup-renderer__media",mediaContainer:"esri-popup-renderer__media-container",mediaItemContainer:"esri-popup-renderer__media-item-container",mediaItem:"esri-popup-renderer__media-item",mediaItemTitle:"esri-popup-renderer__media-item-title",mediaItemCaption:"esri-popup-renderer__media-item-caption",mediaPrevious:"esri-popup-renderer__media-previous",mediaPreviousIconLTR:"esri-popup-renderer__media-previous-icon",
mediaPreviousIconRTL:"esri-popup-renderer__media-previous-icon--rtl",mediaNext:"esri-popup-renderer__media-next",mediaNextIconLTR:"esri-popup-renderer__media-next-icon",mediaNextIconRTL:"esri-popup-renderer__media-next-icon--rtl",mediaSummary:"esri-popup-renderer__media-summary",mediaCount:"esri-popup-renderer__media-count",mediaImageSummary:"esri-popup-renderer__media-image-summary",mediaImageIcon:"esri-popup-renderer__media-image-icon",mediaChart:"esri-popup-renderer__media-chart",mediaChartSummary:"esri-popup-renderer__media-chart-summary",
mediaChartIcon:"esri-popup-renderer__media-chart-icon",loading:"esri-popup-renderer__loading",loadingSpinnerContainer:"esri-popup-renderer__loading-container",spinner:"esri-popup-renderer__loading-spinner"},w=/^\s*(https?:\/\/[^\s]+)\s*$/i;return k.createSubclass([f],{declaredClass:"esri.widgets.Popup.PopupRenderer",templateString:t,baseClass:r.base,constructor:function(){this._charts=[];this._chartTooltips=[]},postCreate:function(){this.inherited(arguments);var a=this;this.own(c.init(this,"viewModel.waitingForContent",
this._loadingSpinner.bind(this)),c.init(this,"viewModel.graphic",this._graphicChanged.bind(this)),c.init(this,"viewModel.content",this._render.bind(this)),l(this._contentNode,l.selector("."+r.mediaNext,n),function(){a._nextMedia(this)}),l(this._contentNode,l.selector("."+r.mediaPrevious,n),function(){a._previousMedia(this)}))},destroy:function(){this._destroyCharts();this._clearResizeTimer()},properties:{viewModel:{type:b},rendered:{readOnly:!0,value:!1}},_i18n:u,_css:r,resize:function(){this._resizeCharts();
this.emit("resize")},_clearResizeTimer:function(){this._mediaResizeTimer&&(clearTimeout(this._mediaResizeTimer),this._mediaResizeTimer=0)},_countMediaInfos:function(a){var b=0,c=0;a.forEach(function(a){"image"===a.type?b++:-1!==a.type.indexOf("chart")&&c++});return{total:c+b,images:b,charts:c}},_createMediaNodes:function(a){this._destroyCharts();var b=a.mediaIndex,c=a.mediaInfos[b];a=a.node;e.empty(a);var d=e.create("div",{className:r.mediaItem},a),b=this._createMediaType(c,b);e.place(b,d,"only");
c.title&&e.create("div",{className:r.mediaItemTitle,innerHTML:c.title},a);c.caption&&e.create("div",{className:r.mediaItemCaption,innerHTML:c.caption},a);this._clearResizeTimer();this._mediaResizeTimer=setTimeout(function(){this.resize();this._clearResizeTimer()}.bind(this),0)},_createMediaType:function(b,c){c=b.value;var d;if("image"===b.type){var f=e.create("img",{alt:b.title||"",src:c.sourceURL});c.linkURL?(d=e.create("a",{title:b.title||"",href:c.linkURL,target:this._preventNewTab(c.linkURL)?
"":"_blank"}),e.place(f,d)):d=f}else-1!==b.type.indexOf("chart")&&(d=e.create("div",{className:r.mediaChart},d),c=["dojox/charting/Chart2D","dojox/charting/action2d/Tooltip"],f=b.value.theme||this.chartTheme,"string"===typeof f&&(f=f.replace(/\./gi,"/"),-1===f.indexOf("/")&&(f="dojox/charting/themes/"+f)),f||(f="dojox/charting/themes/Claro"),c.push(f),this._cancelChartModules(),this._chartsPromise=a.when(m,c).then(function(a){this._showChart(d,b.type,b.value,a[0],a[1],a[2]);this._chartsPromise=null}.bind(this)));
return d},_cancelChartModules:function(){this._chartsPromise&&this._chartsPromise.cancel()},_destroyCharts:function(){this._cancelChartModules();var a;if(this._chartTooltips&&this._chartTooltips.length)for(a=0;a<this._chartTooltips.length;a++)this._chartTooltips[a].destroy();this._chartTooltips.length=0;if(this._charts&&this._charts.length)for(a=0;a<this._charts.length;a++)this._charts[a].destroy();this._charts.length=0},_graphicChanged:function(){this._set("rendered",!1)},_loadingSpinner:function(a){d.toggle(this.domNode,
r.loading,!!a)},_nextMedia:function(a){this._pageMedia(a,"next")},_pageMedia:function(a,b){var c;if(a=g.get(a,"data-element-index"))c=parseInt(a,10),c=this._elementInfo[c];if(c){a=c.mediaInfos;var d=c.mediaIndex;"previous"===b?d--:d++;a&&a.length&&(d=(d+a.length)%a.length);c.mediaIndex=d;this._createMediaNodes(c)}},_preventNewTab:function(a){return(a=a&&h.trim(a).toLowerCase())&&(0===a.indexOf("mailto:")||0===a.indexOf("tel:"))},_previousMedia:function(a){this._pageMedia(a,"previous")},_render:function(a){this._elementInfo=
[];this._destroyCharts();e.empty(this._contentNode);var b=this.viewModel;a&&("string"===typeof a?(a=this._renderText({type:"text",text:a}))&&e.place(a,this._contentNode,"only"):a.nodeName?e.place(a,this._contentNode,"only"):Array.isArray(a)&&a.forEach(function(a,c){var d;switch(a.type){case b.contentTypes.attachments:d=this._renderAttachments(a,c);break;case b.contentTypes.fields:d=this._renderFields(a,c);break;case b.contentTypes.media:d=this._renderMedia(a,c);break;case b.contentTypes.text:d=this._renderText(a,
c)}d&&e.place(d,this._contentNode,0===c?"only":"last")},this));this.resize();setTimeout(function(){this._set("rendered",!0)}.bind(this),0)},_renderAttachments:function(a,b){var c;if((a=a.attachmentInfos)&&a.length){c=e.create("div");d.add(c,[r.attachments,r.contentElement]);e.create("div",{className:r.attachmentsTitle,textContent:u.attach},c);var f=e.create("ul",{},c);a.forEach(function(a){var b=e.create("li",{},f),b=e.create("a",{href:a.url,target:"_blank"},b);e.create("span",{className:r.iconDownload+
" "+r.attachmentsItemIcon},b);e.create("span",{className:r.attachmentsItem,textContent:a.name||u.noTitle},b)},this)}return c},_renderFields:function(a,b){var c=this.viewModel,f,l=c.graphic.getEffectivePopupTemplate();if(a=a.fieldInfos||l&&l.fieldInfos){var n=c.formattedAttributes.content[b]||c.formattedAttributes.global;f=e.create("div");d.add(f,[r.fields,r.contentElement]);b=e.create("table",{summary:u.fieldsSummary},f);var g=e.create("tbody",{},b);a.forEach(function(a){if(a.hasOwnProperty("visible")?
a.visible:1){var b=a.fieldName,c=a.label||b,b=n[b]||"",f;a=a.format&&a.format.dateFormat;b&&"string"===typeof b&&(f=b.replace(w,'\x3ca target\x3d"_blank" href\x3d"$1" title\x3d"'+c+'"\x3e'+u.view+"\x3c/a\x3e"));var l=e.create("tr",{},g),h=c,q=b;f&&f!==b&&(h=c,q=f);e.create("th",{className:r.fieldHeader,innerHTML:h},l);c=e.create("td",{className:r.fieldData,innerHTML:q},l);a&&d.add(c,r.fieldDataDate)}},this)}return f},_renderMedia:function(a,b){var c,f=a.mediaInfos;if(f&&f.length){var l=this._countMediaInfos(f);
a={tabIndex:"0",role:"button"};a["data-element-index"]=b;c=e.create("div");d.add(c,[r.media,r.contentElement]);d.toggle(c,r.showMediaPagination,1<l.total);var n=e.create("ul",{className:r.mediaSummary},c),g=e.create("li",{className:r.mediaImageSummary},n);e.create("span",{className:r.mediaCount,"aria-label":u.numImages,textContent:"("+l.images+")"},g);e.create("span",{"aria-hidden":!0,className:r.mediaImageIcon+" "+r.iconMedia},g);n=e.create("li",{className:r.mediaImageSummary},n);e.create("span",
{className:r.mediaCount,"aria-label":u.numCharts,textContent:"("+l.charts+")"},n);e.create("span",{"aria-hidden":!0,className:r.mediaChartIcon+" "+r.iconChart},n);l=e.create("div",{className:r.mediaContainer},c);n=e.create("div",h.mixin({title:u.previous},a),l);d.add(n,[r.btn,r.mediaPrevious]);g=e.create("span",{"aria-hidden":!0},n);d.add(g,[r.icon,r.mediaPreviousIconLTR,r.iconLeftTriangleArrow]);g=e.create("span",{"aria-hidden":!0},n);d.add(g,[r.icon,r.mediaPreviousIconRTL,r.iconRightTriangleArrow]);
e.create("span",{className:r.iconText,textContent:u.previous},n);f={mediaIndex:0,node:e.create("div",{className:r.mediaItemContainer},l),mediaInfos:f};this._elementInfo[b]=f;this._createMediaNodes(f);b=e.create("div",h.mixin({title:u.next},a),l);d.add(b,[r.btn,r.mediaNext]);a=e.create("span",{"aria-hidden":!0},b);d.add(a,[r.icon,r.mediaNextIconLTR,r.iconRightTriangleArrow]);a=e.create("span",{"aria-hidden":!0},b);d.add(a,[r.icon,r.mediaNextIconRTL,r.iconLeftTriangleArrow]);e.create("span",{className:r.iconText,
textContent:u.next},b)}return c},_renderText:function(a,b){var c;a&&a.text&&(c=e.create("div",{innerHTML:a.text}),d.add(c,[r.text,r.contentElement]));return c},_resizeCharts:function(){if(this._charts&&this._charts.length)for(var a=0;a<this._charts.length;a++){var b=this._charts[a],c=b.node;c&&c.offsetWidth&&c.offsetHeight&&b.resize()}},_showChart:function(a,b,c,d,f,e){a=new d(a,{margins:{l:4,t:4,r:4,b:4}});e&&a.setTheme(e);switch(b){case "pie-chart":a.addPlot("default",{type:"Pie",labels:!1});a.addSeries("Series A",
c.fields);break;case "line-chart":a.addPlot("default",{type:"Markers"});a.addAxis("x",{min:0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1});a.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});c.fields.forEach(function(a,b){a.x=b+1});a.addSeries("Series A",c.fields);break;case "column-chart":a.addPlot("default",{type:"Columns",gap:3});a.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});a.addSeries("Series A",c.fields);break;case "bar-chart":a.addPlot("default",{type:"Bars",
gap:3}),a.addAxis("x",{includeZero:!0,fixUpper:"minor",minorLabels:!1}),a.addAxis("y",{vertical:!0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1}),a.addSeries("Series A",c.fields)}b=new f(a);a.render();this._charts.push(a);this._chartTooltips.push(b)}})})},"esri/widgets/Spinner":function(){define(["./Widgette","./support/AnchorElementViewModel","dojo/i18n!./Spinner/nls/Spinner","dojo/dom-class","dojo/dom-style"],function(m,k,b,a,c){var h={base:"esri-spinner",visible:"esri-spinner--visible",
spinnerStart:"esri-spinner--start",spinnerFinish:"esri-spinner--finish"};return m.createSubclass({properties:{viewModel:{type:k}},declaredClass:"esri.widgets.Spinner",baseClass:h.base,postCreate:function(){this.inherited(arguments);this.own(this.viewModel.watch("point",function(a){this._setDomClasses(a)}.bind(this)),this.viewModel.watch("screenPoint",function(a){this._positionDomNode(a)}.bind(this)))},destroy:function(){this._clearTimeout()},_css:h,_i18n:b,animationDelay:500,visible:!0,_setVisibleAttr:function(a){this._set("visible",
a);this._visibleChange()},_clearTimeout:function(){this._resetTimeout&&clearTimeout(this._resetTimeout)},_setDomClasses:function(b){this.visible&&b?(a.remove(this.domNode,h.spinnerStart),a.remove(this.domNode,h.spinnerFinish),this.domNode.offsetWidth=this.domNode.offsetWidth,a.add(this.domNode,h.spinnerStart)):this.visible&&!b?a.add(this.domNode,h.spinnerFinish):(a.remove(this.domNode,h.spinnerStart),a.remove(this.domNode,h.spinnerFinish))},_positionDomNode:function(a){a?c.set(this.domNode,{left:a.x+
"px",top:a.y+"px"}):(this._clearTimeout(),this._resetTimeout=setTimeout(function(){c.set(this.domNode,{left:"",top:""});this._resetTimeout=0}.bind(this),this.animationDelay))},_visibleChange:function(){a.toggle(this.domNode,h.visible,this.visible)}})})},"esri/widgets/support/AnchorElementViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/watchUtils ../../core/Accessor ../../core/HandleRegistry".split(" "),
function(m,k,b,a,c,h,g,d){m=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b._handles=new d;b.screenPoint=null;b.state="disabled";return b}b(c,a);c.prototype.destroy=function(){this._viewReady&&this._viewReady.cancel();this.view=null;this._handles.destroy();this._viewWatch=this._handles=null};Object.defineProperty(c.prototype,"point",{set:function(a){this._viewControl(a);this._createScreenPoint(a,this.view);this._set("point",a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"view",{set:function(a){var b=this;this._handles&&(this._handles.remove("viewHandles"),this._viewWatch=null);this._viewReady&&this._viewReady.cancel();this._set("state","disabled");a&&(this._viewReady=a.then(function(){b._set("state","ready");var c="viewpoint";"3d"===a.type&&(c="camera");b._viewWatch=h.pausable(a,c,function(){b._createScreenPoint(b.point,b.view)});b._handles.add(b._viewWatch,"viewHandles");b._viewControl(b.point)}));this._set("view",a)},enumerable:!0,configurable:!0});c.prototype._viewControl=
function(a){this._viewWatch&&(a?this._viewWatch.resume():this._viewWatch.pause())};c.prototype._createScreenPoint=function(a,b){this.screenPoint=a?b.toScreen(a.x,a.y,a.z):null};return c}(c.declared(g));a([c.property()],m.prototype,"point",null);a([c.property()],m.prototype,"screenPoint",void 0);a([c.property({readOnly:!0})],m.prototype,"state",void 0);a([c.property()],m.prototype,"view",null);return m=a([c.subclass("esri.widgets.support.AnchorElementViewModel")],m)})},"esri/widgets/Message":function(){define(["./Widgette",
"./support/AnchorElementViewModel","dojo/dom-class","dojo/dom-construct","dojo/dom-style"],function(m,k,b,a,c){var h={base:"esri-message",visible:"esri-message--visible",text:"esri-message__text",messageFadeIn:"esri-message--fade-in"};return m.createSubclass({properties:{viewModel:{type:k}},declaredClass:"esri.widgets.Message",baseClass:h.base,constructor:function(){this._text=a.create("span",{className:h.text})},postCreate:function(){this.inherited(arguments);a.place(this._text,this.domNode);this.own(this.viewModel.watch("point",
function(a){this._setDomClasses(a)}.bind(this)),this.viewModel.watch("screenPoint",function(a){this._positionDomNode(a)}.bind(this)))},destroy:function(){this._clearTimeout()},_css:h,animationDelay:3E3,visible:!0,_setVisibleAttr:function(a){this._set("visible",a);this._visibleChange()},text:"",_setTextAttr:{node:"_text",type:"innerText"},_clearTimeout:function(){this._resetTimeout&&(clearTimeout(this._resetTimeout),this._resetTimeout=0)},_setDomClasses:function(a){this._clearTimeout();b.remove(this.domNode,
h.messageFadeIn);this.domNode.offsetWidth=this.domNode.offsetWidth;a&&(b.add(this.domNode,h.messageFadeIn),this._resetTimeout=setTimeout(function(){this.viewModel.point=null;this._resetTimeout=0}.bind(this),this.animationDelay))},_positionDomNode:function(a){a?c.set(this.domNode,{left:a.x+"px",top:a.y+"px"}):c.set(this.domNode,{left:"",top:""})},_visibleChange:function(){b.toggle(this.domNode,h.visible,this.visible)}})})},"esri/views/ui/DefaultUI":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/watchUtils ./UI ./Component ../../widgets/Attribution ../../widgets/Compass ../../widgets/Zoom ../../widgets/NavigationToggle dojo/dom-geometry".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f,n,u){m=function(a){function c(b){b=a.call(this)||this;b._defaultPositionLookup=null;b.components=[];return b}b(c,a);c.prototype.initialize=function(){this._handles.add([h.init(this,"components",this._componentsWatcher.bind(this)),h.init(this,"view",this._updateViewAwareWidgets.bind(this))])};c.prototype._findComponentPosition=function(a){if(!this._defaultPositionLookup){var b=u.isBodyLtr();this._defaultPositionLookup={attribution:"manual",compass:b?"top-left":"top-right",
"navigation-toggle":b?"top-left":"top-right",zoom:b?"top-left":"top-right"}}return this._defaultPositionLookup[a]};c.prototype._removeComponents=function(a){var b=this;a.forEach(function(a){if(a=b.find(a))b.remove(a),a.destroy()})};c.prototype._updateViewAwareWidgets=function(a){var b=this;this.components.forEach(function(c){(c=(c=b.find(c))&&c.widget)&&void 0!==c.view&&c.set("view",a)})};c.prototype._componentsWatcher=function(a,b){this._removeComponents(b);this._addComponents(a)};c.prototype._addComponents=
function(a){var b=this;this.initialized&&a.forEach(function(a){return b.add(b._createComponent(a),b._findComponentPosition(a))})};c.prototype._createComponent=function(a){var b=this._createWidget(a);if(b)return new d({id:a,node:b})};c.prototype._createWidget=function(a){if("attribution"===a)return this._createAttribution();if("compass"===a)return this._createCompass();if("navigation-toggle"===a)return this._createNavigationToggle();if("zoom"===a)return this._createZoom()};c.prototype._createAttribution=
function(){return new e({view:this.view})};c.prototype._createCompass=function(){return new l({view:this.view})};c.prototype._createNavigationToggle=function(){return new n({view:this.view})};c.prototype._createZoom=function(){return new f({view:this.view})};return c}(c.declared(g));a([c.property()],m.prototype,"components",void 0);return m=a([c.subclass("esri.views.ui.DefaultUI")],m)})},"esri/views/ui/UI":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./Component ../../core/Accessor ../../core/HandleRegistry ../../core/watchUtils dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/dom-style".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f,n,u){function t(a){return"object"!==typeof a||a&&a.isInstanceOf&&a.isInstanceOf(h)||!("component"in a||"index"in a||"position"in a)?null:a}var r={left:0,top:0,bottom:0,right:0},w={bottom:30,top:15,right:15,left:15};m=function(a){function c(){var b=a.call(this)||this;b._cornerNameToContainerLookup={};b._positionNameToContainerLookup={};b._components=[];b._handles=new d;b.padding=w;b.view=null;b._initContainers();return b}b(c,a);c.prototype.initialize=function(){this._handles.add([e.init(this,
"view.padding, container",this._applyViewPadding.bind(this)),e.init(this,"padding",this._applyUIPadding.bind(this))])};c.prototype.destroy=function(){this.container=null;this._components.forEach(function(a){a.destroy()});this._components.length=0;this._handles.destroy()};Object.defineProperty(c.prototype,"container",{set:function(a){var b=this._get("container");a!==b&&(a&&(f.add(a,"esri-ui"),this._attachContainers(a)),b&&(f.remove(b,"esri-ui"),u.set(b,{top:"",bottom:"",left:"",right:""}),n.empty(b)),
this._set("container",a))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"height",{get:function(){var a=this.get("view.height")||0;if(0===a)return a;var b=this._getViewPadding();return Math.max(a-(b.top+b.bottom),0)},enumerable:!0,configurable:!0});c.prototype.castPadding=function(a){return"number"===typeof a?{bottom:a,top:a,right:a,left:a}:l.mixin({},w,a)};Object.defineProperty(c.prototype,"width",{get:function(){var a=this.get("view.width")||0;if(0===a)return a;var b=this._getViewPadding();
return Math.max(a-(b.left+b.right),0)},enumerable:!0,configurable:!0});c.prototype.add=function(a,b){var c=this,d;if(Array.isArray(a))a.forEach(function(a){return c.add(a,b)});else{var f=t(a);f&&(d=f.index,b=f.position,a=f.component);b&&"object"===typeof b&&(d=b.index,b=b.position);!a||b&&!this._isValidPosition(b)||(a&&a.isInstanceOf&&a.isInstanceOf(h)||(a=new h({node:a})),this._place({component:a,position:b,index:d}),this._components.push(a))}};c.prototype.remove=function(a){if(a){if(Array.isArray(a))return a.map(this.remove,
this);if(a=this.find(a)){var b=this._components.indexOf(a);a.node.parentNode&&a.node.parentNode.removeChild(a.node);return this._components.splice(b,1)[0]}}};c.prototype.empty=function(a){var b=this;if(Array.isArray(a))return a.map(function(a){return b.empty(a)}).reduce(function(a,b){return a.concat(b)});a=a||"manual";if("manual"===a)return Array.prototype.slice.call(this._manualContainer.children).filter(function(a){return!f.contains(a,"esri-ui-corner")}).map(function(a){return b.remove(a)});if(this._isValidPosition(a))return Array.prototype.slice.call(this._cornerNameToContainerLookup[a].children).map(this.remove,
this)};c.prototype.move=function(a,b){var c=this;Array.isArray(a)&&a.forEach(function(a){return c.move(a,b)});if(a){var d,f=t(a)||t(b);f&&(d=f.index,b=f.position,a=f.component||a);(!b||this._isValidPosition(b))&&(a=this.remove(a))&&this.add(a,{position:b,index:d})}};c.prototype.find=function(a){return a?a&&a.isInstanceOf&&a.isInstanceOf(h)?this._findByComponent(a):"string"===typeof a?this._findById(a):this._findByNode(a.domNode||a):null};c.prototype._getViewPadding=function(){return this.get("view.padding")||
r};c.prototype._attachContainers=function(a){n.place(this._manualContainer,a);n.place(this._innerContainer,a)};c.prototype._initContainers=function(){var a=n.create("div",{className:"esri-ui-inner-container esri-ui-corner-container"}),b=n.create("div",{className:"esri-ui-inner-container esri-ui-manual-container"}),c=n.create("div",{className:"esri-ui-top-left esri-ui-corner"},a),d=n.create("div",{className:"esri-ui-top-right esri-ui-corner"},a),f=n.create("div",{className:"esri-ui-bottom-left esri-ui-corner"},
a),e=n.create("div",{className:"esri-ui-bottom-right esri-ui-corner"},a);this._innerContainer=a;this._manualContainer=b;this._cornerNameToContainerLookup={"top-left":c,"top-right":d,"bottom-left":f,"bottom-right":e};this._positionNameToContainerLookup=l.mixin({manual:b},this._cornerNameToContainerLookup)};c.prototype._isValidPosition=function(a){return!!this._positionNameToContainerLookup[a]};c.prototype._place=function(a){var b=a.component,c=a.index;a=this._positionNameToContainerLookup[a.position||
"manual"];var d;-1<c?(d=Array.prototype.slice.call(a.children),0===c?this._placeComponent(b,a,"first"):c>=d.length?this._placeComponent(b,a,"last"):this._placeComponent(b,d[c],"before")):this._placeComponent(b,a,"last")};c.prototype._placeComponent=function(a,b,c){var d=a.widget;d&&!d._started&&"function"===typeof d.postMixInProperties&&"function"===typeof d.buildRendering&&"function"===typeof d.postCreate&&"function"===typeof d.startup&&a.widget.startup();n.place(a.node,b,c)};c.prototype._applyViewPadding=
function(){var a=this.container;a&&u.set(a,this._toPxPosition(this._getViewPadding()))};c.prototype._applyUIPadding=function(){this._innerContainer&&u.set(this._innerContainer,this._toPxPosition(this.padding))};c.prototype._toPxPosition=function(a){return{top:this._toPxUnit(a.top),left:this._toPxUnit(a.left),right:this._toPxUnit(a.right),bottom:this._toPxUnit(a.bottom)}};c.prototype._toPxUnit=function(a){return 0===a?0:a+"px"};c.prototype._findByComponent=function(a){var b=null,c;this._components.some(function(d){(c=
d===a)&&(b=d);return c});return b};c.prototype._findById=function(a){var b=null,c;this._components.some(function(d){(c=d.id===a)&&(b=d);return c});return b};c.prototype._findByNode=function(a){var b=null,c;this._components.some(function(d){(c=d.node===a)&&(b=d);return c});return b};return c}(c.declared(g));a([c.property()],m.prototype,"container",null);a([c.property()],m.prototype,"height",null);a([c.property()],m.prototype,"padding",void 0);a([c.cast("padding")],m.prototype,"castPadding",null);a([c.property()],
m.prototype,"view",void 0);a([c.property()],m.prototype,"width",null);return m=a([c.subclass("esri.views.ui.UI")],m)})},"esri/views/ui/Component":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor dojo/dom dojo/dom-class".split(" "),function(m,k,b,a,c,h,g,d){m=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b.widget=null;return b}b(c,a);c.prototype.destroy=
function(){this.widget&&this.widget.destroy();this.node=null};Object.defineProperty(c.prototype,"id",{get:function(){return this._get("id")||this.get("node.id")},set:function(a){this._set("id",a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"node",{set:function(a){var b=this._get("node");a!==b&&(a&&d.add(a,"esri-component"),b&&d.remove(b,"esri-component"),this._set("node",a))},enumerable:!0,configurable:!0});c.prototype.castNode=function(a){if(!a)return this._set("widget",null),
null;if("string"===typeof a||a&&"nodeType"in a)return this._set("widget",null),g.byId(a);a&&"function"===typeof a.render&&!a.domNode&&(a.domNode=document.createElement("div"));this._set("widget",a);return a.domNode};return c}(c.declared(h));a([c.property()],m.prototype,"id",null);a([c.property()],m.prototype,"node",null);a([c.cast("node")],m.prototype,"castNode",null);a([c.property({readOnly:!0})],m.prototype,"widget",void 0);return m=a([c.subclass("esri.views.ui.Component")],m)})},"esri/widgets/Attribution":function(){define("require exports ../core/tsSupport/assignHelper ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ./support/widget ./Widget ./Attribution/AttributionViewModel".split(" "),
function(m,k,b,a,c,h,g,d,e){m=function(c){function d(a){a=c.call(this)||this;a._isOpen=!1;a._attributionTextOverflowed=!1;a._prevSourceNodeHeight=0;a.view=null;a.viewModel=new e;return a}a(d,c);d.prototype.render=function(){var a=(b={},b["esri-attribution--open"]=this._isOpen,b);return g.jsxFactory.createElement("div",{bind:this,class:"esri-attribution esri-widget",classes:a,onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),g.jsxFactory.createElement("div",{class:"esri-attribution__powered-by"},
"Powered by ",g.jsxFactory.createElement("a",{target:"_blank",href:"http://www.esri.com/",class:"esri-attribution__link"},"Esri")));var b};d.prototype._renderSourcesNode=function(){var a=this._isOpen,c=this._isInteractive(),d=c?0:-1,f=this.get("viewModel.attributionText"),a=(e={},e["esri-attribution__sources--open"]=a,e["esri-interactive"]=c,e),d={afterCreate:this._afterSourcesNodeCreate,afterUpdate:this._afterSourcesNodeUpdate,bind:this,class:"esri-attribution__sources",classes:a,key:c?"interactive":
"non-interactive",tabIndex:d};c&&(d.role="button");return g.jsxFactory.createElement("div",b({},d),f);var e};d.prototype._afterSourcesNodeCreate=function(a){this._prevSourceNodeHeight=a.clientWidth};d.prototype._afterSourcesNodeUpdate=function(a){var b=!1,c=a.clientHeight;a=a.scrollWidth>a.clientWidth;var d=this._attributionTextOverflowed!==a;this._attributionTextOverflowed=a;d&&(b=!0);this._isOpen&&(a=c<this._prevSourceNodeHeight,this._prevSourceNodeHeight=c,a&&(this._isOpen=!1,b=!0));b&&this.renderNow()};
d.prototype._toggleState=function(){this._isInteractive()&&(this._isOpen=!this._isOpen)};d.prototype._isInteractive=function(){return this._isOpen||this._attributionTextOverflowed};return d}(h.declared(d));c([h.aliasOf("viewModel.view")],m.prototype,"view",void 0);c([h.property({type:e}),g.renderable(["attributionText","state","view.size"])],m.prototype,"viewModel",void 0);c([g.accessibleHandler()],m.prototype,"_toggleState",null);return m=c([h.subclass("esri.widgets.Attribution")],m)})},"esri/core/tsSupport/assignHelper":function(){define([],
function(){return Object.assign||function(m){for(var k,b=1,a=arguments.length;b<a;b++){k=arguments[b];for(var c in k)Object.prototype.hasOwnProperty.call(k,c)&&(m[c]=k[c])}return m}})},"esri/widgets/support/widget":function(){define(["require","exports","./decorators","./jsxFactory","./widgetUtils"],function(m,k,b,a,c){function h(a){for(var b in a)k.hasOwnProperty(b)||(k[b]=a[b])}h(b);h(a);h(c)})},"esri/widgets/support/decorators":function(){define("require exports ./decorators/accessibleHandler ./decorators/renderable ./decorators/triggerWithSpaceOrEnter ./decorators/vmEvent ./decorators/vmMethod ./decorators/vmProperty".split(" "),
function(m,k,b,a,c,h,g,d){function e(a){for(var b in a)k.hasOwnProperty(b)||(k[b]=a[b])}e(b);e(a);e(c);e(h);e(g);e(d)})},"esri/widgets/support/decorators/accessibleHandler":function(){define(["require","exports","dojo/keys"],function(m,k,b){function a(a){return function(c){for(var h=[],d=1;d<arguments.length;d++)h[d-1]=arguments[d];d=c.type;if(c instanceof KeyboardEvent||"keyup"===d||"keydown"===d||"keypress"===d){if(c.keyCode===b.ENTER||c.keyCode===b.SPACE)c.preventDefault(),c.target.click()}else a.call.apply(a,
[this,c].concat(h))}}k.accessibleHandler=function(){return function(b,h){return{value:a(b[h])}}}})},"esri/widgets/support/decorators/renderable":function(){define(["require","exports","./propUtils"],function(m,k,b){k.renderable=function(a){var c="string"===typeof a?b.splitProps(a):a;return function(a,g){a._renderableProps||(a._renderableProps=[]);a=a._renderableProps;c?a.push.apply(a,b.normalizePropNames(c,g)):a.push(g)}}})},"esri/widgets/support/decorators/propUtils":function(){define(["require",
"exports"],function(m,k){k.splitProps=function(b){return b.split(",").map(function(a){return a.trim()})};k.normalizePropNames=function(b,a){return b.map(function(b){b=0===b.indexOf(a)?b:a+"."+b;return b})}})},"esri/widgets/support/decorators/triggerWithSpaceOrEnter":function(){define(["require","exports","../../../core/Logger","./accessibleHandler"],function(m,k,b,a){k.triggerWithSpaceOrEnter=function(){b.getLogger("esri.widgets.support.decorators.triggerWithSpaceOrEnter").warn("@triggerWithSpaceOrEnter is deprecated, use @accessibleHandler instead.");
return a.accessibleHandler.apply(this,arguments)}})},"esri/widgets/support/decorators/vmEvent":function(){define(["require","exports","./propUtils"],function(m,k,b){k.vmEvent=function(a){return function(c){c._delegatedEventNames||(c._delegatedEventNames=[]);var h=Array.isArray(a)?a:b.splitProps(a);c._delegatedEventNames=c._delegatedEventNames.concat(h)}}})},"esri/widgets/support/decorators/vmMethod":function(){define(["require","exports","../../../core/accessorSupport/get"],function(m,k,b){k.vmMethod=
function(){console.warn("@vmMethod is deprecated, use @aliasOf instead");return function(a,c,h){var g="viewModel."+c,d;h.value=function(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];if(c=b.default(this,g))return d||(d=g.split(".").slice(0,-1).join(".")),c=c.bind(b.default(this,d)),c.call.apply(c,[this].concat(a))}}}})},"esri/widgets/support/decorators/vmProperty":function(){define(["require","exports","../../../core/accessorSupport/decorators"],function(m,k,b){k.vmProperty=function(a){var c=
this;console.warn("@vmProperty is deprecated, use @aliasOf instead");return function(h,g){b.property.call(c,{aliasOf:"viewModel."+(a||g)}).call(c,h,g)}}})},"esri/widgets/support/jsxFactory":function(){define(["require","exports","../libs/maquette/maquette"],function(m,k,b){k.jsxFactory={createElement:b.h}})},"esri/widgets/libs/maquette/maquette":function(){(function(m,k){"function"===typeof define&&define.amd?define(["exports"],k):"object"===typeof exports&&"string"!==typeof exports.nodeName?k(exports):
k(m.maquette={})})(this,function(m){var k=[],b=function(a,b){var c={};Object.keys(a).forEach(function(b){c[b]=a[b]});b&&Object.keys(b).forEach(function(a){c[a]=b[a]});return c},a=function(a,b){return a.vnodeSelector!==b.vnodeSelector?!1:a.properties&&b.properties?a.properties.key!==b.properties.key?!1:a.properties.bind===b.properties.bind:!a.properties&&!b.properties},c=function(a){return{vnodeSelector:"",properties:void 0,children:void 0,text:a.toString(),domNode:null}},h=function(a,b,d){for(var f=
0,e=b.length;f<e;f++){var l=b[f];Array.isArray(l)?h(a,l,d):null!==l&&void 0!==l&&(l.hasOwnProperty("vnodeSelector")||(l=c(l)),d.push(l))}},g=function(){throw Error("Provide a transitions object to the projectionOptions to do animations");},d={namespace:void 0,eventHandlerInterceptor:void 0,styleApplyer:function(a,b,c){a.style[b]=c},transitions:{enter:g,exit:g}},e=function(a){if("string"!==typeof a)throw Error("Style values must be strings");},l=function(a,b,c){if(b)for(var d=c.eventHandlerInterceptor,
f=Object.keys(b),l=f.length,n=0;n<l;n++){var h=f[n],g=b[h];if("className"===h)throw Error('Property "className" is not supported, use "class".');if("class"===h)g.split(/\s+/).forEach(function(b){return a.classList.add(b)});else if("classes"===h)for(var q=Object.keys(g),u=q.length,h=0;h<u;h++){var t=q[h];g[t]&&a.classList.add(t)}else if("styles"===h)for(q=Object.keys(g),u=q.length,h=0;h<u;h++){var t=q[h],r=g[t];r&&(e(r),c.styleApplyer(a,t,r))}else"key"!==h&&null!==g&&void 0!==g&&(q=typeof g,"function"===
q?0===h.lastIndexOf("on",0)&&(d&&(g=d(h,g,a,b)),"oninput"===h&&function(){var a=g;g=function(b){b.target["oninput-value"]=b.target.value;a.apply(this,[b])}}(),a[h]=g):"string"===q&&"value"!==h&&"innerHTML"!==h?"http://www.w3.org/2000/svg"===c.namespace&&"href"===h?a.setAttributeNS("http://www.w3.org/1999/xlink",h,g):a.setAttribute(h,g):a[h]=g)}},f=function(a,b){var c=a.domNode;if(a.properties){var d=a.properties.exitAnimation;if(d){c.style.pointerEvents="none";var f=function(){c.parentNode&&c.parentNode.removeChild(c)};
"function"===typeof d?d(c,f,a.properties):b.exit(a.domNode,a.properties,d,f);return}}c.parentNode&&c.parentNode.removeChild(c)},n=function(b,c,d,f){var e=b[c];if(""!==e.vnodeSelector){var l=e.properties;if(!(l&&(void 0===l.key?l.bind:l.key)))for(l=0;l<b.length;l++)if(l!==c&&a(b[l],e)){if("added"===f)throw Error(d.vnodeSelector+" had a "+e.vnodeSelector+" child added, but there is now more than one. You must add unique key properties to make them distinguishable.");throw Error(d.vnodeSelector+" had a "+
e.vnodeSelector+" child removed, but there were more than one. You must add unique key properties to make them distinguishable.");}}},u,t,r=function(a,b,c){var d=b.children;if(d)for(var f=0;f<d.length;f++)u(d[f],a,void 0,c);b.text&&(a.textContent=b.text);l(a,b.properties,c);b.properties&&b.properties.afterCreate&&b.properties.afterCreate.apply(b.properties.bind||b.properties,[a,c,b.vnodeSelector,b.properties,b.children])};u=function(a,c,d,f){var e,l,h,g=0,n=a.vnodeSelector;if(""===n)e=a.domNode=document.createTextNode(a.text),
void 0!==d?c.insertBefore(e,d):c.appendChild(e);else{for(l=0;l<=n.length;++l)if(h=n.charAt(l),l===n.length||"."===h||"#"===h)h=n.charAt(g-1),g=n.slice(g,l),"."===h?e.classList.add(g):"#"===h?e.id=g:("svg"===g&&(f=b(f,{namespace:"http://www.w3.org/2000/svg"})),void 0!==f.namespace?e=a.domNode=document.createElementNS(f.namespace,g):(e=a.domNode=document.createElement(g),"input"===g&&a.properties&&void 0!==a.properties.type&&e.setAttribute("type",a.properties.type)),void 0!==d?c.insertBefore(e,d):c.appendChild(e)),
g=l+1;r(e,a,f)}};t=function(c,d,l){var h=c.domNode;if(c===d)return!1;var g=!1;if(""===d.vnodeSelector){if(d.text!==c.text)return c=document.createTextNode(d.text),h.parentNode.replaceChild(c,h),d.domNode=c,!0}else{0===d.vnodeSelector.lastIndexOf("svg",0)&&(l=b(l,{namespace:"http://www.w3.org/2000/svg"}));c.text!==d.text&&(g=!0,void 0===d.text?h.removeChild(h.firstChild):h.textContent=d.text);var q;q=c.children;var r=d.children,w=l;if(q===r)q=!1;else{q=q||k;for(var r=r||k,x=q.length,y=r.length,m=w.transitions,
F=0,L=0,Q=!1;L<y;){var N=F<x?q[F]:void 0,J=r[L];if(void 0!==N&&a(N,J))Q=t(N,J,w)||Q,F++;else{b:{var N=q,P=J;if(""!==P.vnodeSelector)for(var I=F+1;I<N.length;I++)if(a(N[I],P)){N=I;break b}N=-1}if(0<=N){for(;F<N;F++)f(q[F],m),n(q,F,d,"removed");Q=t(q[N],J,w)||Q;F=N+1}else u(J,h,F<x?q[F].domNode:void 0,w),N=m,J.properties&&(P=J.properties.enterAnimation)&&("function"===typeof P?P(J.domNode,J.properties):N.enter(J.domNode,J.properties,P)),n(r,L,d,"added")}L++}if(x>F)for(;F<x;F++)f(q[F],m),n(q,F,d,"removed");
q=Q}g=q||g;q=c.properties;r=d.properties;w=l;if(r){Q=!1;x=Object.keys(r);y=x.length;for(m=0;m<y;m++)if(J=x[m],L=r[J],F=q[J],"class"===J){if(F!==L)throw Error('"class" property may not be updated. Use the "classes" property for conditional css classes.');}else if("classes"===J)for(N=h.classList,P=Object.keys(L),I=P.length,J=0;J<I;J++){var O=P[J],ea=!!L[O];ea!==!!F[O]&&(Q=!0,ea?N.add(O):N.remove(O))}else if("styles"===J)for(N=Object.keys(L),P=N.length,J=0;J<P;J++)I=N[J],O=L[I],O!==F[I]&&(Q=!0,O?(e(O),
w.styleApplyer(h,I,O)):w.styleApplyer(h,I,""));else if(L||"string"!==typeof F||(L=""),"value"===J)h[J]!==L&&h["oninput-value"]!==L&&(h[J]=L,h["oninput-value"]=void 0),L!==F&&(Q=!0);else if(L!==F){Q=typeof L;if("function"===Q)throw Error("Functions may not be updated on subsequent renders (property: "+J+"). Hint: declare event handler functions outside the render() function.");"string"===Q&&"innerHTML"!==J?"http://www.w3.org/2000/svg"===w.namespace&&"href"===J?h.setAttributeNS("http://www.w3.org/1999/xlink",
J,L):h.setAttribute(J,L):h[J]!==L&&(h[J]=L);Q=!0}q=Q}else q=void 0;g=q||g;d.properties&&d.properties.afterUpdate&&d.properties.afterUpdate.apply(d.properties.bind||d.properties,[h,l,d.vnodeSelector,d.properties,d.children])}g&&d.properties&&d.properties.updateAnimation&&d.properties.updateAnimation(h,d.properties,c.properties);d.domNode=c.domNode;return!1};var w=function(a,b){return{update:function(c){if(a.vnodeSelector!==c.vnodeSelector)throw Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");
t(a,c,b);a=c},domNode:a.domNode}};m.h=function(a){var b=arguments[1];if("string"!==typeof a)throw Error();var d=1;!b||b.hasOwnProperty("vnodeSelector")||Array.isArray(b)||"object"!==typeof b?b=void 0:d=2;var f=void 0,e=void 0,l=arguments.length;if(l===d+1){var g=arguments[d];"string"===typeof g?f=g:void 0!==g&&null!==g&&1===g.length&&"string"===typeof g[0]&&(f=g[0])}if(void 0===f)for(e=[];d<l;d++)g=arguments[d],null!==g&&void 0!==g&&(Array.isArray(g)?h(a,g,e):g.hasOwnProperty("vnodeSelector")?e.push(g):
e.push(c(g)));return{vnodeSelector:a,properties:b,children:e,text:""===f?void 0:f,domNode:null}};m.dom={create:function(a,c){c=b(d,c);u(a,document.createElement("div"),void 0,c);return w(a,c)},append:function(a,c,f){f=b(d,f);u(c,a,void 0,f);return w(c,f)},insertBefore:function(a,c,f){f=b(d,f);u(c,a.parentNode,a,f);return w(c,f)},merge:function(a,c,f){f=b(d,f);c.domNode=a;r(a,c,f);return w(c,f)}};m.createCache=function(){var a=void 0,b=void 0;return{invalidate:function(){a=b=void 0},result:function(c,
d){if(a)for(var f=0;f<c.length;f++)a[f]!==c[f]&&(b=void 0);b||(b=d(),a=c);return b}}};m.createMapping=function(a,b,c){var d=[],f=[];return{results:f,map:function(e){for(var l=e.map(a),h=f.slice(),g=0,n=0;n<e.length;n++){var q=e[n],u=l[n];if(u===d[g])f[n]=h[g],c(q,h[g],n),g++;else{for(var t=!1,r=1;r<d.length+1;r++){var w=(g+r)%d.length;if(d[w]===u){f[n]=h[w];c(e[n],h[w],n);g=w+1;t=!0;break}}t||(f[n]=b(q,n))}}f.length=e.length;d=l}}};m.createProjector=function(a){var c,f=b(d,a);f.eventHandlerInterceptor=
function(a,b,d,f){return function(){c.scheduleRender();return b.apply(f.bind||this,arguments)}};var e=!0,l,h=!1,g=[],n=[],q=function(){l=void 0;if(e){e=!1;for(var a=0;a<g.length;a++){var b=n[a]();g[a].update(b)}e=!0}};return c={renderNow:q,scheduleRender:function(){l||h||(l=requestAnimationFrame(q))},stop:function(){l&&(cancelAnimationFrame(l),l=void 0);h=!0},resume:function(){h=!1;e=!0;c.scheduleRender()},append:function(a,b){g.push(m.dom.append(a,b(),f));n.push(b)},insertBefore:function(a,b){g.push(m.dom.insertBefore(a,
b(),f));n.push(b)},merge:function(a,b){g.push(m.dom.merge(a,b(),f));n.push(b)},replace:function(a,b){var c=b();u(c,a.parentNode,a,f);a.parentNode.removeChild(a);g.push(w(c,f));n.push(b)},detach:function(a){for(var b=0;b<n.length;b++)if(n[b]===a)return n.splice(b,1),g.splice(b,1)[0];throw Error("renderMaquetteFunction was not found");}}}})},"esri/widgets/support/widgetUtils":function(){define(["require","exports","../../core/Logger"],function(m,k,b){function a(){for(var a=[],b=0;b<arguments.length;b++)a[b]=
arguments[b];return a.join(" ")}k.classes=function(){b.getLogger("esri.widgets.support.widgetUtils").warn("classes is deprecated, use join instead.");return a.apply(this,arguments)};k.join=a;k.isRtl=function(){return"rtl"===document.head.dir}})},"esri/widgets/Widget":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../core/Accessor ../core/Evented ../core/HandleRegistry ../core/Logger ../core/watchUtils dojo/_base/lang dojo/dom ./libs/maquette/maquette ../core/Collection".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f,n,u,t){var r=e.getLogger("esri.widgets.Widget"),w=0;m=function(a){function c(b,c){b=a.call(this)||this;b._attached=!1;b.className="";b.destroyed=!1;b.domNode=null;b.visible=!0;b._projector=u.createProjector({});b._handles=new d;b.render=b.render.bind(b);return b}b(c,a);c.prototype.normalizeCtorArgs=function(a,b){a=f.mixin({},a);b&&(a.container=b);return a};c.prototype.initialize=function(){var a=this;this._handles.add(this._renderableProps.map(function(b){return l.init(a,
b,function(a,c){var d=this;t.isCollection(c)&&this._handles.remove(this.declaredClass+":"+b+"-collection-change-event-listener");t.isCollection(a)&&(a=a.on("change",function(){return d.scheduleRender()}),this._handles.add(a,this.declaredClass+":"+b+"-collection-change-event-listener"));this.scheduleRender()})}));this._delegatedEventNames.length&&this._handles.add(l.init(this,"viewModel",function(){a._get("viewModel")&&a._handles.remove("delegated-events");a._delegatedEventNames.map(function(b){return a.viewModel.on(b,
function(c){a.emit(b,c)})})}),"delegated-events");this.postInitialize();this._handles.add(l.whenOnce(this,"container",function(b){return a._attach(b)}))};c.prototype.postInitialize=function(){};c.prototype.destroy=function(){this.destroyed||(this._detach(this.container),this._handles.destroy(),this._set("destroyed",!0))};c.prototype.startup=function(){r.warn("Widget.startup() is deprecated and no longer needed")};Object.defineProperty(c.prototype,"container",{set:function(a){this._get("container")||
this._set("container",a)},enumerable:!0,configurable:!0});c.prototype.castContainer=function(a){return n.byId(a)};Object.defineProperty(c.prototype,"id",{get:function(){return this._get("id")||this.get("container.id")||Date.now().toString(16)+"-widget-"+w++},set:function(a){a&&this._set("id",a)},enumerable:!0,configurable:!0});c.prototype.scheduleRender=function(){this._projector.scheduleRender()};c.prototype.on=function(a,b){var c=this.inherited(arguments);this._handles.add(c);return c};c.prototype.own=
function(a){1<arguments.length&&(a=Array.prototype.slice.call(arguments));this._handles.add(a)};c.prototype.renderNow=function(){this._projector.renderNow()};c.prototype._attach=function(a){a&&(this._projector.merge(a,this.render),this._attached=!0)};c.prototype._detach=function(a){a&&this._attached&&(this._projector.detach(this.render),a.parentNode&&a.parentNode.removeChild(a),this._attached=!1)};return c}(c.declared(h,g));a([c.shared([])],m.prototype,"_renderableProps",void 0);a([c.shared([])],
m.prototype,"_delegatedEventNames",void 0);a([c.property({value:null})],m.prototype,"container",null);a([c.cast("container")],m.prototype,"castContainer",null);a([c.property({readOnly:!0})],m.prototype,"destroyed",void 0);a([c.property({aliasOf:"container"})],m.prototype,"domNode",void 0);a([c.property({dependsOn:["container"]})],m.prototype,"id",null);a([c.property()],m.prototype,"viewModel",void 0);a([c.property()],m.prototype,"visible",void 0);return m=a([c.subclass("esri.widgets.Widget")],m)})},
"esri/widgets/Attribution/AttributionViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../geometry/support/webMercatorUtils ../../core/HandleRegistry ../../core/Accessor ../../core/lang ../../core/watchUtils ../../geometry/Extent".split(" "),function(m,k,b,a,c,h,g,d,e,l,f){m=function(a){function c(b){b=a.call(this,b)||this;b._handles=new g;b._pendingAttributionItemsByLayerId={};b._attributionDataByLayerId=
{};b.itemDelimiter=" | ";b.items=[];b.view=null;b._updateAttributionItems=b._updateAttributionItems.bind(b);return b}b(c,a);c.prototype.initialize=function(){this._handles.add(l.init(this,"view",this._viewWatcher))};c.prototype.destroy=function(){this._handles.destroy();this.view=this._handles=null};Object.defineProperty(c.prototype,"attributionText",{get:function(){return this.items.join(this.itemDelimiter)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"state",{get:function(){return this.get("view.ready")?
"ready":"disabled"},enumerable:!0,configurable:!0});c.prototype._viewWatcher=function(a){var b=this,c=this._handles;c&&c.remove();a&&(c.add([a.allLayerViews.on("change",function(a){b._addLayerViews(a.added);0<a.removed.length&&(a.removed.forEach(function(a){c.remove(a.uid)}),b._updateAttributionItems())}),l.init(a,"stationary",this._updateAttributionItems)]),this._addLayerViews(a.allLayerViews))};c.prototype._addLayerViews=function(a){var b=this;a.forEach(function(a){b._handles.has(a.uid)||b._handles.add(l.init(a,
"suspended",b._updateAttributionItems),a.uid)})};c.prototype._updateAttributionItems=function(){var a=this,b=[];this._getActiveLayerViews().forEach(function(c){var d=c.layer;if(!d.hasAttributionData)c=d.get("copyright"),a._isUnique(b,c)&&b.push(c);else if(d&&d.tileInfo){var f=a._attributionDataByLayerId;if(f[d.uid])c=a._getDynamicAttribution(f[d.uid],a.view,d),a._isUnique(b,c)&&b.push(c);else{var e=a._pendingAttributionItemsByLayerId;a._inProgress(e[d.uid])||(e[d.uid]=d.fetchAttributionData().then(function(b){b=
a._createContributionIndex(b,a._isBingLayer(d));delete e[d.uid];f[d.uid]=b;a._updateAttributionItems()}))}}});this._itemsChanged(this.items,b)&&this._set("items",b)};c.prototype._itemsChanged=function(a,b){return a.length!==b.length||a.some(function(a,c){return a!==b[c]})};c.prototype._inProgress=function(a){return a&&!a.isFulfilled()};c.prototype._getActiveLayerViews=function(){return this.get("view.allLayerViews").filter(function(a){return!a.suspended&&a.get("layer.attributionVisible")})};c.prototype._isUnique=
function(a,b){return b&&-1===a.indexOf(b)};c.prototype._isBingLayer=function(a){return-1!==a.declaredClass.toLowerCase().indexOf("vetiledlayer")};c.prototype._createContributionIndex=function(a,b){a=a.contributors;var c={};if(!a)return c;a.forEach(function(a,d){var l=a.coverageAreas;l&&l.forEach(function(l){var g=l.bbox,n=l.zoomMin-(b&&l.zoomMin?1:0),q=l.zoomMax-(b&&l.zoomMax?1:0);a={extent:h.geographicToWebMercator(new f({xmin:g[1],ymin:g[0],xmax:g[3],ymax:g[2]})),attribution:a.attribution||"",score:e.isDefined(l.score)?
l.score:100,id:d};for(l=n;l<=q;l++)c[l]=c[l]||[],c[l].push(a)})});c.maxKey=Math.max.apply(null,Object.keys(c));return c};c.prototype._getDynamicAttribution=function(a,b,c){var d=b.extent;b=c.tileInfo.scaleToZoom(b.scale);b=Math.min(a.maxKey,Math.round(b));if(!d||!e.isDefined(b)||-1>=b)return"";a=a[b];var f=d.center.clone().normalize(),l={};return a.filter(function(a){var b=!l[a.id]&&a.extent.contains(f);b&&(l[a.id]=!0);return b}).sort(function(a,b){return b.score-a.score||a.objectId-b.objectId}).map(function(a){return a.attribution}).join(", ")};
return c}(c.declared(d));a([c.property({dependsOn:["items","itemDelimiter"],readOnly:!0})],m.prototype,"attributionText",null);a([c.property()],m.prototype,"itemDelimiter",void 0);a([c.property({readOnly:!0})],m.prototype,"items",void 0);a([c.property({dependsOn:["view.ready"],readOnly:!0})],m.prototype,"state",null);a([c.property()],m.prototype,"view",void 0);return m=a([c.subclass("esri.widgets.Attribution.AttributionViewModel")],m)})},"esri/widgets/Compass":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ./support/widget ./Widget ./Compass/CompassViewModel dojo/i18n!./Compass/nls/Compass".split(" "),
function(m,k,b,a,c,h,g,d,e){m=function(a){function c(b){b=a.call(this)||this;b.view=null;b.viewModel=new d;return b}b(c,a);c.prototype.reset=function(){};c.prototype.render=function(){var a=this.viewModel.orientation,b=this.viewModel.state,c="disabled"===b,d="compass"===("rotation"===b?"rotation":"compass"),b=(f={},f["esri-disabled"]=c,f["esri-interactive"]=!c,f),f=(l={},l["esri-icon-compass"]=d,l["esri-icon-dial"]=!d,l);return h.jsxFactory.createElement("div",{bind:this,class:"esri-compass esri-widget-button esri-widget",
classes:b,onclick:this._reset,onkeydown:this._reset,role:"button",tabIndex:c?-1:0},h.jsxFactory.createElement("span",{"aria-hidden":"true",class:"esri-compass__icon",classes:f,styles:this._toRotationTransform(a),title:e.reset}),h.jsxFactory.createElement("span",{class:"esri-icon-font-fallback-text"},e.reset));var f,l};c.prototype._reset=function(){this.reset()};c.prototype._toRotationTransform=function(a){return{transform:"rotateZ("+a.z+"deg)"}};return c}(c.declared(g));a([c.aliasOf("viewModel.view")],
m.prototype,"view",void 0);a([c.property({type:d}),h.renderable(["viewModel.orientation","viewModel.state"])],m.prototype,"viewModel",void 0);a([c.aliasOf("viewModel.reset")],m.prototype,"reset",null);a([h.accessibleHandler()],m.prototype,"_reset",null);return m=a([c.subclass("esri.widgets.Compass")],m)})},"esri/widgets/Compass/CompassViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/HandleRegistry ../../core/Accessor ../../core/watchUtils".split(" "),
function(m,k,b,a,c,h,g,d){m=function(a){function c(b){b=a.call(this,b)||this;b._handles=new h;b.orientation={x:0,y:0,z:0};b.view=null;b._updateForCamera=b._updateForCamera.bind(b);b._updateForRotation=b._updateForRotation.bind(b);b._updateRotationWatcher=b._updateRotationWatcher.bind(b);return b}b(c,a);c.prototype.initialize=function(){this._handles.add(d.init(this,"view",this._updateRotationWatcher))};c.prototype.destroy=function(){this._handles.destroy();this.view=this._handles=null};Object.defineProperty(c.prototype,
"canShowNorth",{get:function(){var a=this.get("view.spatialReference");return a&&(a.isWebMercator||4326===a.wkid)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"state",{get:function(){return this.get("view.ready")?this.canShowNorth?"compass":"rotation":"disabled"},enumerable:!0,configurable:!0});c.prototype.reset=function(){if(this.get("view.ready")){var a={};"2d"===this.view.type?a.rotation=0:a.heading=0;this.view.goTo(a)}};c.prototype._updateForRotation=function(a){void 0!==
a&&null!==a&&(this.orientation={z:a})};c.prototype._updateForCamera=function(a){a&&(this.orientation={x:0,y:0,z:-a.heading})};c.prototype._updateRotationWatcher=function(a){this._handles.removeAll();a&&("2d"===a.type?this._handles.add(d.init(this,"view.rotation",this._updateForRotation)):this._handles.add(d.init(this,"view.camera",this._updateForCamera)))};return c}(c.declared(g));a([c.property({dependsOn:["view.spatialReference.isWebMercator","view.spatialReference.wkid"],readOnly:!0})],m.prototype,
"canShowNorth",null);a([c.property()],m.prototype,"orientation",void 0);a([c.property({dependsOn:["view.ready","canShowNorth"],readOnly:!0})],m.prototype,"state",null);a([c.property()],m.prototype,"view",void 0);return m=a([c.subclass("esri.widgets.CompassViewModel")],m)})},"esri/widgets/Zoom":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ./support/widget ./Widget ./Zoom/IconButton ./Zoom/ZoomViewModel dojo/i18n!./Zoom/nls/Zoom".split(" "),
function(m,k,b,a,c,h,g,d,e,l){m=function(a){function c(b){b=a.call(this)||this;b.layout="vertical";b.view=null;b.viewModel=new e;return b}b(c,a);c.prototype.postInitialize=function(){this._zoomInButton=new d({action:this.zoomIn.bind(this),iconClass:"esri-icon-plus",title:l.zoomIn});this._zoomOutButton=new d({action:this.zoomOut.bind(this),iconClass:"esri-icon-minus",title:l.zoomOut})};c.prototype.render=function(){var a=this.viewModel,b=(c={},c["esri-zoom--horizontal"]="horizontal"===this.layout,
c);this._zoomInButton.enabled="ready"===a.state&&a.canZoomIn;this._zoomOutButton.enabled="ready"===a.state&&a.canZoomOut;return h.jsxFactory.createElement("div",{class:"esri-zoom esri-widget",classes:b},this._zoomInButton.render(),this._zoomOutButton.render());var c};c.prototype.zoomIn=function(){};c.prototype.zoomOut=function(){};return c}(c.declared(g));a([c.property(),h.renderable()],m.prototype,"layout",void 0);a([c.aliasOf("viewModel.view"),h.renderable()],m.prototype,"view",void 0);a([c.property({type:e}),
h.renderable(["viewModel.canZoomIn","viewModel.canZoomOut","viewModel.state"])],m.prototype,"viewModel",void 0);a([c.aliasOf("viewModel.zoomIn")],m.prototype,"zoomIn",null);a([c.aliasOf("viewModel.zoomOut")],m.prototype,"zoomOut",null);return m=a([c.subclass("esri.widgets.Zoom")],m)})},"esri/widgets/Zoom/IconButton":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../support/widget ../Widget".split(" "),
function(m,k,b,a,c,h,g){m=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b.enabled=!0;b.iconClass="";b.title="";return b}b(c,a);c.prototype.render=function(){var a=this.enabled?0:-1,b=(c={},c["esri-disabled"]=!this.enabled,c["esri-interactive"]=this.enabled,c),c=(d={},d[this.iconClass]=!!this.iconClass,d);return h.jsxFactory.createElement("div",{bind:this,class:"esri-widget-button esri-widget",classes:b,onclick:this._triggerAction,onkeydown:this._triggerAction,role:"button",
tabIndex:a,title:this.title},h.jsxFactory.createElement("span",{"aria-hidden":"true",role:"presentation",class:"esri-icon",classes:c}),h.jsxFactory.createElement("span",{class:"esri-icon-font-fallback-text"},this.title));var c,d};c.prototype._triggerAction=function(){this.action.call(this)};return c}(c.declared(g));a([c.property()],m.prototype,"action",void 0);a([c.property(),h.renderable()],m.prototype,"enabled",void 0);a([c.property(),h.renderable()],m.prototype,"iconClass",void 0);a([c.property(),
h.renderable()],m.prototype,"title",void 0);a([h.accessibleHandler()],m.prototype,"_triggerAction",null);return m=a([c.subclass("esri.widgets.IconButton")],m)})},"esri/widgets/Zoom/ZoomViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor".split(" "),function(m,k,b,a,c,h){m=function(a){function c(b){b=a.call(this,b)||this;b.view=null;b.zoomIn=b.zoomIn.bind(b);b.zoomOut=b.zoomOut.bind(b);
return b}b(c,a);c.prototype.destroy=function(){this.view=null};Object.defineProperty(c.prototype,"canZoomIn",{get:function(){if("2d"!==this.get("view.type"))return!0;var a=this.get("view.scale"),b=this.get("view.constraints.effectiveMaxScale");return 0===b||a>b},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"canZoomOut",{get:function(){if("2d"!==this.get("view.type"))return!0;var a=this.get("view.scale"),b=this.get("view.constraints.effectiveMinScale");return 0===b||a<b},enumerable:!0,
configurable:!0});Object.defineProperty(c.prototype,"state",{get:function(){return this.get("view.ready")?"ready":"disabled"},enumerable:!0,configurable:!0});c.prototype.zoomIn=function(){this.canZoomIn&&this._zoomToFactor(.5)};c.prototype.zoomOut=function(){this.canZoomOut&&this._zoomToFactor(2)};c.prototype._zoomToFactor=function(a){"ready"===this.state&&this.view.goTo({scale:this.get("view.scale")*a})};return c}(c.declared(h));a([c.property({dependsOn:["view.ready","view.scale"],readOnly:!0})],
m.prototype,"canZoomIn",null);a([c.property({dependsOn:["view.ready","view.scale"],readOnly:!0})],m.prototype,"canZoomOut",null);a([c.property({dependsOn:["view.ready"],readOnly:!0})],m.prototype,"state",null);a([c.property()],m.prototype,"view",void 0);return m=a([c.subclass("esri.widgets.Zoom.ZoomViewModel")],m)})},"esri/widgets/NavigationToggle":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ./support/widget ./Widget ./NavigationToggle/NavigationToggleViewModel dojo/i18n!./NavigationToggle/nls/NavigationToggle".split(" "),
function(m,k,b,a,c,h,g,d,e){m=function(a){function c(b){b=a.call(this)||this;b.view=null;b.viewModel=new d;return b}b(c,a);Object.defineProperty(c.prototype,"layout",{set:function(a){"horizontal"!==a&&(a="vertical");this._set("layout",a)},enumerable:!0,configurable:!0});c.prototype.toggle=function(){};c.prototype.render=function(){var a="disabled"===this.get("viewModel.state"),b="pan"===this.get("viewModel.navigationMode"),c=(d={},d["esri-disabled"]=a,d),d=(f={},f["esri-navigation-toggle__button--active"]=
b,f),b=(l={},l["esri-navigation-toggle__button--active"]=!b,l);return h.jsxFactory.createElement("div",{bind:this,class:"esri-navigation-toggle esri-widget",classes:c,onclick:this._toggle,onkeydown:this._toggle,tabIndex:a?-1:0,title:e.toggle},h.jsxFactory.createElement("div",{class:h.join("esri-navigation-toggle__button esri-widget-button","esri-navigation-toggle__button--pan"),classes:d},h.jsxFactory.createElement("span",{class:"esri-icon-pan"})),h.jsxFactory.createElement("div",{class:h.join("esri-navigation-toggle__button esri-widget-button",
"esri-navigation-toggle__button--rotate"),classes:b},h.jsxFactory.createElement("span",{class:"esri-icon-rotate"})));var d,f,l};c.prototype._toggle=function(){this.toggle()};return c}(c.declared(g));a([c.property({value:"vertical"}),h.renderable()],m.prototype,"layout",null);a([c.aliasOf("viewModel.view"),h.renderable()],m.prototype,"view",void 0);a([c.property({type:d}),h.renderable(["viewModel.state","viewModel.navigationMode"])],m.prototype,"viewModel",void 0);a([c.aliasOf("viewModel.toggle")],
m.prototype,"toggle",null);a([h.accessibleHandler()],m.prototype,"_toggle",null);return m=a([c.subclass("esri.widgets.NavigationToggle")],m)})},"esri/widgets/NavigationToggle/NavigationToggleViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/watchUtils ../../core/Accessor ../../core/HandleRegistry".split(" "),function(m,k,b,a,c,h,g,d){m=function(a){function c(b){b=a.call(this,
b)||this;b._handles=new d;b.navigationMode="pan";b.view=null;b.toggle=b.toggle.bind(b);return b}b(c,a);c.prototype.initialize=function(){this._handles.add(h.when(this,"view.inputManager",this._setNavigationMode.bind(this)))};c.prototype.destroy=function(){this._handles.destroy();this.view=this._handles=null};Object.defineProperty(c.prototype,"state",{get:function(){return this.get("view.ready")&&"3d"===this.view.type?"ready":"disabled"},enumerable:!0,configurable:!0});c.prototype.toggle=function(){"disabled"!==
this.state&&(this.navigationMode="pan"!==this.navigationMode?"pan":"rotate",this._setNavigationMode())};c.prototype._setNavigationMode=function(){this.get("view.inputManager").primaryDragAction="pan"===this.navigationMode?"pan":"rotate"};return c}(c.declared(g));a([c.property({dependsOn:["view.ready"],readOnly:!0})],m.prototype,"state",null);a([c.property()],m.prototype,"navigationMode",void 0);a([c.property()],m.prototype,"view",void 0);return m=a([c.subclass("esri.widgets.NavigationToggleViewModel")],
m)})},"esri/views/animation/easing":function(){define(["require","exports"],function(m,k){function b(a){return a}function a(a){var b=2*(a-Math.sqrt((a-1)*a)),c=b/2/a;return function(d){return d<c?a*d*d:b*d-b+1}}function c(a,b){return function(c){return c<b?b*a(c/b):1-a((1-c)/(1-b))*(1-b)}}k.linear=b;k.inQuad=function(a){return a*a};k.outQuad=function(a){return 1-k.inQuad(1-a)};k.inOutQuad=function(a){return.5>a?k.inQuad(2*a)/2:(k.outQuad(2*(a-.5))+1)/2};k.inCubic=function(a){return a*a*a};k.outCubic=
function(a){return 1-k.inCubic(1-a)};k.inOutCubic=function(a){return.5>a?k.inCubic(2*a)/2:(k.outCubic(2*(a-.5))+1)/2};k.inQuart=function(a){return a*a*a*a};k.outQuart=function(a){return 1-k.inQuart(1-a)};k.inOutQuart=function(a){return.5>a?k.inQuart(2*a)/2:(k.outQuart(2*(a-.5))+1)/2};k.inQuint=function(a){return a*a*a*a*a};k.outQuint=function(a){return 1-k.inQuint(1-a)};k.inOutQuint=function(a){return.5>a?k.inQuint(2*a)/2:(k.outQuint(2*(a-.5))+1)/2};k.inSine=function(a){return-Math.cos(a*Math.PI/
2)+1};k.outSine=function(a){return 1-k.inSine(1-a)};k.inOutSine=function(a){return.5>a?k.inSine(2*a)/2:(k.outSine(2*(a-.5))+1)/2};k.inExpo=function(a){return Math.pow(2,10*(a-1))};k.outExpo=function(a){return 1-k.inExpo(1-a)};k.inOutExpo=function(a){return.5>a?k.inExpo(2*a)/2:(k.outExpo(2*(a-.5))+1)/2};k.inCirc=function(a){return-(Math.sqrt(1-a*a)-1)};k.outCirc=function(a){return 1-k.inCirc(1-a)};k.inOutCirc=function(a){return.5>a?k.inCirc(2*a)/2:(k.outCirc(2*(a-.5))+1)/2};k.inCoastQuad=c(a(1),1);
k.outCoastQuad=c(a(1),0);k.inOutCoastQuad=c(a(1),.5);k.inCoastCubic=c(a(2),1);k.outCoastCubic=c(a(2),0);k.inOutCoastCubic=c(a(2),.5);k.inCoastQuart=c(a(3),1);k.outCoastQuart=c(a(3),0);k.inOutCoastQuart=c(a(3),.5);k.inCoastQuint=c(a(4),1);k.outCoastQuint=c(a(4),0);k.inOutCoastQuint=c(a(4),.5);k.named={linear:b,"in-quad":k.inQuad,"out-quad":k.outQuad,"in-out-quad":k.inOutQuad,"in-cubic":k.inCubic,"out-cubic":k.outCubic,"in-out-cubic":k.inOutCubic,"in-quart":k.inQuart,"out-quart":k.outQuart,"in-out-quart":k.inOutQuart,
"in-quint":k.inQuint,"out-quint":k.outQuint,"in-out-quint":k.inOutQuint,"in-sine":k.inSine,"out-sine":k.outSine,"in-out-sine":k.inOutSine,"in-expo":k.inExpo,"out-expo":k.outExpo,"in-out-expo":k.inOutExpo,"in-circ":k.inCirc,"out-circ":k.outCirc,"in-out-circ":k.inOutCirc}})},"esri/geometry/ScreenPoint":function(){define(["./Point"],function(m){return m.createSubclass({declaredClass:"esri.geometry.ScreenPoint",verifySR:function(){}})})},"esri/webscene/Environment":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/JSONSupport ../core/accessorSupport/decorators ./Lighting".split(" "),
function(m,k,b,a,c,h,g){m=d=function(a){function c(b){b=a.call(this,b)||this;b.lighting=new g;return b}b(c,a);c.prototype.clone=function(){return new d({lighting:g.prototype.clone.call(this.lighting)})};c.sanitizeJSON=function(a){return{lighting:a.lighting?g.sanitizeJSON(a.lighting):(new g).toJSON()}};return c}(h.declared(c));a([h.property({type:g,json:{write:!0}})],m.prototype,"lighting",void 0);m=d=a([h.subclass("esri.webscene.Environment")],m);var d;return m})},"esri/webscene/Lighting":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/JSONSupport ../core/accessorSupport/decorators".split(" "),
function(m,k,b,a,c,h){m=g=function(a){function c(b){b=a.call(this,b)||this;b.date=null;b.directShadowsEnabled=!1;b.displayUTCOffset=null;return b}b(c,a);c.prototype.readDate=function(a,b){return null!=b.datetime&&new Date(b.datetime)||null};c.prototype.writeDate=function(a,b){null!=a&&(b.datetime=a.getTime())};c.prototype.readDirectShadowsEnabled=function(a,b){return!!b.directShadows};c.prototype.writedirectShadowsEnabled=function(a,b){a&&(b.directShadows=!0)};c.prototype.writeDisplayUTCOffset=function(a,
b){null!=a&&(b.displayUTCOffset=a)};c.prototype.clone=function(){return new g({date:null!=this.date?new Date(this.date.getTime()):null,directShadowsEnabled:this.directShadowsEnabled,displayUTCOffset:null!=this.displayUTCOffset?this.displayUTCOffset:null})};c.sanitizeJSON=function(a){var b={datetime:a.datetime};void 0!==a.directShadows&&(b.directShadows=!!a.directShadows);void 0!==a.displayUTCOffset&&(b.displayUTCOffset=a.displayUTCOffset);return b};return c}(h.declared(c));a([h.property({type:Date})],
m.prototype,"date",void 0);a([h.reader("date",["datetime"])],m.prototype,"readDate",null);a([h.writer("date")],m.prototype,"writeDate",null);a([h.property({type:Boolean})],m.prototype,"directShadowsEnabled",void 0);a([h.reader("directShadowsEnabled",["directShadows"])],m.prototype,"readDirectShadowsEnabled",null);a([h.writer("directShadowsEnabled")],m.prototype,"writedirectShadowsEnabled",null);a([h.property({type:Number,json:{write:!0}})],m.prototype,"displayUTCOffset",void 0);a([h.writer("displayUTCOffset")],
m.prototype,"writeDisplayUTCOffset",null);m=g=a([h.subclass("esri.webscene.Lighting")],m);var g;return m})},"esri/views/3d/environment/SceneViewEnvironment":function(){define(["dojo/_base/lang","../../../webscene/Environment","../../../webscene/Lighting","./SceneViewLighting","./SceneViewAtmosphere"],function(m,k,b,a,c){var h=k.createSubclass({declaredClass:"esri.views.3d.environment.SceneViewEnvironment",properties:{atmosphere:{type:c,json:{read:!1}},atmosphereEnabled:{value:!0,json:{read:!1}},starsEnabled:{value:!0,
json:{read:!1}},lighting:{set:function(c){if(c)if(this.lighting)null!=c.date&&(this.lighting.date=c.date),null!=c.defaultDate&&(this.lighting.defaultDate=c.defaultDate),null!=c.displayUTCOffset&&(this.lighting.displayUTCOffset=c.displayUTCOffset),this.lighting.directShadowsEnabled=c.directShadowsEnabled,null!=c.ambientOcclusionEnabled&&(this.lighting.ambientOcclusionEnabled=c.ambientOcclusionEnabled),null!=c.cameraTrackingEnabled&&(this.lighting.cameraTrackingEnabled=c.cameraTrackingEnabled);else if(c instanceof
a)this._set("lighting",c);else if(c instanceof b){var d={directShadowsEnabled:c.directShadowsEnabled};null!=c.date&&(d.date=c.date);null!=c.displayUTCOffset&&(d.displayUTCOffset=c.displayUTCOffset);null!=c.defaultDate&&(d.defaultDate=c.defaultDate);this._set("lighting",new a(d))}else this._set("lighting",new a(c));else this.lighting||this._set("lighting",new a)}}},getDefaults:function(){return m.mixin(this.inherited(arguments),{atmosphere:{}})},atmosphere:null,atmosphereEnabled:!0,starsEnabled:!0,
clone:function(){return new h({lighting:this.lighting.clone(),atmosphere:this.atmosphere.clone(),atmosphereEnabled:this.atmosphereEnabled,starsEnabled:this.starsEnabled})}});return h})},"esri/views/3d/environment/SceneViewLighting":function(){define(["../../../core/Evented","../../../webscene/Lighting"],function(m,k){var b=new Date,a={target:null,date:null},c={target:null,timezoneOffset:0};return k.createSubclass([m],{declaredClass:"esri.views.3d.environment.SceneViewLighting",properties:{cameraTrackingEnabled:{value:!0},
ambientOcclusionEnabled:{value:!1},defaultDate:{get:function(){return new Date(this._get("defaultDate"))},set:function(a){var b=this._get("date")===this._get("defaultDate");a=new Date(a);this._set("defaultDate",a);b&&this._set("date",a)}},date:{cast:function(a){return a},set:function(a){null!=a&&(this._set("date",new Date(a)),this.positionTimezoneInfo.autoUpdated=!1,this._emitDateWillChange())}}},constructor:function(){this.positionTimezoneInfo={hours:0,minutes:0,seconds:0,autoUpdated:!0};this._autoUpdateDate=
null;var a=(new Date).getFullYear(),a=new Date("March 15, "+a+" 12:00:00 UTC");this._set("defaultDate",a);this._set("date",a)},autoUpdate:function(a,b){var d=this._calculateTimezoneOffset(this.positionTimezoneInfo);this.positionTimezoneInfo.hours=b.hours;this.positionTimezoneInfo.minutes=b.minutes;this.positionTimezoneInfo.seconds=b.seconds;if(null!=a){this.positionTimezoneInfo.autoUpdated=!0;var e=this.date&&this.date.getTime();this._set("date",new Date(a));this._emitDateWillChange()}b=this._calculateTimezoneOffset(this.positionTimezoneInfo);
d!==b&&(c.target=this,c.timezoneOffset=b,this.emit("timezone-will-change",c));if(null!=a)return e!==a.getTime()},_calculateTimezoneOffset:function(a){return Math.round(a.hours+a.minutes/60+a.seconds/3600)},_emitDateWillChange:function(){a.target=this;b.setTime(this._get("date").getTime());a.date=b;this.emit("date-will-change",a)}})})},"esri/views/3d/environment/SceneViewAtmosphere":function(){define(["../../../core/Accessor"],function(m){return m.createSubclass({properties:{quality:{}},quality:"low",
_qualitySetter:function(k){-1!==["low","high"].indexOf(k)&&this._set("quality",k)},clone:function(){return new this.constructor({quality:this.quality})}})})},"esri/views/3d/environment/SceneViewEnvironmentManager":function(){define("../../../core/declare ../../../core/Accessor ../../../core/Evented ../../../core/promiseUtils ../../../core/watchUtils ../../../core/HandleRegistry ../../../geometry/Point ../../../geometry/support/webMercatorUtils ../../../geometry/SpatialReference ../support/sunUtils ../support/earthUtils ./EnvironmentRenderer".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f,n){var u=new Date,t={hours:0,minutes:0,seconds:0},r=[.5773502691896258,-.5773502691896258,.5773502691896258];m=m([k,b],{declaredClass:"esri.views.3d.environment.SceneViewEnvironmentManager",referencePointUpdateDelay:200,referencePointUpdateInterval:3E3,referencePointUpdateDistThreshold:1E6,properties:{updating:{dependsOn:["noReferencePositionQueries"],readOnly:!0,get:function(){return!this.noReferencePositionQueries&&(!!this._referencePosUpdateQuery||!!this._referencePosMapCoordsRequested)}},
noReferencePositionQueries:{},view:{},_environmentRenderer:{}},constructor:function(){this._viewHandles=new h;this._environmentRenderer=null;this._viewConnected=this._trackingEnabled=this._preserveAbsoluteDateTime=!1;this._referencePosResetPreserveAbsoluteTime=null;this._resetReferencePosition()},destroy:function(){this._viewHandles.destroy();this.disposeRendering()},disposeRendering:function(){this._environmentRenderer&&(this._environmentRenderer.destroy(),this._environmentRenderer=null);this._resetReferencePosition(!0)},
updateReadyChange:function(a){a&&!this._viewConnected?(this._viewConnected=!0,this.connectView(this.view)):!a&&this._viewConnected&&(this._viewConnected=!1,this.disconnectView(this.view))},connectView:function(a){this._environmentRenderer=new n({view:a});this._viewHandles.add([c.on(this.view,"environment.lighting","date-will-change",this._lightingDateHandler.bind(this)),this.view.watch("interacting,stationary",this._interactingStationaryHandler.bind(this)),this.view.watch("environment.lighting.directShadowsEnabled,environment.lighting.ambientOcclusionEnabled",
this._updateRenderParamsHandler.bind(this)),this.view.watch("spatialReference",this._spatialReferenceHandler.bind(this)),c.init(this.view,"viewingMode",this._viewingModeHandler.bind(this)),c.init(this.view,"environment.lighting.cameraTrackingEnabled",this._updateCameraTracking.bind(this),!0),this.watch("noReferencePositionQueries",this._cameraHandler.bind(this,null))]);this._updateRenderParamsHandler();this._updateLightParams();this._cameraHandler()},_updateCameraTracking:function(a){if(this._trackingEnabled=
a)a=c.on(this,"view.navigation","currentViewChanged",this._cameraHandler.bind(this,null),this._cameraHandler.bind(this,null),null,!0),this._viewHandles.add(a,"camera");else{if(a=this.get("view.environment.lighting"))a.positionTimezoneInfo.autoUpdated=!1;this._viewHandles.remove("camera")}},disconnectView:function(a){this.disposeRendering();this._viewHandles.removeAll()},_lightingDateHandler:function(a){if(a=a.date){var b=this.view.environment.lighting;if(!b.positionTimezoneInfo.autoUpdated){this._preserveAbsoluteDateTime=
!0;var c=this.view.spatialReference;if(!(c.isWGS84||c.isWebMercator||(c=this.view.camera.position,this._referencePosMapCoords&&this._referencePosMapCoords.equals(c)))){this._requestReferencePositionUpdate(c);return}this._preupdateTracking(a);this._referencePosWGS84&&(c=f.positionToTimezone(this._referencePosWGS84,t),b.autoUpdate(null,c),this._trackingEnabled&&(b.positionTimezoneInfo.autoUpdated=!0))}this._updateLightParams(a)}},_preupdateTracking:function(a){!this._trackingEnabled&&this.get("view.environment.lighting.cameraTrackingEnabled")&&
this._cameraHandler(a)},_cameraHandler:function(a){var b=this.view.camera;if(b){var c=this.view.spatialReference;c.isWGS84||c.isWebMercator?this._cameraHandlerGlobal(b,a):this._cameraHandlerLocal(b,a)}},_cameraHandlerGlobal:function(a,b){a=a.position;this._referencePosWGS84||(this._referencePosWGS84=new g({spatialReference:e.WGS84}));a.spatialReference.isWebMercator?d.webMercatorToGeographic(a,!1,this._referencePosWGS84):(this._referencePosWGS84.x=a.x,this._referencePosWGS84.y=a.y);this._referencePosWGS84.z=
a.z;this._autoUpdateTimezone(a,b)||this._updateLightParams(b)},_cameraHandlerLocal:function(a,b){a=a.position;(!this._referencePosMapCoords||this._referencePosMapCoordsRequested||this._exceedsReferencePosDistThreshold(a))&&this._requestReferencePositionUpdate(a,!0);this.view.mapCoordsHelper&&this._referencePosWGS84&&(this._referencePosWGS84.z=a.z*this.view.mapCoordsHelper.unitInMeters,this._referencePosChanged())},_interactingStationaryHandler:function(){!this.view.interacting&&this.view.stationary&&
this._executePendingReferencePositionUpdate()},_updateLightParams:function(a){var b=this.view.environment.lighting;a=a||b.date;var b=this.view._stage,c;this._referencePosWGS84?(c=l.computeColorAndIntensity(a,this._referencePosWGS84),l.computeDirection(a,this._referencePosWGS84,this.view.viewingMode,c.diffuse.direction)):c={diffuse:{color:[1,1,1],intensity:.5,direction:r},ambient:{color:[1,1,1],intensity:.5}};b.setDirectionalLight(c.diffuse);b.setAmbientLight(c.ambient);this._updateRenderParamsHandler()},
_autoUpdateTimezone:function(a,b){if(!this.view.get("environment.lighting.cameraTrackingEnabled"))return!1;u.setTime((b||this.view.environment.lighting.date).getTime());a=f.positionToTimezone(a,t);var c=this.view.environment.lighting.positionTimezoneInfo;if(!c.autoUpdated)c=a;else if(c.hours===a.hours&&c.minutes===a.minutes&&c.seconds===a.seconds)return!1;var d=u.getUTCHours()-(a.hours-c.hours),e=u.getUTCMinutes()-(a.minutes-c.minutes),c=u.getUTCSeconds()-(a.seconds-c.seconds);u.setUTCHours(d);u.setUTCMinutes(e);
u.setUTCSeconds(c);return b?!1:this.view.environment.lighting.autoUpdate(u,a)},_updateRenderParamsHandler:function(){var a=this.view._stage,b=!0;this._referencePosWGS84&&(b=l.computeShadowsEnabled(this._referencePosWGS84,this.view.viewingMode));a&&a.setRenderParams({shadowMap:this.view.environment.lighting.directShadowsEnabled&&b,ssao:this.view.environment.lighting.ambientOcclusionEnabled})},_spatialReferenceHandler:function(){this._resetReferencePosition()},_viewingModeHandler:function(a){this._resetReferencePosition()},
_resetReferencePosition:function(a){this._cancelReferencePosUpdates();this._referencePosWGS84=this._referencePosResetPreserveAbsoluteTime=this._referencePosMapCoordsRequested=this._referencePosMapCoords=null;a||this.notifyChange("updating")},_requestReferencePositionUpdate:function(b,c){if(this.view.mapCoordsHelper.canProject()&&!this.noReferencePositionQueries&&(this._referencePosMapCoordsRequested?this._referencePosMapCoordsRequested.copy(b):this._referencePosMapCoordsRequested=b.clone(),this._referencePosResetPreserveAbsoluteTime=
!!c,!this._referencePosUpdateQuery&&!this._referencePosUpdateTimer&&!this.view.interacting&&this.view.stationary)){var d=this,f=this._referencePosUpdateQuery=a.after(this.referencePointUpdateDelay).then(function(){if(d._referencePosUpdateQuery===f)return d._doReferencePositionUpdateQuery(function(){return d._referencePosUpdateQuery!==f})}).always(function(){d._referencePosUpdateQuery===f&&(d._referencePosUpdateQuery=null,d._referencePosUpdateTimer||d._executePendingReferencePositionUpdate(),d.notifyChange("updating"))}),
e=this._referencePosUpdateTimer=a.after(this.referencePointUpdateInterval).then(function(){d._referencePosUpdateTimer===e&&(d._referencePosUpdateTimer=null,d._referencePosUpdateQuery||d._executePendingReferencePositionUpdate())});this.notifyChange("updating")}},_doReferencePositionUpdateQuery:function(a){this._referencePosResetPreserveAbsoluteTime&&(this._preserveAbsoluteDateTime=!1);this._referencePosMapCoords?this._referencePosMapCoords.copy(this._referencePosMapCoordsRequested):this._referencePosMapCoords=
this._referencePosMapCoordsRequested.clone();this._referencePosMapCoordsRequested=this._referencePosResetPreserveAbsoluteTime=null;return this.view.mapCoordsHelper.toGeographic(this._referencePosMapCoords).then(function(b){if(!a()&&!isNaN(b[0])&&!isNaN(b[1])){var c=this._referencePosMapCoords.z*this.view.mapCoordsHelper.unitInMeters;this._referencePosWGS84?(this._referencePosWGS84.x=b[0],this._referencePosWGS84.y=b[1],this._referencePosWGS84.z=c):this._referencePosWGS84=new g({x:b[0],y:b[1],z:c,spatialReference:e.WGS84});
this._referencePosChanged()}}.bind(this))},_executePendingReferencePositionUpdate:function(){var a=this._referencePosMapCoordsRequested;a&&this._requestReferencePositionUpdate(a,this._referencePosResetPreserveAbsoluteTime)},_referencePosChanged:function(){this._preserveAbsoluteDateTime?this._updateLightParams():this._autoUpdateTimezone(this._referencePosWGS84)||this._updateLightParams()},_exceedsReferencePosDistThreshold:function(a){return this._referencePosMapCoords?(a=this._referencePosMapCoords.distance(a),
this.view.mapCoordsHelper&&(a*=this.view.mapCoordsHelper.unitInMeters),a>this.referencePointUpdateDistThreshold):!0},_cancelReferencePosUpdates:function(){this._referencePosUpdateTimer=this._referencePosUpdateQuery=null}});m.FIXED_LIGHT_DIRECTION=r;return m})},"esri/views/3d/support/sunUtils":function(){define(["./mathUtils","../lib/glMatrix","../lib/SunCalc"],function(m,k,b){var a=k.vec3d,c=k.mat4d,h=m.lerp,g=c.identity(),d={azimuth:0,altitude:0};k={local:{altitude:2E3,ambientAtNight:.2,ambientAtNoon:.75,
ambientAtTwilight:.5,diffuseAtNoon:.25,diffuseAtTwilight:.5},global:{altitude:2E4,ambient:.5,diffuse:.5},planarDirection:{localAltitude:1E5,globalAltitude:1E6,globalAngles:{azimuth:Math.PI/2,altitude:Math.PI/2}}};var e={ambient:{color:a.create(),intensity:0},diffuse:{color:a.create(),intensity:0,direction:a.create()}},l={settings:k,computeDirection:function(f,e,h,r){r||(r=a.create());var n=c.identity(g);if("global"===h)b.getPosition(f,0,0,d),a.set3(0,0,-1,r),c.rotateX(n,-d.azimuth),c.rotateY(n,-d.altitude);
else{var q=l.settings.planarDirection;h=q.globalAngles;q=(e.z-q.localAltitude)/(q.globalAltitude-q.localAltitude);q=m.clamp(q,0,1);1>q?(b.getPosition(f,e.y,e.x,d),d.azimuth=(1-q)*d.azimuth+q*h.azimuth,d.altitude=(1-q)*d.altitude+q*h.altitude):(d.azimuth=h.azimuth,d.altitude=h.altitude);a.set3(0,-1,0,r);c.rotateZ(n,-d.azimuth);c.rotateX(n,-d.altitude)}c.multiplyVec3(n,r);return r},computeShadowsEnabled:function(a,b){return"global"===b?!0:a.z<l.settings.planarDirection.localAltitude},computeColorAndIntensity:function(c,
d){var g,n=d.z;g=l.settings;a.set3(1,1,1,e.ambient.color);e.ambient.intensity=g.global.ambient;a.set3(1,1,1,e.diffuse.color);e.diffuse.intensity=g.global.diffuse;n=(n-g.local.altitude)/(g.global.altitude-g.local.altitude);n=m.clamp(n,0,1);if(1>n){g=b.getTimes(c,d.y,d.x);d=c.valueOf();var u,q;g.polarException===b.POLAR_EXCEPTION.MIDNIGHT_SUN?(u=d-36E5*(c.getHours()+48)-6E4*c.getMinutes(),q=u+432E6):g.polarException===b.POLAR_EXCEPTION.POLAR_NIGHT?(u=d-2,q=d-1):(u=g.sunrise.valueOf(),q=g.sunset.valueOf());
var x=q-u;c=u+x/2;var k=x/4;g=c-k;var k=c+k,z=.06*x,x=u-z/2;u+=z/2;var A=q-z/2,C=q+z/2;q=l.settings.local;var B=[.01,q.ambientAtNight],D=[.8,.8,1],H=[.01,.01,.01],K=[q.diffuseAtTwilight,q.ambientAtTwilight],E=[1,.75,.75],F=[.8,.8,1],L=[.9*q.diffuseAtNoon,q.ambientAtNoon],Q=[1,.98,.98],N=[.98,.98,1],J=[q.diffuseAtNoon,q.ambientAtNoon],P=[1,1,1],I=[1,1,1];q=[0,0];var O=[0,0],z=[0,0];d<x||d>C?(q=B,O=H,z=D):d<u?(z=u-x,q=f(d-x,z,B,K),O=f(d-x,z,H,E),z=f(d-x,z,D,F)):d<g?(z=g-u,q=f(d-u,z,K,L),O=f(d-u,z,E,
Q),z=f(d-u,z,F,N)):d<c?(z=c-g,q=f(d-g,z,L,J),O=f(d-g,z,Q,P),z=f(d-g,z,N,I)):d<k?(z=k-c,q=f(d-c,z,J,L),O=f(d-c,z,P,Q),z=f(d-c,z,I,N)):d<A?(z=A-k,q=f(d-k,z,L,K),O=f(d-k,z,Q,E),z=f(d-k,z,N,F)):d<C&&(z=C-A,q=f(d-A,z,K,B),O=f(d-A,z,E,H),z=f(d-A,z,F,D));d=q[0];c=O;g=q[1];a.lerp(z,e.ambient.color,n,e.ambient.color);e.ambient.intensity=h(g,e.ambient.intensity,n);a.lerp(c,e.diffuse.color,n,e.diffuse.color);e.diffuse.intensity=h(d,e.diffuse.intensity,n)}return e}},f=function(a,b,c,d){for(var f=[],e=0;e<c.length;e++)f[e]=
(d[e]-c[e])*a/b+c[e];return f};return l})},"esri/views/3d/lib/SunCalc":function(){define([],function(){function m(a){return new Date(864E5*(a+.5-2440588))}function k(a,b){return r(f(a)*n(y)-u(b)*f(y),n(a))}function b(a,b){return t(f(b)*n(y)+n(b)*f(y)*f(a))}function a(a,b,c){return r(f(a),n(a)*f(b)-u(c)*n(b))}function c(a,b,c){return t(f(b)*f(c)+n(b)*n(c)*n(a))}function h(a){return q*(1.9148*f(a)+.02*f(2*a)+3E-4*f(3*a))}function g(a,c){a=q*(357.5291+.98560028*a);var d=h(a);a=a+d+102.9372*q+l;c||(c=
{dec:0,ra:0});c.dec=b(a,0);c.ra=k(a,0);return c}function d(a,b,c){return 2451545+a+.0053*f(b)-.0069*f(2*c)}function e(a){var c=q*(134.963+13.064993*a),d=q*(93.272+13.22935*a);a=q*(218.316+13.176396*a)+6.289*q*f(c);d=5.128*q*f(d);c=385001-20905*n(c);return{ra:k(a,d),dec:b(a,d),dist:c}}var l=Math.PI,f=Math.sin,n=Math.cos,u=Math.tan,t=Math.asin,r=Math.atan2,w=Math.acos,q=l/180,x={dec:0,ra:0},y=23.4397*q,z={POLAR_EXCEPTION:{NORMAL:0,MIDNIGHT_SUN:1,POLAR_NIGHT:2},getPosition:function(b,d,f,e){f=q*-f;d*=
q;var l=b.valueOf()/864E5-.5+2440588-2451545;b=g(l,x);f=q*(280.16+360.9856235*l)-f-b.ra;e||(e={azimuth:0,altitude:0});e.azimuth=a(f,d,b.dec);e.altitude=c(f,d,b.dec);return e}},A=[[-.83,"sunrise","sunset"]];z.addTime=function(a,b,c){A.push([a,b,c])};z.getTimes=function(a,c,e){function g(a){var b=r,c=y;a=w((f(a)-f(b)*f(c))/(n(b)*n(c)));return d(9E-4+(a+u)/(2*l)+t,x,k)}var u=q*-e,r=q*c,t=Math.round(a.valueOf()/864E5-.5+2440588-2451545-9E-4-u/(2*l));a=9E-4+(0+u)/(2*l)+t;var x=q*(357.5291+.98560028*a);
c=h(x);var k=x+c+102.9372*q+l,y=b(k,0);a=d(a,x,k);c={solarNoon:m(a),nadir:m(a-.5),polarException:z.POLAR_EXCEPTION.NORMAL};var C,B,D,O;e=0;for(C=A.length;e<C;e+=1)B=A[e],D=g(B[0]*q),O=a-(D-a),c[B[1]]=m(O),c[B[2]]=m(D);c.polarException=function(a){a=(f(a)-f(r)*f(y))/(n(r)*n(y));return-1>a?z.POLAR_EXCEPTION.MIDNIGHT_SUN:1<a?z.POLAR_EXCEPTION.POLAR_NIGHT:z.POLAR_EXCEPTION.NORMAL}(A[0][0]*q);return c};z.getMoonPosition=function(b,d,f){f=q*-f;d*=q;var l=b.valueOf()/864E5-.5+2440588-2451545;b=e(l);f=q*
(280.16+360.9856235*l)-f-b.ra;l=c(f,d,b.dec);l+=.017*q/u(l+10.26*q/(l+5.1*q));return{azimuth:a(f,d,b.dec),altitude:l,distance:b.dist}};z.getMoonFraction=function(a){var b=a.valueOf()/864E5-.5+2440588-2451545;a=g(b);b=e(b);a=w(f(a.dec)*f(b.dec)+n(a.dec)*n(b.dec)*n(a.ra-b.ra));a=r(149598E3*f(a),b.dist-149598E3*n(a));return(1+n(a))/2};return z})},"esri/views/3d/environment/EnvironmentRenderer":function(){define("../../../core/watchUtils ../support/ExternalRenderer ./PanoramicAtmosphere ./RealisticAtmosphere ./SimpleAtmosphere ./Stars ../webgl-engine/lib/RenderSlot".split(" "),
function(m,k,b,a,c,h,g){return k.createSubclass({declaredClass:"esri.views.3d.environment.EnvironmentRenderer",properties:{view:{},viewingMode:{dependsOn:["view.viewingMode"],get:function(){return this.get("view.viewingMode")||"global"}},atmosphereQuality:{dependsOn:["view.environment.atmosphereEnabled","view.environment.atmosphere.quality"],get:function(){return this.get("view.environment.atmosphereEnabled")?this.get("view.environment.atmosphere.quality")||"none":"none"}},starsEnabled:{dependsOn:["view.environment.starsEnabled"],
get:function(){return this.get("view.environment.starsEnabled")||!1}},transparent:{dependsOn:["view.basemapTerrain.opacity","view.basemapTerrain.wireframe"],get:function(){var a=this.get("view.basemapTerrain");return a&&a._renderer.isTransparent()}},_atmosphere:{},_stars:{},needsRender:{dependsOn:["_stars.needsRender","_atmosphere.needsRender"],get:function(){return!!(this._needsRender||this._atmosphere&&this._atmosphere.needsRender||this._stars&&this._stars.needsRender)}}},constructor:function(){this._STANDARD_SLOT=
g.BACKGROUND;this._SPECIAL_SLOT=g.POSTPROCESSING_ATMOSPHERE;this._slots=[this._STANDARD_SLOT,this._SPECIAL_SLOT];this._stars=this._atmosphere=this._atmosphereReadyPromise=this._AtmosphereClass=null;this._needsRender=!0;this.notifyChange("needsRender")},initialize:function(){this.view._stage.addExternalRenderer(this._slots,this);this._basemapTerrainHandle=m.when(this.view,"basemapTerrain",this._updateBasemapTerrain.bind(this))},destroy:function(){this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=
null);this._stars&&(this._stars.destroy(),this._stars=null);this._basemapTerrainHandle&&this._basemapTerrainHandle.remove();this.view&&(this.view._stage.removeExternalRenderer(this),this.view=null)},setup:function(a){this.watch("viewingMode,atmosphereQuality,transparent,visible",this._updateAtmosphere.bind(this));this._updateAtmosphere();this.watch("starsEnabled,transparent,visible",this._updateStars.bind(this));this._updateStars();this.watch("view.basemapTerrain.loaded",function(){this._needsRender=
!0;this.notifyChange("needsRender")}.bind(this))},resetNeedsRender:function(){this._atmosphere&&(this._atmosphere.resetNeedsRender?this._atmosphere.resetNeedsRender():this._atmosphere.didRender&&(this._atmosphere.needsRender=!1,this._atmosphere.didRender=!1));this._stars&&(this._stars.resetNeedsRender?this._stars.resetNeedsRender():this._stars.didRender&&(this._stars.needsRender=!1,this._stars.didRender=!1));this.didRender&&(this.didRender=this._needsRender=!1,this.notifyChange("needsRender"))},render:function(a){if(!this.get("view.basemapTerrain.loaded")&&
"global"===this.viewingMode)return!1;if(!this._stars&&!this._atmosphere)return!0;this._stars&&this._stars.render(a);this._atmosphere&&this._atmosphere.render(a);return this._stars&&this._stars.didRender||this._atmosphere&&this._atmosphere.didRender},_updateStars:function(){var a=this._getAtmosphereSlot();this.starsEnabled&&!this._stars?(this._stars=new h({view:this.view,slot:a}),this._stars.initializeRenderContext(this.renderContext)):!this.starsEnabled&&this._stars?(this._stars.destroy(),this._stars=
null):this._stars&&(this._stars.slot=a);this._needsRender=!0;this.notifyChange("needsRender")},_updateAtmosphere:function(){var a=this._getAtmosphereSlot();this._atmosphere&&(this._atmosphere.slot=a);if(this._updateAtmosphereClass(this.renderContext)){this._needsRender=!0;this.notifyChange("needsRender");var b=function(){this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=null)}.bind(this);if(this._AtmosphereClass){this._atmosphereReadyPromise&&(this._atmosphereReadyPromise.cancel(),this._atmosphereReadyPromise=
null);var c=new this._AtmosphereClass({view:this.view,slot:a});c.initializeRenderContext(this.renderContext);this._atmosphere?this._atmosphereReadyPromise=c.then(function(){b();this._atmosphereReadyPromise=null;this._atmosphere=c}.bind(this)):this._atmosphere=c;c.then(function(){this._updateBasemapTerrain()}.bind(this))}else b(),this._updateBasemapTerrain()}},_updateAtmosphereClass:function(d){var e=this._AtmosphereClass;"none"===this.atmosphereQuality?this._AtmosphereClass=null:"high"===this.atmosphereQuality&&
!this.transparent&&a.isSupported(d)?this._AtmosphereClass="local"===this.viewingMode?b:a:this._AtmosphereClass="local"===this.viewingMode?b:c;return this._AtmosphereClass!==e},_getAtmosphereSlot:function(){return this.transparent&&"global"===this.viewingMode?this._SPECIAL_SLOT:this._STANDARD_SLOT},_updateBasemapTerrain:function(){var b=this.get("view.basemapTerrain");b&&(b.velvetOverground=!(!this._AtmosphereClass||this._AtmosphereClass===a))}})})},"esri/views/3d/support/ExternalRenderer":function(){define("../../../core/declare ../../../core/Accessor ../../../core/Promise dojo/Deferred dojo/aspect dojo/_base/lang".split(" "),
function(m,k,b,a,c,h){return m([k,b],{"-chains-":h.mixin(k._meta.chains,{setup:"after",initializeRenderContext:"after",uninitializeRenderContext:"before"}),properties:{gl:{readOnly:!0,get:function(){return this._gl}},needsRender:{value:!0},visible:{value:!0}},constructor:function(){this.didRender=!1;this.renderContext=null;this.watch("visible",function(){this.needsRender=!0}.bind(this));this._contextDfd=new a},initialize:function(){this.addResolvingPromise(this._contextDfd.promise);c.around(this,
"render",function(a){return function(){return this.isRejected()?this.didRender=!0:this.isResolved()?!this.visible||a.apply(this,arguments)?this.didRender=!0:!1:!1}.bind(this)}.bind(this));this.then(function(){this.destroyed||this.setup(this.renderContext)}.bind(this))},needsRender:!0,visible:!0,initializeRenderContext:function(a){this.renderContext=a;this._contextDfd.resolve()},uninitializeRenderContext:function(a){},setup:function(a){},render:function(a){return!1}})})},"esri/views/3d/environment/PanoramicAtmosphere":function(){define("dojo/text!./materials/SimpleAtmosphereMaterial.xml dojo/Deferred ../support/ExternalRenderer ../lib/glMatrix ../webgl-engine/lib/GeometryRenderer ../webgl-engine/lib/GeometryUtil ../webgl-engine/lib/Texture ../webgl-engine/lib/Util ../webgl-engine/lib/GLTextureRep ../webgl-engine/lib/RenderPass ../webgl-engine/lib/RenderSlot ./resources/SimpleAtmosphereTexture ../../webgl/Program ../webgl-engine/lib/DefaultVertexBufferLayouts ../webgl-engine/lib/DefaultVertexAttributeLocations".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f,n,u,t,r){var w=a.vec2d,q=a.vec3d,x=a.mat4d,y=d.VertexAttrConstants,z=x.create();return b.createSubclass({declaredClass:"esri.views.3d.environment.PanoramicAtmosphere",properties:{view:{},needsRender:{value:!1},slot:{value:f.BACKGROUND,set:function(a){this.needsRender=!0;this._set("slot",a)}}},constructor:function(){this._renderData={texV:w.create(),silCircleCenter:q.create(),silCircleV1:q.create(),silCircleV2:q.create()};this._textureRep=this._texture=null;this.slot=
f.BACKGROUND},initialize:function(){this._textureDfd=new k;this.addResolvingPromise(this._textureDfd.promise)},destroy:function(){this._textureRep&&(this._texture&&(this._textureRep.release("SimpleAtmosphere"),this._textureRep.getTexture("SimpleAtmosphere").unload()),this._textureRep=null);this._program&&(this._program.dispose(),this._program=null);this._textureDfd&&(this._textureDfd.cancel(),this._textureDfd=null)},initializeRenderContext:function(a){this._textureRep=new e({SimpleAtmosphere:new g(n,
"SimpleAtmosphere",{wrapClamp:!0})},a.programRep,function(){return this.view._stage.getCamera().viewport}.bind(this),a.rctx);this._texture=this._textureRep.aquire("SimpleAtmosphere",void 0,void 0,function(a){this._texture=a.getGLTexture();this._textureDfd.resolve();this._textureDfd=null}.bind(this))},setup:function(a){var b=this._createGeometryData(),d=this.renderContext.rctx;this._renderer=new c(b,t.Pos3,null,d);a.shaderSnippets.vsSimpleAtmosphere||a.shaderSnippets._parse(m);this._program=new u(d,
a.shaderSnippets.vsSimpleAtmosphere,a.shaderSnippets.fsSimpleAtmosphere,r.Default3D,["PANORAMIC"])},render:function(a){if(a.slot!==this.slot||a.pass!==l.MATERIAL||!this._textureRep.getIsLoaded("SimpleAtmosphere"))return!1;var b=this.renderContext.rctx,c=b.gl,d=this._program;b.bindProgram(d);b.bindTexture(this._texture);d.setUniform1i("tex",0);d.setUniformMatrix4fv("proj",a.camera.projectionMatrix);x.toRotationMat(a.camera.viewMatrix,z);d.setUniformMatrix4fv("view",z);d.setUniform4f("color",1,1,1,
1);d.setUniform3fv("lightDirection",a.lightingData.direction);b.setFaceCullingEnabled(!0);b.setDepthFunction(c.LEQUAL);b.setBlendingEnabled(!0);b.setDepthWriteEnabled(!1);this._renderer.render(this._program);b.setDepthWriteEnabled(!0);b.setBlendingEnabled(!1);b.setDepthFunction(c.LESS);b.setFaceCullingEnabled(!1);return!0},_createGeometryData:function(){for(var a=h.createPolySphereGeometry(1,2),b=a.getFaces(),c=b[0].indices[y.POSITION],d=0;d<c.length;d+=3){var f=c[d];c[d]=c[d+2];c[d+2]=f}a=a.getVertexAttr();
c=a[y.NORMAL].data;for(d=0;d<c.length;d++)c[d]=-c[d];return{faces:b[0],vertexAttr:a}}})})},"esri/views/3d/webgl-engine/lib/GeometryRenderer":function(){define("require exports ../materials/internal/MaterialUtil ./DefaultVertexAttributeLocations ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ../../../webgl/Util ../../../webgl/enums".split(" "),function(m,k,b,a,c,h,g,d){return function(){function d(d,f,e,u){this._drawMode=4;this._layout=f;var l=d.faces;this._count=l.indices[l.positionKey].length;
l=new Float32Array(this._count*g.getStride(f)/4);e?e(d,void 0,void 0,null,f,l,0):b.fillInterleaved(d,void 0,void 0,null,f,l,0);this._rctx=u;this._vao=new c(u,a.Default3D,{geometry:f},{geometry:h.createVertex(u,35044,l)})}d.prototype.enablePointRendering=function(a){this._drawMode=a?0:4};d.prototype.render=function(a){var b=this._rctx;b.bindVAO(this._vao);g.assertCompatibleVertexAttributeLocations(this._vao,a);b.drawArrays(this._drawMode,0,this._count)};return d}()})},"esri/views/3d/environment/resources/SimpleAtmosphereTexture":function(){define([],
function(){return"data:image/png;base64,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"})},
"esri/views/3d/environment/RealisticAtmosphere":function(){define("dojo/text!./materials/RealisticAtmosphereMaterial.xml ../../../core/watchUtils ../../../core/HandleRegistry ../support/ExternalRenderer ../lib/glMatrix ../webgl-engine/lib/GeometryRenderer ../webgl-engine/lib/GeometryUtil ../webgl-engine/lib/RenderPass ../webgl-engine/lib/RenderSlot ../webgl-engine/lib/OffscreenRenderingHelper ../support/earthUtils ../../webgl/Program ../webgl-engine/lib/DefaultVertexBufferLayouts ../webgl-engine/lib/DefaultVertexAttributeLocations".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f,n,u,t){var r=f.earthRadius,w=c.vec3d,q=c.vec2d,x=c.vec4d;c=.02*Math.PI;f=.004*Math.PI;var y=w.createFrom(1/Math.pow(.65,4),1/Math.pow(.57,4),1/Math.pow(.475,4)),z=w.create(y);w.scale(z,c);w.add(z,w.createFrom(f,f,f));var A=(1- -.99999*-.99999)/(2+-.99999*-.99999)*1.5;a=a.createSubclass({declaredClass:"esri.views.3d.environment.RealisticAtmosphere",properties:{view:{},planar:{value:!1,set:function(a){a=!!a;a!==this.planar&&this._update();this._set("planar",a)}},needsRender:{value:!1}},
constructor:function(){this._handles=new b;this._lowerElevationBoundRadius=0;this._earthRadius=r;this._renderer=this._skyPlanarProgram=this._skyProgram=this._hazePlanarProgram=this._hazeProgram=null;this._renderData={texDepth:q.create(),v3CameraPos:w.create(),v3CameraUp:w.create(),v3CameraRight:w.create(),v3CameraDir:w.create(),v3CameraCenter:w.create(),halfSizeNearPlane:q.create(),v2CameraCenterOffset:q.create(),v4SphereComp:x.create(),v4AtmosParams1:x.create(),v4AtmosParams2:x.create(),v4AtmosParams3:x.create(),
v3InvWavelength:y,v3InvWavelengthScaled:z,v4Radii:x.create(),fScale:0,fScaleDepth:.25,fLowerAlphaBlendBound:0,fScaleOverScaleDepth:0,fOneOverScaleDepth:0,fScaleDepthBlue:.05,fOneOverScaleDepthBlue:20,fScaleOverScaleDepthBlue:0,g:-.99999,g2:-.99999*-.99999,fMiePhaseCoefficients:A,showTest:0,nearFar:q.create()};this._updateRadius(r);this._hazeSlot=e.POSTPROCESSING_ATMOSPHERE;this._skySlot=e.BACKGROUND},destroy:function(){this._handles&&(this._handles.destroy(),this._handles=null);this._hazeProgram&&
(this._hazeProgram.dispose(),this._hazeProgram=null);this._hazePlanarProgram&&(this._hazePlanarProgram.dispose(),this._hazePlanarProgram=null);this._skyProgram&&(this._skyProgram.dispose(),this._skyProgram=null);this._skyPlanarProgram&&(this._skyPlanarProgram.dispose(),this._skyPlanarProgram=null)},setup:function(a){var b=g.createSquareGeometry(),c={faces:b.getFaces()[0],vertexAttr:b.getVertexAttr()},b=this.renderContext.rctx;this._renderer=new h(c,u.Pos3Tex,null,b);var d=this._update.bind(this);
this._handles.add(k.on(this,"view.navigation","currentViewChanged",function(a){d(a.camera)},function(){d()},null,!0));var c=this._updateElevation.bind(this),f=this._updateVisibleElevationBounds.bind(this);this._handles.add(k.on(this,"view.basemapTerrain","elevation-change",c,c));this._handles.add(k.on(this,"view.basemapTerrain","elevation-bounds-change",f,f));a.shaderSnippets.fsRealisticAtmosphere||a.shaderSnippets._parse(m);this._hazeProgram=new n(b,a.shaderSnippets.vsRealisticAtmosphere,a.shaderSnippets.fsRealisticAtmosphere,
t.Default3D,["HAZE"]);this._skyProgram=new n(b,a.shaderSnippets.vsRealisticAtmosphere,a.shaderSnippets.fsRealisticAtmosphere,t.Default3D);this._hazePlanarProgram=new n(b,a.shaderSnippets.vsRealisticAtmosphere,a.shaderSnippets.fsRealisticAtmosphere,t.Default3D,["HAZE","PLANAR"]);this._skyPlanarProgram=new n(b,a.shaderSnippets.vsRealisticAtmosphere,a.shaderSnippets.fsRealisticAtmosphere,t.Default3D,["PLANAR"])},render:function(a){if(!(a.slot!=this._hazeSlot&&a.slot!=this._skySlot||a.pass!=d.MATERIAL||
a.slot==this._hazeSlot&&a.options.earlyOcclusionPixelDraw)){var b,c=this.renderContext.rctx,f=c.gl,e=a.offscreenRenderingHelper,l=!1;if(a.slot==this._hazeSlot){b=this.planar?this._hazePlanarProgram:this._hazeProgram;c.bindProgram(b);c.setBlendFunctionSeparate(f.ONE,f.ONE_MINUS_SRC_COLOR,f.ZERO,f.ONE);e.detachDepthTextureFromBuffer();var l=!0,g=e.getDepthTexture();c.bindTexture(g,0);b.setUniform1i("tDepth",0);b.setUniform4fv("v4SphereComp",this._renderData.v4SphereComp)}a.slot==this._skySlot&&(b=this.planar?
this._skyPlanarProgram:this._skyProgram,c.bindProgram(b),c.setBlendFunctionSeparate(f.SRC_ALPHA,f.ONE_MINUS_SRC_ALPHA,f.ONE,f.ONE_MINUS_SRC_ALPHA),b.setUniform4fv("v4SphereComp",this._renderData.v4SphereComp),b.setUniform4fv("v4AtmosParams3",this._renderData.v4AtmosParams3));b.setUniform3fv("v3InvWavelength",this._renderData.v3InvWavelength);b.setUniform3fv("v3InvWavelengthScaled",this._renderData.v3InvWavelengthScaled);b.setUniform3fv("v3LightDir",a.lightingData.direction);b.setUniform3fv("v3CameraPos",
this._renderData.v3CameraPos);b.setUniform3fv("v3CameraUp",this._renderData.v3CameraUp);b.setUniform3fv("v3CameraRight",this._renderData.v3CameraRight);b.setUniform3fv("v3CameraDir",this._renderData.v3CameraDir);b.setUniform2fv("nearFar",this._renderData.nearFar);b.setUniform2fv("halfSizeNearPlane",this._renderData.halfSizeNearPlane);b.setUniform2fv("v2CameraCenterOffset",this._renderData.v2CameraCenterOffset);b.setUniform4fv("v4Radii",this._renderData.v4Radii);b.setUniform4fv("v4AtmosParams1",this._renderData.v4AtmosParams1);
b.setUniform4fv("v4AtmosParams2",this._renderData.v4AtmosParams2);b.setUniform1f("showTest",this._renderData.showTest);c.setDepthTestEnabled(!1);c.setBlendingEnabled(!0);this._renderer.render(b);c.setBlendingEnabled(!1);c.setDepthTestEnabled(!0);c.setBlendFunctionSeparate(f.SRC_ALPHA,f.ONE_MINUS_SRC_ALPHA,f.ONE,f.ONE_MINUS_SRC_ALPHA);l&&e.restoreDepthTextureToBuffer();return!0}},_setEnableTestImage:function(a){this._renderData.showTest=a?1:0;this.needsRender=!0},_adjustRadiusForTesselation:function(a){return a*
Math.cos(Math.PI/Math.pow(2,4)/16)},_normalizeRadius:function(a){a=this._adjustRadiusForTesselation(a);return Math.max(r-1E4,Math.min(a,r))},_updateElevation:function(){if(this.get("view.basemapTerrain.ready")){var a=this._adjustRadiusForTesselation(r+this.view.basemapTerrain.rootTiles[0].elevationBounds[0]);a!==this._lowerElevationBoundRadius&&(this._lowerElevationBoundRadius=a,this._earthRadius=-1,this._updateVisibleElevationBounds())}},_updateVisibleElevationBounds:function(){var a=this._adjustRadiusForTesselation(r+
this.view.basemapTerrain.getElevationBounds()[0]);return 0>this._earthRadius||a<this._earthRadius?this._updateRadius(a):!1},_updateRadius:function(a){this._earthRadius=a;var b=a*a,c=a/10*10.25,d=c*c,f=1/(c-a),e=f/.25,l=f/.05,g=.3*(c-a)+a,n=1/(c-g),h=this._renderData;x.set4(f,.25,e,4,h.v4AtmosParams1);x.set4(-.99999,.05,l,20,h.v4AtmosParams2);x.set4(-.99999*-.99999,A,g,n,h.v4AtmosParams3);x.set4(a,b,c,d,h.v4Radii);h.fScale=f;h.fLowerAlphaBlendBound=g;h.fScaleOverScaleDepth=e;h.fScaleOverScaleDepthBlue=
l;this._update();return!0},_update:function(a){if(a=a||this.get("view.navigation.currentCamera")){w.negate(a.viewForward,this._renderData.v3CameraDir);w.set(a.viewUp,this._renderData.v3CameraUp);w.set(a.viewRight,this._renderData.v3CameraRight);if(this.planar){var b=this.view.renderCoordsHelper;this._renderData.fCameraHeight=b.getAltitude(a.eye)/b.unitInMeters+r}else this._renderData.fCameraHeight=w.length(a.eye);this._renderData.fCameraHeight2=this._renderData.fCameraHeight*this._renderData.fCameraHeight;
this._renderData.fC=this._renderData.fCameraHeight2-this._renderData.v4Radii[3];this._renderData.fCSur=this._renderData.fCameraHeight2-this._renderData.v4Radii[1];this._renderData.v4SphereComp=x.createFrom(this._renderData.fCameraHeight,this._renderData.fCameraHeight2,this._renderData.fC,this._renderData.fCSur);w.set(a.eye,this._renderData.v3CameraPos);w.set(a.center,this._renderData.v3CameraCenter);q.set2(Math.tan(a.fovX/2)/(a.width/a.fullWidth),Math.tan(a.fovY/2)/(a.height/a.fullHeight),this._renderData.halfSizeNearPlane);
q.set2((a.padding[3]+a.width/2)/a.fullWidth-.5,(a.padding[2]+a.height/2)/a.fullHeight-.5,this._renderData.v2CameraCenterOffset);q.set2(a.near,a.far,this._renderData.nearFar);this.needsRender=!0}}});a.isSupported=function(a){return l.supportsDepthTexture(a.rctx.extensions)};return a})},"esri/views/3d/environment/SimpleAtmosphere":function(){define("dojo/text!./materials/SimpleAtmosphereMaterial.xml dojo/Deferred ../../../core/watchUtils ../support/ExternalRenderer ../lib/glMatrix ../webgl-engine/lib/GeometryRenderer ../webgl-engine/lib/Texture ../webgl-engine/lib/Util ../webgl-engine/lib/GLTextureRep ../webgl-engine/lib/RenderPass ../webgl-engine/lib/RenderSlot ./resources/SimpleAtmosphereTexture ../support/earthUtils ../../webgl/Program ../webgl-engine/lib/DefaultVertexAttributeLocations".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f,n,u,t,r){var w=u.earthRadius,q=c.vec3d,x=c.vec2d,y=c.mat4d,z=d.VertexAttrConstants,A=(w-1E4)/w,C=(w+3E5)/w,B=-1E4/3E5,D=1-B;return a.createSubclass({declaredClass:"esri.views.3d.environment.SimpleAtmosphere",properties:{view:{},needsRender:{value:!1},slot:{value:f.BACKGROUND,set:function(a){this.needsRender=!0;this._set("slot",a)}}},constructor:function(){this._renderData={texV:x.create(),silCircleCenter:q.create(),silCircleV1:q.create(),silCircleV2:q.create()};this._textureRep=
this._texture=null},initialize:function(){this._textureDfd=new k;this.addResolvingPromise(this._textureDfd.promise)},destroy:function(){this._currentViewChangedHandle&&(this._currentViewChangedHandle.remove(),this._currentViewChangedHandle=null);this._textureRep&&(this._texture&&(this._textureRep.release("SimpleAtmosphere"),this._textureRep.getTexture("SimpleAtmosphere").unload()),this._textureRep=null);this._program&&(this._program.dispose(),this._program=null);this._textureDfd&&(this._textureDfd.cancel(),
this._textureDfd=null)},initializeRenderContext:function(a){this._textureRep=new e({SimpleAtmosphere:new g(n,"SimpleAtmosphere",{wrapClamp:!0})},a.programRep,function(){return this.view._stage.getCamera().viewport}.bind(this),a.rctx);this._texture=this._textureRep.aquire("SimpleAtmosphere",void 0,void 0,function(a){this._texture=a.getGLTexture();this._textureDfd.resolve();this._textureDfd=null}.bind(this))},setup:function(a){var c=this._createRibbonGeometryData();this._renderer=new h(c,[{name:"position",
count:3,type:5126,offset:0,stride:12,normalized:!1}],null,a.rctx);this._currentViewChangedHandle=b.on(this,"view.navigation","currentViewChanged",function(a){this._update(a.camera)}.bind(this),function(){this._update(this.get("view.navigation.currentCamera"))}.bind(this),null,!0);a.shaderSnippets.vsSimpleAtmosphere||a.shaderSnippets._parse(m);this._program=new t(a.rctx,a.shaderSnippets.vsSimpleAtmosphere,a.shaderSnippets.fsSimpleAtmosphere,r.Default3D)},render:function(a){if(a.slot!==this.slot||a.pass!==
l.MATERIAL)return!1;var b=this.renderContext.rctx,c=b.gl,d=this._program;b.bindProgram(d);d.setUniform4f("color",1,1,1,1);d.setUniformMatrix4fv("proj",a.camera.projectionMatrix);d.setUniformMatrix4fv("view",a.camera.viewMatrix);d.setUniform3fv("silCircleCenter",this._renderData.silCircleCenter);d.setUniform3fv("silCircleV1",this._renderData.silCircleV1);d.setUniform3fv("silCircleV2",this._renderData.silCircleV2);d.setUniform2fv("texV",this._renderData.texV);b.bindTexture(this._texture,0);d.setUniform1i("tex",
0);d.setUniform3fv("lightDirection",a.lightingData.direction);b.setDepthFunction(c.LEQUAL);b.setBlendingEnabled(!0);b.setDepthWriteEnabled(!1);this._renderer.render(d);b.setBlendingEnabled(!1);b.setDepthWriteEnabled(!0);b.setDepthFunction(c.LESS);return!0},_update:function(a){var b=q.create(),c=q.create(),f=q.create(),e=this.view.renderCoordsHelper.getAltitude(a.eye);q.scale(a.eye,(w+50)/q.length(a.eye),f);this._computeSilhouetteCircle(f,a.center,a.up,w);q.add(this._renderData.silCircleCenter,this._renderData.silCircleV2,
b);q.scale(b,C,c);var f=this._computeScreenRimWidth(f,a.up,b,c),l=0,g=1,n=1;50>e?(l=.001953125,g=.1015625):500>e?(n=(e-50)/450,l=.001953125*(1-n)+.001953125*n,g=.1015625*(1-n)+.21875*n):5E3>e?(n=(e-500)/4500,l=.001953125*(1-n)+.001953125*n,g=.21875*(1-n)+.51171875*n):5E4>e&&(n=(e-5E3)/45E3,l=.001953125*(1-n)+.001953125*n,g=.51171875*(1-n)+.4140625*n);e=B+l*D;n=B+f*g*D;50<q.length(a.eye)-w&&(this._computeSilhouetteCircle(a.eye,a.center,a.up,w),q.add(this._renderData.silCircleCenter,this._renderData.silCircleV2,
b),q.scale(b,C,c),a=this._computeScreenRimWidth(a.eye,a.up,b,c),a=d.clamp((a-1.5)/(f-1.5),0,1),e=B+a*l*D,n=B+d.lerp(1,f*g,a)*D);x.set2(e,n,this._renderData.texV);this.needsRender=!0},_computeSilhouetteCircle:function(a,b,c,d){var f=q.length(a),e=d*Math.sqrt(f*f-d*d)/f,l=this._renderData.silCircleV1,g=this._renderData.silCircleV2;q.scale(a,Math.sqrt(d*d-e*e)/f,this._renderData.silCircleCenter);q.cross(a,b,l);1>q.length2(l)&&q.cross(a,c,l);q.scale(l,e/q.length(l));q.cross(l,a,g);q.scale(g,e/q.length(g));
return e},_computeScreenRimWidth:function(a,b,c,f){var e=y.create();y.lookAt(a,c,b,e);a=this.view.navigation.currentCamera;d.project(c,e,a.projectionMatrix,a.viewport);d.project(f,e,a.projectionMatrix,a.viewport);return q.dist(c,f)/a.height},_createRibbonGeometryData:function(){for(var a=new Float32Array(768),b=new Uint32Array(768),c=0;128>c;c++){var d=6*c;a[d+0]=c;a[d+1]=A;a[d+2]=0;a[d+3]=c;a[d+4]=C;a[d+5]=1;var f=2*c,e=127===c?0:f+2;b[d+0]=f;b[d+1]=f+1;b[d+2]=e+1;b[d+3]=e+1;b[d+4]=e;b[d+5]=f}c=
{};c[z.POSITION]=b;b={};b[z.POSITION]={size:3,data:a};return{faces:{type:"triangle",indices:c,positionKey:z.POSITION},vertexAttr:b}}})})},"esri/views/3d/environment/Stars":function(){define("dojo/text!./materials/StarMaterial.xml require ../../../request ../../../core/watchUtils ../../../core/promiseUtils ../lib/glMatrix ../support/ExternalRenderer ../webgl-engine/lib/GeometryRenderer ../webgl-engine/lib/Util ../webgl-engine/materials/internal/MaterialUtil ../webgl-engine/lib/RenderPass ../webgl-engine/lib/RenderSlot ../../webgl/Program ../webgl-engine/lib/DefaultVertexAttributeLocations ../../webgl/Util".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f,n,u,t,r){var w=h.mat4d;h=h.mat3d;var q=e.VertexAttrConstants,x="9bb2ff;9eb5ff;aabfff;bbccff;ccd8ff ;dae2ff;e4e9ff;eeefff;f8f6ff;fff9fb;fff5ef;fff1e5;ffeddb;ffe9d2;ffe6ca;ffe3c3;ffe0bb;ffddb4;ffdaad;ffd6a5;ffd29c;ffcc8f;ffc178;ffa94b;ff7b00".split(";"),y=h.toMat4(h.createFrom(1,0,0,0,.9174771405229186,.39778850739794974,0,-.39778850739794974,.9174771405229186)),z=h.toMat4(h.createFrom(1,0,0,0,.9174771405229186,-.39778850739794974,0,.39778850739794974,.9174771405229186)),
A=null;return g.createSubclass({properties:{view:{},numBinaryFloats:{value:2},numBinaryUInt8:{value:1},bytesPerStar:{value:9},needsRender:{value:!1},slot:{value:n.BACKGROUND,set:function(a){this.needsRender=!0;this._set("slot",a)}}},constructor:function(){this._renderData={model:w.identity()};this.slot=n.BACKGROUND;this._vertexBufferLayout=[{name:"position",count:3,type:5126,offset:0,stride:20,normalized:!1},{name:"color",count:4,type:5121,offset:12,stride:20,normalized:!1},{name:"size",count:1,type:5126,
offset:16,stride:20,normalized:!1}]},initialize:function(){this._loadDataPromise=this._loadBrightStarCatalogue();this.addResolvingPromise(this._loadDataPromise)},destroy:function(){this._loadDataPromise.isFulfilled()||this._loadDataPromise.cancel("Atmosphere has been removed.");this._dateHandle&&(this._dateHandle.remove(),this._dateHandle=null);this._program&&(this._program.dispose(),this._program=null)},setup:function(b){this._numStars=this._starData.byteLength/this.bytesPerStar;var c=new Float32Array(this._starData,
0,this._numStars*this.numBinaryFloats),f=new Uint8Array(this._starData,this._numStars*this.numBinaryFloats*4,this._numStars*this.numBinaryUInt8),c=this._createStarGeometryData(c,f);this._renderer=new d(c,this._vertexBufferLayout,this._fillInterleaved,b.rctx);this._renderer.enablePointRendering(!0);this._dateHandle=a.init(this,"view.environment.lighting.date",this._update.bind(this));b.shaderSnippets.vertexShaderStar||b.shaderSnippets._parse(m);this._program=new u(b.rctx,b.shaderSnippets.vertexShaderStar,
b.shaderSnippets.fragmentShaderStar,t.Default3D)},render:function(a){if(a.slot!==this.slot||a.pass!==f.MATERIAL)return!1;var b=this.renderContext.rctx,c=b.gl,d=this._program;b.bindProgram(d);d.setUniformMatrix4fv("view",a.camera.viewMatrix);d.setUniformMatrix4fv("proj",a.camera.projectionMatrix);d.setUniform4fv("viewport",a.camera.fullViewport);d.setUniformMatrix4fv("model",this._renderData.model);b.setDepthFunction(c.LEQUAL);b.setBlendingEnabled(!0);b.setBlendFunctionSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,
c.ONE,c.ONE_MINUS_SRC_ALPHA);b.setDepthWriteEnabled(!1);this._renderer.render(d);b.setBlendingEnabled(!1);b.setDepthWriteEnabled(!0);b.setDepthFunction(c.LESS);return!0},_fillInterleaved:function(a,b,c,d,f,e,g){var n=r.getStride(f);c=n/4;var h=l.fill,u=a.faces.indices[q.POSITION],t=a.vertexAttr[q.POSITION].data;d=g+r.findAttribute(f,"position").offset/4;for(var w=0;w<u.length;++w){var x=3*u[w];h(t,x,e,d,b,3);d+=c}b=a.faces.indices[q.COLOR];u=a.vertexAttr[q.COLOR].data;d=g+r.findAttribute(f,"color").offset;
t=new Uint8Array(e.buffer);for(w=0;w<b.length;++w)x=4*b[w],h(u,x,t,d,null,4),d+=n;n=a.faces.indices[q.SIZE];a=a.vertexAttr[q.SIZE].data;d=g+r.findAttribute(f,"size").offset/4;for(w=0;w<n.length;++w)e[d]=a[n[w]],d+=c},_computeDayDuration:function(a){var b=new Date(a.getFullYear(),0,1,11,58,56),c=new Date(a.getFullYear()+1,0,1,11,58,55);return(a-b)/(c-b)},_update:function(a){if(a){var b=a.getHours()/12,c=a.getMinutes()/60*(2/24),d=a.getSeconds()/60*(2/1440),b=(b+c+d-.9972222)%2;a=2*this._computeDayDuration(a);
c=w.create(z);w.rotateZ(c,-a*Math.PI);w.multiply(y,c,c);w.rotateZ(c,-b*Math.PI);this._renderData.model=c;this.needsRender=!0}},_hexToRGB:function(a){return[parseInt(a.substring(0,2),16),parseInt(a.substring(2,4),16),parseInt(a.substring(4,6),16)]},_unpackUint8Attributes:function(a){return 192<=a?[2.9,a-192]:160<=a?[2.5,a-160]:128<=a?[2,a-128]:96<=a?[1.5,a-96]:64<=a?[1,a-64]:32<=a?[.7,a-32]:[.4,a]},_createStarGeometryData:function(a,b){for(var c=new Float32Array(3*this._numStars),d=new Uint8Array(4*
this._numStars),f=new Float32Array(this._numStars),e=new Uint32Array(this._numStars),l=0;l<this._numStars;l++){var g=2*l,n=3*l,h=4*l,u=a[g+0],g=a[g+1];c[n+0]=-Math.cos(u)*Math.sin(g);c[n+1]=-Math.sin(u)*Math.sin(g);c[n+2]=-Math.cos(g);n=this._unpackUint8Attributes(b[l]);u=this._hexToRGB(x[n[1]]);d[h+0]=255*u[0];d[h+1]=255*u[1];d[h+2]=255*u[2];d[h+3]=255;f[l]=n[0];e[l]=l}a={};a[q.POSITION]=e;a[q.NORMAL]=e;a[q.UV0]=e;a[q.COLOR]=e;a[q.SIZE]=e;e={};e[q.POSITION]={size:3,data:c};e[q.COLOR]={size:4,data:d};
e[q.SIZE]={size:1,data:f};return{faces:{type:"point",indices:a,positionKey:q.POSITION},vertexAttr:e}},_loadBrightStarCatalogue:function(){return A?(this._starData=A,c.resolve()):b(k.toUrl("./resources/stars.wsv"),{responseType:"array-buffer",failOk:!0}).then(function(a){if(a=a.data)this._starData=A=a;else throw Error("no data received");}.bind(this)).otherwise(function(a){console.error("Failed to load star data:",a);throw a;})}})})},"esri/views/3d/constraints/SceneViewConstraints":function(){define(["../../../core/Accessor",
"./SceneViewAltitudeConstraint","./SceneViewClipDistanceConstraint","./SceneViewTiltConstraint","./SceneViewCollisionConstraint"],function(m,k,b,a,c){return m.createSubclass([],{declaredClass:"esri.views.3d.constraints.SceneViewConstraints",properties:{tilt:a,altitude:k,clipDistance:b,collision:c},getDefaults:function(a){var b={};a.tilt||(b.tilt={});a.altitude||(b.altitude={});a.clipDistance||(b.clipDistance={});a.collision||(b.collision={});return b},scale:function(a){this.tilt.scale(a);this.altitude.scale(a);
this.clipDistance.scale(a)}})})},"esri/views/3d/constraints/SceneViewAltitudeConstraint":function(){define(["../../../core/Accessor","../support/earthUtils"],function(m,k){k=4*k.earthRadius;m=m.createSubclass([],{declaredClass:"esri.views.3d.constraints.SceneViewAltitudeConstraint",properties:{mode:{value:"auto"},min:{value:-Infinity,set:function(b){this._set("min",b);this._get("max")<b&&this._set("max",b);this.mode="manual"}},max:{value:k,set:function(b){this._set("max",b);this._get("min")>b&&this._set("min",
b);this.mode="manual"}}},autoUpdate:function(b,a){"auto"===this.mode&&(this._get("min")!==b&&this._set("min",b),this._get("max")!==a&&this._set("max",a))},scale:function(b){this._set("max",this._get("max")*b);this._set("min",this._get("min")*b)}});m.MIN_DEFAULT=-Infinity;m.MAX_DEFAULT=k;return m})},"esri/views/3d/constraints/SceneViewClipDistanceConstraint":function(){define(["../../../core/Accessor"],function(m){return m.createSubclass([],{declaredClass:"esri.views.3d.constraints.SceneViewClipDistanceConstraint",
properties:{near:{value:0,cast:function(k){return Math.max(1E-8,k)},set:function(k){this._set("near",k);k>=this._get("far")&&(this.far=k+1E-9);this.mode="manual"}},far:{value:0,cast:function(k){return Math.max(1E-8,k)},set:function(k){this._set("far",k);k<=this._near&&(this.near=k-1E-9);this.mode="manual"}},mode:{value:"auto"}},autoUpdate:function(k,b){"auto"===this.mode&&(this._get("near")!==k&&this._set("near",k),this._get("far")!==b&&this._set("far",b))},scale:function(k){this._set("near",this._get("near")*
k);this._set("far",this._get("far")*k)}})})},"esri/views/3d/constraints/SceneViewTiltConstraint":function(){define(["../../../core/Accessor","../support/mathUtils"],function(m,k){m=m.createSubclass([],{declaredClass:"esri.views.3d.constraints.SceneViewTiltConstraint",properties:{mode:{value:"auto"},max:{value:.5,cast:function(b){return k.clamp(b,.5,179.5)},set:function(b){this._set("max",b);this.mode="manual"}}},autoUpdate:function(b){"auto"===this.mode&&this._get("max")!==b&&this._set("max",b)},
scale:function(b){}});m.MAX_DEFAULT=.5;m.MIN_DEFAULT=179.5;return m})},"esri/views/3d/constraints/SceneViewCollisionConstraint":function(){define(["../../../core/Accessor"],function(m){return m.createSubclass([],{declaredClass:"esri.views.3d.constraints.SceneViewCollisionConstraint",properties:{enabled:!0}})})},"esri/views/3d/input/SceneInputManager":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/watchUtils ../../../core/Accessor ../../../core/HandleRegistry ../../../core/accessorSupport/decorators ../../input/InputManager ../../input/BrowserEventSource ../../input/ViewEvents ../../input/handlers/PreventContextMenu ./handlers/pinch/PinchNavigationGlobal ./handlers/pinch/PinchNavigationLocal ./handlers/DoubleClickZoom ./handlers/DragPan ./handlers/DragRotate ./handlers/DragZoom ./handlers/KeyPan ./handlers/MouseWheelZoom ./handlers/SingleKeyResetHeading ./handlers/SingleKeyResetTilt ./handlers/PointerDownCancelAnimation ./handlers/TwoFingerTilt ./NavigationHelper".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f,n,u,t,r,w,q,x,y,z,A,C,B,D,H){m=function(a){function d(){var b=null!==a&&a.apply(this,arguments)||this;b._handles=new g;return b}b(d,a);d.prototype.initialize=function(){var a=this;this.viewEvents=new f.ViewEvents(this.view);this._handles.add([c.whenNot(this.view,"ready",function(){return a._disconnect()}),c.when(this.view,"ready",function(){return a._connect()})])};d.prototype.destroy=function(){this._handles&&(this._handles.removeAll(),this._handles=null);this._disconnect()};
Object.defineProperty(d.prototype,"primaryDragAction",{get:function(){return this._get("primaryDragAction")},set:function(a){"pan"!==a&&"rotate"!==a||a===this._get("primaryDragAction")||(this._set("primaryDragAction",a),this._updateMode())},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"mode",{get:function(){return this._get("mode")},set:function(a){"default"!==a&&"pro"!==a||a===this._get("mode")||(this._set("mode",a),this._updateMode())},enumerable:!0,configurable:!0});d.prototype._disconnect=
function(){this.viewEvents.disconnect();this._source&&(this._source.destroy(),this._source=null);this._inputManager&&(this._inputManager.destroy(),this._inputManager=null)};d.prototype._connect=function(){var a=this.view;this._source=new l.BrowserEventSource(this.view.canvas);var b=new e.InputManager(this._source);this._inputManager=b;b.installHandlers("prevent-context-menu",[new n.PreventContextMenu]);this._modeDragPan=new w.DragPan(a,"primary");this._modeDragRotate=new q.DragRotate(a,"secondary",
"center");this._modeDragZoom=new x.DragZoom(a,"tertiary");this._pinchNavigation="global"===this.view.viewingMode?new u.PinchNavigationGlobal(a,new H.NavigationHelper(a.navigation.picker)):new t.PinchNavigationLocal(a,new H.NavigationHelper(a.navigation.picker));b.installHandlers("navigation",[new B.PointerDownCancelAnimation(a),new r.DoubleClickZoom(a),new y.KeyPan(a,{left:"ArrowLeft",right:"ArrowRight",forward:"ArrowUp",backward:"ArrowDown",up:"u",down:"j"}),new z.MouseWheelZoom(a),new C.SingleKeyResetTilt(a,
"p"),new A.SingleKeyResetHeading(a,"n"),new D.TwoFingerTilt(a),this._pinchNavigation,new q.DragRotate(a,"primary","eye",["b"]),new q.DragRotate(a,"secondary","center",["b"]),new w.DragPan(a,"tertiary",["b"]),this._modeDragPan,this._modeDragRotate,this._modeDragZoom]);this.viewEvents.connect(b);this._updateMode()};d.prototype._updateMode=function(){var a=this.primaryDragAction,a=K.get(this.mode).get(a);this._modeDragPan&&(this._modeDragPan.pointerType=a.pan);this._modeDragRotate&&(this._modeDragRotate.pointerType=
a.rotate);this._modeDragZoom&&(this._modeDragZoom.pointerType=a.zoom)};return d}(d.declared(h));a([d.property()],m.prototype,"view",void 0);a([d.property({value:"pan"})],m.prototype,"primaryDragAction",null);a([d.property({value:"default"})],m.prototype,"mode",null);a([d.property({readOnly:!0,aliasOf:"_inputManager.latestPointerType"})],m.prototype,"latestPointerType",void 0);a([d.property()],m.prototype,"_inputManager",void 0);m=a([d.subclass("esri.views.3d.input.SceneInputManager")],m);var K=new Map;
a=new Map;d=new Map;a.set("pan",{pan:"primary",rotate:"secondary",zoom:"tertiary"});a.set("rotate",{pan:"secondary",rotate:"primary",zoom:"tertiary"});d.set("pan",{pan:"primary",rotate:"tertiary",zoom:"secondary"});d.set("rotate",{pan:"tertiary",rotate:"primary",zoom:"secondary"});K.set("default",a);K.set("pro",d);return m})},"esri/views/input/InputManager":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor ./keys ./recognizers ../../core/Logger ./handlers/LatestPointerType".split(" "),
function(m,k,b,a,c,h,g,d,e,l){var f=e.getLogger("esri.views.input");m=function(a){function c(b,c){b=a.call(this)||this;b._pointerCaptures=new Map;b._nameToGroup={};b._handlers=[];b._currentPropagation=null;b._sourceEvents=new Set;b._keyModifiers=new Set;b._activeKeyModifiers=new Set;b.primaryKey=g.primaryKey;b.latestPointerType="mouse";b._installRecognizers();return b}b(c,a);c.prototype.normalizeCtorArgs=function(a,b){this._browserEvents=a;this._browserEvents.onEventReceived=this._onEventReceived.bind(this);
this._recognizers=b;this._recognizers||(this._recognizers=d.defaults.map(function(a){return new a}));return{}};c.prototype.destroy=function(){for(var a=0,b=Object.keys(this._nameToGroup);a<b.length;a++)this.uninstallHandlers(b[a])};c.prototype.installHandlers=function(a,b){var c=this;if(this._nameToGroup[a])f.error("There is already an InputHandler group registered under the name `"+a+"`");else if(0===b.length)f.error("Can't register a group of zero handlers");else{var d={name:a,handlers:b.map(function(a,
b){return{handler:a,active:!0,removed:!1,priorityIndex:0,eventCallback:null,uninstallCallback:null}})};this._nameToGroup[a]=d;a=function(a){var b=d.handlers[a];e._handlers.push(b);b.handler.onInstall({updateDependencies:function(){c.updateDependencies()},emit:function(a,d,f){c._emitInputEvent(b.priorityIndex,a,d,f)},setPointerCapture:function(a,f){c._setPointerCapture(d,b,a,f)},setEventCallback:function(a){b.eventCallback=a},setUninstallCallback:function(a){b.uninstallCallback=a}})};var e=this;for(b=
d.handlers.length-1;0<=b;b--)a(b);this.updateDependencies()}};c.prototype.uninstallHandlers=function(a){var b=this._nameToGroup[a];b?(b.handlers.forEach(function(a){a.removed=!0;a.uninstallCallback()}),delete this._nameToGroup[a],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):f.error("There is no InputHandler group registered under the name `"+a+"`")};c.prototype.hasHandlers=function(a){return void 0!==this._nameToGroup[a]};c.prototype.updateDependencies=
function(){var a=new Set,b=new Set;this._handlersPriority=[];for(var c=this._handlers.length-1;0<=c;c--){var d=this._handlers[c];d.priorityIndex=c;this._handlersPriority.push(d)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(c=this._handlersPriority.length-1;0<=c;c--){d=this._handlersPriority[c];d.priorityIndex=c;var f=d.handler.hasSideEffects;if(!f)for(var e=0,l=d.handler.outgoingEventTypes;e<l.length;e++)if(a.has(l[e])){f=!0;break}if(f)for(e=0,l=d.handler.incomingEventMatches;e<
l.length;e++){var n=l[e];a.add(n.eventType);for(var h=0,n=n.keyModifiers;h<n.length;h++){var u=n[h];g.isSystemModifier(u)||b.add(u)}}d.active=f}this._sourceEvents=a;this._keyModifiers=b;0<this._pointerCaptures.size&&this._sourceEvents.add("pointer-capture-lost");0<this._keyModifiers.size&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up"));this._browserEvents&&(this._browserEvents.activeEvents=this._sourceEvents)};c.prototype._setLatestPointerType=function(a){this._set("latestPointerType",
a)};c.prototype._onEventReceived=function(a,b){"pointer-capture-lost"===a&&this._pointerCaptures.delete(b.native.pointerId);this._updateKeyModifiers(a,b);this._emitInputEventFromSource(a,b)};c.prototype._updateKeyModifiers=function(a,b){var c=this;if(b){var d=!1,f=function(){if(!d){var a=new Set;c._activeKeyModifiers.forEach(function(b){a.add(b)});c._activeKeyModifiers=a;d=!0}},e=function(a,b){b&&!c._activeKeyModifiers.has(a)?(f(),c._activeKeyModifiers.add(a)):!b&&c._activeKeyModifiers.has(a)&&(f(),
c._activeKeyModifiers.delete(a))};if("key-down"===a||"key-up"===a){var l=b.key;this._keyModifiers.has(l)&&e(l,"key-down"===a)}a=b.native;e("Alt",!(!a||!a.altKey));e("Ctrl",!(!a||!a.ctrlKey));e("Shift",!(!a||!a.shiftKey));e("Meta",!(!a||!a.metaKey));e("Primary",this._activeKeyModifiers.has(this.primaryKey))}};c.prototype._installRecognizers=function(){var a=this;this._latestPointerTypeHandler=new l.LatestPointerType(function(b){return a._setLatestPointerType(b)});0<this._recognizers.length&&this.installHandlers("default",
this._recognizers);this.installHandlers("input-manager-logic",[this._latestPointerTypeHandler])};c.prototype._setPointerCapture=function(a,b,c,d){a=a.name+"-"+b.priorityIndex;b=this._pointerCaptures.get(c.pointerId)||new Set;this._pointerCaptures.set(c.pointerId,b);d?(b.add(a),1===b.size&&this._browserEvents&&this._browserEvents.setPointerCapture(c,!0)):(b.delete(a),0===b.size&&(this._pointerCaptures.delete(c.pointerId),this._browserEvents&&this._browserEvents.setPointerCapture(c,!1)))};c.prototype._garbageCollectRemovedHandlers=
function(){this._handlers=this._handlers.filter(function(a){return!a.removed});this.updateDependencies()};c.prototype._emitInputEventFromSource=function(a,b){this._emitInputEvent(0,a,b)};c.prototype._emitInputEvent=function(a,b,c,d){b=new n(b,c,d||this._activeKeyModifiers);this._currentPropagation?this._currentPropagation.addedEvents.push(b):this._doNewPropagation(a,b)};c.prototype._doNewPropagation=function(a,b){for(a=this._currentPropagation={events:[b],addedEvents:[],currentHandler:this._handlersPriority[a],
needsHandlerGarbageCollect:!1};a.currentHandler;){if(a.currentHandler.removed)a.needsHandlerGarbageCollect=!0;else{b=a.events;var c=[];a.addedEvents=[];for(var d=0;d<b.length;d++){var f=b[d];a.currentHandler.active&&a.currentHandler.eventCallback(f);f.shouldStopPropagation()||c.push(f)}a.events=c.concat(a.addedEvents)}a.currentHandler=this._handlersPriority[a.currentHandler.priorityIndex+1]}a.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers();this._currentPropagation=null};c.prototype._compareHandlerPriority=
function(a,b){if(a.handler.hasSideEffects!==b.handler.hasSideEffects)return a.handler.hasSideEffects?1:-1;for(var c=0,d=a.handler.incomingEventMatches;c<d.length;c++)for(var f=d[c],e=function(a){if(f.eventType!==a.eventType)return"continue";var b=f.keyModifiers.filter(function(b){return-1!==a.keyModifiers.indexOf(b)});if(b.length===f.keyModifiers.length!==(b.length===a.keyModifiers.length))return{value:f.keyModifiers.length>a.keyModifiers.length?-1:1}},l=0,g=b.handler.incomingEventMatches;l<g.length;l++){var n=
e(g[l]);if("object"===typeof n)return n.value}return a.priorityIndex>b.priorityIndex?-1:1};c.prototype._sortHandlersPriority=function(a){for(var b=[],c=0;c<a.length;c++){for(var d=a[c],f=0;f<b.length&&0<=this._compareHandlerPriority(d,b[f]);)f++;b.splice(f,0,d)}return b};return c}(c.declared(h));a([c.property({readOnly:!0})],m.prototype,"latestPointerType",void 0);m=a([c.subclass("esri.views.input.InputManager")],m);k.InputManager=m;var n=function(){function a(a,b,c){this.type=a;this.data=b;this.modifiers=
c;this._stopPropagation=!1;this.timestamp=Date.now()}a.prototype.stopPropagation=function(){this._stopPropagation=!0};a.prototype.shouldStopPropagation=function(){return this._stopPropagation};return a}()})},"esri/views/input/keys":function(){define(["require","exports","../../core/sniff"],function(m,k,b){k.primaryKey=b("mac")?"Meta":"Ctrl";var a={8:"Backspace",9:"Tab",13:"Enter",27:"Escape",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",
46:"Delete"};for(m=48;58>m;m++)a[m]=String.fromCharCode(m);for(m=1;25>m;m++)a[111+m]="F"+m;for(m=65;91>m;m++)a[m]=[String.fromCharCode(m+32),String.fromCharCode(m)];var c={Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown"};k.eventKey=function(b){if(void 0!==b.key)return c[b.key]||b.key;var g=a[b.keyCode];return Array.isArray(g)?b.shiftKey?g[1]:g[0]:g};k.isSystemModifier=function(a){switch(a){case "Ctrl":case "Alt":case "Shift":case "Meta":case "Primary":return!0}}})},"esri/views/input/recognizers":function(){define("require exports ./recognizers/Drag ./recognizers/PointerClickHoldAndDrag ./recognizers/SingleAndDoubleClick ./recognizers/VerticalTwoFingerDrag".split(" "),
function(m,k,b,a,c,h){k.defaults=[a.PointerClickHoldAndDrag,c.SingleAndDoubleClick,b.Drag,h.VerticalTwoFingerDrag]})},"esri/views/input/recognizers/Drag":function(){define("require exports ../../../core/tsSupport/extendsHelper ../InputHandler ./support ../../../core/now".split(" "),function(m,k,b,a,c,h){m=function(a){function d(){var b=a.call(this,"recognizers.Drag",!1)||this;b._startStateModifiers=new Set;b._activePointers=[];b._activePointerMap=new Map;b._isDragging=!1;b._drag=b.registerOutgoing("drag");
b.registerIncoming("pointer-drag",b._handlePointerDrag.bind(b));b.registerIncoming("pointer-down",b._handlePointerDown.bind(b));b.registerIncoming("pointer-up",b._handlePointerUpAndPointerLost.bind(b));b.registerIncoming("pointer-capture-lost",b._handlePointerUpAndPointerLost.bind(b));return b}b(d,a);d.prototype._createPayload=function(a,b){return{action:a,pointers:this._activePointers.map(function(a){return a.data}),startState:this._startState,previousState:this._previousState,currentState:b}};d.prototype._fitCircleLSQ=
function(){var a=this._activePointers.map(function(a){return a.data.currentEvent});return c.fitCircleLSQ(a)};d.prototype._createDragState=function(){for(var a=this._fitCircleLSQ(),b=0,c=0,d=this._activePointers;c<d.length;c++){for(var g=d[c],t=this._pointerAngle(g,a),t=t-g.lastAngle;t>Math.PI;)t-=2*Math.PI;for(;t<-Math.PI;)t+=2*Math.PI;t=g.lastAngle+t;g.lastAngle=t;b+=t-g.initialAngle}b/=this._activePointers.length;return{angle:b,radius:a.radius,center:a.center,timeStamp:h()}};d.prototype._updateMultiPointer=
function(a){var b=a.startEvent.native.pointerId,c=this._activePointerMap.get(b),d=!c;d?(c={data:null,initialAngle:0,lastAngle:0},this._activePointers.push(c),this._activePointerMap.set(b,c),c.data={startEvent:a.startEvent,previousEvent:a.previousEvent,currentEvent:a.currentEvent},a=this._fitCircleLSQ(),c.initialAngle=this._pointerAngle(c,a),c.lastAngle=c.initialAngle):c.data={startEvent:c.data.startEvent,previousEvent:a.previousEvent,currentEvent:a.currentEvent};d&&this._isDragging&&this._updateInitialAngles();
return c};d.prototype._pointerAngle=function(a,b){a=a.data.currentEvent;return Math.atan2(a.y-b.center.y,a.x-b.center.x)};d.prototype._updateInitialAngles=function(){for(var a=this._createDragState(),b=0,c=this._activePointers;b<c.length;b++){var d=c[b];d.initialAngle=this._pointerAngle(d,a)}};d.prototype._emitStart=function(a){this._updateInitialAngles();var b=this._createDragState();this._previousState=this._startState=b;this._startStateModifiers=a.modifiers;this._isDragging=!0;a=0;for(var c=this._activePointers;a<
c.length;a++){var d=c[a];d.data={previousEvent:d.data.currentEvent,startEvent:d.data.currentEvent,currentEvent:d.data.currentEvent}}this._drag.emit(this._createPayload("start",b))};d.prototype._emitUpdate=function(){var a=this._createDragState();this._drag.emit(this._createPayload("update",a),this._startStateModifiers);this._previousState=a};d.prototype._emitEnd=function(){var a=this._createDragState();this._drag.emit(this._createPayload("end",a),this._startStateModifiers);this._startState=this._previousState=
null;this._isDragging=!1};d.prototype._handlePointerDown=function(a){a=a.data;this._isDragging&&this._emitEnd();this._updateMultiPointer({startEvent:a,previousEvent:a,currentEvent:a})};d.prototype._removeMultiPointer=function(a){a=a.pointerId;var b=this._activePointerMap.get(a);b&&(this._isDragging&&this._emitEnd(),this._activePointerMap.delete(a),a=this._activePointers.indexOf(b),this._activePointers.splice(a,1),this._isDragging&&this._updateInitialAngles())};d.prototype._handlePointerUpAndPointerLost=
function(a){this._removeMultiPointer(a.data.native)};d.prototype._handlePointerDrag=function(a){var b=a.data;switch(b.action){case "start":this._isDragging||this._emitStart(a);break;case "update":this._isDragging||this._emitStart(a),this._updateMultiPointer(b),this._emitUpdate()}};return d}(a.InputHandler);k.Drag=m})},"esri/views/input/InputHandler":function(){define(["require","exports","./EventMatch","../../core/Logger"],function(m,k,b,a){var c=a.getLogger("esri.views.input");m=function(){function a(a,
b){this._manager=null;this._incoming={};this._outgoing={};this._outgoingEventTypes=this._incomingEventTypes=this._incomingEventMatches=null;this._name=a;this._hasSideEffects=b}Object.defineProperty(a.prototype,"incomingEventMatches",{get:function(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(var a in this._incoming)for(var b=0,c=this._incoming[a];b<c.length;b++)this._incomingEventMatches.push(c[b].match)}return this._incomingEventMatches},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"incomingEventTypes",{get:function(){this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map(function(a){return a.eventType}));return this._incomingEventTypes},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"outgoingEventTypes",{get:function(){this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing));return this._outgoingEventTypes},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasSideEffects",{get:function(){return this._hasSideEffects},
enumerable:!0,configurable:!0});a.prototype.onInstall=function(a){var b=this;this._manager?c.error("This InputHandler has already been registered with an InputManager"):(a.setEventCallback(function(a){return b._handleEvent(a)}),a.setUninstallCallback(function(){return b._onUninstall()}),this._manager=a)};a.prototype.onUninstall=function(){};a.prototype.registerIncoming=function(a,c,d){var f=this;"function"===typeof c?(d=c,c=[]):c=c||[];a="string"===typeof a?new b.EventMatch(a,c):a;var e=function(){f._incomingEventTypes=
null;f._incomingEventMatches=null};c=function(a){var b=f._incoming[a.match.eventType];b&&(a=b.indexOf(a),b.splice(a,1),e(),f._manager&&f._manager.updateDependencies())};d=new h(a,d,{onPause:c,onRemove:c,onResume:function(a){var b=f._incoming[a.match.eventType];b&&-1===b.indexOf(a)&&(b.push(a),e(),f._manager&&f._manager.updateDependencies())}});c=this._incoming[a.eventType];c||(c=[],this._incoming[a.eventType]=c);c.push(d);e();this._manager&&this._manager.updateDependencies();return d};a.prototype.registerOutgoing=
function(a){var b=this;if(this._outgoing[a])throw Error("There is already a callback registered for this outgoing InputEvent: "+a);var c=new g(a,{onEmit:function(a,c,d){b._manager.emit(a.eventType,c,d)},onRemove:function(a){delete b._outgoing[a.eventType];b._manager.updateDependencies()}});this._outgoing[a]=c;this._outgoingEventTypes=null;this._manager&&this._manager.updateDependencies();return c};a.prototype.startCapturingPointer=function(a){this._manager.setPointerCapture(a,!0)};a.prototype.stopCapturingPointer=
function(a){this._manager.setPointerCapture(a,!1)};a.prototype._onUninstall=function(){this._manager?(this.onUninstall(),this._manager=null):c.error("This InputHandler is not registered with an InputManager")};a.prototype._handleEvent=function(a){var b=this._incoming[a.type];if(b)for(var c=0;c<b.length;c++){var d=b[c];if(d.match.matches(a)&&(d.callback(a),a.shouldStopPropagation()))break}};return a}();k.InputHandler=m;var h=function(){function a(a,b,c){this.match=a;this._callback=b;this._handler=
c}a.prototype.pause=function(){this._handler.onPause(this)};a.prototype.resume=function(){this._handler.onResume(this)};a.prototype.remove=function(){this._handler.onRemove(this)};Object.defineProperty(a.prototype,"callback",{get:function(){return this._callback},enumerable:!0,configurable:!0});return a}(),g=function(){function a(a,b){this.eventType=a;this._removed=!1;this._handler=b}a.prototype.emit=function(a,b){if(!this._removed)this._handler.onEmit(this,a,b)};a.prototype.remove=function(){this._removed=
!0;this._handler.onRemove(this)};return a}()})},"esri/views/input/EventMatch":function(){define(["require","exports"],function(m,k){m=function(){function b(a,b){void 0===b&&(b=[]);this.eventType=a;this.keyModifiers=b}b.prototype.matches=function(a){if(a.type!==this.eventType)return!1;if(0===this.keyModifiers.length)return!0;a=a.modifiers;for(var b=0,h=this.keyModifiers;b<h.length;b++)if(!a.has(h[b]))return!1;return!0};return b}();k.EventMatch=m})},"esri/views/input/recognizers/support":function(){define(["require",
"exports"],function(m,k){k.manhattanDistance=function(b,a){return Math.abs(a.x-b.x)+Math.abs(a.y-b.y)};k.fitCircleLSQ=function(b,a){a?(a.radius=0,a.center.x=0,a.center.y=0):a={radius:0,center:{x:0,y:0}};if(0===b.length)return a;if(1===b.length)return a.center.x=b[0].x,a.center.y=b[0].y,a;if(2===b.length){var c=b[0];b=b[1];var h=[b.x-c.x,b.y-c.y],g=h[0],h=h[1];a.radius=Math.sqrt(g*g+h*h)/2;a.center.x=(c.x+b.x)/2;a.center.y=(c.y+b.y)/2;return a}for(var d=0,e=0,l=0;l<b.length;l++)d+=b[l].x,e+=b[l].y;
for(var d=d/b.length,e=e/b.length,f=b.map(function(a){return a.x-d}),n=b.map(function(a){return a.y-e}),u=c=a=0,t=0,r=g=0,l=h=0;l<f.length;l++){var w=f[l],q=n[l],x=w*w,k=q*q;a+=x;c+=k;u+=w*q;t+=x*w;g+=k*q;r+=w*k;h+=q*x}l=a;f=u;n=c;t=.5*(t+r);g=.5*(g+h);h=l*n-u*f;r=(t*n-g*f)/h;g=(l*g-u*t)/h;return{radius:Math.sqrt(r*r+g*g+(a+c)/b.length),center:{x:r+d,y:g+e}}}})},"esri/views/input/recognizers/PointerClickHoldAndDrag":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","../InputHandler",
"./support"],function(m,k,b,a,c){m=function(a){function g(b,c,l){void 0===b&&(b=300);void 0===c&&(c=1.5);void 0===l&&(l=500);var d=a.call(this,"recognizers.PointerClickHoldAndDrag",!1)||this;d.maximumClickDelay=b;d.movementUntilDrag=c;d.holdDelay=l;d._pointerState=new Map;d._modifiers=new Set;d._pointerDrag=d.registerOutgoing("pointer-drag");d._pointerClick=d.registerOutgoing("pointer-click");d._pointerHold=d.registerOutgoing("hold");d.registerIncoming("pointer-down",d._handlePointerDown.bind(d));
d.registerIncoming("pointer-up",d._handlePointerUpOrLost.bind(d));d.registerIncoming("pointer-capture-lost",d._handlePointerUpOrLost.bind(d));d._moveHandle=d.registerIncoming("pointer-move",d._handlePointerMove.bind(d));d._moveHandle.pause();return d}b(g,a);g.prototype.onUninstall=function(){this._pointerState.forEach(function(a){0!==a.holdTimeout&&(clearTimeout(a.holdTimeout),a.holdTimeout=0)});a.prototype.onUninstall.call(this)};g.prototype._handlePointerDown=function(a){var b=this,c=a.data,d=c.native.pointerId,
g=0;0===this._pointerState.size&&(g=setTimeout(function(){var a=b._pointerState.get(d);a&&(a.isDragging||(b._pointerHold.emit(a.previousEvent),a.holdEmitted=!0),a.holdTimeout=0)},this.holdDelay));1===this._pointerState.size&&this._pointerState.forEach(function(a){0!==a.holdTimeout&&(clearTimeout(a.holdTimeout),a.holdTimeout=0)});this._pointerState.set(d,{startEvent:c,previousEvent:c,startTimestamp:a.timestamp,totalMovement:0,isDragging:!1,downButton:c.native.button,holdTimeout:g});this.startCapturingPointer(c.native);
this._moveHandle.resume()};g.prototype._createPointerDragData=function(a,b,c){return{action:a,startEvent:b.startEvent,previousEvent:b.previousEvent,currentEvent:c}};g.prototype._handlePointerMove=function(a){var b=a.data,d=this._pointerState.get(b.native.pointerId);d&&(d.isDragging?this._pointerDrag.emit(this._createPointerDragData("update",d,b),this._modifiers):(d.totalMovement+=c.manhattanDistance(b,d.previousEvent),d.totalMovement>this.movementUntilDrag&&(d.isDragging=!0,d.previousEvent=d.startEvent,
this._modifiers=a.modifiers,0!==d.holdTimeout&&clearTimeout(d.holdTimeout),this._pointerDrag.emit(this._createPointerDragData("start",d,d.startEvent)),this._pointerDrag.emit(this._createPointerDragData("update",d,b)))),d.previousEvent=b)};g.prototype._handlePointerUpOrLost=function(a){var b=a.data,c=b.native.pointerId,d=this._pointerState.get(c);d&&(0!==d.holdTimeout&&clearTimeout(d.holdTimeout),d.isDragging?this._pointerDrag.emit(this._createPointerDragData("end",d,b),this._modifiers):d.downButton===
b.native.button&&a.timestamp-d.startTimestamp<=this.maximumClickDelay&&!d.holdEmitted&&this._pointerClick.emit(b),this._pointerState.delete(c),this.stopCapturingPointer(b.native),0===this._pointerState.size&&this._moveHandle.pause())};return g}(a.InputHandler);k.PointerClickHoldAndDrag=m})},"esri/views/input/recognizers/SingleAndDoubleClick":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","../InputHandler","./support"],function(m,k,b,a,c){m=function(a){function g(b,
c,l){void 0===b&&(b=250);void 0===c&&(c=10);void 0===l&&(l=35);var d=a.call(this,"recognizers.SingleAndDoubleClick",!1)||this;d.maximumDoubleClickDelay=b;d.maximumDoubleClickDistance=c;d.maximumDoubleTouchDistance=l;d._pointerState=new Map;d._click=d.registerOutgoing("click");d._doubleClick=d.registerOutgoing("double-click");d.registerIncoming("pointer-click",d._handlePointerClick.bind(d));return d}b(g,a);g.prototype._pointerId=function(a){a=a.native;return"mouse"===a.pointerType?a.pointerId+":"+
a.button:""+a.pointerType};g.prototype._handlePointerClick=function(a){a=a.data;var b=this._pointerId(a),d=this._pointerState.get(b);if(d){clearTimeout(d.doubleClickTimeout);d.doubleClickTimeout=0;var f="touch"===a.native.pointerType?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;c.manhattanDistance(d.event,a)>f?(this._doubleClickTimeoutExceeded(b),this._startClick(a)):(this._doubleClick.emit(a),this._pointerState.delete(b))}else this._startClick(a)};g.prototype._startClick=function(a){var b=
this,c=this._pointerId(a);this._pointerState.set(c,{event:a,doubleClickTimeout:setTimeout(function(){return b._doubleClickTimeoutExceeded(c)},this.maximumDoubleClickDelay)})};g.prototype._doubleClickTimeoutExceeded=function(a){var b=this._pointerState.get(a);this._click.emit(b.event);b.doubleClickTimeout=0;this._pointerState.delete(a)};return g}(a.InputHandler);k.SingleAndDoubleClick=m})},"esri/views/input/recognizers/VerticalTwoFingerDrag":function(){define(["require","exports","../../../core/tsSupport/extendsHelper",
"../InputHandler"],function(m,k,b,a){m=function(a){function c(b,c){void 0===b&&(b=20);void 0===c&&(c=40);var d=a.call(this,"recognizers.Drag",!1)||this;d._threshold=b;d._maxDelta=c;d._vertical=d.registerOutgoing("vertical-two-finger-drag");d._artificalDragEnd=d.registerOutgoing("drag");d.registerIncoming("drag",d._handleDrag.bind(d));return d}b(c,a);c.prototype._handleDrag=function(a){if(2===a.data.pointers.length)switch(a.data.action){case "start":this._handleDragStart(a);break;case "update":this._handleDragUpdate(a);
break;case "end":this._handleDragEnd(a)}};c.prototype._handleDragStart=function(a){this._failed=!1;this._dragStartCenter=a.data.currentState.center};c.prototype._handleDragUpdate=function(a){this._failed||(this._active?(this._vertical.emit({delta:a.data.currentState.center.y-this._thresholdReachedCenter.y,action:"update"}),a.stopPropagation()):(this._failed=!this._checkDeltaConstraint(a.data),!this._failed&&this._checkThresholdReached(a.data)&&(this._active=!0,this._thresholdReachedCenter=a.data.currentState.center,
this._artificalDragEnd.emit({action:"end",currentState:a.data.currentState,previousState:a.data.previousState,startState:a.data.startState,pointers:a.data.pointers}),this._vertical.emit({delta:a.data.currentState.center.y-this._thresholdReachedCenter.y,action:"begin"}),a.stopPropagation())))};c.prototype._handleDragEnd=function(a){this._active&&(this._vertical.emit({delta:a.data.currentState.center.y-this._thresholdReachedCenter.y,action:"end"}),a.stopPropagation());this._active=!1};c.prototype._checkDeltaConstraint=
function(a){var b=Math.abs(a.pointers[0].startEvent.x-a.pointers[1].startEvent.x),c=Math.abs(a.pointers[0].startEvent.y-a.pointers[1].startEvent.y),l=Math.abs(a.pointers[0].currentEvent.y-a.pointers[1].currentEvent.y),f=Math.abs(a.pointers[0].currentEvent.x-a.pointers[1].currentEvent.x);return Math.abs(a.currentState.center.x-a.startState.center.x)<this._threshold&&Math.abs(f-b)<=this._maxDelta&&Math.abs(l-c)<=this._maxDelta};c.prototype._checkThresholdReached=function(a){return Math.min(Math.abs(a.pointers[0].currentEvent.y-
a.pointers[0].startEvent.y),Math.abs(a.pointers[1].currentEvent.y-a.pointers[1].startEvent.y),Math.abs(a.currentState.center.y-a.startState.center.y))>=this._threshold};return c}(a.InputHandler);k.VerticalTwoFingerDrag=m})},"esri/views/input/handlers/LatestPointerType":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","../InputHandler"],function(m,k,b,a){m=function(a){function c(b){var c=a.call(this,"LatestPointerInteraction",!0)||this;c._onChange=b;c._value="mouse";c.registerIncoming("pointer-down",
function(a){c._setValue("touch"===a.data.native.pointerType?"touch":"mouse")});c._moveHandler=c.registerIncoming("pointer-move",function(a){c._setValue("touch"===a.data.native.pointerType?"touch":"mouse")});c._moveHandler.pause();return c}b(c,a);c.prototype._setValue=function(a){a!==this._value&&("touch"===a?this._moveHandler.resume():this._moveHandler.pause(),this._value=a,this._onChange(a))};return c}(a.InputHandler);k.LatestPointerType=m})},"esri/views/input/BrowserEventSource":function(){define(["require",
"exports","./keys","../../core/libs/pep/pep","dojo/sniff"],function(m,k,b,a,c){var h=c("trident"),g=c("edge"),d=c("chrome"),e=c("ff"),l=c("safari");m=function(){function c(b){this._active={};this._activePointerCaptures=new Set;this._keyDownState=new Set;this._element=b;a.applyLocal(b);b.getAttribute("tabindex")||b.setAttribute("tabindex","0");this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointerDown,"pointer-move":this._handlePointer,"pointer-up":this._handlePointer,
"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost};this._initialCssTouchAction=b.style.touchAction;b.style.touchAction="none"}c.prototype.destroy=function(){var a=this;this.activeEvents=this._callback=null;this._activePointerCaptures.forEach(function(b){a._element.releasePointerCapture(b)});this._activePointerCaptures=null;this._element.style.touchAction=this._initialCssTouchAction};Object.defineProperty(c.prototype,"onEventReceived",{set:function(a){this._callback=
a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"activeEvents",{set:function(a){var b=this,c;for(c in this._active)a&&a.has(c)||(this._element.removeEventListener(f[c],this._active[c]),delete this._active[c]);a&&a.forEach(function(a){if(!b._active[a]&&f[a]){var c=(b._eventHandlers[a]||b._handleDefault).bind(b,a);b._element.addEventListener(f[a],c);b._active[a]=c}})},enumerable:!0,configurable:!0});c.prototype.setPointerCapture=function(a,b){b?(this._element.setPointerCapture(a.pointerId),
this._activePointerCaptures.add(a.pointerId)):(this._element.releasePointerCapture(a.pointerId),this._activePointerCaptures.delete(a.pointerId))};c.prototype._updateNormalizedPointerLikeEvent=function(a,b){var c=this._element.getBoundingClientRect();b.x=a.clientX-Math.round(c.left);b.y=a.clientY-Math.round(c.top);return b};c.prototype._handleKey=function(a,c){var d=b.eventKey(c);d&&"key-up"===a&&this._keyDownState.delete(d);c={native:c,key:d,repeat:d&&this._keyDownState.has(d)};d&&"key-down"===a&&
this._keyDownState.add(c.key);this._callback(a,c)};c.prototype._handlePointerDown=function(a,b){b=this._updateNormalizedPointerLikeEvent(b,{native:b,x:0,y:0});this._callback(a,b)};c.prototype._handlePointer=function(a,b){var c=this._updateNormalizedPointerLikeEvent(b,{native:b,x:0,y:0});b.preventDefault();this._callback(a,c)};c.prototype._handleMouseWheel=function(a,b){b.preventDefault();var c=b.deltaY;switch(b.deltaMode){case 0:if(h||g)c=c/document.documentElement.clientHeight*600;break;case 1:c*=
30;break;case 2:c*=900}h||g?c*=.7:d||l?c*=.6:e&&(c*=1.375);var f=Math.abs(c);100<f&&(c=c/f*200/(1+Math.exp(-.02*(f-100))));b=this._updateNormalizedPointerLikeEvent(b,{native:b,x:0,y:0,deltaY:c});this._callback(a,b)};c.prototype._handlePointerCaptureLost=function(a,b){this._activePointerCaptures.delete(b.pointerId);this._handleDefault(a,b)};c.prototype._handleDefault=function(a,b){var c={native:b};b.preventDefault();this._callback(a,c)};return c}();k.BrowserEventSource=m;var f={"key-down":"keydown",
"key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu"}})},"esri/core/libs/pep/pep":function(){define(function(){function m(a,b){b=b||Object.create(null);var c=document.createEvent("Event");c.initEvent(a,b.bubbles||!1,b.cancelable||!1);a=2;for(var d;a<l.length;a++)d=l[a],c[d]=b[d]||f[a];c.buttons=b.buttons||0;a=0;a=b.pressure?
b.pressure:c.buttons?.5:0;c.x=c.clientX;c.y=c.clientY;c.pointerId=b.pointerId||0;c.width=b.width||0;c.height=b.height||0;c.pressure=a;c.tiltX=b.tiltX||0;c.tiltY=b.tiltY||0;c.pointerType=b.pointerType||"";c.hwTimestamp=b.hwTimestamp||0;c.isPrimary=b.isPrimary||!1;return c}function k(){this.array=[];this.size=0}function b(a,b,c,d){this.addCallback=a.bind(d);this.removeCallback=b.bind(d);this.changedCallback=c.bind(d);B&&(this.observer=new B(this.mutationWatcher.bind(this)))}function a(a){return"body /shadow-deep/ "+
c(a)}function c(a){return'[touch-action\x3d"'+a+'"]'}function h(a){return"{ -ms-touch-action: "+a+"; touch-action: "+a+"; touch-action-delay: none; }"}function g(){if(E){H.forEach(function(b){String(b)===b?(K+=c(b)+h(b)+"\n",F&&(K+=a(b)+h(b)+"\n")):(K+=b.selectors.map(c)+h(b.rule)+"\n",F&&(K+=b.selectors.map(a)+h(b.rule)+"\n"))});var b=document.createElement("style");b.textContent=K;document.head.appendChild(b)}}function d(a){if(!q.pointermap.has(a))throw a=Error("InvalidPointerId"),a.name="InvalidPointerId",
a;}function e(a){if(!a.ownerDocument.contains(a))throw a=Error("InvalidStateError"),a.name="InvalidStateError",a;}var l="bubbles cancelable view detail screenX screenY clientX clientY ctrlKey altKey shiftKey metaKey button relatedTarget pageX pageY".split(" "),f=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0],n=window.Map&&window.Map.prototype.forEach?Map:k;k.prototype={set:function(a,b){if(void 0===b)return this.delete(a);this.has(a)||this.size++;this.array[a]=b},has:function(a){return void 0!==
this.array[a]},delete:function(a){this.has(a)&&(delete this.array[a],this.size--)},get:function(a){return this.array[a]},clear:function(){this.size=this.array.length=0},forEach:function(a,b){return this.array.forEach(function(c,d){a.call(b,c,d,this)},this)}};var u="bubbles cancelable view detail screenX screenY clientX clientY ctrlKey altKey shiftKey metaKey button relatedTarget buttons pointerId width height pressure tiltX tiltY pointerType hwTimestamp isPrimary type target currentTarget which pageX pageY timeStamp".split(" "),
t=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],r={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},w="undefined"!==typeof SVGElementInstance,q={pointermap:new n,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(a,b){var c=b.events;c&&(c.forEach(function(a){b[a]&&(this.eventMap[a]=b[a].bind(b))},this),this.eventSources[a]=b,this.eventSourceList.push(b))},register:function(a){for(var b=
this.eventSourceList.length,c=0,d;c<b&&(d=this.eventSourceList[c]);c++)d.register.call(d,a)},unregister:function(a){for(var b=this.eventSourceList.length,c=0,d;c<b&&(d=this.eventSourceList[c]);c++)d.unregister.call(d,a)},contains:function(a,b){try{return a.contains(b)}catch(Y){return!1}},down:function(a){a.bubbles=!0;this.fireEvent("pointerdown",a)},move:function(a){a.bubbles=!0;this.fireEvent("pointermove",a)},up:function(a){a.bubbles=!0;this.fireEvent("pointerup",a)},enter:function(a){a.bubbles=
!1;this.fireEvent("pointerenter",a)},leave:function(a){a.bubbles=!1;this.fireEvent("pointerleave",a)},over:function(a){a.bubbles=!0;this.fireEvent("pointerover",a)},out:function(a){a.bubbles=!0;this.fireEvent("pointerout",a)},cancel:function(a){a.bubbles=!0;this.fireEvent("pointercancel",a)},leaveOut:function(a){this.out(a);this.propagate(a,this.leave,!1)},enterOver:function(a){this.over(a);this.propagate(a,this.enter,!0)},eventHandler:function(a){if(!a._handledByPE){var b=a.type;(b=this.eventMap&&
this.eventMap[b])&&b(a);a._handledByPE=!0}},listen:function(a,b){b.forEach(function(b){this.addEvent(a,b)},this)},unlisten:function(a,b){b.forEach(function(b){this.removeEvent(a,b)},this)},addEvent:function(a,b){a.addEventListener(b,this.boundHandler)},removeEvent:function(a,b){a.removeEventListener(b,this.boundHandler)},makeEvent:function(a,b){this.captureInfo[b.pointerId]&&(b.relatedTarget=null);a=new m(a,b);b.preventDefault&&(a.preventDefault=b.preventDefault);a._target=a._target||b.target;return a},
fireEvent:function(a,b){a=this.makeEvent(a,b);return this.dispatchEvent(a)},cloneEvent:function(a){for(var b=Object.create(null),c,d=0;d<u.length;d++)c=u[d],b[c]=a[c]||t[d],w&&("target"===c||"relatedTarget"===c)&&b[c]instanceof SVGElementInstance&&(b[c]=b[c].correspondingUseElement);a.preventDefault&&(b.preventDefault=function(){a.preventDefault()});return b},getTarget:function(a){var b=this.captureInfo[a.pointerId];if(!b)return a._target;if(a._target===b||!(a.type in r))return b},propagate:function(a,
b,c){for(var d=a.target,f=[];!d.contains(a.relatedTarget)&&d!==document;)f.push(d),d=d.parentNode;c&&f.reverse();f.forEach(function(c){a.target=c;b.call(this,a)},this)},setCapture:function(a,b){this.captureInfo[a]&&this.releaseCapture(a);this.captureInfo[a]=b;var c=new m("gotpointercapture");c.pointerId=a;this.implicitRelease=this.releaseCapture.bind(this,a);document.addEventListener("pointerup",this.implicitRelease);document.addEventListener("pointercancel",this.implicitRelease);c._target=b;this.asyncDispatchEvent(c)},
releaseCapture:function(a){var b=this.captureInfo[a];if(b){var c=new m("lostpointercapture");c.pointerId=a;this.captureInfo[a]=void 0;document.removeEventListener("pointerup",this.implicitRelease);document.removeEventListener("pointercancel",this.implicitRelease);c._target=b;this.asyncDispatchEvent(c)}},dispatchEvent:function(a){var b=this.getTarget(a);if(b)return b.dispatchEvent(a)},asyncDispatchEvent:function(a){requestAnimationFrame(this.dispatchEvent.bind(this,a))}};q.boundHandler=q.eventHandler.bind(q);
var x={shadow:function(a){if(a)return a.shadowRoot||a.webkitShadowRoot},canTarget:function(a){return a&&!!a.elementFromPoint},targetingShadow:function(a){a=this.shadow(a);if(this.canTarget(a))return a},olderShadow:function(a){var b=a.olderShadowRoot;!b&&(a=a.querySelector("shadow"))&&(b=a.olderShadowRoot);return b},allShadows:function(a){var b=[];for(a=this.shadow(a);a;)b.push(a),a=this.olderShadow(a);return b},searchRoot:function(a,b,c){if(a){var d=a.elementFromPoint(b,c),f;for(f=this.targetingShadow(d);f;){if(a=
f.elementFromPoint(b,c))return d=this.targetingShadow(a),this.searchRoot(d,b,c)||a;f=this.olderShadow(f)}return d}},owner:function(a){for(;a.parentNode;)a=a.parentNode;a.nodeType!==Node.DOCUMENT_NODE&&a.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(a=document);return a},findTarget:function(a){var b=a.clientX,c=a.clientY;a=this.owner(a.target);a.elementFromPoint(b,c)||(a=document);return this.searchRoot(a,b,c)}},y=Array.prototype.forEach.call.bind(Array.prototype.forEach),z=Array.prototype.map.call.bind(Array.prototype.map),
A=Array.prototype.slice.call.bind(Array.prototype.slice),C=Array.prototype.filter.call.bind(Array.prototype.filter),B=window.MutationObserver||window.WebKitMutationObserver,D={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};b.prototype={watchSubtree:function(a){this.observer&&x.canTarget(a)&&this.observer.observe(a,D)},enableOnSubtree:function(a){this.watchSubtree(a);a===document&&"complete"!==document.readyState?this.installOnLoad():this.installNewSubtree(a)},
installNewSubtree:function(a){y(this.findElements(a),this.addElement,this)},findElements:function(a){return a.querySelectorAll?a.querySelectorAll("[touch-action]"):[]},removeElement:function(a){this.removeCallback(a)},addElement:function(a){this.addCallback(a)},elementChanged:function(a,b){this.changedCallback(a,b)},concatLists:function(a,b){return a.concat(A(b))},installOnLoad:function(){document.addEventListener("readystatechange",function(){"complete"===document.readyState&&this.installNewSubtree(document)}.bind(this))},
isElement:function(a){return a.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(a){var b=z(a,this.findElements,this);b.push(C(a,this.isElement));return b.reduce(this.concatLists,[])},mutationWatcher:function(a){a.forEach(this.mutationHandler,this)},mutationHandler:function(a){"childList"===a.type?(this.flattenMutationTree(a.addedNodes).forEach(this.addElement,this),this.flattenMutationTree(a.removedNodes).forEach(this.removeElement,this)):"attributes"===a.type&&this.elementChanged(a.target,
a.oldValue)}};var H=["none","auto","pan-x","pan-y",{rule:"pan-x pan-y",selectors:["pan-x pan-y","pan-y pan-x"]}],K="",E=window.PointerEvent||window.MSPointerEvent,F=!window.ShadowDOMPolyfill&&document.head.createShadowRoot,L=q.pointermap,Q=[1,4,2,8,16],N=!1;try{N=1===(new MouseEvent("test",{buttons:1})).buttons}catch(la){}var J={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(a){q.listen(a,this.events)},unregister:function(a){q.unlisten(a,
this.events)},lastTouches:[],isEventSimulatedFromTouch:function(a){var b=this.lastTouches,c=a.clientX;a=a.clientY;for(var d=0,f=b.length,e;d<f&&(e=b[d]);d++){var l=Math.abs(a-e.y);if(25>=Math.abs(c-e.x)&&25>=l)return!0}},prepareEvent:function(a){var b=q.cloneEvent(a),c=b.preventDefault;b.preventDefault=function(){a.preventDefault();c()};b.pointerId=this.POINTER_ID;b.isPrimary=!0;b.pointerType=this.POINTER_TYPE;return b},prepareButtonsForMove:function(a,b){var c=L.get(this.POINTER_ID);a.buttons=0!==
b.which&&c?c.buttons:0;b.buttons=a.buttons},mousedown:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=L.get(this.POINTER_ID),c=this.prepareEvent(a);N||(c.buttons=Q[c.button],b&&(c.buttons|=b.buttons),a.buttons=c.buttons);L.set(this.POINTER_ID,a);b&&0!==b.buttons?q.move(c):q.down(c)}},mousemove:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);N||this.prepareButtonsForMove(b,a);b.button=-1;L.set(this.POINTER_ID,a);q.move(b)}},mouseup:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=
L.get(this.POINTER_ID),c=this.prepareEvent(a);if(!N){var d=Q[c.button];c.buttons=b?b.buttons&~d:0;a.buttons=c.buttons}L.set(this.POINTER_ID,a);c.buttons&=~Q[c.button];0===c.buttons?q.up(c):q.move(c)}},mouseover:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);N||this.prepareButtonsForMove(b,a);b.button=-1;L.set(this.POINTER_ID,a);q.enterOver(b)}},mouseout:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);N||this.prepareButtonsForMove(b,a);b.button=
-1;q.leaveOut(b)}},cancel:function(a){a=this.prepareEvent(a);q.cancel(a);this.deactivateMouse()},deactivateMouse:function(){L.delete(this.POINTER_ID)}},P=q.captureInfo,I=x.findTarget.bind(x),O=x.allShadows.bind(x),ea=q.pointermap,W,fa={events:["touchstart","touchmove","touchend","touchcancel"],register:function(a){W.enableOnSubtree(a)},unregister:function(a){},elementAdded:function(a){var b=a.getAttribute("touch-action"),c=this.touchActionToScrollType(b);c&&(a._scrollType=c,q.listen(a,this.events),
O(a).forEach(function(a){a._scrollType=c;q.listen(a,this.events)},this))},elementRemoved:function(a){a._scrollType=void 0;q.unlisten(a,this.events);O(a).forEach(function(a){a._scrollType=void 0;q.unlisten(a,this.events)},this)},elementChanged:function(a,b){var c=a.getAttribute("touch-action"),d=this.touchActionToScrollType(c);b=this.touchActionToScrollType(b);d&&b?(a._scrollType=d,O(a).forEach(function(a){a._scrollType=d},this)):b?this.elementRemoved(a):d&&this.elementAdded(a)},scrollTypes:{EMITTER:"none",
XSCROLLER:"pan-x",YSCROLLER:"pan-y",SCROLLER:/^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/},touchActionToScrollType:function(a){var b=this.scrollTypes;if("none"===a)return"none";if(a===b.XSCROLLER)return"X";if(a===b.YSCROLLER)return"Y";if(b.SCROLLER.exec(a))return"XY"},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(a){return this.firstTouch===a.identifier},setPrimaryTouch:function(a){if(0===ea.size||1===ea.size&&ea.has(1))this.firstTouch=a.identifier,this.firstXY={X:a.clientX,Y:a.clientY},
this.scrolling=!1,this.cancelResetClickCount()},removePrimaryPointer:function(a){a.isPrimary&&(this.firstXY=this.firstTouch=null,this.resetClickCount())},clickCount:0,resetId:null,resetClickCount:function(){var a=function(){this.clickCount=0;this.resetId=null}.bind(this);this.resetId=setTimeout(a,200)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(a){var b=0;if("touchstart"===a||"touchmove"===a)b=1;return b},touchToPointer:function(a){var b=this.currentTouchEvent,
c=q.cloneEvent(a),d=c.pointerId=a.identifier+2;c.target=P[d]||I(c);c.bubbles=!0;c.cancelable=!0;c.detail=this.clickCount;c.button=0;c.buttons=this.typeToButtons(b.type);c.width=a.radiusX||a.webkitRadiusX||0;c.height=a.radiusY||a.webkitRadiusY||0;c.pressure=a.force||a.webkitForce||.5;c.isPrimary=this.isPrimaryTouch(a);c.pointerType=this.POINTER_TYPE;c.altKey=b.altKey;c.ctrlKey=b.ctrlKey;c.metaKey=b.metaKey;c.shiftKey=b.shiftKey;var f=this;c.preventDefault=function(){f.scrolling=!1;f.firstXY=null;b.preventDefault()};
return c},processTouches:function(a,b){var c=a.changedTouches;this.currentTouchEvent=a;a=0;for(var d;a<c.length;a++)d=c[a],b.call(this,this.touchToPointer(d))},shouldScroll:function(a){if(this.firstXY){var b;b=a.currentTarget._scrollType;if("none"===b)b=!1;else if("XY"===b)b=!0;else{a=a.changedTouches[0];var c="Y"===b?"X":"Y";b=Math.abs(a["client"+b]-this.firstXY[b])>=Math.abs(a["client"+c]-this.firstXY[c])}this.firstXY=null;return b}},findTouch:function(a,b){for(var c=0,d=a.length,f;c<d&&(f=a[c]);c++)if(f.identifier===
b)return!0},vacuumTouches:function(a){var b=a.touches;if(ea.size>=b.length){var c=[];ea.forEach(function(a,d){1===d||this.findTouch(b,d-2)||c.push(a.out)},this);c.forEach(this.cancelOut,this)}},touchstart:function(a){this.vacuumTouches(a);this.setPrimaryTouch(a.changedTouches[0]);this.dedupSynthMouse(a);this.scrolling||(this.clickCount++,this.processTouches(a,this.overDown))},overDown:function(a){ea.set(a.pointerId,{target:a.target,out:a,outTarget:a.target});q.enterOver(a);q.down(a)},touchmove:function(a){this.scrolling||
(this.shouldScroll(a)?(this.scrolling=!0,this.touchcancel(a)):(a.preventDefault(),this.processTouches(a,this.moveOverOut)))},moveOverOut:function(a){var b=ea.get(a.pointerId);if(b){var c=b.out,d=b.outTarget;q.move(a);c&&d!==a.target&&(c.relatedTarget=a.target,a.relatedTarget=d,c.target=d,a.target?(q.leaveOut(c),q.enterOver(a)):(a.target=d,a.relatedTarget=null,this.cancelOut(a)));b.out=a;b.outTarget=a.target}},touchend:function(a){this.dedupSynthMouse(a);this.processTouches(a,this.upOut)},upOut:function(a){this.scrolling||
(q.up(a),q.leaveOut(a));this.cleanUpPointer(a)},touchcancel:function(a){this.processTouches(a,this.cancelOut)},cancelOut:function(a){q.cancel(a);q.leaveOut(a);this.cleanUpPointer(a)},cleanUpPointer:function(a){ea.delete(a.pointerId);this.removePrimaryPointer(a)},dedupSynthMouse:function(a){var b=J.lastTouches;a=a.changedTouches[0];this.isPrimaryTouch(a)&&(a={x:a.clientX,y:a.clientY},b.push(a),b=function(a,b){b=a.indexOf(b);-1<b&&a.splice(b,1)}.bind(null,b,a),setTimeout(b,2500))}};W=new b(fa.elementAdded,
fa.elementRemoved,fa.elementChanged,fa);var X=q.pointermap,aa=window.MSPointerEvent&&"number"===typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,R={events:"MSPointerDown MSPointerMove MSPointerUp MSPointerOut MSPointerOver MSPointerCancel MSGotPointerCapture MSLostPointerCapture".split(" "),register:function(a){q.listen(a,this.events)},unregister:function(a){q.unlisten(a,this.events)},POINTER_TYPES:["","unavailable","touch","pen","mouse"],prepareEvent:function(a){var b=a;aa&&(b=q.cloneEvent(a),b.pointerType=
this.POINTER_TYPES[a.pointerType]);return b},cleanup:function(a){X.delete(a)},MSPointerDown:function(a){X.set(a.pointerId,a);a=this.prepareEvent(a);q.down(a)},MSPointerMove:function(a){a=this.prepareEvent(a);q.move(a)},MSPointerUp:function(a){var b=this.prepareEvent(a);q.up(b);this.cleanup(a.pointerId)},MSPointerOut:function(a){a=this.prepareEvent(a);q.leaveOut(a)},MSPointerOver:function(a){a=this.prepareEvent(a);q.enterOver(a)},MSPointerCancel:function(a){var b=this.prepareEvent(a);q.cancel(b);this.cleanup(a.pointerId)},
MSLostPointerCapture:function(a){a=q.makeEvent("lostpointercapture",a);q.dispatchEvent(a)},MSGotPointerCapture:function(a){a=q.makeEvent("gotpointercapture",a);q.dispatchEvent(a)}},ia,ga;window.navigator.msPointerEnabled?(ia=function(a){d(a);e(this);0!==q.pointermap.get(a).buttons&&this.msSetPointerCapture(a)},ga=function(a){d(a);this.msReleasePointerCapture(a)}):(ia=function(a){d(a);e(this);0!==q.pointermap.get(a).buttons&&q.setCapture(a,this)},ga=function(a){d(a);q.releaseCapture(a,this)});var ha=
window.PointerEvent||window.MSPointerEvent;return{dispatcher:q,Installer:b,PointerEvent:m,PointerMap:n,targetFinding:x,applyGlobal:function(){g();window.PointerEvent||(window.PointerEvent=m,window.navigator.msPointerEnabled?(Object.defineProperty(window.navigator,"maxTouchPoints",{value:window.navigator.msMaxTouchPoints,enumerable:!0}),q.registerSource("ms",R)):(q.registerSource("mouse",J),void 0!==window.ontouchstart&&q.registerSource("touch",fa)),q.register(document));window.Element&&!Element.prototype.setPointerCapture&&
Object.defineProperties(Element.prototype,{setPointerCapture:{value:ia},releasePointerCapture:{value:ga}})},applyLocal:function(a){ha||(window.PointerEvent||(window.navigator.msPointerEnabled?q.registerSource("ms",R):(q.registerSource("mouse",J),void 0!==window.ontouchstart&&q.registerSource("touch",fa)),q.register(document)),window.Element&&!Element.prototype.setPointerCapture&&(a.setPointerCapture=ia.bind(a),a.releasePointerCapture=ga.bind(a)),a.getAttribute("touch-action")||a.setAttribute("touch-action",
"none"))}}})},"esri/views/input/ViewEvents":function(){define(["require","exports","../../core/tsSupport/extendsHelper","./InputHandler","../../geometry/ScreenPoint"],function(m,k,b,a,c){function h(a){return!!d[a]}function g(a){for(var b=0;b<a.length;b++)if(!h(a[b]))return!1;return!0}var d={click:!0,"double-click":!0,hold:!0,drag:!0,"key-down":!0,"key-up":!0,"pointer-down":!0,"pointer-move":!0,"pointer-up":!0,"mouse-wheel":!0},e;(function(a){a[a.Left=0]="Left";a[a.Middle=1]="Middle";a[a.Right=2]=
"Right"})(e||(e={}));m=function(){function a(a){this.handlers=new Map;this.counter=0;this.view=a;this.inputManager=null}a.prototype.connect=function(a){var b=this;a&&this.disconnect();this.inputManager=a;this.handlers.forEach(function(a,c){return b.inputManager.installHandlers(c,[a])})};a.prototype.disconnect=function(){var a=this;this.inputManager&&this.handlers.forEach(function(b,c){return a.inputManager.uninstallHandlers(c)});this.inputManager=null};a.prototype.destroy=function(){this.disconnect();
this.handlers.clear();this.view=null};a.prototype.register=function(a,b,c){var d=this;a=Array.isArray(a)?a:a.split(",");if(!g(a))return a.some(h)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;var f=Array.isArray(b)?b:[];c=Array.isArray(b)?c:b;var e=this.createUniqueGroupName();b=new l(this.view,a,f,c);this.handlers.set(e,b);this.inputManager&&this.inputManager.installHandlers(e,[b]);return{remove:function(){return d.removeHandler(e)}}};
a.prototype.removeHandler=function(a){this.handlers.has(a)&&this.handlers.delete(a);this.inputManager&&this.inputManager.uninstallHandlers(a)};a.prototype.createUniqueGroupName=function(){this.counter+=1;return"viewEvents_"+this.counter};return a}();k.ViewEvents=m;var l=function(a){function d(b,c,d,f){var e=a.call(this,"esri.views.input.ViewEventHandler",!0)||this;e.view=b;for(b=0;b<c.length;b++)switch(c[b]){case "click":e.registerIncoming("click",d,function(a){return f(e.wrapClick(a))});break;case "double-click":e.registerIncoming("double-click",
d,function(a){return f(e.wrapDoubleClick(a))});break;case "hold":e.registerIncoming("hold",d,function(a){return f(e.wrapHold(a))});break;case "drag":e.registerIncoming("drag",d,function(a){return f(e.wrapDrag(a))});break;case "key-down":e.registerIncoming("key-down",d,function(a){return f(e.wrapKeyDown(a))});break;case "key-up":e.registerIncoming("key-up",d,function(a){return f(e.wrapKeyUp(a))});break;case "pointer-down":e.registerIncoming("pointer-down",d,function(a){return f(e.wrapPointer(a,"pointer-down"))});
break;case "pointer-move":e.registerIncoming("pointer-move",d,function(a){return f(e.wrapPointer(a,"pointer-move"))});break;case "pointer-up":e.registerIncoming("pointer-up",d,function(a){return f(e.wrapPointer(a,"pointer-up"))});break;case "mouse-wheel":e.registerIncoming("mouse-wheel",d,function(a){return f(e.wrapMouseWheel(a))})}return e}b(d,a);d.prototype.wrapClick=function(a){var b=a.data.x,d=a.data.y;return{type:"click",button:"touch"===a.data.native.pointerType?0:a.data.native.button,x:b,y:d,
native:a.data.native,timestamp:a.timestamp,screenPoint:new c(b,d),mapPoint:this.view.toMap(b,d),stopPropagation:function(){return a.stopPropagation()}}};d.prototype.wrapDoubleClick=function(a){var b=a.data.x,c=a.data.y;return{type:"double-click",button:"touch"===a.data.native.pointerType?0:a.data.native.button,x:b,y:c,native:a.data.native,timestamp:a.timestamp,mapPoint:this.view.toMap(b,c),stopPropagation:function(){return a.stopPropagation()}}};d.prototype.wrapHold=function(a){var b=a.data.x,c=a.data.y;
return{type:"hold",button:"touch"===a.data.native.pointerType?0:a.data.native.button,x:b,y:c,native:a.data.native,timestamp:a.timestamp,mapPoint:this.view.toMap(b,c),stopPropagation:function(){return a.stopPropagation()}}};d.prototype.wrapDrag=function(a){return{type:"drag",action:a.data.action,x:a.data.currentState.center.x,y:a.data.currentState.center.y,origin:{x:a.data.startState.center.x,y:a.data.startState.center.y},native:a.data.pointers[0].currentEvent.native,timestamp:a.timestamp,stopPropagation:function(){return a.stopPropagation()}}};
d.prototype.wrapKeyDown=function(a){return{type:"key-down",key:a.data.key,repeat:a.data.repeat,native:a.data.native,timestamp:a.timestamp,stopPropagation:function(){return a.stopPropagation()}}};d.prototype.wrapKeyUp=function(a){return{type:"key-up",key:a.data.key,native:a.data.native,timestamp:a.timestamp,stopPropagation:function(){return a.stopPropagation()}}};d.prototype.wrapPointer=function(a,b){return{type:b,x:a.data.x,y:a.data.y,pointerId:a.data.native.pointerId,pointerType:a.data.native.pointerType,
native:a.data.native,timestamp:a.timestamp,stopPropagation:function(){return a.stopPropagation()}}};d.prototype.wrapMouseWheel=function(a){return{type:"mouse-wheel",x:a.data.x,y:a.data.y,deltaY:a.data.deltaY,native:a.data.native,timestamp:a.timestamp,stopPropagation:function(){return a.stopPropagation()}}};return d}(a.InputHandler)})},"esri/views/input/handlers/PreventContextMenu":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","../InputHandler"],function(m,k,b,a){m=
function(a){function c(){var b=a.call(this,"PreventContextMenu",!0)||this;b.registerIncoming("context-menu",function(a){a.data.native.preventDefault()});return b}b(c,a);return c}(a.InputHandler);k.PreventContextMenu=m;Object.defineProperty(k,"__esModule",{value:!0});k.default=m})},"esri/views/3d/input/handlers/pinch/PinchNavigationGlobal":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../lib/glMatrix ../../util ./PinchNavigationBase ./MomentumNavigationGlobal".split(" "),
function(m,k,b,a,c,h,g){var d;(function(a){a[a.Horizontal=0]="Horizontal";a[a.Vertical=1]="Vertical"})(d=k.PanMode||(k.PanMode={}));var e=a.vec3d.create(),l=16/180*Math.PI;m=function(f){function n(b,e){var l=f.call(this,b,e)||this;l.view=b;l._rotation={axis:a.vec3d.create(),valueSmooth:new c.ExponentialFalloff(.05)};l._panning={axis:a.vec3d.create(),plane:{distance:0,normal:a.vec3d.create()},planarCenterScene:a.vec3d.create()};l._scaling={valueSmooth:new c.ExponentialFalloff(.05),centerScreen:a.vec2.create()};
l._beginScenePoints={points:[],center:a.vec3d.create()};l._panMode=d.Horizontal;l._navigationSphereRadius=0;l._tmpN=a.vec3d.create();l._tmp2d=a.vec2.create();l._tmpPickPointScreen=a.vec2.create();l._tmpPickPointScene=a.vec3d.create();l._tmpCurrentPoints=[];l._tmpCurrentCenter=a.vec3d.create();l._tmpD=a.vec3d.create();l._momentumNavigation=new g.MomentumNavigationGlobal(l,e);return l}b(n,f);Object.defineProperty(n.prototype,"momentum",{get:function(){return this._momentumNavigation},enumerable:!0,
configurable:!0});n.prototype.onNavigationBegin=function(b){var c=this._tmpPickPointScreen,f=this._tmpPickPointScene,e=this._helper;this._rotation.valueSmooth.reset();this._scaling.valueSmooth.reset();a.vec2.set2(b.data.currentState.center.x,this.view.height-b.data.currentState.center.y,c);e.picker.pickPointInScreen(c,f)?this._navigationSphereRadius=a.vec3d.length(f):this._navigationSphereRadius=Math.max(a.vec3d.length(this.beginCamera.center),.9*e.earthUtils.earthRadius);this._panMode=d.Horizontal;
3E4>this.view.renderCoordsHelper.getAltitude(this.beginCamera.eye)&&(this._navigationSphereRadius>a.vec3d.length(this.beginCamera.eye)?this._panMode=d.Vertical:(a.vec3d.normalize(a.vec3d.subtract(this.beginCamera.eye,f,this._tmpN)),Math.abs(.5*Math.PI-Math.acos(a.vec3d.dot(f,this._tmpN)/a.vec3d.length(f)))<l&&(this._panMode=d.Vertical)));this._computeSpherePoints(b,"startEvent",this._navigationSphereRadius,this.beginCamera,this._beginScenePoints.points);e.spherical.computePointCenter(this._beginScenePoints.points,
this._navigationSphereRadius,this._beginScenePoints.center);this._panMode===d.Vertical&&(a.vec3d.normalize(a.vec3d.subtract(this.beginCamera.eye,this.beginCamera.center,this._panning.plane.normal)),this._panning.plane.distance=a.vec3d.dot(f,this._panning.plane.normal),a.vec2.set2(b.data.currentState.center.x,this.view.height-b.data.currentState.center.y,this._tmp2d),this._helper.planar.intersectPlaneFromScreenPoint(this._panning.plane,this.beginCamera,this._tmp2d,this._panning.planarCenterScene))};
n.prototype.onNavigationUpdate=function(b,c){var f=this._helper,l=b.data.pointers.length,g=1<l;if(this._panMode===d.Horizontal){var n=this._navigationSphereRadius;if(g){var h=b.data.startState.radius/b.data.currentState.radius,u=.001875*Math.min(Math.max(b.data.currentState.radius,40),120);this._scaling.valueSmooth.gain=u;this._scaling.valueSmooth.update(h);f.spherical.applyZoom(n,this.view,c,this._scaling.valueSmooth.value);a.vec2.set2(b.data.currentState.center.x,this.view.height-b.data.currentState.center.y,
this._scaling.centerScreen);this.momentum.addScaleValue(this._scaling.valueSmooth.value)}h=this._tmpCurrentPoints;u=this._tmpCurrentCenter;this._computeSpherePoints(b,"currentEvent",n,c,h);f.spherical.computePointCenter(h,n,u);var h=this._panning.axis,t=f.spherical.rotationFromPoints(n,this._beginScenePoints.center,u,h);f.applyRotation(c,e,h,t);t=this._tmp2d;a.vec2.set2(b.data.currentState.center.x,this.view.height-b.data.currentState.center.y,t);this.momentum.addPanValue(t,u,h);if(g){g=this._rotation.axis;
h=this._tmpCurrentPoints;a.vec3d.normalize(this._beginScenePoints.center,g);this._computeSpherePoints(b,"currentEvent",n,c,h);n=0;if(2===l)n=f.rotationFromPointsAroundAxis(h[0],this._beginScenePoints.points[0],g);else{for(u=0;u<l;u++)n+=f.rotationFromPointsAroundAxis(h[u],this._beginScenePoints.points[u],g);n/=l}l=this._rotation.valueSmooth.value;n=f.normalizeRotationDelta(n-l);u=.00125*Math.min(Math.max(b.data.currentState.radius,40),120);this._rotation.valueSmooth.gain=u;this._rotation.valueSmooth.update(l+
n);b=this._rotation.valueSmooth.value;this.momentum.addRotationValue(b);f.applyRotation(c,e,g,b)}}else l=this._panning.plane,g&&(h=b.data.startState.radius/b.data.currentState.radius,u=.001875*Math.min(Math.max(b.data.currentState.radius,40),120),this._scaling.valueSmooth.gain=u,this._scaling.valueSmooth.update(h),this.momentum.addScaleValue(this._scaling.valueSmooth.value),this.momentum.setVerticalParameters(l,this._panning.planarCenterScene),f.planar.applyZoom(l,this.view,c,this._panning.planarCenterScene,
this._scaling.valueSmooth.value)),h=this._tmpCurrentPoints,u=this._tmpCurrentCenter,this.computePlanePoints(b,"currentEvent",l,c,h),f.planar.computePointCenter(h,u),l=this._tmpD,a.vec3d.subtract(u,this._panning.planarCenterScene,l),a.vec3d.subtract(c.eye,l),a.vec3d.subtract(c.center,l),c.markViewDirty(),t=this._tmp2d,a.vec2.set2(b.data.currentState.center.x,this.view.height-b.data.currentState.center.y,t),this.momentum.addPanValue(t,u,l),g&&(g=this._rotation.axis,a.vec3d.set(this._beginScenePoints.center,
g),n=b.data.currentState.angle,l=this._rotation.valueSmooth.value,n=f.normalizeRotationDelta(n-l),u=.00125*Math.min(Math.max(b.data.currentState.radius,40),120),this._rotation.valueSmooth.gain=u,this._rotation.valueSmooth.update(l+n),b=this._rotation.valueSmooth.value,this.momentum.addRotationValue(b),f.applyRotation(c,e,g,b));c.markViewDirty()};n.prototype.onNavigationEnd=function(a){this.momentum.setParameters(this._navigationSphereRadius,this._scaling.centerScreen,this._beginScenePoints.center,
this._panMode)};n.prototype._computeSpherePoints=function(b,c,d,f,e){e.length=b.data.pointers.length;for(var l=this._tmp2d,g=0;g<e.length;g++){var n=b.data.pointers[g];l[0]=n[c].x;l[1]=this.view.height-n[c].y;void 0===e[g]&&(e[g]=a.vec3d.create());this._helper.spherical.makeRenderCoordSpherePoint(d,f,l,e[g])}return e};return n}(h.PinchNavigationBase);k.PinchNavigationGlobal=m})},"esri/views/3d/input/util":function(){define(["require","exports"],function(m,k){m=function(){function b(a){this._gain=
a}b.prototype.reset=function(a){this._value=a};Object.defineProperty(b.prototype,"gain",{set:function(a){this._gain=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"value",{get:function(){return void 0===this._value?0:this._value},enumerable:!0,configurable:!0});b.prototype.update=function(a){this._value=void 0===this._value?a:this._gain*a+(1-this._gain)*this._value};return b}();k.ExponentialFalloff=m})},"esri/views/3d/input/handlers/pinch/PinchNavigationBase":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../input/InputHandler ../../../lib/glMatrix ../../../webgl-engine/lib/Camera".split(" "),
function(m,k,b,a,c,h){m=function(a){function d(b,d){var f=a.call(this,"esri.views.3d.input.handlers.PinchTest",!0)||this;f.view=b;f._helper=d;f._lastEndTimestamp=0;f._dragNavigationActive=!1;f._beginCamera=new h;f._tmpvec2d=c.vec2.create();f.registerIncoming("drag",function(a){return f._handleDrag(a)});f.registerIncoming("pointer-down",function(a){return f.stopMomentumNavigation()});f.registerIncoming("two-finger-drag-vertical",function(a){return f.stopMomentumNavigation()});return f}b(d,a);d.prototype.stopMomentumNavigation=
function(){this.momentum&&this.momentum.stop()};d.prototype.destroy=function(){this.momentum&&this.momentum.destroy()};d.prototype.applyNavigationConstraints=function(){var a=this.view.navigation;a.fixTargetUpVector();a.constrainTargetEyeByElevationAndMoveLookAt();a.targetAndCurrentChanged()};Object.defineProperty(d.prototype,"beginCamera",{get:function(){return this._beginCamera},enumerable:!0,configurable:!0});d.prototype.computePlanePoints=function(a,b,d,g,h){h.length=a.data.pointers.length;for(var f=
this._tmpvec2d,e=0;e<h.length;e++){var l=a.data.pointers[e];f[0]=l[b].x;f[1]=this.view.height-l[b].y;void 0===h[e]&&(h[e]=c.vec3d.create());this._helper.planar.intersectPlaneFromScreenPoint(d,g,f,h[e])}return h};d.prototype._handleDrag=function(a){if(1!==a.data.pointers.length||"mouse"!==a.data.pointers[0].currentEvent.native.pointerType){var b=a.timestamp-this._lastEndTimestamp,b=this.momentum&&this.momentum.active&&40>b;switch(a.data.action){case "start":if(b)break;this._navigationBegin(a);break;
case "update":if(b)break;this._dragNavigationActive?this._navigationUpdate(a):this._navigationBegin(a);break;case "end":this._dragNavigationActive&&(this._lastEndTimestamp=a.timestamp,this._navigationEnd(a))}a.stopPropagation()}};d.prototype._navigationBegin=function(a){var b=this.view.navigation;this.stopMomentumNavigation();this._dragNavigationActive=!0;this.beginCamera.copyFrom(b.currentCamera);b.begin(this);this.onNavigationBegin(a)};d.prototype._navigationUpdate=function(a){if(!(.002>(a.data.currentState.timeStamp-
a.data.previousState.timeStamp)/1E3)){var b=this.view.navigation.targetCamera;b.eye=this.beginCamera.eye;b.center=this.beginCamera.center;b.up=this.beginCamera.up;this.onNavigationUpdate(a,b);this.applyNavigationConstraints()}};d.prototype._navigationEnd=function(a){this.onNavigationEnd(a);this._dragNavigationActive=!1;this.momentum&&this.momentum.initiate();this.view.navigation.end(this)};return d}(a.InputHandler);k.PinchNavigationBase=m})},"esri/views/3d/input/handlers/pinch/MomentumNavigationGlobal":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../lib/glMatrix ./MomentumNavigationBase ./PinchNavigationGlobal".split(" "),
function(m,k,b,a,c,h){var g=a.vec3d.create();m=function(c){function d(b,d){b=c.call(this,b,d)||this;b._panAxisOrDirection=a.vec3d.create();b._centerOnScreen=a.vec2.create();b._centerOnSphere=a.vec3d.create();b._tmpSphereCenter=a.vec3d.create();b._tmpScaleAxis=a.vec3d.create();b._verticalPlane={distance:0,normal:a.vec3d.create()};b._verticalCenter=a.vec3d.create();return b}b(d,c);d.prototype.setParameters=function(b,c,d,e){this._radius=b;a.vec2.set(c,this._centerOnScreen);a.vec3d.set(d,this._centerOnSphere);
this._mode=e};d.prototype.addPanValue=function(b,c,d){this.pan.estimator.add(b[0],b[1],c);a.vec3d.set(d,this._panAxisOrDirection)};d.prototype.addRotationValue=function(a){this.rotation.estimator.add(a)};d.prototype.addScaleValue=function(a){this.zoom.estimator.add(a)};d.prototype.setVerticalParameters=function(b,c){a.vec3d.set(c,this._verticalCenter);a.vec3d.set(b.normal,this._verticalPlane.normal);this._verticalPlane.distance=b.distance};d.prototype.onUpdate=function(b,c,d){var f=this._radius,e=
this._centerOnScreen,l=this._centerOnSphere;if(this.zoom.momentum){var n=this.zoom.momentum.valueDelta(b,c);this._mode===h.PanMode.Horizontal?(this.helper.spherical.applyZoom(f,this.view,d,n),this.helper.spherical.makeRenderCoordSpherePoint(f,d,e,this._tmpSphereCenter),f=this.helper.spherical.rotationFromPoints(f,l,this._tmpSphereCenter,this._tmpScaleAxis),this.helper.applyRotation(d,g,this._tmpScaleAxis,f)):this.helper.planar.applyZoom(this._verticalPlane,this.view,d,this._verticalCenter,n)}this.pan.momentum&&
(this._mode===h.PanMode.Horizontal?(f=this.helper.spherical.rotationFromPoints(this._radius,this.pan.momentum.dataOldest,this.pan.momentum.dataNewest,this._panAxisOrDirection),f/=this.pan.momentum.dataTimeDelta,f*=this.pan.momentum.velocityFactor(b),this.helper.applyRotation(d,g,this._panAxisOrDirection,f*c)):(f=a.vec3d.dist(this.pan.momentum.dataOldest,this.pan.momentum.dataNewest),f/=this.pan.momentum.dataTimeDelta,f*=this.pan.momentum.velocityFactor(b),a.vec3d.normalize(this._panAxisOrDirection),
a.vec3d.scale(this._panAxisOrDirection,f*c),a.vec3d.subtract(d.eye,this._panAxisOrDirection),a.vec3d.subtract(d.center,this._panAxisOrDirection),d.markViewDirty()));this.rotation.momentum&&(b=this.rotation.momentum.valueDelta(b,c),this.helper.applyRotation(d,g,l,b))};return d}(c.MomentumNavigationBase);k.MomentumNavigationGlobal=m})},"esri/views/3d/input/handlers/pinch/MomentumNavigationBase":function(){define(["require","exports","../../../../../core/tsSupport/extendsHelper","../../../../navigation/Momentum"],
function(m,k,b,a){m=function(){function b(b,c){this.pinchNavigation=b;this._helper=c;this.zoom={momentum:null,estimator:new a.ZoomMomentumEstimator(.05),enabled:!0};this.rotation={momentum:null,estimator:new a.RotationMomentumEstimator(.05,3,.05,.95),enabled:!0};this.pan={momentum:null,estimator:new a.ScreenspaceMomentumEstimator(.05,600,6,.82),enabled:!0};this._elapsedTime=0;this._active=!1}b.prototype.destroy=function(){this.stop()};Object.defineProperty(b.prototype,"active",{get:function(){return this._active},
enumerable:!0,configurable:!0});b.prototype.doFrameUpdate=function(a){this._onUpdate(.001*a)};b.prototype.stop=function(){this.pan.estimator.reset();this.rotation.estimator.reset();this.zoom.estimator.reset();this._active=!1};b.prototype.initiate=function(){this._active||(this._elapsedTime=0,this.pan.momentum=null,this.zoom.momentum=null,this.rotation.momentum=null,this.zoom.enabled&&(this.zoom.momentum=this.zoom.estimator.evaluateMomentum()),!this.zoom.momentum&&this.rotation.enabled&&(this.rotation.momentum=
this.rotation.estimator.evaluateMomentum()),this.zoom.momentum||this.rotation.momentum||!this.pan.enabled||(this.pan.momentum=this.pan.estimator.evaluateMomentum()),this._active=null!=(this.zoom.momentum||this.rotation.momentum||this.pan.momentum))};Object.defineProperty(b.prototype,"helper",{get:function(){return this._helper},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"view",{get:function(){return this.pinchNavigation.view},enumerable:!0,configurable:!0});b.prototype._onUpdate=
function(a){this.active&&(this.zoom.momentum&&this.zoom.momentum.isFinished(this._elapsedTime)&&(this.zoom.momentum=null),this.rotation.momentum&&this.rotation.momentum.isFinished(this._elapsedTime)&&(this.rotation.momentum=null),this.pan.momentum&&this.pan.momentum.isFinished(this._elapsedTime)&&(this.pan.momentum=null),this.zoom.momentum||this.rotation.momentum||this.pan.momentum?(this.view.navigation.targetCamera.copyFrom(this.view.navigation.currentCamera),this.onUpdate(this._elapsedTime,a,this.view.navigation.targetCamera),
this.pinchNavigation.applyNavigationConstraints(),this._elapsedTime+=a):this.stop())};return b}();k.MomentumNavigationBase=m})},"esri/views/navigation/Momentum":function(){define(["require","exports","../../core/tsSupport/extendsHelper","./ValueHistory","../3d/lib/glMatrix"],function(m,k,b,a,c){var h=function(){function a(a,b,c){this._initialVelocity=a;this._stopVelocity=b;this._friction=c;this._duration=Math.abs(Math.log(Math.abs(this._initialVelocity)/this._stopVelocity)/Math.log(1-this._friction))}
Object.defineProperty(a.prototype,"duration",{get:function(){return this._duration},enumerable:!0,configurable:!0});a.prototype.isFinished=function(a){return a>this.duration};Object.defineProperty(a.prototype,"friction",{get:function(){return this._friction},enumerable:!0,configurable:!0});a.prototype.value=function(a){a=Math.min(a,this.duration);var b=1-this._friction;return this._initialVelocity*(Math.pow(b,a)-1)/Math.log(b)};a.prototype.valueDelta=function(a,b){var c=this.value(a);return this.value(a+
b)-c};return a}();k.Momentum=h;m=function(){function b(b,c,d,e){void 0===b&&(b=.05);this._minimumInitialVelocity=c;this._stopVelocity=d;this._friction=e;this._history=new a.ValueHistory(1E3*b)}b.prototype.add=function(a,b){void 0!==b&&(b*=1E3);this._history.add(a,b)};b.prototype.reset=function(){this._history.reset()};Object.defineProperty(b.prototype,"stopVelocity",{get:function(){return this._stopVelocity},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"friction",{get:function(){return this._friction},
enumerable:!0,configurable:!0});b.prototype.evaluateMomentum=function(){var a=this._evaluateVelocity();return null!==a?new h(a,this._stopVelocity,this._friction):null};b.prototype._evaluateVelocity=function(){var a=this._history,b=a.oldest,a=a.newest;if(b&&a){var c=(a.timeStamp-b.timeStamp)/1E3;if(0<c&&(b=(a.value-b.value)/c,Math.abs(b)>=this._minimumInitialVelocity))return b}return null};return b}();k.MomentumEstimator=m;var g=function(a){function c(b,c,d){return a.call(this,b,c,d)||this}b(c,a);
c.prototype.value=function(b){b=a.prototype.value.call(this,b);return Math.exp(b)};c.prototype.valueDelta=function(b,c){var d=a.prototype.value.call(this,b);b=a.prototype.value.call(this,b+c);return Math.exp(b-d)};return c}(h);k.ZoomMomentum=g;var d=function(a){function c(b,c,d,f){void 0===b&&(b=.05);void 0===c&&(c=4);void 0===d&&(d=.01);void 0===f&&(f=.95);return a.call(this,b,c,d,f)||this}b(c,a);c.prototype.add=function(b,c){a.prototype.add.call(this,Math.log(b),c)};c.prototype.evaluateMomentum=
function(){var a=this._evaluateVelocity();return null!==a?new g(a,this.stopVelocity,this.friction):null};return c}(m);k.ZoomMomentumEstimator=d;m=function(a){function c(b,c,d,f){void 0===b&&(b=.05);void 0===c&&(c=4);void 0===d&&(d=.01);void 0===f&&(f=.95);return a.call(this,b,c,d,f)||this}b(c,a);c.prototype.add=function(b,c){var d=this._history.newest;if(d){d=d.value;for(b-=d;b>Math.PI;)b-=2*Math.PI;for(;b<-Math.PI;)b+=2*Math.PI;b=d+b}a.prototype.add.call(this,b,c)};return c}(m);k.RotationMomentumEstimator=
m;var e=function(a){function c(b,c,d,f,e,l){b=a.call(this,b,c,d)||this;b.dataOldest=f;b.dataNewest=e;b.dataTimeDelta=l;return b}b(c,a);c.prototype.velocityFactor=function(a){a=Math.min(a,this.duration);return Math.pow(1-this.friction,a)};c.prototype.valueFromInitialVelocity=function(a,b){b=Math.min(b,this.duration);var c=1-this.friction;return a*(Math.pow(c,b)-1)/Math.log(c)};return c}(h);k.ScreenspaceMomentum=e;m=function(){function b(b,c,d,e){void 0===b&&(b=.05);this._minimumInitialVelocity=c;this._stopVelocity=
d;this._friction=e;this._entryPool=[];this._history=new a.ValueHistory(1E3*b)}b.prototype.add=function(a,b,d,e){void 0!==e&&(e*=1E3);var f;0!==this._entryPool.length?(f=this._entryPool.pop(),f.x=a,f.y=b,c.vec3d.set(d,f.data)):f={x:a,y:b,data:c.vec3d.create(d)};this._history.add(f,e)};b.prototype.reset=function(){for(var a=0,b=this._history.values;a<b.length;a++)this._entryPool.push(b[a].value);this._history.reset()};Object.defineProperty(b.prototype,"stopVelocity",{get:function(){return this._stopVelocity},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"friction",{get:function(){return this._friction},enumerable:!0,configurable:!0});b.prototype.evaluateMomentum=function(){var a=this._evaluateVelocity(),b=this._history.oldest,c=this._history.newest;return null!==a?new e(a,this._stopVelocity,this._friction,b.value.data,c.value.data,.001*(c.timeStamp-b.timeStamp)):null};b.prototype._evaluateVelocity=function(){var a=this._history,b=a.oldest,c=a.newest;if(b&&c&&(a=.001*(c.timeStamp-b.timeStamp),
0<a)){var d=c.value.x-b.value.x,b=c.value.y-b.value.y,b=Math.sqrt(d*d+b*b)/a;if(Math.abs(b)>=this._minimumInitialVelocity)return b}return null};return b}();k.ScreenspaceMomentumEstimator=m})},"esri/views/navigation/ValueHistory":function(){define(["require","exports","../../core/now"],function(m,k,b){m=function(){function a(a){this._maximumAge=a;this._values=[]}Object.defineProperty(a.prototype,"values",{get:function(){return this._values},enumerable:!0,configurable:!0});a.prototype.reset=function(){this._values=
[]};a.prototype.add=function(a,h){h=void 0!==h?h:b();this._values.push({value:a,timeStamp:h});this._cleanup(h)};Object.defineProperty(a.prototype,"newest",{get:function(){var a=this._values.length;if(0<a)return this._values[a-1]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"oldest",{get:function(){if(0<this._values.length)return this._values[0]},enumerable:!0,configurable:!0});a.prototype._cleanup=function(a){for(;0<this._values.length;)if(this._values[0].timeStamp+this._maximumAge<
a)this._values.shift();else break};return a}();k.ValueHistory=m})},"esri/views/3d/input/handlers/pinch/PinchNavigationLocal":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../lib/glMatrix ../../util ./PinchNavigationBase ./MomentumNavigationLocal".split(" "),function(m,k,b,a,c,h,g){var d;(function(a){a[a.Horizontal=0]="Horizontal";a[a.Vertical=1]="Vertical"})(d=k.PanMode||(k.PanMode={}));var e=20/180*Math.PI,l=a.vec3d.createFrom(0,0,1);m=function(f){function h(b,
d){var e=f.call(this,b,d)||this;e.view=b;e._rotation={valueSmooth:new c.ExponentialFalloff(.05)};e._scaling={valueSmooth:new c.ExponentialFalloff(.05)};e._planeHorizontal={normal:a.vec3d.create(),distance:0};e._planeVertical={normal:a.vec3d.create(),distance:0};e._beginCenterHorizontal=a.vec3d.create();e._beginCenterVertical=a.vec3d.create();e._tmpPoints=[];e._tmpPickPointScreen=a.vec2.create();e._tmpPickPointScene=a.vec3d.create();e._tmpBwd=a.vec3d.create();e._tmpUp=a.vec3d.create();e._tmpD=a.vec3d.create();
e._tmpC3=a.vec3d.create();e._tmpC2=a.vec2.create();e._momentumNavigation=new g.MomentumNavigationLocal(e,d);return e}b(h,f);Object.defineProperty(h.prototype,"momentum",{get:function(){return this._momentumNavigation},enumerable:!0,configurable:!0});h.prototype.onNavigationBegin=function(b){var c=this._helper,f=this._tmpPickPointScreen,g=this._tmpPickPointScene;this._rotation.valueSmooth.reset();this._scaling.valueSmooth.reset();a.vec2.set2(b.data.currentState.center.x,this.view.height-b.data.currentState.center.y,
f);this._planeHorizontal.distance=0;a.vec3d.set(l,this._planeHorizontal.normal);c.picker.pickPointInScreen(f,g)||c.picker.pickFreePointInScreen(f,g);f=this._tmpBwd;a.vec3d.negate(this.beginCamera.viewForward,f);var h=this._tmpUp;a.vec3d.set(l,h);var n=a.vec3d.dot(f,h);this._mode=Math.asin(0>n?-n:n)>=e?d.Horizontal:d.Vertical;this._planeHorizontal.distance=a.vec3d.dot(this._planeHorizontal.normal,g);0>a.vec3d.dot(this._planeHorizontal.normal,this.beginCamera.eye)-this._planeHorizontal.distance&&(a.vec3d.negate(this._planeHorizontal.normal),
this._planeHorizontal.distance*=-1);this._mode===d.Vertical&&(a.vec3d.scale(h,n),a.vec3d.subtract(f,h,this._planeVertical.normal),a.vec3d.normalize(this._planeVertical.normal),this._planeVertical.distance=a.vec3d.dot(this._planeVertical.normal,g),this.computePlanePoints(b,"currentEvent",this._planeVertical,this.beginCamera,this._tmpPoints),c.planar.computePointCenter(this._tmpPoints,this._beginCenterVertical));this.computePlanePoints(b,"currentEvent",this._planeHorizontal,this.beginCamera,this._tmpPoints);
c.planar.computePointCenter(this._tmpPoints,this._beginCenterHorizontal)};h.prototype.onNavigationUpdate=function(b,c){var f=this._helper,e=1<b.data.pointers.length,l=this._mode===d.Horizontal?this._planeHorizontal:this._planeVertical,g=this._mode===d.Horizontal?this._beginCenterHorizontal:this._beginCenterVertical;if(e){var h=b.data.startState.radius/b.data.currentState.radius,n=.001875*Math.min(Math.max(b.data.currentState.radius,40),120);this._scaling.valueSmooth.gain=n;this._scaling.valueSmooth.update(h);
f.planar.applyZoom(l,this.view,c,g,this._scaling.valueSmooth.value);this.momentum.addScaleValue(this._scaling.valueSmooth.value,l,g)}n=this._tmpC3;this.computePlanePoints(b,"currentEvent",l,c,this._tmpPoints);f.planar.computePointCenter(this._tmpPoints,n);l=this._tmpD;a.vec3d.subtract(n,g,l);a.vec3d.subtract(c.eye,l);a.vec3d.subtract(c.center,l);c.markViewDirty();h=this._tmpC2;a.vec2.set2(b.data.currentState.center.x,b.data.currentState.center.y,h);this.momentum.addPanValue(h,n,l);e&&(e=this._planeHorizontal.normal,
a.vec3d.set(this._planeHorizontal.normal,e),n=b.data.currentState.angle,l=this._rotation.valueSmooth.value,h=f.normalizeRotationDelta(n-l),n=.00125*Math.min(Math.max(b.data.currentState.radius,40),120),this._rotation.valueSmooth.gain=n,this._rotation.valueSmooth.update(l+h),b=this._rotation.valueSmooth.value,this.momentum.addRotationValue(g,e,b),f.applyRotation(c,g,e,b))};h.prototype.onNavigationEnd=function(a){};return h}(h.PinchNavigationBase);k.PinchNavigationLocal=m})},"esri/views/3d/input/handlers/pinch/MomentumNavigationLocal":function(){define(["require",
"exports","../../../../../core/tsSupport/extendsHelper","../../../lib/glMatrix","./MomentumNavigationBase"],function(m,k,b,a,c){m=function(c){function g(b,e){b=c.call(this,b,e)||this;b._scaleState={plane:{distance:0,normal:a.vec3d.create()},center:a.vec3d.create()};b._rotationState={center:a.vec3d.create(),axis:a.vec3d.create()};b._panState={direction:a.vec3d.create()};b.pan.enabled=!1;return b}b(g,c);g.prototype.addPanValue=function(b,c,l){this.pan.estimator.add(b[0],b[1],c);a.vec3d.set(l,this._panState.direction);
a.vec3d.normalize(this._panState.direction)};g.prototype.addRotationValue=function(b,c,l){this.rotation.estimator.add(l);a.vec3d.set(b,this._rotationState.center);a.vec3d.set(c,this._rotationState.axis)};g.prototype.addScaleValue=function(b,c,l){this.zoom.estimator.add(b);this._scaleState.plane.distance=c.distance;a.vec3d.set(c.normal,this._scaleState.plane.normal);a.vec3d.set(l,this._scaleState.center)};g.prototype.onUpdate=function(b,c,l){if(this.zoom.momentum){var d=this.zoom.momentum.valueDelta(b,
c);this.helper.planar.applyZoom(this._scaleState.plane,this.view,l,this._scaleState.center,d)}this.pan.momentum&&(a.vec3d.normalize(this._panState.direction),d=a.vec3d.dist(this.pan.momentum.dataOldest,this.pan.momentum.dataNewest),d/=this.pan.momentum.dataTimeDelta,d*=this.pan.momentum.velocityFactor(b),a.vec3d.scale(this._panState.direction,d*c),a.vec3d.subtract(l.eye,this._panState.direction),a.vec3d.subtract(l.center,this._panState.direction),l.markViewDirty());this.rotation.momentum&&(b=this.rotation.momentum.valueDelta(b,
c),this.helper.applyRotation(l,this._rotationState.center,this._rotationState.axis,b))};return g}(c.MomentumNavigationBase);k.MomentumNavigationLocal=m})},"esri/views/3d/input/handlers/DoubleClickZoom":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler","../../../input/handlers/support"],function(m,k,b,a,c){m=function(a){function g(b,c){var d=a.call(this,"esri.views.3d.input.handlers.DoubleClickZoom",!0)||this;d.view=b;d.registerIncoming("double-click",
c,function(a){return d._handleDoubleClick(a)});return d}b(g,a);g.prototype._handleDoubleClick=function(a){var b=a.data;c.eventMatchesPointerType(b.native,"primary")&&(this.view.navigation.zoom.stepScreen(Math.log(.5)/Math.log(.6),[b.x,this.view.height-b.y]),a.stopPropagation())};return g}(a.InputHandler);k.DoubleClickZoom=m})},"esri/views/input/handlers/support":function(){define(["require","exports"],function(m,k){k.eventMatchesPointerType=function(b,a){switch(a){case "primary":return"touch"===b.pointerType||
0===b.button;case "secondary":return"touch"!==b.pointerType&&2===b.button;case "tertiary":return"touch"!==b.pointerType&&1===b.button}}})},"esri/views/3d/input/handlers/DragPan":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler","./support"],function(m,k,b,a,c){m=function(a){function g(b,c,l){var d=a.call(this,"esri.views.3d.input.handlers.DragPan",!0)||this;d.view=b;d.pointerType=c;d.registerIncoming("drag",l,function(a){return d._handleDrag(a)});
return d}b(g,a);g.prototype._handleDrag=function(a){var b=a.data;if(!(1<b.pointers.length)){var d=b.pointers[0];if(c.eventMatchesPointerType(d.startEvent.native,this.pointerType)){var d=[d.currentEvent.x,this.view.height-d.currentEvent.y],f=this.view.navigation.pan;switch(b.action){case "start":f.begin(d);break;case "update":f.update(d);break;case "end":f.end(d)}a.stopPropagation()}}};return g}(a.InputHandler);k.DragPan=m})},"esri/views/3d/input/handlers/support":function(){define(["require","exports"],
function(m,k){k.eventMatchesPointerType=function(b,a){switch(a){case "primary":return"touch"===b.pointerType||0===b.button;case "secondary":return"touch"!==b.pointerType&&2===b.button;case "tertiary":return"touch"!==b.pointerType&&1===b.button}}})},"esri/views/3d/input/handlers/DragRotate":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../input/InputHandler ./support ../../navigation/NavigationConstants".split(" "),function(m,k,b,a,c,h){m=function(a){function d(b,
c,d,g){var f=a.call(this,"esri.views.3d.input.handlers.DragRotate",!0)||this;f.view=b;f.pointerType=c;f.pivotPoint=d;f.registerIncoming("drag",g,function(a){return f._handleDrag(a)});switch(d){case "center":f._navigationPivot=h.Rotate.PivotPoint.POI;break;case "eye":f._navigationPivot=h.Rotate.PivotPoint.EYE}return f}b(d,a);d.prototype._handleDrag=function(a){var b=a.data;if(!(1<b.pointers.length)){var d=b.pointers[0];if(c.eventMatchesPointerType(d.startEvent.native,this.pointerType)){var d=[d.currentEvent.x,
this.view.height-d.currentEvent.y],e=this.view.navigation.rotate;switch(b.action){case "start":e.begin(d,this._navigationPivot);break;case "update":e.update(d,this._navigationPivot);break;case "end":e.end(d)}a.stopPropagation()}}};return d}(a.InputHandler);k.DragRotate=m})},"esri/views/3d/navigation/NavigationConstants":function(){define(["require","exports"],function(m,k){k.Pan={Direction:{LEFT:1,RIGHT:2,FORWARD:4,BACKWARD:8,UP:16,DOWN:32},Mode:{HORIZONTAL:0,VERTICAL:1},Momentum:{DURATION_SHORT:1,
DURATION_LONG:3,DURATION_LONG_VEL:8,INPUT_FILTER:.2,BUFFER_SIZE:5,MINIMUM_VELOCITY:300},Vertical:{ELEVATION_THRESHOLD:3E4,ANGLE_THRESHOLD:8/180*Math.PI}};k.Rotate={PivotPoint:{POI:1,EYE:2}}})},"esri/views/3d/input/handlers/DragZoom":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler","./support"],function(m,k,b,a,c){m=function(a){function g(b,c,l){var d=a.call(this,"esri.views.3d.input.handlers.DragZoom"+c,!0)||this;d.view=b;d.pointerType=
c;d.registerIncoming("drag",l,function(a){return d._handleDrag(a)});return d}b(g,a);g.prototype._handleDrag=function(a){var b=a.data;if(!(1<b.pointers.length)){var d=b.pointers[0];if(c.eventMatchesPointerType(d.startEvent.native,this.pointerType)){var d=[d.currentEvent.x,this.view.height-d.currentEvent.y],f=this.view.navigation.zoom;switch(b.action){case "start":f.begin(d);break;case "update":f.update(d);break;case "end":f.end(d)}a.stopPropagation()}}};return g}(a.InputHandler);k.DragZoom=m})},"esri/views/3d/input/handlers/KeyPan":function(){define(["require",
"exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler","../../navigation/NavigationConstants"],function(m,k,b,a,c){var h=c.Pan.Direction;m=function(a){function c(b,c,d){var f=a.call(this,"esri.views.3d.input.handlers.KeyPan",!0)||this;f.view=b;f.keys=c;f._keyToDirection=(e={},e[c.left]=h.LEFT,e[c.right]=h.RIGHT,e[c.forward]=h.FORWARD,e[c.backward]=h.BACKWARD,e[c.up]=h.UP,e[c.down]=h.DOWN,e);f.registerIncoming("key-down",d,function(a){return f._handleKeyDown(a)});f.registerIncoming("key-up",
d,function(a){return f._handleKeyUp(a)});return f;var e}b(c,a);c.prototype._handleKeyDown=function(a){a.data.repeat||this._handleKey(a,!0)};c.prototype._handleKeyUp=function(a){this._handleKey(a,!1)};c.prototype._handleKey=function(a,b){var c=this._keyToDirection[a.data.key];null!=c&&(b?this.view.navigation.pan.beginContinuous(c):this.view.navigation.pan.endContinuous(c),a.stopPropagation())};return c}(a.InputHandler);k.KeyPan=m})},"esri/views/3d/input/handlers/MouseWheelZoom":function(){define(["require",
"exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],function(m,k,b,a){m=function(a){function c(b,c){var d=a.call(this,"esri.views.3d.input.handlers.MouseWheelZoom",!0)||this;d.view=b;d.registerIncoming("mouse-wheel",c,function(a){return d._handleMouseWheel(a)});return d}b(c,a);c.prototype._handleMouseWheel=function(a){var b=a.data;this.view.navigation.zoom.stepScreen(-1/60*b.deltaY,[b.x,this.view.height-b.y]);a.stopPropagation()};return c}(a.InputHandler);k.MouseWheelZoom=
m})},"esri/views/3d/input/handlers/SingleKeyResetHeading":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","./SingleKey"],function(m,k,b,a){m=function(a){function c(b,c,e){e=a.call(this,"esri.views.3d.input.handlers.SingleKeyResetHeading",c,e)||this;e.view=b;e.key=c;return e}b(c,a);c.prototype.activate=function(){this.view.goTo({heading:0})};return c}(a.SingleKey);k.SingleKeyResetHeading=m})},"esri/views/3d/input/handlers/SingleKey":function(){define(["require","exports",
"../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],function(m,k,b,a){m=function(a){function c(b,c,e){var d=a.call(this,b,!0)||this;d.key=c;d.registerIncoming("key-down",e,function(a){return d._handleKeyDown(a)});return d}b(c,a);c.prototype._handleKeyDown=function(a){a.data.key===this.key&&(this.activate(),a.stopPropagation())};return c}(a.InputHandler);k.SingleKey=m})},"esri/views/3d/input/handlers/SingleKeyResetTilt":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper",
"./SingleKey"],function(m,k,b,a){m=function(a){function c(b,c,e){e=a.call(this,"esri.views.3d.input.handlers.SingleKeyResetTilt",c,e)||this;e.view=b;e.key=c;return e}b(c,a);c.prototype.activate=function(){this.view.goTo({tilt:0})};return c}(a.SingleKey);k.SingleKeyResetTilt=m})},"esri/views/3d/input/handlers/PointerDownCancelAnimation":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],function(m,k,b,a){m=function(a){function c(b,c){var d=
a.call(this,"esri.views.3d.input.handlers.PointerDownCancelAnimation",!0)||this;d.view=b;d.registerIncoming("pointer-down",c,function(a){return d._handlePointerDown(a)});return d}b(c,a);c.prototype._handlePointerDown=function(a){this.view.navigation.stop()};return c}(a.InputHandler);k.PointerDownCancelAnimation=m})},"esri/views/3d/input/handlers/TwoFingerTilt":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler","../../navigation/NavigationConstants"],
function(m,k,b,a,c){m=function(a){function g(b,c){void 0===c&&(c=!1);var d=a.call(this,"esri.views.3d.input.handlers.TwoFingerTilt",!0)||this;d.view=b;d._invert=c;d.registerIncoming("vertical-two-finger-drag",function(a){return d._handleTwoFinger(a)});return d}b(g,a);g.prototype._handleTwoFinger=function(a){var b=this.view,d=[0,-a.data.delta*(this._invert?-1:1)];switch(a.data.action){case "begin":b.navigation.rotate.begin(d,c.Rotate.PivotPoint.POI);break;case "update":b.navigation.rotate.update(d,
c.Rotate.PivotPoint.POI);break;case "end":b.navigation.rotate.end(d)}};return g}(a.InputHandler);k.TwoFingerTilt=m})},"esri/views/3d/input/NavigationHelper":function(){define("require exports ../lib/glMatrix ../support/earthUtils ../webgl-engine/lib/Util ../support/mathUtils".split(" "),function(m,k,b,a,c,h){m=function(){function c(c){this.picker=c;this.earthUtils=a;this._axisTmp1=b.vec3d.create();this._axisTmp2=b.vec3d.create();this._axisTmp3=b.vec3d.create();this._tmpTransform2=b.mat4d.create();
this.spherical=new d(this);this.planar=new g(this)}c.prototype.normalizeRotationDelta=function(a){for(;a>Math.PI;)a-=2*Math.PI;for(;a<-Math.PI;)a+=2*Math.PI;return a};c.prototype.rotationFromPointsAroundAxis=function(a,c,d){var f=this._axisTmp1,e=this._axisTmp2,l=this._axisTmp3;b.vec3d.set(a,e);b.vec3d.set(c,l);a=b.vec3d.dot(e,d);c=b.vec3d.dot(l,d);b.vec3d.scale(d,a,f);b.vec3d.subtract(e,f);b.vec3d.normalize(e);b.vec3d.scale(d,c,f);b.vec3d.subtract(l,f);b.vec3d.normalize(l);a=b.vec3d.dot(e,l);b.vec3d.cross(d,
e,f);d=b.vec3d.dot(l,f);return Math.atan2(d,a)};c.prototype.applyRotation=function(a,c,d,e){var f=this._tmpTransform2;b.mat4d.identity(f);b.mat4d.rotate(f,e,d);b.vec3d.subtract(a.eye,c);b.mat4d.multiplyVec3(f,a.eye,a.eye);b.vec3d.add(a.eye,c);b.vec3d.subtract(a.center,c);b.mat4d.multiplyVec3(f,a.center,a.center);b.vec3d.add(a.center,c);b.mat4d.multiplyVec3(f,a.up,a.up);a.markViewDirty()};return c}();k.NavigationHelper=m;var g=function(){function a(a){this._helper=a;this._tmpForward=b.vec3d.create();
this._tmpP0=b.vec3d.create();this._tmpP1=b.vec3d.create()}a.prototype.applyZoom=function(a,c,d,e,g){a=this._tmpForward;g=1-g;b.vec3d.subtract(e,d.eye,a);var f=b.vec3d.length(a),l=f*(1-g);0<=g&&4>l&&(l=4);l=c.navigation.limitAltitude(l,e,a,f,0<=g?-1:1);1E-6>Math.abs(f-l)||(g=-(l-f)/f,b.vec3d.scale(a,g),b.vec3d.add(d.eye,a),b.vec3d.lerp(d.center,e,g),c.navigation.fixTargetUpVector(),d.markViewDirty())};a.prototype.intersectPlaneFromScreenPoint=function(a,c,d,e){var f=this._tmpP0,l=this._tmpP1;this._helper.picker.createPickRay(d,
null,c.viewMatrix,f,l);b.vec3d.subtract(l,f);c=b.vec3d.dot(a.normal,l);if(0===c)return!1;a=b.vec3d.dot(a.normal,f)-a.distance;b.vec3d.add(f,b.vec3d.scale(l,-a/c,e),e);return!0};a.prototype.computePointCenter=function(a,c){b.vec3d.set3(0,0,0,c);for(var d=0;d<a.length;d++)b.vec3d.add(c,a[d]);b.vec3d.scale(c,1/a.length)};return a}(),d=function(){function a(a){this._helper=a;this._tmpForward=b.vec3d.create();this._tmpP0=b.vec3d.create();this._tmpP1=b.vec3d.create();this._tmpAxis=b.vec3d.create();this._tmpTransform=
b.mat4d.create()}a.prototype.applyZoom=function(a,c,d,e){var f=this._tmpForward;b.vec3d.subtract(d.center,d.eye,f);a/=b.vec3d.length(d.center);var l=1-a,g=b.vec3d.length(f),h;h=c.navigation.limitAltitude(g*e,d.center,f,g);e=h/g;1E-6>Math.abs(g-h)||(b.vec3d.scale(d.center,a+l*e),b.vec3d.scale(f,e),b.vec3d.subtract(d.center,f,d.eye),d.markViewDirty(),c.navigation.applyConstraints(d))};a.prototype.makeRenderCoordSpherePoint=function(a,c,d,e){this._helper.picker.createPickRay(d,null,c.viewMatrix,this._tmpP0,
this._tmpP1);b.vec3d.subtract(this._tmpP1,c.eye);this.intersect(a,c.eye,this._tmpP1,e)||this.closestPointOnSilhouette(a,c.eye,this._tmpP0,e)};a.prototype.intersect=function(a,b,d,e){return c.raySphereClosestPositive(b,d,a,e)};a.prototype.closestPointOnSilhouette=function(a,c,d,e){var f=this._tmpAxis,g=this._tmpTransform;b.vec3d.cross(c,d,f);b.vec3d.cross(f,c,e);b.vec3d.scale(e,1/b.vec3d.length(e)*a);a=-h.asin(a/b.vec3d.length(c));b.mat4d.identity(g);b.mat4d.rotate(g,a,f);b.mat4d.multiplyVec3(g,e)};
a.prototype.rotationFromPoints=function(a,c,d,e){b.vec3d.cross(c,d,e);return-Math.acos(1-b.vec3d.dist2(c,d)/(2*a*a))};a.prototype.computePointCenter=function(a,c,d){b.vec3d.set3(0,0,0,d);for(var f=0;f<a.length;f++)b.vec3d.add(d,a[f]);b.vec3d.normalize(d);b.vec3d.scale(d,c)};return a}()})},"esri/views/3d/support/cameraUtils":function(){define("dojo/_base/lang ../../../geometry/SpatialReference ../../../config ../../../geometry/Point ../../../geometry/support/webMercatorUtils ../../../Camera ../lib/glMatrix ./mathUtils ./earthUtils ./projectionUtils ./cameraUtilsPlanar ./cameraUtilsSpherical".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f,n){function u(a,b){return"global"===a.viewingMode?n[b]:f[b]}function t(b,c,f){var e=b.renderSpatialReference,g=z.set(c.viewForward,B),g=x(b,c.eye,g,c.up,D);b=b.spatialReference||k.WGS84;l.vectorToVector(c.eye,e,A,b)||(b=k.WGS84,l.vectorToVector(c.eye,e,A,b));return f?(f.position.x=A[0],f.position.y=A[1],f.position.z=A[2],f.position.spatialReference=b,f.heading=g.heading,f.tilt=g.tilt,f.fov=d.rad2deg(c.fov),f):new h(new a(A,b),g.heading,g.tilt,d.rad2deg(c.fov))}function r(a,
c,f){var e=a.navigation.currentCamera,g=e.fovX,e=e.width/2;"global"===a.viewingMode&&null!=f&&(c*=Math.cos(d.deg2rad(f)));c/=a.renderCoordsHelper.unitInMeters;return e/(39.37*b.screenDPI/c)/Math.tan(g/2)}function w(a,c,f){var e=a.navigation.currentCamera;c=39.37*b.screenDPI/(e.width/2/(c*Math.tan(e.fovX/2)));"global"===a.viewingMode&&(c/=Math.cos(d.deg2rad(f)));return c*=a.renderCoordsHelper.unitInMeters}function q(a,b,c,d,f,e){var g=a.renderSpatialReference;b=y(a,d.heading,d.tilt,b,c,f);a=l.vectorToPoint(b.eye,
g,a.spatialReference||k.WGS84);if(!a)return null;if(!e)return new h(a,b.heading,b.tilt,d.fov);e.position=a;e.heading=b.heading;e.tilt=b.tilt;e.fov=d.fov;return e}function x(a,b,c,d,f){return u(a,"directionToHeadingTilt")(b,c,d,f)}function y(b,c,d,f,e,g){var h=z.create(),n=b.renderSpatialReference;if(f&&f instanceof a){var q=f;l.pointToVector(q,h,b.renderSpatialReference);null==q.z&&("global"===b.viewingMode?b._pickRay([0,0,0],h):b._pickRay([h[0],h[1]-1,h[2]],h),null!=b.basemapTerrain&&(q=b.basemapTerrain.getElevation(q),
null!=q&&b.renderCoordsHelper.setAltitude(q,h)))}else f?z.set(f,h):z.set(b.navigation.currentCamera.center,h);f&&f instanceof a||(f=l.vectorToPoint(h,n,b.spatialReference||k.WGS84));e=Math.max(e,b.navigation.minPoiDist);n=d;d=e;if(!(q=g&&g.noReset))var t=f,q=b.engineToScreen(b.navigation.currentCamera.center),x=b.toScreen(t),t=q.x-x.x,q=q.y-x.y,q=!(Math.sqrt(t*t+q*q)>5*Math.max(b.width,b.height));q?(n=u(b,"eyeTiltToLookAtTilt")(h,d,n),n=b.navigation.constraints.tilt.apply(n,d),n=u(b,"lookAtTiltToEyeTilt")(h,
d,n)):(c=0,n=b.navigation.constraints.tilt.min(d));d=n;c=u(b,"eyeForCenterWithHeadingTilt")(h,e,c,d);c.center=h;return g&&g.noReset||"global"!==b.viewingMode||(h=b.renderCoordsHelper.fromRenderCoords(c.eye,H,b.spatialReference)?b.basemapTerrain&&(b.basemapTerrain.getElevation(H)||0)>H.z-1:!1,!h)?c:(h=b.navigation.constraints.tilt.min(e),y(b,0,h,f,e,m.mixin({},g,{noReset:!0})))}var z=g.vec3d,A=z.create(),C=z.create(),B=z.create(),D={heading:0,tilt:0},H=new a,K=new d.Cyclical(-2.0037508342788905E7,
2.0037508342788905E7);return{externalToInternal:function(a,b){var c=a.renderSpatialReference,f=u(a,"headingTiltToDirectionUp"),e=z.create();return l.pointToVector(b.position,e,c)?(c=f(e,b.heading,b.tilt),z.add(c.direction,e),a=a.navigation.getCameraIntersectTerrain(e,c.direction,c.up),a.fov=d.deg2rad(b.fov),a):null},internalToExternal:t,scaleToDistance:r,distanceToScale:w,fromExtent:function(b,d,f,g,n){g instanceof h&&(n=g,g={});var q="global"===b.viewingMode,t=b.renderSpatialReference,u=b.spatialReference||
k.WGS84,x=k.WebMercator,r=d.spatialReference||x,w,m=0;null!=d.zmax&&null!=d.zmin&&(w=(d.zmax+d.zmin)/2,m=d.zmax-d.zmin);if(q){var q=new a(d.xmin,d.ymin,r),A=new a(d.xmax,d.ymax,r),q=c.project(q,x),A=c.project(A,x);if(null===q||null===A)return;d=new a(K.center(q.x,A.x),(A.y+q.y)/2,x);null!=w&&(d.z=w);w=e.getGreatCircleSpanAt(d,q,A);x=w.lon;r=w.lat;K.diff(q.x,A.x)>K.range/2&&(x+=e.halfEarthCircumference);x=Math.min(x,e.halfEarthCircumference);r=Math.min(r,e.halfEarthCircumference)}else c.canProject(d,
u)&&(d=c.project(d,u)),x=d.xmax-d.xmin,r=d.ymax-d.ymin,d=new a({x:d.xmin+.5*x,y:d.ymin+.5*r,z:w,spatialReference:u});w=b.navigation.currentCamera;f=y(b,f.heading,f.tilt,d,Math.max(1/Math.tan(w.fovX/2)*x*.5,1/Math.tan(w.fovY/2)*r*.5,1/Math.tan(w.fov/2)*m*.5)/1,g);t=l.vectorToPoint(f.eye,t,u);if(!t)return null;n||(n=new h);n.position=t;n.heading=f.heading;n.tilt=f.tilt;n.fov=b.camera.fov;return n},toExtent:function(a,b,c,d,g){var h;h=a.renderSpatialReference;b||(c||(c=a.navigation.currentCamera),b=
t(a,c,g));if(c)g=l.vectorToPoint(c.center,h,a.spatialReference||k.WGS84),h=c.distance;else{g=a.toMap(a.screenCenter);if(!g)return null;h=e.computeCarthesianDistance(b.position,g)}c||(c=a.navigation.currentCamera);b=2*h*Math.tan(c.fovX/2)*1;c=2*h*Math.tan(c.fovY/2)*1;return"global"===a.viewingMode?n.toExtent(a,g,b,c,d):f.toExtent(a,g,b,c,d)},fromCenterScale:function(a,b,c,d,f,e){c=r(a,c,b.latitude);return q(a,b,c,d,f,e)},fromCenterDistance:q,directionToHeadingTilt:x,eyeHeadingTiltForCenterPointAtDistance:y,
scaleToZoom:function(a,b){return(a=a.get("basemapTerrain.tilingScheme"))?a.levelAtScale(b):void 0},zoomToScale:function(a,b){return(a=a.get("basemapTerrain.tilingScheme"))?a.scaleAtLevel(b):void 0},computeScale:function(a,b,c){var d=a.renderSpatialReference;b||(b=a.navigation.currentCamera);var f;f=k.WGS84;b.center?(l.vectorToVector(b.center,d,C,f),f=C[1],b=b.distance):(f=b.position.latitude,l.pointToVector(b.position,A,d),l.pointToVector(c,C,d),b=z.dist(A,C));return w(a,b,f)}}})},"esri/views/3d/support/cameraUtilsPlanar":function(){define(["../../../geometry/Extent",
"./mathUtils","./projectionUtils","../lib/glMatrix","./cameraUtilsInternal"],function(m,k,b,a,c){function h(a,b,c){a=d.create();var g=d.create();e.identity(n);e.rotateZ(n,-k.deg2rad(b));e.rotateX(n,k.deg2rad(c));e.multiplyVec3(n,f,a);d.scale(a,-1);e.multiplyVec3(n,l,g);return{direction:a,up:g}}var g={headingTiltToDirectionUp:h,directionToHeadingTilt:function(a,b,d,e){return c.directionToHeadingTilt(b,d,e,f,l)},eyeForCenterWithHeadingTilt:function(a,b,c,f){var e=h(a,c,f);a=d.add(d.scale(e.direction,
-b,d.create()),a);return{up:e.up,eye:a,heading:c,tilt:f}},lookAtTiltToEyeTilt:function(a,b,c){return k.rad2deg(c)},eyeTiltToLookAtTilt:function(a,b,c){return k.deg2rad(c)},toExtent:function(a,c,d,f,e){var g=a.renderSpatialReference;a=a.map&&a.spatialReference||c.spatialReference;b.pointToVector(c,u,g);b.pointToVector(c,t,g);u[0]-=d/2;t[0]+=d/2;u[1]-=f/2;t[1]+=f/2;b.vectorToVector(u,g,u,a);b.vectorToVector(t,g,t,a);e?(e.xmin=u[0],e.ymin=u[1],e.xmax=t[0],e.ymax=t[1],e.spatialReference=a):e=new m(u[0],
u[1],t[0],t[1],a);return e}},d=a.vec3d,e=a.mat4d,l=d.createFrom(0,1,0),f=d.createFrom(0,0,1),n=e.create(),u=d.create(),t=d.create();return g})},"esri/views/3d/support/cameraUtilsInternal":function(){define(["./mathUtils","../lib/glMatrix"],function(m,k){var b=k.vec3d,a=b.create(),c=b.create();return{directionToHeadingTilt:function(h,g,d,e,l){var f=a;b.normalize(h,f);var n=Math.abs(b.dot(f,e));.99<n&&(n=Math.abs(b.dot(g,e)),.99>n?b.set(g,f):f=null);g=0;f&&(b.scale(e,b.dot(e,f),c),b.subtract(f,c),g=
b.dot(f,l)/(b.length(f)*b.length(l)),b.cross(f,l,c),g=(0<b.dot(c,e)?1:-1)*m.rad2deg(m.acos(g)));h=m.rad2deg(m.acos(-b.dot(e,h)/b.length(h)));return d?(d.heading=g,d.tilt=h,d):{heading:g,tilt:h}}}})},"esri/views/3d/support/cameraUtilsSpherical":function(){define("../../../geometry/SpatialReference ../../../geometry/Extent ../../../geometry/support/webMercatorUtils ./mathUtils ./earthUtils ../lib/glMatrix ./cameraUtilsInternal".split(" "),function(m,k,b,a,c,h,g){function d(b,c,d){var f=n.create(),e=
n.create();n.cross(b,t,x);0===n.dot(x,x)&&n.cross(b,r,x);u.identity(q);u.rotate(q,-a.deg2rad(c),b);u.rotate(q,-a.deg2rad(d),x);n.cross(x,b,e);n.normalize(e);u.multiplyVec3(q,e);n.normalize(b,f);u.multiplyVec3(q,n.negate(f));return{direction:f,up:e}}function e(a){var b=a[1];a[1]=-a[2];a[2]=b}function l(a,b){b=d(b,a.heading,a.tilt);a.up=b.up;return a}var f={headingTiltToDirectionUp:d,directionToHeadingTilt:function(a,b,c,d){var f=x,e=y;n.normalize(a,f);n.cross(f,t,y);0===n.dot(y,y)&&n.cross(f,r,y);
n.cross(y,f,e);return g.directionToHeadingTilt(b,c,d,f,e)},eyeForCenterWithHeadingTilt:function(b,c,d,f){var g={eye:n.create(),tilt:f,heading:d},h=x;h[0]=b[0];h[1]=b[2];h[2]=-b[1];d=a.deg2rad(d);var q=a.deg2rad(f);f=Math.sin(d);d=Math.cos(d);var t=Math.sin(q),u=Math.cos(q),k=n.length(h);if(1E-8>Math.abs(q))q=c+k;else var w=k/t,r=a.asin(c/w),q=w*Math.sin(Math.PI-q-r);var w=t*c,u=u*c,r=d*w,y=q-u,m=y*y,A=c*c*t*t,t=d*d*A,A=f*f*A,B=h[1]*y,C=t*(t+m-h[1]*h[1]);if(0>C)return n.scale(h,q/k,g.eye),g.tilt=0,
g;var z=Math.sqrt(C),C=t+m,B=0<d?-z+B:z+B;if(1E-8>Math.abs(C))return 1E-8>k?(g.eye[0]=0,g.eye[1]=0,g.eye[2]=c):n.scale(h,q/k,g.eye),g.tilt=0,e(g.eye),l(g,b);g.eye[1]=B/C;C=g.eye[1]*g.eye[1];c=1-C;B=Math.sqrt(c);r=t*C+A-2*r*g.eye[1]*B*y+c*m;if(1E-8>Math.abs(r))return n.scale(h,q/k,g.eye),g.tilt=0,e(g.eye),l(g,b);g.eye[0]=(c*(q*h[0]-u*h[0])-w*B*(h[0]*g.eye[1]*d+h[2]*f))/r;g.eye[2]=(c*(q*h[2]-u*h[2])-w*B*(h[2]*g.eye[1]*d-h[0]*f))/r;n.scale(g.eye,q);e(g.eye);return l(g,b)},lookAtTiltToEyeTilt:function(b,
c,d){b=n.length(b);c=a.asin(c/(Math.sqrt(c*c+b*b-2*c*b*Math.cos(Math.PI-d))/Math.sin(d)));return a.rad2deg(d-c)},eyeTiltToLookAtTilt:function(b,c,d){d=a.deg2rad(d);b=n.length(b);return a.asin(c/(b/Math.sin(d)))+d},toExtent:function(d,f,e,g,l){var h;h=f.latitude;f=f.longitude;var n=c.getLonDeltaForDistance(f,h,e)/2;e=f-n;f+=n;h=a.deg2rad(h);n=c.earthRadius;h=(1+Math.sin(h))/(1-Math.sin(h));var q=(h+1)*Math.tan(g/n/2);h=1.5*Math.PI-2*Math.atan(.5*(q+Math.sqrt(4*h+q*q)));g=h+g/n;n=function(b){var c=
Math.PI/2;b=a.cyclical2PI.normalize(b,-c);b>c&&(b=Math.PI-b);return b};h=n(h);g=n(g);g<h&&(n=g,g=h,h=n);h=Math.max(a.rad2deg(h),-90);g=Math.min(a.rad2deg(g),90);f=w.monotonic(e,f);180<f-e&&(n=(f-e-180)/2,e+=n,f-=n);l?(l.xmin=e,l.ymin=h,l.xmax=f,l.ymax=g,l.spatialReference=m.WGS84):l=new k(e,h,f,g,m.WGS84);d.spatialReference&&d.spatialReference.isWebMercator&&b.geographicToWebMercator(l,!1,l);return l}},n=h.vec3d,u=h.mat4d,t=n.createFrom(0,0,1),r=n.normalize(n.createFrom(1,1,1)),w=new a.Cyclical(-180,
180),q=u.create(),x=n.create(),y=n.create();return f})},"esri/views/3d/support/viewpointUtils":function(){define("../../../geometry/SpatialReference ../../../geometry/Geometry ../../../geometry/Point ../../../geometry/Extent ../../../geometry/support/webMercatorUtils ../../../core/Error ../../../core/promiseUtils ../../../Camera ../../../Viewpoint ../../../Graphic ../lib/glMatrix ./mathUtils ./projectionUtils ./cameraUtils ./aaBoundingBox ./aaBoundingRect ./intersectionUtils".split(" "),function(m,
k,b,a,c,h,g,d,e,l,f,n,u,t,r,w,q){function x(a){return 360-n.cyclicalDeg.normalize(a)}function y(a){return n.cyclicalDeg.normalize(360-a)}function z(a,f,e){if(!f)return null;var g=a.spatialReference||m.WGS84,l;if(f.camera){l=f.get("camera.position.spatialReference");if(!c.canProject(l,g))return null;f=f.camera.clone();l.equals(g)||(a=c.project(f.position,g),f.position=a);return f}if((l=f.get("targetGeometry.spatialReference"))&&!c.canProject(l,g))return null;var h=a.navigation.currentCamera;l=t.internalToExternal(a,
h);var n={noReset:!1};null!=f.rotation&&(l.heading=x(f.rotation),n.noReset=!0);null!=e&&(l.tilt=e);if(f.targetGeometry instanceof b){var q=f.targetGeometry;e=f.targetGeometry.clone();f=null!=f.scale?t.scaleToDistance(a,f.scale,q.latitude):h.distance;f=t.eyeHeadingTiltForCenterPointAtDistance(a,l.heading,l.tilt,e,f,n);a=u.vectorToPoint(f.eye,a.renderSpatialReference,g);return new d(a,f.heading,f.tilt,l.fov)}return t.fromExtent(a,f.targetGeometry.extent,l,n)}function A(a,b,c,d){var f=c.scale;null==
f&&null!=c.zoom&&(f=t.zoomToScale(a,c.zoom));null==f&&null!=c.distance&&(b=b.center||b,f=t.distanceToScale(a,c.distance,b.latitude));null==f&&d&&(f="function"===typeof d?d():d);return f}function C(a,c,d,f,e){if(!(c&&d.position||c&&d.direction||d.position&&d.direction))return!1;var g=a.spatialReference||m.WGS84,l=a.renderSpatialReference,h=d.direction;c&&d.position&&(h=null);d.position&&u.pointToVector(d.position,W,l);c&&u.pointToVector(c,fa,l);if(h){var n=new b(d.position||c);n.x+=h[0];n.y+=h[1];
2<h.length&&(n.z+=h[2]);u.pointToVector(n,X,l);I.subtract(X,d.position?W:fa)}d.position&&h?(e.camera.position=new b(d.position),t.directionToHeadingTilt(a,W,X,f.up,e.camera),I.add(W,X,fa),a.navigation.getCenterIntersectTerrain(W,fa,fa),e.targetGeometry=u.vectorToPoint(fa,l,g),e.scale=t.distanceToScale(a,I.dist(W,fa),e.targetGeometry.latitude)):c&&h?(e.targetGeometry=new b(c),e.scale=A(a,e.targetGeometry,d,function(){return t.computeScale(a,f)}),c=t.scaleToDistance(a,e.scale,c.latitude),I.scale(X,
c/I.length(X),W),I.add(W,fa),e.camera.position=u.vectorToPoint(W,l,g),t.directionToHeadingTilt(a,W,X,f.up,e.camera)):(e.targetGeometry=new b(c),e.camera.position=new b(d.position),I.subtract(fa,W,X),t.directionToHeadingTilt(a,W,X,f.up,e.camera),e.scale=t.distanceToScale(a,I.dist(W,fa),e.targetGeometry.latitude));e.rotation=y(e.camera.heading);return!0}function B(a,b){var c=!1;null!=b.heading?(a.heading=b.heading,c=!0):null!=b.rotation&&(a.heading=x(b.rotation),c=!0);null!=b.tilt&&(a.tilt=b.tilt,c=
!0);null!=b.fov&&(a.fov=b.fov);return c}function D(a,b,c){var d=a.spatialReference||m.WGS84;b=b||t.externalToInternal(a,c.camera);c.targetGeometry=u.vectorToPoint(b.center,a.renderSpatialReference,d);c.scale=t.computeScale(a,b);c.rotation=y(c.camera.heading);return c}function H(a,c,d){if(c){var f=[];if(!c.hasZ&&a.basemapTerrain){var e;e=c.isInstanceOf(b)?c:c.centroid||c.center;R[2]=e?a.basemapTerrain.getElevation(e)||0:0}Y[c.declaredClass](c,function(a){f.push(a[0],a[1],a[2])},R);var g=f.length/3;
if(0!==g&&(e=Array(f.length),u.bufferToBuffer(f,c.spatialReference,0,e,a.spatialReference,0,g)))for(c.hasZ&&(d.hasZ=!0),a=0;a<e.length;a+=3)c.hasZ?(R[0]=e[a+0],R[1]=e[a+1],R[2]=e[a+2]):(R[0]=e[a+0],R[1]=e[a+1]),r.expand(d.boundingBox,R)}}function K(a,b,c){return a.whenViewForGraphic(b).then(function(a){if(a&&a.whenGraphicBounds)return a.whenGraphicBounds(b)}).then(function(a){r.expand(c.boundingBox,a);isFinite(a[2])&&(c.hasZ=!0)}).otherwise(function(){H(a,b.geometry,c)})}function E(a,b,c){if(Array.isArray(b)&&
2===b.length&&"number"===typeof b[0]&&"number"===typeof b[1])da.x=b[0],da.y=b[1],da.z=void 0,da.spatialReference=m.WGS84,H(a,da,c);else{if(b&&b.forEach)return g.eachAlways(b.map(function(b){return E(a,b,c)}));if(b instanceof k)H(a,b,c);else if(b instanceof l)return K(a,b,c)}return g.resolve()}function F(a,b,c,d){if(b.camera)return L(a,c,b.camera,d);d.scale=b.scale;d.rotation=b.rotation;d.targetGeometry=b.targetGeometry?b.targetGeometry.clone():null;d.camera=null;null!=c.heading?d.rotation=y(c.heading):
null!=c.rotation&&(d.rotation=c.rotation);b=A(a,d.targetGeometry,c);null!=b&&(d.scale=b);d.camera=z(a,d,c.tilt);return d}function L(a,b,d,f){f.camera=d.clone();f.camera.fov=a.camera.fov;b=a.spatialReference;d=f.camera.position.spatialReference;if(!c.canProject(d,b))return null;d.equals(b)||(b=c.project(f.camera.position,b),f.camera.position=b);return D(a,null,f)}function Q(a,b,c,d){if(!c)return null;d.targetGeometry=c.clone();var f=a.navigation.getCameraIntersectTerrain();if(C(a,d.targetGeometry,
b,f,d))return d;t.internalToExternal(a,f,d.camera);var e={noReset:!1};B(d.camera,b)&&(e.noReset=!0);d.scale=A(a,d.targetGeometry,b);null==d.scale&&(u.pointToVector(c,R,a.renderSpatialReference),q.frustumPoint(f.frustumPlanes,R)?d.scale=t.distanceToScale(a,I.dist(f.eye,R),c.latitude):d.scale=t.computeScale(a,f));return t.fromCenterScale(a,d.targetGeometry,d.scale,d.camera,e,d.camera)?d:null}function N(a,b,c,d){d.targetGeometry=c.clone();var f=a.navigation.getCameraIntersectTerrain();t.internalToExternal(a,
f,d.camera);f={noReset:!1};B(d.camera,b)&&(f.noReset=!0);return t.fromExtent(a,c,d.camera,f,d.camera)?d:null}function J(a,b){if(!b||!a.spatialReference)return null;a={};if(null!=b.declaredClass||Array.isArray(b))a.target=b;else{for(var c in b)a[c]=b[c];b.center&&!a.target&&(a.target=b.center)}return a}function P(a){a&&(a.rotation=y(a.camera.heading));return g.resolve(a)}var I=f.vec3d,O=f.mat3d,ea=f.mat4d,W=I.create(),fa=I.create(),X=I.create(),aa={heading:0,tilt:0},R=I.create(),ia=ea.create(),ga=
O.create(),ha=r.create(),la=w.create(),da=new b;f=function(a,b,c){for(var d=a.hasZ,f=0;f<a.rings.length;f++)for(var e=a.rings[f],g=0;g<e.length;g++)c[0]=e[g][0],c[1]=e[g][1],d&&(c[2]=e[g][2]),b(c)};var Y={"esri.geometry.Point":function(a,b,c){c[0]=a.x;c[1]=a.y;a.hasZ&&(c[2]=a.z);b(c)},"esri.geometry.Polygon":f,"esri.geometry.Circle":f,"esri.geometry.Polyline":function(a,b,c){for(var d=a.hasZ,f=0;f<a.paths.length;f++)for(var e=a.paths[f],g=0;g<e.length;g++)c[0]=e[g][0],c[1]=e[g][1],d&&(c[2]=e[g][2]),
b(c)},"esri.geometry.Multipoint":function(a,b,c){var d=a.points;a=a.hasZ;for(var f=0;f<d.length;f++)c[0]=d[f][0],c[1]=d[f][1],a&&(c[2]=d[f][2]),b(c)},"esri.geometry.Extent":function(a,b,c){a.hasZ?(b(I.set3(a.xmin,a.ymin,a.zmin,c)),b(I.set3(a.xmax,a.ymin,a.zmin,c)),b(I.set3(a.xmin,a.ymax,a.zmin,c)),b(I.set3(a.xmax,a.ymax,a.zmin,c)),b(I.set3(a.xmin,a.ymin,a.zmax,c)),b(I.set3(a.xmax,a.ymin,a.zmax,c)),b(I.set3(a.xmin,a.ymax,a.zmax,c)),b(I.set3(a.xmax,a.ymax,a.zmax,c))):(b(I.set3(a.xmin,a.ymin,c[2],c)),
b(I.set3(a.xmax,a.ymin,c[2],c)),b(I.set3(a.xmin,a.ymax,c[2],c)),b(I.set3(a.xmax,a.ymax,c[2],c)))}},V={create:function(c,f){var l=J(c,f);if(!l)return g.reject(new h("viewpointutils-create:no-target","Missing target for creating viewpoint"));var n=new e({camera:new d({fov:c.camera.fov})}),q=null!=l.scale||null!=l.zoom||null!=l.distance;if(l.target instanceof e)return P(F(c,l.target,l,n));if(l.target instanceof d)return P(L(c,l,l.target,n));if(l.target instanceof a)return f=l.target.xmin===l.target.xmax||
l.target.ymin===l.target.ymax,q||f?P(Q(c,l,l.target.center,n)):P(N(c,l,l.target,n));var k={boundingBox:r.create(r.NEGATIVE_INFINITY),spatialReference:c.spatialReference,hasZ:!1};return E(c,l.target,k).then(function(){if(isFinite(k.boundingBox[0])){r.center(k.boundingBox,R);da.x=R[0];da.y=R[1];da.z=R[2];da.spatialReference=c.spatialReference;var a;isFinite(da.z)&&k.hasZ?a=r.isPoint(k.boundingBox):(da.z=void 0,a=w.isPoint(r.toRect(k.boundingBox,la)));if(q||a)return Q(c,l,da,n);var d=da,f=k.boundingBox,
e=V.DEFAULT_FRAME_COVERAGE;n.targetGeometry=d.clone();a=c.navigation.getCameraIntersectTerrain();var g=0;d.hasZ?g=d.z:c.basemapTerrain&&(g=c.basemapTerrain.getElevation(d));I.set3(d.x,d.y,g,R);u.computeLinearTransformation(c.spatialReference,R,ia,c.renderSpatialReference);ea.toMat3(ia,ga);O.transpose(ga);r.set(ha,r.NEGATIVE_INFINITY);for(var d=[[0,1,2],[3,1,2],[0,4,2],[3,4,2],[0,1,5],[3,1,5],[0,4,5],[3,4,5]],h=0;h<d.length;h++){var y=d[h],m=f[y[2]];isFinite(m)||(m=g);I.set3(f[y[0]],f[y[1]],m,R);u.vectorToVector(R,
c.spatialReference,R,c.renderSpatialReference);r.expand(ha,O.multiplyVec3(ga,R))}f=r.width(ha);g=r.height(ha);d=r.depth(ha);h=1/Math.tan(a.fovY/2);e=Math.max(.5*Math.sqrt(f*f+d*d)*Math.max(h,1/Math.tan(a.fovX/2))+.5*g,.5*g*h+.5*Math.max(f,d))/e;t.internalToExternal(c,a,n.camera);a={noReset:!1};B(n.camera,l)&&(a.noReset=!0);n.scale=t.distanceToScale(c,e,n.targetGeometry.latitude);a=t.fromCenterScale(c,n.targetGeometry,n.scale,n.camera,a,n.camera)?n:null;return a}a=c.navigation.getCameraIntersectTerrain();
C(c,null,l,a,n)?a=n:l.position?(I.set(a.viewForward,X),t.directionToHeadingTilt(c,a.eye,X,a.up,aa),n.camera.position=new b(l.position),a=n.camera,e=aa.heading,f=l.heading,null==f&&null!=l.rotation&&(f=x(l.rotation)),null==f&&e&&(f="function"===typeof e?e():e),a.heading=f,a=n.camera,e=aa.tilt,e=null!=l.tilt?l.tilt:null!=e?"function"===typeof e?e():e:void 0,a.tilt=e,a=D(c,null,n)):(a=u.vectorToPoint(a.center,c.renderSpatialReference,da,c.spatialReference),a=Q(c,l,a,n));return a}).then(function(a){return P(a)})},
rotationToHeading:x,headingToRotation:y,toCamera:z,fromCamera:function(a,b,c){c||(c=new e);c.camera=b.clone();return D(a,null,c)},fromInternalCamera:function(a,b,c){c||(c=new e({camera:new d}));t.internalToExternal(a,b,c.camera);return D(a,b,c)},DEFAULT_FRAME_COVERAGE:.66};return V})},"esri/views/3d/support/intersectionUtils":function(){define(["../lib/glMatrix"],function(m){function k(b,c,e,l){l.clip[0]=0;l.clip[1]=e?l.len:Number.MAX_VALUE;for(e=0;e<b.length;e++){var d;var g=b[e],h=c;d=l;var t=a.dot(g,
d.dir),h=-a.dot(h,g)-g[3];0>h&&0<=t?d=!1:-1E-6<t&&1E-6>t?d=!0:!(0>h||0>t)||0>h&&0>t?(h/=t,0<t?h<d.clip[1]&&(d.clip[1]=h):h>d.clip[0]&&(d.clip[0]=h),d=d.clip[0]<=d.clip[1]):d=!0;if(!d)return!1}return!0}function b(b,d,e,l){b?(e&&l&&(c.len=a.dist(d,e)),a.set(b,c.dir)):l?(c.len=a.dist(d,e),a.scale(a.subtract(e,d,c.dir),1/c.len)):a.normalize(a.subtract(e,d,c.dir));return c}var a=m.vec3d;m=m.vec2d;var c={dir:a.create(),len:0,clip:m.create()},h={planeSphere:function(a,b,c){return a[0]*b[0]+a[1]*b[1]+a[2]*
b[2]+a[3]<c},frustumSphere:function(a,b,c){for(var d=0;6>d;d++)if(!h.planeSphere(a[d],b,c))return!1;return!0},frustumRay:function(a,c,e,l){e=b(l,c,e,!1);return k(a,c,null,e)},frustumPoint:function(b,c){for(var d=0;6>d;d++){var g=b[d];if(0>-a.dot(c,g)-g[3])return!1}return!0},conservativeFrustumConvexBuffer:function(a,b,c,l,f){f=f||0;for(var d=0;6>d;d++){for(var e=(f+d)%6,g=!1,h=0;h<l;h++){var k=a[e],q=c+3*h;if(0<=-k[0]*b[q]-k[1]*b[q+1]-k[2]*b[q+2]-k[3]){g=!0;break}}if(!g)return e}return-1},frustumLineSegment:function(a,
c,e,l){l=b(l,c,e,!0);return k(a,c,e,l)}};return h})},"esri/views/3d/support/RenderCoordsHelper":function(){define(["./earthUtils","./projectionUtils","../lib/glMatrix","../webgl-engine/lib/BufferVectorMath","../../../geometry/support/scaleUtils"],function(m,k,b,a,c){var h=b.vec3,g=a.Vec3Compact,d=m.earthRadius,e=[0,0,1];m=function(a){this.spatialReference=a};m.prototype.toRenderCoords=function(a,b,c){return"esri.geometry.Point"===a.declaredClass?k.pointToVector(a,b,this.spatialReference):k.vectorToVector(a,
b,c,this.spatialReference)};m.prototype.fromRenderCoords=function(a,b,c){return"esri.geometry.Point"===b.declaredClass||"esri.SpatialReference"===b.declaredClass?k.vectorToPoint(a,this.spatialReference,b,c):k.vectorToVector(a,this.spatialReference,b,c)};b=function(a){this.spatialReference=a=a||k.SphericalRenderSpatialReference;this.unitInMeters=1};b.prototype=new m;b.prototype.getAltitude=function(a,b){return g.length(a,b||0)-d};b.prototype.setAltitude=function(a,b,c){c=c||0;a=(a+d)/g.length(b,c);
g.scale(b,c,a)};b.prototype.setAltitudeOfTransformation=function(a,b){this.setAltitude(a,b,12)};b.prototype.worldUpAtPosition=function(a,b){h.normalize(a,b)};a=function(a){this.spatialReference=a;this.unitInMeters=c.getUnitValueForSR(a);this.worldUp=e};a.prototype=new m;a.prototype.getAltitude=function(a,b){return b?a[b+2]:a[2]};a.prototype.setAltitude=function(a,b,c){c?b[c+2]=a:b[2]=a};a.prototype.setAltitudeOfTransformation=function(a,b){this.setAltitude(a,b,12)};a.prototype.worldUpAtPosition=function(a,
b){h.set(e,b)};a.worldUp=e;m.Spherical=b;m.Planar=a;return m})},"esri/views/3d/support/MapCoordsHelper":function(){define("dojo/Evented dojo/Deferred ../../../core/declare ../../../portal/support/geometryServiceUtils ../../../tasks/support/ProjectParameters ../../../geometry/SpatialReference ../../../geometry/Point ../../../geometry/support/scaleUtils".split(" "),function(m,k,b,a,c,h,g,d){return b(m,{unitInMeters:1,spatialReference:null,constructor:function(b,c,f){this.spatialReference=c;this.unitInMeters=
d.getUnitValueForSR(this.spatialReference);(this.geometryService=f)||a.create(b&&b.portalItem).then(function(a){this.geometryService=a}.bind(this)).otherwise(function(){})},toGeographic:function(a){var b=new k,d=!0,e=this.spatialReference;if(!this.geometryService)return b.reject("Must specify geometryService in esri/config"),b;Array.isArray(a[0])&&"number"!==typeof a[0]||(a=[a],d=!1);a.forEach(function(b,c){b instanceof g||(a[c]=new g(b,e))});var u=new c({geometries:a,outSR:h.WGS84});this.geometryService.project(u).then(function(a){try{a=
a.map(function(a){return[a.x,a.y]}),b.resolve(d?a:a[0])}catch(r){b.reject(r)}},function(a){b.reject(a)});return b.promise},canProject:function(){return!!this.geometryService}})})},"esri/portal/support/geometryServiceUtils":function(){define("require exports ../Portal ../PortalItem ../../config ../../tasks/GeometryService ../../core/promiseUtils ../../core/Error".split(" "),function(m,k,b,a,c,h,g,d){k.create=function(e){void 0===e&&(e=null);if(c.geometryServiceUrl)return g.resolve(new h({url:c.geometryServiceUrl}));
if(!e)return g.reject(new d("internal:geometry-service-url-not-configured"));var l;e.isInstanceOf(a)?l=e.portal||b.getDefault():e.isInstanceOf(b)&&(l=e);return l.load().then(function(a){if(a.helperServices&&a.helperServices.geometry&&a.helperServices.geometry.url)return g.resolve(new h({url:a.helperServices.geometry.url}));throw new d("internal:geometry-service-url-not-configured");})}})},"esri/views/3d/support/ResourceController":function(){define("../../../core/declare ../../../core/Scheduler ../../../core/HandleRegistry ../../../core/watchUtils ./StreamDataSupplier ./StreamDataLoader ./PreallocArray ../webgl-engine/lib/Util".split(" "),
function(m,k,b,a,c,h,g,d){function e(a){this.budget=this.begin=0;this.performance=d.performance;this.enabled=!0;void 0!==a&&this.reset(a)}var l=d.assert,f={TERRAIN:"terrain",SCENE:"scene",SYMBOLOGY:"symbols"},n=new g(20);e.prototype.now=function(){return this.performance.now()};e.prototype.reset=function(a){this.begin=this.now();this.budget=this.enabled?a:Number.MAX_VALUE};e.prototype.done=function(){return this.enabled&&this.elapsed()>=this.budget};e.prototype.remaining=function(){return Math.max(this.budget-
this.elapsed(),0)};e.prototype.elapsed=function(){return this.now()-this.begin};m=m(null,{constructor:function(c,g){this._clients=[];this._frameWorker=null;this._budget=new e;this._idleFrameWorkers=[];this._idleFrameWorkerRobin=0;this._idleUpdatesStartFired=!1;this._lastTargetChangeTime=d.performance.now();this.navigationTimeout=300;this.animatingFrameTimeBudget=10;this.idleFrameWorkerBudget=30;this.idleFrameTimeBudget=50;var l={},n;for(n in f)l[f[n]]=0;l[f.TERRAIN]=15;l[f.SCENE]=20;l[f.SYMBOLOGY]=
5;this._maxGpuMemory=1500;this.streamDataLoader=new h(l);this._cameraListeners=new b;this._cameraListeners.add([a.on(c,"navigation","currentViewReachedTarget",this._targetReached.bind(this)),a.on(c,"navigation","targetViewChanged",this._targetChanged.bind(this))]);g||(g=k);this._frameTask=g.addFrameTask({update:this._frameUpdate.bind(this)});this._view=c;this.stats={frameUpdateTime:new u,idleUpdateTime:new u};this.frameUpdateNavigation=null},destroy:function(){this._frameTask.remove();this._frameTask=
null;this._cameraListeners.remove();this.streamDataLoader.destroy();this.streamDataLoader=null},setEnableBudget:function(a){this._budget.enabled=!!a},registerClient:function(a,b,d){this._clients.push({client:a,type:b});"function"===typeof a.setMaxGpuMemory&&a.setMaxGpuMemory(this._maxGpuMemory);return new c(b,this.streamDataLoader,d)},deregisterClient:function(a){for(var b=0;b<this._clients.length;b++)if(this._clients[b].client===a){this._clients[b]=this._clients[this._clients.length-1];this._clients.pop();
return}console.warn("deregistering an unregistered client.")},setMaxGpuMemory:function(a){this._maxGpuMemory=a;for(var b=0;b<this._clients.length;b++){var c=this._clients[b].client;"function"===typeof c.setMaxGpuMemory&&c.setMaxGpuMemory(a)}},registerIdleFrameWorker:function(a,b){var c=this._idleFrameWorkers.some(function(b){return b.client===a});l(!c,"Can only register idle frame workers once per client/layer");l(!b.idleFrame||b.needsUpdate,"needsUpdate has to be specified if idleFrame is specified");
this._idleFrameWorkers.push({client:a,callbacks:b});this._isIdle()&&this._idleUpdatesStartFired&&b.idleBegin&&b.idleBegin.call(a)},deregisterIdleFrameWorker:function(a){for(var b=this._idleFrameWorkers,c=0;c<b.length;c++){var d=b[c];if(d.client===a){this._idleUpdatesStartFired&&d.callbacks.idleEnd&&d.callbacks.idleEnd.call(a);b[c]=b[b.length-1];b.pop();break}}},registerFrameWorker:function(a){l(!this._frameWorker,"Only one (non-idle) per-frame worker supported at the moment");this._frameWorker=a},
deregisterFrameWorker:function(){this._frameWorker=null},_targetChanged:function(a){this._lastTargetChangeTime=d.performance.now();this._targetReached=!1;this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._callWorkersNoScheduling("idleEnd"))},_targetReached:function(a){this._targetReached=!0},_frameUpdate:function(a){var b=this._isIdle();this._budget.reset((b?this.idleFrameWorkerBudget:this.animatingFrameTimeBudget)-a.spendInFrame);this._view.navigation&&this._view.navigation.step(a.deltaTime);
this._view.inputManager&&this._view.inputManager._pinchNavigation&&this._view.inputManager._pinchNavigation.momentum.doFrameUpdate(a.deltaTime);this._frameWorker&&(this._frameWorker(this._budget),this.stats.frameUpdateTime.addSample(this._budget.elapsed()));b&&(this._idleUpdatesStartFired||(this._callWorkersNoScheduling("idleBegin"),this._idleUpdatesStartFired=!0),this._budget.reset(this.idleFrameTimeBudget-this._budget.elapsed()),3<this._budget.remaining()&&(this._callWorkersStrictScheduling("idleFrame",
this._budget),this.stats.idleUpdateTime.addSample(this._budget.elapsed())))},_isIdle:function(){return this._budget.now()-this._lastTargetChangeTime>this.navigationTimeout&&this._targetReached},_callWorkersNoScheduling:function(a){for(var b=this._idleFrameWorkers,c=0;c<b.length;c++){var d=b[c];d.callbacks[a]&&d.callbacks[a].call(d.client)}},_callWorkersStrictScheduling:function(a,b){var c=this._idleFrameWorkers,d=c.length,f,e,g;n.clear();e=0;for(g=this._idleFrameWorkerRobin;e<d;e++)f=c[g++%d],f.callbacks.needsUpdate&&
f.callbacks.needsUpdate.call(f.client)&&(0===n.length&&(this._idleFrameWorkerRobin=g),n.push(f));f=b.now();for(c=f+b.remaining();0<n.length&&f<c;)b.reset((c-f)/n.length),f=n.pop(),f.callbacks[a].call(f.client,b),f=b.now()}});m.ClientType=f;var u=function(){this.addSample=function(a){this.min=Math.min(this.min,a);this.max=Math.max(this.max,a);this.total+=a;this.numSamples++};this.getAverage=function(){return this.total/this.numSamples};this.reset=function(){this.numSamples=this.total=0;this.min=Number.MAX_VALUE;
this.max=-Number.MAX_VALUE};this.reset()};return m})},"esri/views/3d/support/StreamDataSupplier":function(){define(["require","exports"],function(m,k){return function(){function b(a,b,h){this._clientType=a;this._loader=b;this._activeRequests=null;this._addUrlToken=h&&h.addUrlToken;h&&h.trackRequests&&(this._activeRequests=new Map)}b.prototype.request=function(a,b,h){var c=this;b=this._loader.request(a,b,this._clientType,h,this._addUrlToken);this._activeRequests&&(this._activeRequests.set(a,b),h=function(){c._activeRequests.delete(a)},
b.then(h,h));return b};b.prototype.isRequested=function(a){return this._loader.isRequested(a)};b.prototype.cancelRequest=function(a){this._loader.cancel(a)};b.prototype.cancelAll=function(){var a=this;this._activeRequests&&(this._activeRequests.forEach(function(b){a._loader.cancel(b)}),this._activeRequests.clear())};return b}()})},"esri/views/3d/support/StreamDataLoader":function(){define("../../../core/declare ../../../request ../../../core/urlUtils ./PromiseLightweight ./AsyncQuotaRoundRobinQueue ../webgl-engine/lib/Util".split(" "),
function(m,k,b,a,c,h){var g=h.assert,d={QUEUED:1,DOWNLOADING:2,CANCELLED:4};m=m(null,{constructor:function(a){this.alreadyLoading={};this.loadQueue=new c(l,this._doneLoadingCallback,this,a);this._urlInfo={hasSameOrigin:{},canUseXhr:{}}},destroy:function(){for(var a in this.alreadyLoading){for(var b=this.alreadyLoading[a],c=0;c<b.clientPromises.length;c++){var d=b.clientPromises[c];d.isRejected()||d.reject(b.url.url,null,b.docType,b.clientMetadata[c])}this._cancelTask(b)}this.loadQueue.clear();this.alreadyLoading=
this.loadQueue=null},request:function(b,c,e,g,h){g=g||{};var f=new a.Promise;f.requestURL=b;var l=this.alreadyLoading[b];l?(l.clientPromises.push(f),l.clientMetadata.push(g.metadata)):(l={url:{url:null,normalized:null,normalizedWithToken:null,hasSameOrigin:!1,canUseXhr:!1},docType:c,clientType:e,status:d.QUEUED,clientMetadata:[g.metadata],clientPromises:[f],downloadObj:null,_cancelledInQueue:!1},this._prepareUrl(l,b,h),this.alreadyLoading[b]=l,this.loadQueue.push(l));return f},isRequested:function(a){return void 0!==
this.alreadyLoading[a]},cancel:function(a){var b=this.alreadyLoading[a.requestURL];b&&this._removeRequestPromiseFromTask(b,a)},hasPendingDownloads:function(){return!h.objectEmpty(this.alreadyLoading)},_prepareUrl:function(a,c,d){a.url.url=c;a.url.isData=b.isDataProtocol(c);if(a.url.isData||"image"!==a.docType)a.url.normalized=c,!a.url.isData&&d&&(a.url.normalizedWithToken=d(c));else{c=b.normalize(c);a.url.normalized=c;var f=b.getOrigin(c);d&&(a.url.normalizedWithToken=d(c));c=this._urlInfo.hasSameOrigin[f];
void 0!==c?a.url.hasSameOrigin=c:(a.url.hasSameOrigin=b.hasSameOrigin(f,window.location.href),this._urlInfo.hasSameOrigin[f]=a.url.hasSameOrigin);a.url.hasSameOrigin||(c=this._urlInfo.canUseXhr[f],void 0!==c?a.url.canUseXhr=c:(a.url.canUseXhr=b.canUseXhr(f),this._urlInfo.canUseXhr[f]=a.url.canUseXhr))}},_removeRequestPromiseFromTask:function(a,b){var c=a.clientPromises.length;1<c?(b=a.clientPromises.indexOf(b),g(-1<b,"request to be cancelled is already cancelled or invalid"),a.clientPromises[b]=a.clientPromises[c-
1],a.clientPromises.pop(),a.clientMetadata[b]=a.clientMetadata[c-1],a.clientMetadata.pop()):(g(a.clientPromises[0]===b,"request to be cancelled is already cancelled or invalid"),this._cancelTask(a))},_cancelTask:function(a){if(a.status===d.DOWNLOADING){this.loadQueue.workerCancelled(a);if("image"===a.docType&&a.url.isData){var b=a.downloadObj;b.removeAttribute("onload");b.removeAttribute("onerror");b.removeAttribute("src")}else a.status=d.CANCELLED,a.downloadObj.cancel();a.downloadObj=null}a.status=
d.CANCELLED;a.clientPromise=void 0;a.metadata=void 0;delete this.alreadyLoading[a.url.url]},_doneLoadingCallback:function(a,b){var c;g(a.status===d.DOWNLOADING);delete this.alreadyLoading[a.url.url];if(b)for(c=0;c<a.clientPromises.length;c++)a.clientPromises[c].isRejected()||a.clientPromises[c].reject(a.url.url,b,a.docType,a.clientMetadata[c]);else for(c=0;c<a.clientPromises.length;c++)a.clientPromises[c].done(a.url.url,a.result,a.docType,a.clientMetadata[c])}});var e=function(a,b,c){a.onload=function(){b.status!==
d.CANCELLED&&(b.result=a,a.removeAttribute("onload"),a.removeAttribute("onerror"),c(b))};a.onerror=function(){b.status!==d.CANCELLED&&(a.removeAttribute("onload"),a.removeAttribute("onerror"),c(b,{status:404}))}},l=function(a,b){if(a.status===d.CANCELLED)return!1;a.status=d.DOWNLOADING;if("image"===a.docType&&a.url.isData){var c=new Image;e(c,a,b);c.src=a.url.normalized;a.downloadObj=c;return!0}var f;switch(a.docType){case "binary":f="array-buffer";c=0;break;case "image":f="image";break;default:f=
"json"}a.downloadObj=k(a.url.normalizedWithToken||a.url.normalized,{responseType:f,timeout:c,failOk:!0,crossOrigin:!a.url.hasSameOrigin||a.url.canUseXhr,allowImageDataAccess:"image"===a.docType});a.downloadObj.then(function(c){a.duration=h.performance.now()-a.startTime;a.size=0;a.result=c.data;b(a)},function(c){a.downloadObj.isCanceled()||b(a,c)});return!0};m.TaskStatus=d;return m})},"esri/views/3d/support/AsyncQuotaRoundRobinQueue":function(){define(["../../../core/arrayUtils","../webgl-engine/lib/Util"],
function(m,k){return function(b,a,c,h,g){function d(){return"workers: "+n+", queues: "+f.map(function(a){return a.length})}var e=0,l={},f=[],n=[],u=[],t=[],r=0,w=0,q;for(q in h)f[e]=[],n[e]=0,t[e]={requests:0,size:0,duration:0,speed:0},u[e]=h[q],l[q]=e++,w+=h[q];var x=f.length,e=0;this.setWorkerQuota=function(a){k.assert(m.equals(Object.keys(this.typeWorkerAllication),Object.keys(a)));this.typeWorkerAllication=a;w=0;for(var b in a)u[l[b]]=a[b],w+=a[b]};this.setWorkerFunc=function(a){b=a};this.push=
function(a){var c=l[a.clientType];r<w?(n[c]++,r++,g&&console.log("queue start type "+c+", "+d()),b(a,A)):(f[c].push(a),g&&console.log("queue push type "+c+", "+d()))};this._getStatsForType=function(a){a=l[a];return{quota:u[a],workers:n[a],queueSize:f[a].length,requestStats:t[a]}};this.removeTasks=function(a,b){for(var c=[],d=f[l[b]],e=0;e<d.length;e++){var g=d[e];-1<a.indexOf(g)||c.push(g)}f[l[b]]=c};this.workerCancelled=function(a){y(a);a._cancelledInQueue=!0};this.clear=function(){for(var a=0;a<
f.length;a++)f[a]=[]};var y=function(a){var b=l[a.clientType];n[b]--;r--;t[b].requests++;t[b].size+=a.size||0;t[b].duration+=a.duration||0;t[b].speed=0<t[b].duration?t[b].size/t[b].duration:0;k.assert(0<=n[b]);a=e;b=!1;do n[a]<u[a]&&z(a)&&(b=!0),a=(a+1)%x;while(!b&&a!=e);if(!b){do z(a)&&(b=!0),a=(a+1)%x;while(!b&&a!=e)}!b&&g&&console.log("queue sink, "+d());e=a},z=function(a){for(;0<f[a].length;){if(b(f[a].shift(),A))return g&&console.log("queue startqueued clientType "+a+", "+d()),n[a]++,r++,!0;
g&&console.log("queue task cancelled, "+d())}return!1},A=function(b){b._cancelledInQueue||(a.apply(c,arguments),y(b))}}})},"esri/views/3d/support/PreallocArray":function(){define(["../../../core/declare","./HeapSort"],function(m,k){return m([],{constructor:function(b,a){this.data=Array(b);this.length=0;if(a){for(var c=0;c<b;c++)this.data[c]=a(c);this._allocator=a;this._hasAllocator=!0}else this._allocator=this._nullAllocator,this._hasAllocator=!1},_nullAllocator:function(){return null},grow:function(b){for(;this.data.length<
b;)this.data.push(this._allocator(this.data.length))},next:function(){if(!this._hasAllocator)return null;this.data.length===this.length&&this.grow(2*this.length);return this.data[this.length++]},swap:function(b,a){var c=this.data[b];this.data[b]=this.data[a];this.data[a]=c},push:function(b){this.data.length===this.length&&this.grow(2*this.length);this.data[this.length++]=b},pushArray:function(b){var a=this.length+b.length;a>=this.data.length&&this.grow(Math.max(2*this.length,a));for(a=0;a<b.length;a++)this.data[this.length++]=
b[a]},pushEither:function(b){Array.isArray(b)?this.pushArray(b):this.push(b)},pop:function(){if(0===this.length)return null;var b=this.data[--this.length];this._hasAllocator||(this.data[this.length]=null);return b},slice:function(b,a){void 0===a&&(a=this.length);return this.data.slice(b,a)},clear:function(){if(!this._hasAllocator)for(var b=0;b<this.length;b++)this.data[b]=null;this.length=0},peek:function(){return 0===this.length?null:this.data[this.length-1]},sort:function(b){k.sort(this.data,0,
this.length,b);return this}})})},"esri/views/3d/support/HeapSort":function(){define([],function(){function m(b,a,c,h){for(var g=a,d=c>>>1,e=b[g-1];a<=d;){a=g<<1;a<c&&0>h(b[a-1],b[a])&&++a;var l=b[a-1];if(0>=h(l,e))break;b[g-1]=l;g=a}b[g-1]=e}function k(b,a){return b<a?-1:b>a?1:0}return{sort:function(b,a,c,h){void 0===a&&(a=0);void 0===c&&(c=b.length);void 0===h&&(h=k);for(var g=c>>>1;g>a;g--)m(b,g,c,h);for(var d=a+1,g=c-1;g>a;g--)c=b[a],b[a]=b[g],b[g]=c,m(b,d,g,h);return b}}})},"esri/views/3d/support/DisplayQualityProfile":function(){define(["require",
"exports","../../../core/sniff"],function(m,k,b){var a={low:{sceneService:{"3dObject":{lodFactor:.2},point:{lodFactor:1},integratedMesh:{lodFactor:.6},pointCloud:{lodFactor:.5}},tiledSurface:{lodBias:-1,angledSplitBias:.5},antialiasingEnabled:!1},high:{sceneService:{"3dObject":{lodFactor:1},point:{lodFactor:1},integratedMesh:{lodFactor:1},pointCloud:{lodFactor:1}},tiledSurface:{lodBias:0,angledSplitBias:1},antialiasingEnabled:!0}};return function(){function c(){}c.isValidProfile=function(b){return b in
a};c.getDefaultProfile=function(){return b("trident")||b("safari")?"low":"high"};c.apply=function(b,c){b=a[b];c.qualitySettings.sceneService["3dObject"].lodFactor=b.sceneService["3dObject"].lodFactor;c.qualitySettings.sceneService.point.lodFactor=b.sceneService.point.lodFactor;c.qualitySettings.sceneService.integratedMesh.lodFactor=b.sceneService.integratedMesh.lodFactor;c.qualitySettings.sceneService.pointCloud.lodFactor=b.sceneService.pointCloud.lodFactor;c.qualitySettings.tiledSurface.lodBias=
b.tiledSurface.lodBias;c.qualitySettings.tiledSurface.angledSplitBias=b.tiledSurface.angledSplitBias;c.qualitySettings.antialiasingEnabled=b.antialiasingEnabled};return c}()})},"esri/views/3d/support/QualitySettings":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/typescript ../../../core/Accessor".split(" "),function(m,k,b,a,c,h){var g=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}
b(c,a);return c}(h);a([c.property({value:1})],g.prototype,"lodFactor",void 0);var g=a([c.subclass()],g),d=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}b(c,a);c.prototype.getDefaults=function(){return{"3dObject":new g,point:new g,integratedMesh:new g,pointCloud:new g}};return c}(h);a([c.property()],d.prototype,"3dObject",void 0);a([c.property()],d.prototype,"point",void 0);a([c.property()],d.prototype,"integratedMesh",void 0);a([c.property()],d.prototype,"pointCloud",void 0);
var d=a([c.subclass()],d),e=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}b(c,a);return c}(h);a([c.property({value:0})],e.prototype,"lodBias",void 0);a([c.property({value:1})],e.prototype,"angledSplitBias",void 0);e=a([c.subclass()],e);m=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}b(c,a);c.prototype.getDefaults=function(){return{sceneService:new d,tiledSurface:new e,antialiasingEnabled:!0}};return c}(h);a([c.property()],m.prototype,"sceneService",
void 0);a([c.property()],m.prototype,"tiledSurface",void 0);a([c.property()],m.prototype,"antialiasingEnabled",void 0);return m=a([c.subclass()],m)})},"esri/core/accessorSupport/typescript":function(){define(["../declare","../typescript","../JSONSupport","dojo/_base/lang"],function(m,k,b,a){function c(a,b){if(!a)return b;if(!b)return a;for(var d in b){var e=a[d],g=b[d];Array.isArray(g)&&Array.isArray(e)?a[d]=e.concat(g):a[d]="object"===typeof g&&"object"===typeof e?c(e,g):g}return a}return{subclass:function(h,
g){return function(d){d=k.declareDefinition(d,h);e&&(d.instanceMembers.properties=c(e,d.instanceMembers.properties));var e=d.instanceMembers.properties;if(e)for(var g in e){var f=e[g];f&&!f.reader&&f.type&&(f.type===Date?f.reader=function(a){return null!=a?new Date(a):null}:-1!==f.type._meta.bases.indexOf(b)&&(f.reader=function(a){return function(b){return a.fromJSON(b)}}(f.type)))}return a.mixin(m(d.bases,d.instanceMembers),d.classMembers)}},shared:k.shared,property:function(a){return function(b,
c){var d=Object.getPrototypeOf(b),d=d&&d.properties;b.properties&&b.properties!==d||(b.properties={});b.properties=b.properties||{};b.properties[c]=a||{}}}}})},"esri/core/typescript":function(){define(["./declare","dojo/_base/lang"],function(m,k){var b={declareDefinition:function(a,b){var c=[],g=Object.getPrototypeOf(a.prototype),d;if(g!==Object.prototype){var e=g.constructor;d=e.prototype;c.push(e)}b&&(c=c.concat(b));b={};for(var e=Object.getOwnPropertyNames(a.prototype),l=0;l<e.length;l++){var f=
e[l];if("constructor"!==f){var n=f;"dojoConstructor"===f&&(n="constructor");d&&a.prototype[f]===d[f]||(b[n]=a.prototype[f])}}e=Object.getOwnPropertyNames(a);g=Object.getOwnPropertyNames(g.constructor);d={};for(l=0;l<e.length;l++)f=e[l],-1===g.indexOf(f)&&(d[f]=a[f]);return{bases:c,instanceMembers:b,classMembers:d}},subclass:function(a){return function(c){c=b.declareDefinition(c,a);return k.mixin(m(c.bases,c.instanceMembers),c.classMembers)}},shared:function(a){return function(b,h){b[h]=a}}};return b})},
"esri/views/3d/support/SharedSymbolResources":function(){define("require exports dojo/io-query ./TextureCollection ./ResourceController ../../../identity/IdentityManager".split(" "),function(m,k,b,a,c,h){return function(){function g(b,e){var d=this;this.streamDataSupplier=this.textures=null;this.tokens={};var f=c.ClientType.SYMBOLOGY;this.resourceController=e;this.streamDataSupplier=e.registerClient(this,f,{addUrlToken:function(a){return d.addUrlToken(a)}});this.textures=new a(this.streamDataSupplier,
b,{wrapClamp:!0})}g.prototype.destroy=function(){this.resourceController.deregisterClient(this);this.streamDataSupplier=this.textures=null};g.prototype.addUrlToken=function(a){if(0===a.indexOf("data:"))return a;var c=a.match(/^(((?:https?:)?\/\/[^\/]+).*?)(?:\?(.*))?$/);if(!c)return a;var d=c[1],f=c[2],c=b.queryToObject(c[3]||"");"token"in c||(null==this.tokens[f]&&(a=h.findCredential(a),this.tokens[f]=a&&a.token||""),this.tokens[f]&&(c.token=this.tokens[f]));return(f=b.objectToQuery(c))?d+"?"+f:
d};return g}()})},"esri/views/3d/support/TextureCollection":function(){define("../../../core/declare dojo/Deferred dojo/_base/lang ../webgl-engine/Stage ../webgl-engine/lib/Texture ../webgl-engine/lib/Util".split(" "),function(m,k,b,a,c,h){var g=h.assert;return m(null,{constructor:function(a,b,c){this._streamDataSupplier=a;this._stage=b;this._textureRecords={};this._loadedHandler=this._loadedHandler.bind(this);this._errorHandler=this._errorHandler.bind(this);this._textureOptions=c||{}},acquire:function(b,
c){var d;if(d=this._textureRecords[b])return d.referenceCount++,d.texture||d.clientDfd;if(c)return c=c(b),this._stage.add(a.ModelContentType.TEXTURE,c),d={texture:c,referenceCount:1},this._textureRecords[b]=d,c;d=new k;c=this._streamDataSupplier.request(b,"image");this._textureRecords[b]={clientDfd:d,loaderDfd:c,texture:null,referenceCount:1};c.then(this._loadedHandler,this._errorHandler);return d.promise},release:function(b){var c=this._textureRecords[b];c?(1>c.referenceCount&&console.warn("TextureCollection: reference count is \x3c 1 for "+
b),c.referenceCount--,1>c.referenceCount&&(c.texture?(this._stage.remove(a.ModelContentType.TEXTURE,c.texture.getId()),c.texture=null):this._streamDataSupplier.cancelRequest(c.loaderDfd),delete this._textureRecords[b])):console.warn("TextureCollection: texture doesn't exist: "+b)},isInUse:function(a){a=this._textureRecords[a];g(!a||0<a.referenceCount,"texture record with zero reference count");return!!a},_loadedHandler:function(d,e,h){d=this._textureRecords[d];g(d&&!d.texture);h=b.mixin({width:e.width,
height:e.height},this._textureOptions);e=new c(e,"symbol",h);this._stage.add(a.ModelContentType.TEXTURE,e);d.texture=e;d.clientDfd.resolve(e)},_errorHandler:function(a){a=this._textureRecords[a];g(a&&!a.texture);a.clientDfd.reject()}})})},"esri/views/3d/support/debugFlags":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/typescript ../../../core/Accessor".split(" "),function(m,k,b,a,c,h){m=function(a){function c(){return null!==
a&&a.apply(this,arguments)||this}b(c,a);return c}(h);a([c.property({value:!1})],m.prototype,"SCENEVIEW_HITTEST_RETURN_SELECTOR",void 0);m=a([c.subclass()],m);return new m})},"esri/views/3d/terrain/TerrainSurface":function(){define("../../../core/declare ../../../core/Accessor ../../../core/arrayUtils ../../../core/Logger ../../../core/watchUtils ../../../core/CollectionFlattener dojo/Evented dojo/on ../lib/glMatrix ../support/projectionUtils ../support/ResourceController ../support/PromiseLightweight ../../../geometry/support/webMercatorUtils ./TerrainRenderer ./OverlayManager ./SurfaceExtentHelper ./SurfaceTilingSchemeLogic ./terrainUtils ./tileUtils ./TerrainConst ./TileGeometryFactory ./SphericalTile ./PlanarTile ./TilemapOnlyTile ./MapTileAgent ./ElevationTileAgent ../support/PreallocArray ../../../core/ObjectPool ../support/aaBoundingRect ../support/mathUtils".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f,n,u,t,r,w,q,x,y,z,A,C,B,D,H,K,E,F,L,Q){function N(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]}var J=e.vec3d,P=e.vec4d,I=e.mat4d,O=x.weakAssert,ea=a.getLogger("esri.views.3d.terrain"),W=z.MAX_ROOT_TILES,fa=80/180*Math.PI,X=z.TileUpdateTypes,aa=P.create(),R=[0,0,0],ia=Array(10),ga=[null],ha={spatialReference:null,tile:null},la={spatialReference:null,extent:null},da={spatialReference:null,extent:null,scale:0},Y=[-Infinity,-Infinity,Infinity,Infinity],V=function(a){a.remove()},
ba=m([k,g],{properties:{ready:{readOnly:!0,get:function(){return!!this.rootTiles}},rootTiles:{readOnly:!0},manifold:{readOnly:!0},tilingScheme:{readOnly:!0},tilingSchemeLogic:{readOnly:!0},tilingSchemeLocked:{readOnly:!0,aliasOf:"tilingSchemeLogic.tilingSchemeLocked"},spatialReference:{readOnly:!0,dependsOn:["tilingScheme"],aliasOf:"tilingScheme.spatialReference"},overlayManager:{value:null},wireframe:{value:!1},opacity:1,cullBackFaces:!1,renderOrder:1,skirts:!0,frontMostTransparent:!1,tileBackground:"data:image/png;base64,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",
velvetOverground:!0,extent:{},loaded:!1},defaultTileBackground:"data:image/png;base64,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",
constructor:function(){this._set("rootTiles",null);this._iteratorPool=new F(y.IteratorPreorder);this._postorderIterator=new y.IteratorPostorder;this._topLevelTilemapOnlyTiles=Array(z.TILEMAP_SIZE_EXP+1);for(a=0;a<this._topLevelTilemapOnlyTiles.length;a++)this._topLevelTilemapOnlyTiles[a]=new D([a-z.TILEMAP_SIZE_EXP,0,0]);this._dataExtent=this._clippingExtent=null;this._rootExtent=[0,0,0,0];this.notifyChange("extent");this._elevationBounds=[0,0];this._frameUpdateLowerPrio=new E(500);this.maxTextureScale=
1.2;this._stage=this._view._stage;this._updateNextFrame=this._lvPendingUpdates=this._pendingUpdates=this.suspended=this.visible=!1;this._curOverlayOpacity=1;this._curEyePos=J.create();this._curSplitLimits=[0,0,0,0,0,0];this._curFrustumPlanes=Array(6);this._viewProjectionMatrix=I.identity();for(var a=0;6>a;++a)this._curFrustumPlanes[a]=P.create();this.tilemapStats={tilemapRequestsSent:0,tilemapRequestsPending:0,tilemapRequestErrors:0,fullTilemaps:0,emptyTilemaps:0,tilesRequested:0,tileRequestsSent:0,
tileRequestErrors:0,tilesNotPresent:0};this._layerViews=[[],[]];this._layerIndexByLayerViewId=[{},{}];this._basemapLayerViewHandles={};this._groupLayerViewHandles={};this._layerViewChangesHandle=null;this.hideSkirtsDistanceFromExtentMargin=1.2;this.hideSkirtsMinimumCameraTilt=fa},normalizeCtorArgs:function(a,b){this._view=a;this._set("manifold",b);this.TileClass="planar"===b?B:C;return{}},initialize:function(){this._renderer=new t(this.manifold);this._renderer.loaded=this._setLoaded.bind(this);this._renderer.updateTileBackground(this.tileBackground);
this._renderer.install(this._view._stage);this.overlayManager=new r(this,this._view);this.extentHelper=new ("spherical"===this.manifold?w.SurfaceExtentHelperGlobal:w.SurfaceExtentHelperLocal)({layers:this._view.map.allLayers,layerViews:this._view.allLayerViews,spatialReference:this._view.spatialReference});var a;a=this._view.defaultsFromMap?new h({root:this._view.map,rootCollectionNames:this._view.defaultsFromMap.mapCollectionPaths,getChildrenFunction:function(a){return a.layers}}):this._view.map.allLayers;
this._set("tilingSchemeLogic",new q({layers:a,extentHelper:this.extentHelper,manifold:this.manifold,viewSpatialReference:this._view.spatialReference}));this.tilingSchemeLogic.watch("tilingScheme",this._updateTilingSchemeAndExtent.bind(this),!0);this.tilingSchemeLogic.watch("extent",this._updateTilingSchemeAndExtent.bind(this),!0);this._updateTilingSchemeAndExtent();this._streamDataSupplier=this._view.resourceController.registerClient(this,f.ClientType.TERRAIN);this._idleWorkers={needsUpdate:this._needsIdleUpdate,
idleFrame:this._idleUpdate};this._view.resourceController.registerFrameWorker(this._frameUpdate.bind(this));this._view.resourceController.registerIdleFrameWorker(this,this._idleWorkers);this._viewChangeListenerHandles=[];this._viewChangeUpdate=this._viewChangeUpdate.bind(this);this._viewChangeListenerHandles.push(this._view.on("resize",this._viewChangeUpdate));this._viewChangeListenerHandles.push(c.on(this._view,"navigation","currentViewChanged",this._viewChangeUpdate));this._viewChangeListenerHandles.push(this._view.watch("qualitySettings.tiledSurface.lodBias",
this._viewChangeUpdate));this._layerViewChangesHandle=this._view.allLayerViews.on("change",this._handleLayerViewChanges.bind(this));this._handleLayerViewChanges({added:this._view.allLayerViews.toArray(),removed:[],moved:[]});this._clippingChangedHandle=this._view.watch("clippingArea",this._clippingChanged.bind(this));this._updateClippingExtent()},destroy:function(){this._removeAllTiles();this.tilingSchemeLogic.destroy();this._set("tilingSchemeLogic",null);this.extentHelper.destroy();this.extentHelper=
null;for(var a in this._basemapLayerViewHandles)this._unregisterTiledLayerView(a);this._view.resourceController.deregisterFrameWorker(this);this._view.resourceController.deregisterIdleFrameWorker(this);this._view.resourceController.deregisterClient(this);this._viewChangeListenerHandles.forEach(V);for(var b in this._groupLayerViewHandles)this._groupLayerViewHandles[b].forEach(V);this._layerViewChangesHandle.remove();this._clippingChangedHandle.remove();this.overlayManager&&(this.overlayManager.destroy(),
this.overlayManager=null);this._renderer.uninstall(this._stage);this._streamDataSupplier=this._stage=this._view=this._renderer=null},setVisibility:function(a){a!==this.visible&&(this.visible=a,this._renderer.setVisibility(a),this.setUpdatesDisabled(!a),a&&this._viewChangeUpdate())},isVisible:function(){return this.visible&&this.ready},setUpdatesDisabled:function(a){(this.suspended=a)||this._viewChangeUpdate()},getElevation:function(a){return this.ready&&0!==this.rootTiles[0].layerInfo[z.LayerClass.ELEVATION].length?
Array.isArray(a)?this._getElevation(a):l.pointToVector(a,aa,this.tilingScheme.spatialReference)?this._getElevation(aa):(ea.error("TerrainSurface.getElevation(): could not project given point to tiling scheme coordinate system"),null):null},_getElevation:function(a){var b=z.LayerClass.ELEVATION,c=this.rootTiles[0].layerInfo[b].length,d;ia.length<c&&(ia.length=c);for(var f=0;f<this.rootTiles.length;f++){var e=this.rootTiles[f];if(y.isPosWithinTile(e,a))for(;e;){var g=e.layerInfo[b];for(d=0;d<c;d++)g[d].data&&
(ia[d]=g[d].data.samplerData);if(!e.children[0])break;d=0;a[0]>e.children[0].extent[2]&&(d+=1);a[1]<e.children[0].extent[1]&&(d+=2);e=e.children[d]}}a=A.elevationSampler(a[0],a[1],ia);for(d=0;d<c;d++)ia[d]=void 0;return a},getElevationBounds:function(){return this._elevationBounds},getScale:function(a){if(this.tilingScheme){if(!l.pointToVector(a,aa,this.spatialReference))return ea.error("TerrainSurface.getElevation(): could not project given point to tiling scheme coordinate system"),null;if(this.rootTiles)for(var b=
0;b<this.rootTiles.length;b++)if(a=this.rootTiles[b],y.isPosWithinTile(a,aa)){for(;a.children[0];)b=0,aa[0]>a.children[0].extent[2]&&(b+=1),aa[1]<a.children[0].extent[1]&&(b+=2),a=a.children[b];return this._getLodBiasCorrectedScale(a.lij[0])}}return 1E100},queryVisibleScaleRange:function(a,b,c,d){b=b?this.tilingScheme.levelAtScale(b):0;c=c?this.tilingScheme.levelAtScale(c):Infinity;var f=this._getLodBias();this._renderer.queryVisibleLevelRange(a,b+f,c+f,d)},_setLoaded:function(){this.loaded||(this.loaded=
!0,this.emit("load"))},_updateTilingSchemeAndExtent:function(){var a=this.tilingSchemeLogic.extent,b=this.tilingSchemeLogic.tilingScheme,c=!1;a&&!L.equals(a,this._dataExtent)&&(c=!0,this._dataExtent?L.set(this._dataExtent,a):this._dataExtent=L.create(a));b!=this.tilingScheme&&(O(b,"tiling scheme cannot be reset to undefined"),c=!0,this.tilingScheme&&this._removeAllTiles(),this._set("tilingScheme",b),this._updateClippingExtent(),b&&(this._updateTiledLayers(),this._renderer.setTileSize(b.pixelSize[0]),
this.overlayManager.setSpatialReference(b.spatialReference,"spherical"===this.manifold)));c&&this._updateRootTiles()},_acquireTile:function(a,b,c,d){var f=this.TileClass.Pool.acquire();R[0]=a;R[1]=b;R[2]=c;f.init(R,d,this,this.tilingScheme);return f},_releaseTile:function(a){a.dispose();a.parent=null;a.parentSurface=null;this.TileClass.Pool.release(a)},_updateRootTiles:function(){var a=this._clippingExtent||this._dataExtent,c=this.tilingScheme;if(a&&c){var d=c.rootTilesInExtent(a,aa,Infinity);if(this.rootTiles){if(d.length>
W){ea.warn(ba.TOO_MANY_ROOT_TILES_AFTER_CHANGE);return}var a=this.rootTiles.map(function(a){return a.lij}),f=b.difference(a,d,N);if(0<f.removed.length||0<f.added.length){var e=this.rootTiles.filter(function(a){return-1<b.findIndex(f.removed,N.bind(null,a.lij))?(this._purgeChildTiles(a),this._purgeTile(a),!1):!0}.bind(this));f.added.forEach(function(a){a=this._acquireTile(0,a[1],a[2],null);e.push(a);this._loadTile(a)}.bind(this));this._set("rootTiles",e);this._renderer.setRootTiles(this.rootTiles)}}else d.length>
W&&(ea.warn(ba.TOO_MANY_ROOT_TILES_FOR_LAYER_ERROR),d=c.rootTilesInExtent(a,aa,W)),this._set("rootTiles",d.map(function(a){a=this._acquireTile(0,a[1],a[2],null);this._loadTile(a);return a}.bind(this))),this._renderer.setRootTiles(this.rootTiles);b.equals(aa,this._rootExtent)||(this._rootExtent=P.create(aa),this._hasFixedExtent()||this.notifyChange("extent"));this.setVisibility(!0);this._viewChangeUpdate();this.notifyChange("ready")}},_viewChangeUpdate:function(){this._stage&&!this.suspended&&this.tilingScheme&&
this.visible&&(this._updateViewDependentParameters(),this._updateOverlayOpacity(this._curEyePos),this._updateTiles(this.rootTiles),this.overlayManager&&this.overlayManager.setOverlayDirty())},_hasVisibleSiblings:function(a){Array.isArray(a)||(ga[0]=a,a=ga);for(var b=0;b<a.length;b++){var c=a[b],d=c.parent;if(d)for(var f=0;4>f;f++){var e=d.children[f];if(e&&e!==c&&e.visible)return!0}}return!1},_updateTiles:function(a){var b=this._iteratorPool.acquire();b.reset(a);var c=this._curSplitLimits,f=this._curFrustumPlanes,
e=this._curEyePos,g;this._hasVisibleSiblings(a)?(a=this._elevationBounds[0],g=this._elevationBounds[1]):(a=Infinity,g=-Infinity);for(;!b.done;){var h=b.next();h.updateClippingStatus(this._clippingExtent);var l=!0;if(h.updateVisibility(f,e)){h.updateScreenDepth(this._viewProjectionMatrix);h.renderData&&(a=Math.min(h.elevationBounds[0],a),g=Math.max(h.elevationBounds[1],g));var n=h.shouldSplit(c,e);n===X.SPLIT?(h.pendingUpdates&=~X.MERGE,h.renderData?(l=!1,h.pendingUpdates|=X.SPLIT,b.skip()):l=!1):
(h.pendingUpdates&=~X.SPLIT,n===X.VSPLITMERGE&&h.updateAgents(z.LayerClass.ELEVATION),b.skip())}else b.skip();if(l&&!h.renderData){h.pendingUpdates|=X.MERGE;h.pendingUpdates&=~X.SPLIT;l=this._iteratorPool.acquire();for(l.reset(h);!l.done;)n=l.next(),n.updateVisibility(f,e),n.visible&&n.updateScreenDepth(this._viewProjectionMatrix);this._iteratorPool.release(l)}0!==h.pendingUpdates&&(this._pendingUpdates=!0)}this._iteratorPool.release(b);isFinite(a)&&isFinite(g)&&(this._elevationBounds[0]!==a||this._elevationBounds[1]!==
g)&&(this._elevationBounds[0]=a,this._elevationBounds[1]=g,d.emit(this,"elevation-bounds-change"))},_viewParamSelector:{projectionMatrix:!0,fovX:!0,viewport:!0},_updateViewDependentParameters:function(){var a=this._view.navigation.currentCamera,b=Math.tan(.5*a.fovX),c=Math.tan(.5*a.fovY),d=this.tilingScheme.pixelSize,f=Math.pow(2,-this._getLodBias());this._curSplitLimits[0]=b;this._curSplitLimits[1]=d[0]/a.width*this.maxTextureScale*f;this._curSplitLimits[2]=c;this._curSplitLimits[3]=d[1]/a.height*
this.maxTextureScale*f;this._curSplitLimits[4]=this.tilingScheme.getMaxLod();this._curSplitLimits[5]=this._view.qualitySettings.tiledSurface.angledSplitBias;a.copyFrustumPlanes(this._curFrustumPlanes);I.multiply(a.projectionMatrix,a.viewMatrix,this._viewProjectionMatrix);J.set(a.eye,this._curEyePos);x.autoUpdateSkirtsVisibility(this,this._curEyePos)},_setLayerViewsUpdating:function(){for(var a=0;a<z.LayerClass.LAYER_CLASS_COUNT;a++)for(var b=this._layerViews[a],c=0;c<b.length;c++)b[c]._evaluateUpdatingState(this._pendingUpdates)},
_frameUpdateTraversal:function(a){if(!this.suspended){this._frameUpdateLowerPrio.clear();var b=this._renderer.resourceCounter.numTileTexturesComposited,c=this._iteratorPool.acquire();c.reset(this.rootTiles);for(var d=!1,f=!1;!c.done&&(1<a.remaining()||!d)&&12>this._renderer.resourceCounter.numTileTexturesComposited-b;){var e=c.next();e.pendingUpdates&X.MERGE?(this._mergeTile(e),e.pendingUpdates&=~X.MERGE,d=!0,c.skip()):e.pendingUpdates&X.SPLIT?(this._splitTile(e),e.pendingUpdates&=~X.SPLIT,d=!0,c.skip()):
0<e.pendingUpdates&&this._frameUpdateLowerPrio.push(e);0!==e.pendingUpdates&&(f=!0)}this._pendingUpdates=f||!c.done;this._iteratorPool.release(c);return d}},_updateTileGeometry:function(a){this._renderer._updateTileGeometry(a);ha.spatialReference=this.spatialReference;ha.tile=a;d.emit(this,"elevation-change-tile",ha)},_updateTileTexture:function(a){this._renderer.updateTileTexture(a)},_frameUpdate:function(a){if(this.rootTiles){for(var b=this._frameUpdateTraversal(a);(1<a.remaining()||!b)&&0<this._frameUpdateLowerPrio.length;){var c=
this._frameUpdateLowerPrio.pop();c.pendingUpdates&X.DECODE_LERC?(this._decodeLERC(c),c.pendingUpdates&=~X.DECODE_LERC,b=!0):c.pendingUpdates&X.UPDATE_GEOMETRY?(this._renderer.updateTileGeometryNeedsUpdate(c),this._updateTileGeometry(c),b=!0,c.pendingUpdates&=~X.UPDATE_GEOMETRY):c.pendingUpdates&X.UPDATE_TEXTURE&&(this._updateTileTexture(c),c.pendingUpdates&=~X.UPDATE_TEXTURE,b=!0);0!==c.pendingUpdates&&(this._pendingUpdates=!0)}0<this._frameUpdateLowerPrio.length&&(this._pendingUpdates=!0);this._streamDataSupplier._loader.hasPendingDownloads()&&
(this._pendingUpdates=!0);this._pendingUpdates===this._lvPendingUpdates||!this._pendingUpdates&&20!==++this._updateNextFrame||(this._setLayerViewsUpdating(),this._lvPendingUpdates=this._pendingUpdates,this._updateNextFrame=0)}},_needsIdleUpdate:function(){return this.isVisible()&&this.overlayManager&&this.overlayManager.overlaysNeedUpdate()},_idleUpdate:function(a){this.overlayManager.updateOverlay();this._updateOverlayOpacity(this._curEyePos)},_updateClippingExtent:function(){if(!this.spatialReference)return!1;
var a=[],c=null;l.extentToBoundingRect(this._view.clippingArea,a,this.spatialReference)&&(c=a);if(b.equals(c,this._clippingExtent))return!1;this._clippingExtent=c;this._renderer.clippingExtent=c;this.notifyChange("extent");return!0},_clippingChanged:function(){this._updateClippingExtent()&&this._updateRootTiles()},_getLodBias:function(){return Math.round(this._view.qualitySettings.tiledSurface.lodBias)},_getLodBiasCorrectedScale:function(a){var b=this.tilingScheme.levels;a=Q.clamp(a-this._getLodBias(),
0,b.length-1);return b[a].scale},_cancelTilemapRequests:function(a){for(var b=0;b<z.LayerClass.LAYER_CLASS_COUNT;b++){var c=a.layerInfo[b];if(c)for(var d=0;d<c.length;d++){var f=c[d];f.tilemapRequest&&(f.tilemapRequest.cancel(),f.tilemapRequest=null)}}},_removeAllTiles:function(){this.rootTiles&&(this.rootTiles.forEach(function(a){this._purgeChildTiles(a);this._purgeTile(a)}.bind(this)),this._set("rootTiles",null),this.notifyChange("ready"));for(var a=0;a<this._topLevelTilemapOnlyTiles.length;a++)this._cancelTilemapRequests(this._topLevelTilemapOnlyTiles[a]);
this.setVisibility(!1)},_purgeChildTiles:function(a){var b=this._postorderIterator;for(b.reset(a);!b.done;){for(var c=b.next(),d=0;4>d;d++)c.children[d]=null;c!==a&&this._purgeTile(c)}},_purgeTile:function(a){a.unload(this._renderer);this._cancelTilemapRequests(a);a.parent=null;a.releaseLayerResources();this._releaseTile(a)},_splitTile:function(a){var b=a.lij[0]+1,c=2*a.lij[1],f=2*a.lij[2];a.children[0]=this._createTile(b,c,f,a);a.children[1]=this._createTile(b,c,f+1,a);a.children[2]=this._createTile(b,
c+1,f,a);a.children[3]=this._createTile(b,c+1,f+1,a);a.unload(this._renderer);da.spatialReference=this.spatialReference;da.extent=a.extent;da.scale=this._getLodBiasCorrectedScale(b);d.emit(this,"scale-change",da)},_createTile:function(a,b,c,d){O(d,"_createTile sanity check");a=this._acquireTile(a,b,c,d);a.updateClippingStatus(this._clippingExtent);a.updateVisibility(this._curFrustumPlanes,this._curEyePos);a.visible&&(a.updateScreenDepth(this._viewProjectionMatrix),a.shouldSplit(this._curSplitLimits,
this._curEyePos)===X.SPLIT&&(a.pendingUpdates|=X.SPLIT,this._pendingUpdates=!0));this._loadTile(a);return a},_mergeTile:function(a){O(!a.renderData,"_mergeTile sanity check");this._loadTile(a);this._purgeChildTiles(a);da.spatialReference=this.spatialReference;da.extent=a.extent;da.scale=this._getLodBiasCorrectedScale(a.lij[0]);d.emit(this,"scale-change",da)},_loadTile:function(a){a.load(this._renderer);this.overlayManager&&this.overlayManager.hasOverlays()&&this.overlayManager.setOverlayParamsOfTile(a,
a.renderData,this._curOverlayOpacity)},_decodeLERC:function(a){var b=z.LayerClass.ELEVATION,c=a.layerInfo[b];if(c)for(var d=0;d<c.length;d++){var f=c[d];f.pendingUpdates&=~X.DECODE_LERC;if(f.rawData){var e=a.createElevationDataFromLERC(f.rawData);f.rawData=null;if(e){f.data=e;var f=a.lij[0],g=this._iteratorPool.acquire();for(g.reset(a);!g.done;){var h=g.next();h.findElevationBoundsForLayer(d,f);h.computeElevationBounds()}this._iteratorPool.release(g);a.dataArrived(d,b,e);this._updateTiles(a);la.spatialReference=
this.spatialReference;la.extent=a.extent;this._emitElevationChange(la)}}}},_handleLayerViewChanges:function(a){var b=!1;a.added.forEach(function(a){var c=a.layer;if(x.isTiledLayerView(a))this._registerTiledLayer(c,a),c.loaded&&(b=!0);else if(a.supportsDraping&&this.overlayManager)this.overlayManager.registerLayerView(a);else if("IntegratedMeshLayer"===c.operationalLayerType&&!this._renderer.isStencilEnabledLayerExtent(a.uid)){var d=c.fullExtent,c=d.spatialReference,f=[d.xmax,d.ymax,d.zmax],e=Array(6);
(d=(d=l.bufferToBuffer([d.xmin,d.ymin,d.zmin],c,0,e,this.spatialReference,0))&&l.bufferToBuffer(f,c,0,e,this.spatialReference,3))&&this._renderer.addStencilEnabledLayerExtent(a.uid,e)}}.bind(this));a.removed.forEach(function(a){x.isTiledLayerView(a)?(b=!0,this._unregisterTiledLayerView(a.uid)):a.supportsDraping&&this.overlayManager?this.overlayManager.unregisterLayerView(a):this._renderer.isStencilEnabledLayerExtent(a.uid)&&this._renderer.removeStencilEnabledLayerExtent(a.uid)}.bind(this));(b=b||
0<a.moved.filter(x.isTiledLayerView).length)&&this._updateTiledLayers()},_registerTiledLayer:function(a,b){a=[];a.push(b.watch("suspended",function(){this._updateTiledLayers()}.bind(this)));a.push(b.watch("fullOpacity",this._updateTileTextures.bind(this)));b.on("data-changed",function(){var a=x.isElevationLayerView(b)?z.LayerClass.ELEVATION:z.LayerClass.MAP,c=this._layerIndexByLayerViewId[a][b.uid];null!=c&&this._invalidateLayerData(c,a)}.bind(this));this._basemapLayerViewHandles[b.uid]=a},_unregisterTiledLayerView:function(a){var b=
this._basemapLayerViewHandles[a];if(b){for(var c=0;c<b.length;c++)b[c].remove();delete this._basemapLayerViewHandles[a]}},_updateTiledLayers:function(){if(this.tilingScheme){var a=this._view.allLayerViews,b=[[],[]],c=z.LayerClass,d=null,f=L.create(L.NEGATIVE_INFINITY),e=function(a){var e=a.layer;if(e&&a&&!a.suspended&&x.isTiledLayerView(a)){var g=e.fullExtent;if(g){var h=x.isVectorTileLayerView(a)&&256===this.tilingScheme.pixelSize[0]?e.tileInfo256:e.tileInfo;this.tilingScheme.compatibleWith(h)?(L.expand(f,
g),x.isElevationLayerView(a)?b[c.ELEVATION].push(a):(Infinity!==a.maxDataLevel&&(null===d||a.maxDataLevel>d)&&(d=a.maxDataLevel),b[c.MAP].push(a))):ea.warn("Terrain: tiling scheme of layer "+e.id+" is incompatible with other tiled layers, will not be drawn")}else ea.warn("Terrain: Map or elevation layer does not have fullExtent: "+e.id)}}.bind(this);a.forEach(e,this);for(var g=0;g<c.LAYER_CLASS_COUNT;g++){e=this._layerViews[g];a=b[g];a.reverse();var h=e.length!==a.length,l=a.length,n=Array(l),q=Array(e.length);
this._layerIndexByLayerViewId[g]={};for(var k=0;k<l;k++){this._layerIndexByLayerViewId[g][a[k].uid]=k;var u=e.indexOf(a[k]);n[k]=u;k!==u&&(h=!0);-1<u&&(q[u]=k)}if(h){this._topLevelTilemapOnlyTiles.forEach(function(a){a.modifyLayers(q,n,g)});e=this._postorderIterator;if(this.rootTiles)for(e.reset(this.rootTiles);!e.done;)e.next().modifyLayers(q,n,g);this._layerViews[g]=a;if(this.rootTiles){for(e.reset(this.rootTiles);!e.done;)a=e.next(),a.restartAgents(g),g===c.ELEVATION&&a.computeElevationBounds();
this._updateTiles(this.rootTiles)}g===c.ELEVATION&&this.tilingScheme&&(la.spatialReference=this.tilingScheme.spatialReference,la.extent=Y,this._emitElevationChange(la))}}this.tilingScheme.levels.length-1<d&&(this.tilingScheme.ensureMaxLod(d),this._viewChangeUpdate())}},_emitElevationChange:function(a){d.emit(this,"elevation-change",a);if(ba.UPDATE_OVERLAY_MANAGER_BY_ELEVATION_UPDATES_DEFAULT)this.overlayManager.onElevationChange(a)},_getLayerExtentUnion:function(a){var b=this._view.allLayerViews,
c=L.create(L.NEGATIVE_INFINITY);b.forEach(function(b){var d=b.layer;(b=b.fullExtentInViewSpatialReference||d.fullExtent)&&!b.spatialReference.equals(a)&&(b=u.canProject(b.spatialReference,a)?u.project(b,a):null);b&&L.expand(c,b)});return L.allFinite(c)?c:null},layerViewByIndex:function(a,b){return this._layerViews[b][a]},agentTypeByLayerIndex:function(a,b){return b===z.LayerClass.ELEVATION?K:H},numLayers:function(a){return this._layerViews[a].length},numTotalLayers:function(){return this._layerViews.reduce(function(a,
b){return b.length+a},0)},_updateTileTextures:function(){var a=this._iteratorPool.acquire();for(a.reset(this.rootTiles);!a.done;)a.next().updateTexture();this._iteratorPool.release(a)},_invalidateLayerData:function(a,b){var c=this._iteratorPool.acquire();for(c.reset(this.rootTiles);!c.done;)c.next().reinitializeLayer(a,b);this._iteratorPool.release(c)},requestTileData:function(a,b,c){this.tilemapStats.tilesRequested++;var d=this.layerViewByIndex(b,c);if(d.layer.tilemapCache){var f=this.getTilemapTile(a),
e=f.layerInfo[c][b];if(e.tilemap){if(!f.tileDataAvailable(a,b,c))return this.tilemapStats.tilesNotPresent++,this._dispatchDataEvent(a,"dataMissing",c,d,{notInTilemap:!0}),b=new n.Promise,b.reject(),b}else{var g=new n.Promise;g.actualTileRequestPromise=null;e.tilemapRequest||(e.tilemapRequest=this.requestTilemap(f,b,c,d));e.tilemapRequest.then(function(){e.tilemapRequest=null;if(!g.isCancelled()){var b=this._layerIndexByLayerViewId[c][d.uid];null!=b&&(f.tileDataAvailable(a,b,c)?(g.actualTileRequestPromise=
this._requestTileData(a,b,c,d),g.actualTileRequestPromise.then(function(){g.resolve()})):(this.tilemapStats.tilesNotPresent++,this._dispatchDataEvent(a,"dataMissing",c,d,{notInTilemap:!0}),g.reject()))}}.bind(this));return g}}return this._requestTileData(a,b,c,d)},_requestTileData:function(a,b,c,d){this.tilemapStats.tileRequestsSent++;b=d.getTileUrl(a.lij[0],a.lij[1],a.lij[2]);var f=this;if(c===z.LayerClass.ELEVATION)b=this._streamDataSupplier.request(b,"binary"),b.then(function(b,e){var g=f._layerIndexByLayerViewId[c][d.uid];
null!=g?(g=a.layerInfo[c][g],e.url=b,g.rawData=e,a.pendingUpdates|=X.DECODE_LERC,g.pendingUpdates|=X.DECODE_LERC,f._pendingUpdates=!0):ea.warn("TerrainSurface: received data from unknown layer %d %s",c,a.lij.toString())},function(b){f.tilemapStats.tileRequestErrors++;f._dispatchDataEvent(a,"dataMissing",c,d,b)});else if(x.isVectorTileLayerView(d)){b=d.tileHandler;var e=d.schemeHelper.getCompatibleLevelRowCol(a.lij);b=b.getVectorTileWithLRC(e[0],e[1],e[2],0);b.then(function(b){f._dispatchDataEvent(a,
"dataArrived",c,d,b)}).otherwise(function(b){"cancel"!==b&&(f._dispatchDataEvent(a,"dataMissing",c,d,b),f.tilemapStats.tileRequestErrors++)})}else b=this._streamDataSupplier.request(b,"image"),b.then(function(b,e){f._dispatchDataEvent(a,"dataArrived",c,d,e)},function(b){f.tilemapStats.tileRequestErrors++;f._dispatchDataEvent(a,"dataMissing",c,d,b)});return b},requestTilemap:function(a,b,c,d){var f,e=new n.Promise(function(){f.cancel()}),g=a.lij[0]+z.TILEMAP_SIZE_EXP,h=a.lij[1]<<z.TILEMAP_SIZE_EXP,
l=a.lij[2]<<z.TILEMAP_SIZE_EXP;this.tilemapStats.tilemapRequestsSent++;this.tilemapStats.tilemapRequestsPending++;var q=this;f=d.layer.tilemapCache.fetchTilemap(g,h,l,{timeout:6E3});f.then(function(f){q.tilemapStats.tilemapRequestsPending--;b=this._layerIndexByLayerViewId[c][d.uid];null!=b&&(a.layerInfo[c][b].tilemap=f);e.resolve()}.bind(this),function(){q.tilemapStats.tilemapRequestsPending--;q.tilemapStats.tilemapRequestErrors++;e.resolve()});return e},getTilemapTile:function(a){var b=a.lij[0];
return b>z.TILEMAP_SIZE_EXP?y.getTileNLevelsUp(a,z.TILEMAP_SIZE_EXP):this._topLevelTilemapOnlyTiles[b]},_dispatchDataEvent:function(a,b,c,d,f){d=this._layerIndexByLayerViewId[c][d.uid];if(null!=d)a[b](d,c,f);else ea.warn("TerrainSurface: received data from unknown layer")},cancelRequest:function(a){var b=a.actualTileRequestPromise;void 0!==b?(null!==b&&this._streamDataSupplier.cancelRequest(b),a.cancel()):this._streamDataSupplier.cancelRequest(a)},_updateTileOverlayParams:function(){if(this.rootTiles){var a=
this._iteratorPool.acquire();for(a.reset(this.rootTiles);!a.done;){var b=a.next();b.renderData&&this.overlayManager&&this.overlayManager.setOverlayParamsOfTile(b,b.renderData,this._curOverlayOpacity)}this._iteratorPool.release(a);this._renderer.setNeedsRender()}},_updateOverlayOpacity:function(a){if(this.overlayManager&&(a=this.overlayManager.updateOpacity(a),!isNaN(a))){if(a!==this._curOverlayOpacity&&this.rootTiles){var b=this._iteratorPool.acquire();for(b.reset(this.rootTiles);!b.done;){var c=
b.next();c.renderData&&c.renderData.overlayTexId&&(c.renderData.overlayOpacity=a)}this._iteratorPool.release(b)}this._curOverlayOpacity=a;this._renderer.setNeedsRender()}},getStats:function(){var a=0,b=0,c=0,d=[],f=this._iteratorPool.acquire();for(f.reset(this.rootTiles);!f.done;){var e=f.next();a++;e.renderData&&(b++,e.visible&&(c++,e=e.lij[0],d[e]=null!=d[e]?d[e]+1:1))}this._iteratorPool.release(f);return{numNodes:a,numLeaves:b,numVisible:c,numVisiblePerLevel:d}},getTile:function(a){var b=a.split("/").map(JSON.parse);
if(0===b[0])return this.rootTiles.forEach(function(a){if(a.lij[1]===b[1]&&a.lij[2]===b[2])return a}),null;var c=Math.pow(2,b[0]),d=Math.floor(b[1]/c),f=Math.floor(b[2]/c),e;this.rootTiles.some(function(a){return a.lij[1]===d&&a.lij[2]===f?(e=a,!0):!1});if(e){for(c=1<<b[0]-1;e.lij[0]<b[0];){var g=b[1]&c?2:0;0<(b[2]&c)&&g++;if(!e.children[g])return console.log("Tile "+a+" doesn't exist, smallest ancestor is "+y.tile2str(e)),null;e=e.children[g];c>>=1}O(e.lij[0]===b[0]&&e.lij[1]===b[1]&&e.lij[2]===b[2],
"not the right tile?");return e}return null},hasPendingUpdates:function(){if(this._streamDataSupplier._loader.hasPendingDownloads())return!0;var a=this._iteratorPool.acquire();for(a.reset(this.rootTiles);!a.done;)if(0<a.next().pendingUpdates)return this._iteratorPool.release(a),!0;this._iteratorPool.release(a);return!1},setBorders:function(a){this._renderer.setBorders(a)},setDisableRendering:function(a){this._renderer.setDisableRendering(a)},_extentGetter:function(){return this._clippingExtent||this._rootExtent},
_hasFixedExtent:function(){return!!this._clippingExtent},_wireframeSetter:function(a){this._renderer.setWireframe(a);this._set("wireframe",a);this._view._stage.setRenderParams({earlyOcclusionPixelDraw:a})},_opacitySetter:function(a){this._renderer.setOpacity(a);this._set("opacity",a)},_skirtsSetter:function(a){this._renderer.setDrawSkirts(!!a);this._set("skirts",a)},_cullBackFacesSetter:function(a){this._renderer.setCullBackFaces(a);this._set("cullBackFaces",a)},_renderOrderSetter:function(a){this._renderer.setRenderOrder(a);
this._set("renderOrder",a)},_frontMostTransparentSetter:function(a){this._renderer.setFrontMostTransparent(!!a);this._set("frontMostTransparent",a)},_tileBackgroundSetter:function(a){a!==this.tileBackground&&this._renderer.updateTileBackground(a);this._set("tileBackground",a)},_velvetOvergroundSetter:function(a){a!==this.velvetOverground&&this._renderer.setVelvetOverground(a);this._set("velvetOverground",a)}});ba.TOO_MANY_ROOT_TILES_AFTER_CHANGE="Cannot extend surface to encompass all layers because it would result in too many root tiles.";
ba.UPDATE_OVERLAY_MANAGER_BY_ELEVATION_UPDATES_DEFAULT=!1;return ba})},"esri/views/3d/terrain/TerrainRenderer":function(){define("dojo/Deferred dojo/when ./tileUtils ./TerrainConst ./TileGeometryFactory ./TileRenderData ./ResourceCounter ./TileRenderer ../support/PreallocArray ../../../core/ObjectPool ../webgl-engine/lib/ShaderVariations dojo/text!./TerrainMaterial.xml ../webgl-engine/materials/internal/MaterialUtil ../webgl-engine/lib/Util ../lib/glMatrix ../webgl-engine/lib/RenderPass ../webgl-engine/lib/RenderSlot ../webgl-engine/lib/tracer ../../webgl/Texture ../../webgl/VertexArrayObject ../../webgl/BufferObject ../../webgl/Program ../webgl-engine/lib/DefaultVertexAttributeLocations ../webgl-engine/lib/DefaultVertexBufferLayouts ../../webgl/Util".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f,n,u,t,r,w,q,x,y,z,A,C,B,D,H){var K=t.assert;t=r.vec2d;var E=r.vec3d,F=r.vec4d,L=r.mat4d.identity(),Q=[2,2],N=q.OPAQUE_TERRAIN,J=q.TRANSPARENT_TERRAIN,P=E.create(),I,O=t.create();r=function(q,t){function r(a,b){a=a.screenDepth;b=b.screenDepth;return a<b?-wa:a>b?wa:0}function ea(a,b){return 0===a.tiles.length?-wa:0===b.tiles.length?wa:r(a.tiles.data[0],b.tiles.data[0])}function W(a,b){void 0===b&&(b=p.subdivisionReduceLevels);return 0===b?a:0>b?Math.floor((a-1)*(1<<-b))+
1:Math.floor((a-1)/(1<<b))+1}t=t||256;var R,ia=!1,ga=null,ha=null,la=null,da={},Y,V,ba=new l(h),T=new e(10,function(){return{root:null,tiles:new e(300)}}),U=new b.IteratorPreorder,Z,G,ja=!0,S=1,ca=!0,p={mode:"none",width:1.5,falloff:1.5,wireOpacity:1,surfaceOpacity:0,color:[1,1,1,0],subdivision:"geometry",subdivisionReduceLevels:0},qa=!1,Ca=!1,ma=!1,wa=1,Da=!0,ra=!0,sa=null,ta=null,Aa=null,Qa=null,ua=[];this.updateTileBackground=function(a){var b=new m;Aa&&Aa.reject(b.promise);Qa=a;Aa=b;if(a){var c=
new Image;c.src=a instanceof Image?a.src:a;c.complete?b.resolve(c):c.onload=function(){b.isFulfilled()||b.resolve(c)}}else b.resolve(null);this.renderTileBackground();return b.promise};var Ja=0,Ka=0,Ta=0,Ua=0;this.resourceCounter=new g;this.castShadows=!1;this.clippingExtent=null;this.loaded=function(){};var Za=!1;this.needsRender=!0;this.receiveShadows=this.didRender=!1;var ya=new e(10),Na=0,La=new e(30),Ba=new l(function(){this.extent=F.create();this.maxLevel=this.minLevel=0;this.callback=null},
!1);this.renderTileBackground=function(){if(Y&&Aa&&ta)return Aa.then(function(a){ta.setGridImage(a);ga&&b.traverseTilesPreorder(ga,function(a){ta.updateTileTexture(a)}.bind(this))}.bind(this))};this.initializeRenderContext=function(a){Y=a.rctx;V=a.rctx.gl;G=Y.extensions.textureFilterAnisotropic;K(!I||I===G.TEXTURE_MAX_ANISOTROPY_EXT,"contexts have different definitions afExt.TEXTURE_MAX_ANISOTROPY_EXT");null!=G&&(I=G.TEXTURE_MAX_ANISOTROPY_EXT);c.setSupportsUintIndices(!!Y.extensions.elementIndexUint);
var b=function(a){k(a).then(function(){ia=!0;this.setNeedsRender()}.bind(this)).otherwise(b)}.bind(this);b(this.renderTileBackground());R=a.textureRep;var e=a.shaderSnippets,g=a.shaderRep;a=a.programRep;e.vsTerrain||e._parse(n);Y.extensions.standardDerivatives;var h=new f("terrain",["vsTerrain","fsTerrain"],null,a,g,e,Y);h.addDefine("Spherical","SPHERICAL");h.addDefine("Overlay","OVERLAY");h.addDefine("Atmosphere","ATMOSPHERE");h.addDefine("Wireframe","WIREFRAME");h.addDefine("TileBorders","TILE_BORDERS");
h.addBinaryShaderSnippetSuffix("Wireframe","Wireframe",[!1,!0]);h.addDefine("ReceiveShadows","RECEIVE_SHADOWS");g=new f("terrainNormal",["vsTerrainNormal","fsNormal"],null,a,g,e,Y);g.addDefine("Spherical","SPHERICAL");g.addDefine("AlphaZero","ALPHA_ZERO");la={depth:a.get("depth"),depthShadowMap:a.get("depthShadowMap"),depthOnly:new C(Y,e.vsTerrainDepthOnly,e.fsTerrainDepthOnly,B.Default3D)};ha={color:h,normal:g};this._updatePrograms();ta=new d(Y,t,a,this.resourceCounter,this.setNeedsRender.bind(this));
Aa&&Aa.then(function(a){ta.setGridImage(a)});sa=new y(Y,{target:V.TEXTURE_2D,pixelFormat:V.RGBA,dataType:V.UNSIGNED_BYTE,samplingMode:V.NEAREST,width:4,height:4})};this.uninitializeRenderContext=function(a){null!=sa&&(sa.dispose(),sa=null);ta&&(ta.dispose(),ta=null)};this._updatePrograms=function(){var a="spherical"===q,b="shader"===p.mode;la.color=ha.color.getProgram([a,!0,a&&ra,b,qa,b||qa,this.receiveShadows]);la.normal=ha.normal.getProgram([a,!0])};this.install=function(a){a.addExternalRenderer([N,
J],this)};this.uninstall=function(a){a.removeExternalRenderer(this)};this.setRootTiles=function(a){ga=a};this.isStencilEnabledLayerExtent=function(a){return ua.some(function(b){return a===b.id})};this.addStencilEnabledLayerExtent=function(a,b){ua.push({id:a,extent:[b[0],b[1],b[3],b[4]]})};this.removeStencilEnabledLayerExtent=function(a){for(var b=0;b<ua.length;b++)if(a===ua[b].id){ua.splice(b,1);break}};this.setTileSize=function(a){t=a;ta&&(ta.tileSize=a)};this.loadTile=function(a){K(null===a.renderData);
a.renderData=ba.acquire();a.renderData.init();var b=this.getLocalOriginOfTile(a),c=a.createGeometry(a.renderData.updateGeometryState(a),b,"debug"===p.mode,a.renderData.geometryInfo);a.renderData.localOrigin=b;this._setTileGeometry(a,c);ta.updateTileTexture(a)};this.queryVisibleLevelRange=function(a,b,c,d){var e=Ba.acquire();F.set(a,e.extent);e.minLevel=b?b:-Number.MAX_VALUE;e.maxLevel=null!=c?c:Number.MAX_VALUE;e.callback=d;La.push(e);this.setNeedsRender()};this.updateTileTexture=function(a){ta&&
ta.updateTileTexture(a)};this.updateTileGeometryNeedsUpdate=function(a){return a.renderData.updateGeometryState(a).needsUpdate};this._updateTileGeometry=function(b){for(var c=b.renderData.geometryState,d=b.layerInfo[a.LayerClass.ELEVATION],e=0;e<d.length;e++)d[e].pendingUpdates&=~a.TileUpdateTypes.UPDATE_GEOMETRY;return c.needsUpdate?(b.renderData.vao&&this._releaseTileGeometry(b),c=b.createGeometry(c,b.renderData.localOrigin,"debug"===p.mode,b.renderData.geometryInfo),this._setTileGeometry(b,c),
!0):!1};this.updateTileGeometry=function(a){a.renderData.updateGeometryState(a);return this._updateTileGeometry(a)};this.unloadTile=function(a){this._releaseTileGeometry(a);a.renderData.texture&&a.renderData.texture.dispose();ba.release(a.renderData);a.renderData=null};this.getLocalOriginOfTile=function(a){if(10<=a.lij[0]){for(;7<a.lij[0];)a=a.parent;return a.centerAtSeaLevel}if("spherical"===q)return P;for(;a.parent;)a=a.parent;return a.centerAtSeaLevel};this.setVisibility=function(a){ja=a;this.setNeedsRender()};
this.getStats=function(){return{numTilesRendered:Ka,numTilesCulled:Ta,numTrianglesRendered:Ja,numOriginsRendered:Ua}};this.setDisableRendering=function(a){Ca=!!a;this.setNeedsRender()};this.getOpacity=function(){return S};this.getWireframeEnabled=function(){return"shader"===p.mode};this.setWireframe=function(a){a&&!0!==a||(a={mode:a?"shader":"none"});if(void 0!==a.mode&&p.mode!==a.mode){var c="debug"===p.mode,d="debug"===a.mode;p.mode=a.mode;this._updatePrograms();c!==d&&ga&&b.traverseTilesPreorder(ga,
function(a){if(a.renderData){a.renderData.vao&&this._releaseTileGeometry(a);var b=a.createGeometry(a.renderData.updateGeometryState(a),a.renderData.localOrigin,d,a.renderData.geometryInfo);this._setTileGeometry(a,b)}}.bind(this));this.setNeedsRender()}for(var e in a)p.hasOwnProperty(e)&&(p[e]=a[e]),this.setNeedsRender()};this.setOpacity=function(a){S=a;this.setNeedsRender()};this.setDrawSkirts=function(a){ca=a;this.setNeedsRender()};this.setCullBackFaces=function(a){ma=a;this.setNeedsRender()};this.setRenderOrder=
function(a){wa=a;this.setNeedsRender()};this.setBorders=function(a){qa!==a&&(qa=a,"none"===p.mode&&(p.transitionTime=0),this._updatePrograms(),this.setNeedsRender())};this.setFrontMostTransparent=function(a){Da!==a&&(Da=a,this.setNeedsRender())};this.setVelvetOverground=function(a){ra!==a&&(ra=a,this._updatePrograms(),this.setNeedsRender())};this.setNeedsRender=function(){this.needsRender=!0;this.didRender=!1};this.resetNeedsRender=function(){this.didRender&&(this.needsRender=0!==La.length,this.didRender=
!1)};var Ma=E.create();this.isTransparent=function(){return 1>S||"shader"===p.mode&&(1>p.wireOpacity||1>p.surfaceOpacity)||!Qa};this.render=function(a){if(ia&&!Ca&&ja&&ga){var b=this.isTransparent();if(a.slot===(b?J:N)){x.trace("# BEGIN RENDER TERRAIN");T.clear();Z=null;this._renderCollectOrigins();if(0!==wa){for(var c=0;c<T.length;c++)this._sortFrontToBack(T.data[c].tiles,r);this._sortFrontToBack(T,ea)}var d,e=!1,f=!1;d=a.pass;var g=a.camera;Y.setBlendFunctionSeparate(V.SRC_ALPHA,V.ONE_MINUS_SRC_ALPHA,
V.ONE,V.ONE_MINUS_SRC_ALPHA);Y.setFaceCullingEnabled(ma);if(d===w.MATERIAL){if(f=b,e=a.shadowMap&&a.shadowMap.getEnableState(),this.receiveShadows!=e&&(this.receiveShadows=e,this._updatePrograms()),b&&Da&&(e=la.depthOnly,Y.bindProgram(e),Y.setColorMask(!1,!1,!1,!1),Y.setDepthTestEnabled(!0),this._renderTilesDepthOnly(g,Y,e),Y.setColorMask(!0,!0,!0,!0),Y.setDepthFunction(V.EQUAL),Y.setDepthWriteEnabled(!1)),d=la.color,e=!0,Y.bindProgram(d),d.setUniform1f("opacity",S),Y.setBlendingEnabled(f),"shader"===
p.mode||qa)d.setUniform1f("wireframe.width",p.width),d.setUniform1f("wireframe.falloff",Math.min(p.width,p.falloff)),d.setUniform1f("wireframe.wireOpacity",p.wireOpacity*S),d.setUniform1f("wireframe.surfaceOpacity",p.surfaceOpacity*S),d.setUniform4fv("wireframe.color",p.color),d.setUniform1f("wireframe.near",g.near),d.setUniform1f("wireframe.far",g.far),"geometry"!==p.subdivision&&"constant"!==p.subdivision&&d.setUniform1f("wireframe.subdivision",W(p.subdivision))}else if(d===w.MATERIAL_DEPTH_SHADOWMAP&&
this.castShadows||d===w.MATERIAL_DEPTH)d=d===w.MATERIAL_DEPTH_SHADOWMAP?la.depthShadowMap:la.depth,Y.bindProgram(d),d.setUniformMatrix4fv("model",L),O[0]=g.near,O[1]=g.far,d.setUniform2fv("nearFar",O);else if(d===w.MATERIAL_NORMAL)d=la.normal,Y.bindProgram(d);else return;a.shadowMap&&a.shadowMap.bind(d);a.ssaoHelper&&a.ssaoHelper.setUniforms(d);e&&(d.setUniform1i("tex",4),d.setUniform1i("overlayTex",5));d.setUniformMatrix4fv("viewNormal",g.viewInverseTransposeMatrix);d.setUniformMatrix4fv("proj",
g.projectionMatrix);d.setUniform3fv("lightDirection",a.lightingData.direction);g=g.viewMatrix;E.set3(g[12],g[13],g[14],Ma);E.normalize(Ma);d.setUniform3fv("viewDirection",Ma);for(Ua=Ja=Ta=Ka=0;ya.length<ya.data.length&&0<La.length;)c=La.pop(),ya.push(c);Na=ya.length;for(c=0;c<T.length;c++){var h=T.data[c];d.setUniform3fv("origin",h.origin);u.bindView(h.origin,g,d);a.shadowMap&&a.shadowMap.bindView(d,h.origin);Ua++;this._renderTiles(h.tiles,d,e,a)}f&&Y.setBlendingEnabled(!1);b&&Da&&(Y.setDepthFunction(V.LESS),
Y.setDepthWriteEnabled(!0));ma&&Y.setFaceCullingEnabled(!1);a.stencilRenderingHelper&&a.stencilRenderingHelper.getEnableState()&&a.stencilRenderingHelper.prepareStencilDisabledPass();for(a=0;a<ya.length;a++)b=ya.data[a],Ba.release(b),b.callback(a>=Na),b.callback=null;ya.clear();0<Ka&&!Za&&(Za=!0,this.loaded&&this.loaded());x.trace("# END RENDER TERRAIN");return!0}}};this._renderCollectOrigins=function(){for(var a=0;a<ga.length;a++){var b=ga[a],c=T.next();c.root=b;c.origin="spherical"===q?P:b.centerAtSeaLevel;
c.tiles.clear();this._renderCollectOriginsForRoot(c)}};this._renderCollectOriginsForRoot=function(a){for(U.reset(a.root);!U.done;){var b=U.next(),c=b.renderData;if(c&&!b.visible)Ta++,U.skip();else{var d=T.peek();if(7===b.lij[0]){if(d===a||0!==d.tiles.length)d=T.next(),d.tiles.clear();d.root=b;d.origin=b.centerAtSeaLevel}if(c){c=b.lij[0];10<=c?T.peek().tiles.push(b):a.tiles.push(b);if(null===Z||Z.lij[0]<c)Z=b;U.skip()}}}};this._sortFrontToBack=function(a,b){a.sort(b)};this._renderTilesDepthOnly=function(a,
b,c){var d=a.viewMatrix;c.setUniformMatrix4fv("proj",a.projectionMatrix);for(a=0;a<T.length;a++){var e=T.data[a];c.setUniform3fv("origin",e.origin);u.bindView(e.origin,d,c);for(var f=0;f<e.tiles.length;f++){var g=e.tiles.data[f].renderData;b.bindVAO(g.vao);H.assertCompatibleVertexAttributeLocations(g.vao,c);var h=g.vao.indexBuffer.size;ca||(h=g.geometryInfo.numWithoutSkirtIndices);b.drawElements(V.TRIANGLES,h,g.vao.indexBuffer.indexType,0)}}b.bindVAO(null)};this._renderTiles=function(a,b,c,d){if(0!==
a.length){var e=V.TRIANGLES;"debug"===p.mode&&(e=V.LINES);var f="geometry"===p.subdivision,g="constant"===p.subdivision,h=Z,l,n=!1;h?(l=h.lij[0],h=W(h.renderData.geometryInfo.numVertsPerRow)):h=l=16;Y.setDepthTestEnabled(!0);Y.setBlendingEnabled(this.isTransparent());for(var q=0;q<a.length;q++){var k=a.data[q],u=k.renderData;if(d.stencilRenderingHelper&&d.stencilRenderingHelper.getEnableState()){for(var t=!1,w=0;w<ua.length;w++)if(k.intersectsExtent(ua[w].extent)){t=!0;break}t&&!n?(d.stencilRenderingHelper.prepareStencilReadPass(),
n=!0):!t&&n&&(d.stencilRenderingHelper.prepareStencilDisabledPass(),n=!1)}x.trace("# RENDER TILE "+k.lij[0]+"/"+k.lij[1]+"/"+k.lij[2]+", screenDepth:"+k.screenDepth);if(c){b.setUniform2fv("texOffset",u.texOffset);b.setUniform1f("texScale",u.texScale);Y.bindTexture(u.textureReference||u.texture,4);if(u.overlayTexId){var t=b,w=u,r=w.overlayTexId,y=da[r];y||(y=R.aquire(r).getGLTexture(),K(y),da[r]=y);t.setUniform2fv("overlayTexOffset",w.overlayTexOffset);t.setUniform2fv("overlayTexScale",w.overlayTexScale);
t.setUniform1f("overlayOpacity",w.overlayOpacity);Y.bindTexture(y,5)}else b.setUniform2fv("overlayTexOffset",Q),Y.bindTexture(sa,5);"shader"!==p.mode&&!qa||!f&&!g||(f?b.setUniform1f("wireframe.subdivision",W(u.geometryInfo.numVertsPerRow)):(t=W(h,k.lij[0]-l),b.setUniform1f("wireframe.subdivision",t)))}t=u.vao.indexBuffer.size;ca||(t=u.geometryInfo.numWithoutSkirtIndices);Y.bindVAO(u.vao);H.assertCompatibleVertexAttributeLocations(u.vao,b);Y.drawElements(e,t,u.vao.indexBuffer.indexType,0);k.renderOrder=
Ka;Ka++;Ja+=t/3;u=k.extent;k=k.lij[0];for(t=0;t<Na;)w=ya.data[t],r=w.extent,k>=w.minLevel&&k<=w.maxLevel&&r[0]<=u[2]&&r[2]>=u[0]&&r[1]<=u[3]&&r[3]>=u[1]?(ya.swap(t,Na-1),Na--):t++}Y.bindVAO(null)}};var Oa=E.create(),Ra=E.create(),Va=E.create(),Ea=this.clippingExtent;this.intersect=function(a,c,d,e){if(ga&&(!a.isSelection||!this.isTransparent())){E.subtract(d,c,Oa);var f=a.getMinResult(),g=a.getMaxResult();U.reset(ga);for(e={};!U.done;){var h=U.next();if(null!==h.renderData){if(a.enableInvisibleTerrain){if(!h.visible&&
Ea&&!h.intersectsExtent(Ea))continue}else if(!h.visible)continue;var l=h.renderData.geometryInfo.geometry,n=h.renderData.localOrigin;E.subtract(c,n,Ra);E.subtract(d,n,Va);u.intersectTriangleGeometry(l,e,void 0,a,Ra,Va,function(c,d,e){if((ca||!(3*e>=h.renderData.geometryInfo.numWithoutSkirtIndices))&&0<=c&&(a.enableBackfacesTerrain||0>E.dot(d,Oa))){if(void 0===f.dist||c<f.dist)e=b.lij2str(h.lij[0],h.lij[1],h.lij[2]),f.set(void 0,e,c,d,void 0),f.setIntersector("terrain");if(void 0===g.dist||c>g.dist)e=
b.lij2str(h.lij[0],h.lij[1],h.lij[2]),g.set(void 0,e,c,d,void 0),g.setIntersector("terrain")}})}}}};this._setTileGeometry=function(a,b){a=a.renderData;var d=b.geometry.getData(),e=d.getVertexAttr().terrain.data,d=d.getFaces()[0].indices.terrain;a.vao=new z(Y,B.Default3D,{geometry:D.Pos3Tex},{geometry:A.createVertex(Y,V.STATIC_DRAW,e)},A.createIndex(Y,V.STATIC_DRAW,d));a.geometryInfo.geometry&&c.releaseGeometry(a.geometryInfo.geometry);a.geometryInfo=b;this.setNeedsRender()};this._releaseTileGeometry=
function(a){a=a.renderData;a.vao.dispose(!0);a.vao=null;a.geometryInfo.geometry&&c.releaseGeometry(a.geometryInfo.geometry);a.geometryInfo.geometry=null;this.setNeedsRender()}};r.TileRenderData=h;return r})},"esri/views/3d/terrain/tileUtils":function(){define(["require","exports","./UpsampleInfo","../support/PreallocArray"],function(m,k,b,a){function c(a,b,g,f){f=b.call(g,a,f);for(var d=0;4>d;d++){var e=a.children[d];e&&c(e,b,g,f)}}function h(a,b,c){if(Array.isArray(a))for(var d=0;d<a.length;d++)g(a[d],
b,c);else g(a,b,c)}function g(a,b,c){for(var d=0;4>d;d++){var e=a.children[d];e&&h(e,b,c)}b.call(c,a)}m=function(){function b(b){this.q=new a(b||100);this._last=null;this.done=!0}b.prototype.reset=function(a){this.q.clear();a&&this.q.pushEither(a);this._last=null;this.done=0===this.q.length};b.prototype.skip=function(){this._last=null;0===this.q.length&&(this.done=!0)};b.prototype.next=function(){if(this.done)return null;if(null!==this._last){var a=this._last.children;if(a[0])for(var b=4;0<=b;b--){var c=
a[b];c&&this.q.push(c)}this._last=null}this._last=this.q.pop();0!==this.q.length||this._last.children[0]||(this.done=!0);return this._last};return b}();k.IteratorPreorder=m;m=function(){function b(b){this.q=new a(b||100);this.done=!0}b.prototype.reset=function(a){this.q.clear();this.q.pushEither(a);for(a=0;a<this.q.length;)for(var b=this.q.data[a++],c=0;4>c;c++){var d=b.children[c];d&&this.q.push(d)}this.done=0===this.q.length};b.prototype.next=function(){var a=this.q.pop();this.done=0===this.q.length;
return a};return b}();k.IteratorPostorder=m;k.lij2str=function(a,b,c){return a+"/"+b+"/"+c};k.tile2str=function(a){return a.lij[0]+"/"+a.lij[1]+"/"+a.lij[2]};k.traverseTilesPreorder=function(a,b,g,f){if(Array.isArray(a))for(var d=0;d<a.length;d++)c(a[d],b,g,f);else c(a,b,g,f)};k.traverseTilesPostorder=h;k.fallsWithinLayer=function(a,b,c){b=b.layer;var d=b.fullExtent,e=a.extent;if(c){if(e[0]<d.xmin||e[1]<d.ymin||e[2]>d.xmax||e[3]>d.ymax)return!1}else if(d.xmin>e[2]||d.ymin>e[3]||d.xmax<e[0]||d.ymax<
e[1])return!1;a=a.parentSurface.tilingScheme.levels[a.lij[0]].scale;return 0<b.minScale&&a>1.00000001*b.minScale?!1:a>=.99999999*b.maxScale};k.isPosWithinTile=function(a,b){a=a.extent;return b[0]>=a[0]&&b[1]>=a[1]&&b[0]<=a[2]&&b[1]<=a[3]};k.getTileNLevelsUp=function(a,b){for(;0<b;)a=a.parent,b--;return a};k.nextTileInAncestry=function(a,b){var c=a.lij[0]-b.lij[0]-1,d=a.lij[2]>>c,e=0;a.lij[1]>>c&1&&(e+=2);d&1&&(e+=1);return b.children[e]};k.computeUpsampleInfoForAncestor=function(a,c){for(var d=1,
e=0,g=0;a!==c;)if(d*=.5,e*=.5,g*=.5,a.lij[2]&1&&(e+=.5),0===(a.lij[1]&1)&&(g+=.5),a=a.parent,null==a)throw Error("tile was not a descendant of ancestorTile");a=b.Pool.acquire();a.init(c,e,g,d);return a}})},"esri/views/3d/terrain/UpsampleInfo":function(){define(["require","exports","../lib/glMatrix","../../../core/ObjectPool"],function(m,k,b,a){var c=b.vec2d;m=function(){function a(a,b,e,h){this.scale=0;this.tile=null;this.offset=c.create();void 0!==a&&this.init(a,b,e,h)}a.prototype.init=function(a,
b,c,h){this.tile=a;this.offset[0]=b;this.offset[1]=c;this.scale=h};a.prototype.dispose=function(){this.tile=null;this.offset[0]=0;this.scale=this.offset[1]=0};return a}();m.Pool=new a(m);return m})},"esri/views/3d/terrain/TerrainConst":function(){define(["require","exports","./TilingScheme","../support/aaBoundingRect"],function(m,k,b,a){(function(a){a[a.MAP=0]="MAP";a[a.ELEVATION=1]="ELEVATION";a[a.LAYER_CLASS_COUNT=2]="LAYER_CLASS_COUNT"})(k.LayerClass||(k.LayerClass={}));(function(a){a[a.NONE=0]=
"NONE";a[a.SPLIT=1]="SPLIT";a[a.VSPLITMERGE=2]="VSPLITMERGE";a[a.MERGE=4]="MERGE";a[a.DECODE_LERC=8]="DECODE_LERC";a[a.UPDATE_GEOMETRY=16]="UPDATE_GEOMETRY";a[a.UPDATE_TEXTURE=32]="UPDATE_TEXTURE"})(k.TileUpdateTypes||(k.TileUpdateTypes={}));k.TILE_LOADING_DEBUGLOG=!1;k.MAX_ROOT_TILES=64;k.MAX_TILE_TESSELATION=512;k.ELEVATION_NODATA_VALUE=3.40282347E38/10;k.ELEVATION_DESIRED_RESOLUTION_LEVEL=4;k.TILEMAP_SIZE_EXP=5;k.TILEMAP_SIZE=1<<k.TILEMAP_SIZE_EXP;k.WEBMERCATOR_WORLD_EXTENT=a.create([0,0,0,0]);
b.WebMercatorAuxiliarySphere.getExtent(0,0,0,k.WEBMERCATOR_WORLD_EXTENT);k.GEOGRAPHIC_WORLD_EXTENT=a.create([-180,-90,180,90])})},"esri/views/3d/terrain/TilingScheme":function(){define(["../../../geometry/SpatialReference","../../../geometry/support/scaleUtils","../support/projectionUtils","../support/mathUtils"],function(m,k,b,a){function c(a,b){b=Error(b);b.name=a;return b}var h=b.webMercator.x2lon,g=b.webMercator.y2lat,d=[0,0,0,0],e=function(a){var b=e._checkUnsupported(a);if(b)throw b;this.spatialReference=
a.spatialReference;this._isWebMercator=this.spatialReference.isWebMercator;this._isWGS84=this.spatialReference.isWGS84;this.origin=[a.origin.x,a.origin.y];this.pixelSize=[a.size[0],a.size[1]];var c=a.lods.reduce(function(a,b,c){b.level<a.min&&(a.min=b.level,a.minIndex=c);a.max=Math.max(a.max,b.level);return a},{min:Infinity,minIndex:0,max:-Infinity}),d=a.lods[c.minIndex],g=Math.pow(2,d.level),b=d.resolution*g,d=d.scale*g;this.levels=Array(c.max+1);for(c=0;c<this.levels.length;c++)this.levels[c]={resolution:b,
scale:d,tileSize:[b*a.size[0],b*a.size[1]]},b/=2,d/=2};e.prototype={getExtent:function(b,c,d,e,k){e=e||Array(4);var f=this.levels[b];b=f.tileSize[0];f=f.tileSize[1];e[0]=this.origin[0]+d*b;e[2]=e[0]+b;e[3]=this.origin[1]-c*f;e[1]=e[3]-f;k&&(this._isWebMercator?(k[0]=h(e[0]),k[1]=g(e[1]),k[2]=h(e[2]),k[3]=g(e[3])):this._isWGS84&&(k[0]=a.deg2rad(e[0]),k[1]=a.deg2rad(e[1]),k[2]=a.deg2rad(e[2]),k[3]=a.deg2rad(e[3])))},ensureMaxLod:function(a){for(;this.levels.length<=a;){var b=this.levels[this.levels.length-
1],c=b.resolution/2;this.levels.push({resolution:c,scale:b.scale/2,tileSize:[c*this.pixelSize[0],c*this.pixelSize[1]]})}},capMaxLod:function(a){this.levels.length>a+1&&(this.levels.length=a+1)},getMaxLod:function(){return this.levels.length-1},scaleAtLevel:function(a){return this.levels[0].scale/Math.pow(2,a)},levelAtScale:function(a){var b=this.levels[0].scale;return a>=b?0:Math.log(b/a)*Math.LOG2E},compatibleWith:function(b){if(!(b instanceof e)){if(e._checkUnsupported(b))return!1;b=new e(b)}if(!b.spatialReference.equals(this.spatialReference)||
b.pixelSize[0]!==this.pixelSize[0]||b.pixelSize[1]!==this.pixelSize[1])return!1;var c=Math.min(this.levels.length,b.levels.length)-1,d=this.levels[c].resolution,g=a.floatEqualAbsolute,h=.5*d;if(!g(b.origin[0],this.origin[0],h)||!g(b.origin[1],this.origin[1],h))return!1;h=.5*d/Math.pow(2,c)/Math.max(this.pixelSize[0],this.pixelSize[1])*12;return g(d,b.levels[c].resolution,h)},rootTilesInExtent:function(a,b,c){var f=this.levels[0].tileSize;e.computeRowColExtent(a,f,this.origin,d);a=d[1];var g=d[3],
h=d[0],l=d[2],n=l-h,k=g-a;n*k>c&&(c=Math.floor(Math.sqrt(c)),k>c&&(a=a+Math.floor(.5*k)-Math.floor(.5*c),g=a+c),n>c&&(h=h+Math.floor(.5*n)-Math.floor(.5*c),l=h+c));c=Array((l-h)*(g-a));n=0;for(k=a;k<g;k++)for(var y=h;y<l;y++)c[n++]=[0,k,y];b&&(b[0]=this.origin[0]+h*f[0],b[1]=this.origin[1]-g*f[1],b[2]=this.origin[0]+l*f[0],b[3]=this.origin[1]-a*f[1]);return c}};e.computeRowColExtent=function(a,b,c,d){var e=.001*(a[2]-a[0]+(a[3]-a[1]));d[0]=Math.floor((a[0]+e-c[0])/b[0]);d[2]=Math.ceil((a[2]-e-c[0])/
b[0]);d[1]=Math.floor((c[1]-a[3]+e)/b[1]);d[3]=Math.ceil((c[1]-a[1]-e)/b[1])};e.isPowerOfTwo=function(b){b=b.lods;var c=b[0].resolution*Math.pow(2,b[0].level);return!b.some(function(b){return!a.floatEqualRelative(b.resolution,c/Math.pow(2,b.level))})};e.hasGapInLevels=function(a){a=a.lods.map(function(a){return a.level});a.sort(function(a,b){return a-b});for(var b=1;b<a.length;b++)if(a[b]!==a[0]+b)return!0;return!1};e.tileSizeSupported=function(a){var b=a.size[1];return b===a.size[0]&&0===(b&b-1)&&
128<=b&&512>=b};e._checkUnsupported=function(a){return a?1>a.lods.length?c("tilingscheme:generic","Tiling scheme must have at least one level"):e.isPowerOfTwo(a)?null:c("tilingscheme:power-of-two","Tiling scheme must be power of two"):c("tilingscheme:tile-info-missing","Tiling scheme must have tiling information")};e.checkUnsupported=function(a){var b=e._checkUnsupported(a);return b?b:e.hasGapInLevels(a)?c("tilingscheme:gaps","Tiling scheme levels must not have gaps between min and max level"):e.tileSizeSupported(a)?
null:c("tilingscheme:tile-size","Tiles must be square and size must be one of [128, 256, 512]")};e.fromExtent=function(a,b){var c=a[2]-a[0],d=a[3]-a[1],f=k.getUnitValueForSR(b),g=1.2*Math.max(c,d);a=new e({size:[256,256],origin:{x:a[0]-.5*(g-c),y:a[3]+.5*(g-d)},lods:[{level:0,resolution:g/256,scale:1/(256/96*.0254/(g*f))}],spatialReference:b});a.ensureMaxLod(20);return a};e.WebMercatorAuxiliarySphereTileInfo={size:[256,256],origin:{x:-2.0037508342787E7,y:2.0037508342787E7},spatialReference:m.WebMercator,
lods:[{level:0,resolution:156543.03392800014,scale:5.91657527591555E8}]};e.makeWebMercatorAuxiliarySphere=function(a){a=a||19;var b=new e(e.WebMercatorAuxiliarySphereTileInfo);b.ensureMaxLod(a);return b};e.WebMercatorAuxiliarySphere=e.makeWebMercatorAuxiliarySphere(19);e.makeWGS84WithTileSize=function(a,b){b=b||16;var c=256/a;a=new e({size:[a,a],origin:{x:-180,y:90},spatialReference:m.WGS84,lods:[{level:0,resolution:.703125*c,scale:2.95497598570834E8*c}]});a.ensureMaxLod(b);return a};return e})},
"esri/views/3d/terrain/TileGeometryFactory":function(){define("../webgl-engine/lib/Geometry ../webgl-engine/lib/GeometryData ../lib/glMatrix ../support/earthUtils ../support/mathUtils ./TerrainConst".split(" "),function(m,k,b,a,c,h){function g(a,b,c,d,e){a<d[0]&&(d[0]=a);a>e[0]&&(e[0]=a);b<d[1]&&(d[1]=b);b>e[1]&&(e[1]=b);c<d[2]&&(d[2]=c);c>e[2]&&(e[2]=c)}function d(a,b,d){for(var e=0;e<d.length;e++){var f=d[e];if(f){var g=f.safeWidth,l=f.width,n=f.pixelData,q=c.clamp(f.dy*(f.y1-b),0,g),f=c.clamp(f.dx*
(a-f.x0),0,g),g=Math.floor(q),k=Math.floor(f),x=g*l+k,t=x+l,u=n[x],l=n[t],x=n[x+1],n=n[t+1];if(u+l+x+n<.5*h.ELEVATION_NODATA_VALUE)return q-=g,f-=k,a=u+(x-u)*f,a+(l+(n-l)*f-a)*q}}return null}function e(a){u||65536<a*a+4*(a-1)&&(a=1<<Math.floor(c.log2(.5*(-4+Math.sqrt(262176)))));return a}var l=a.earthRadius,f=b.vec3d,n=c.lerp,u=!1,t=function(){var a=f.create(),b=f.create(),c=f.create(),d,e,g;this.init=function(h,l){e=h;g=l;f.subtract(c,b,a);d=.5*f.length(a);f.lerp(b,c,.5,a)};this.getCenter=function(){return a};
this.getBSRadius=function(){return d};this.getBBMin=function(){return b};this.getBBMax=function(){return c};this.getPosition=function(){return e};this.getIndices=function(){return g};this.getPrimitiveIndices=function(){};this.getChildren=function(){}},r=function(a,b,c,d){a*=l;for(var e=0;e<=b;e++)c[5*d]=0,c[5*d+1]=0,c[5*d+2]=a,d++},w=new function(){var a=Array(50),b=0,c={};this.get=function(e){var f=c[e];f||(f={ptr:0,data:Array(50)},c[e]=f);0<f.ptr?(d.vertexArrayHits++,e=f.data[--f.ptr],f.data[f.ptr]=
null):(d.vertexArrayMisses++,e=new Float32Array(e));if(0<b)return d.geometryHits++,f=a[--b],a[b]=null,f.getData().getVertexAttr().terrain.data=e,f;d.geometryMisses++;f={};f.terrain={size:5,data:e};e=new t;return new m(new k([{type:"triangle",indices:{terrain:null},positionKey:"terrain"}],f),"tile",[e])};this.put=function(d){var e=d.getData(),f=e.getVertexAttr(),g=f.terrain.data,h=c[g.length];50>h.ptr&&(h.data[h.ptr++]=g);f.terrain.data=null;e.getFaces()[0].indices.terrain=null;50>b&&(a[b++]=d)};var d=
{geometryHits:0,geometryMisses:0,vertexArrayHits:0,vertexArrayMisses:0};this.stats=d;this._pools={geometry:a,vertexArray:c}},q=[],x=Array(h.MAX_TILE_TESSELATION+1),y=Array(h.MAX_TILE_TESSELATION+1),z=Array(h.MAX_TILE_TESSELATION+1),A=Array(h.MAX_TILE_TESSELATION+1),C={values:null,numSurfaceIndices:0,numSkirtIndices:0},B=function(a,b,c){c||(a.values=b.values);a.numSurfaceIndices=b.numSurfaceIndices;a.numSkirtIndices=b.numSkirtIndices;return a},D=function(a,b,c,d,e){var f;f=C;var g=c&2,h=b+(d?1024:
0)+(g?2048:0),l=q[h];f||(f={});if(l)B(f,l);else{var l=b-1,n=b-1,k=b*b,x=2*l+2*n,t=l*n*6,w=6*x,y=6*(2*l+n-1);d&&(t*=2,w*=2,y*=2);for(var x=u&&65536<k+x?new Uint32Array(t+w):new Uint16Array(t+w),r=0,m=0,A=t,z,F,K,H,L=0,E=0;E<=n;E++){g&&(L=0===E?y:E===n?-y:0);for(var A=A+L,D=0;D<=l;D++)H=F=-1,0===E&&(F=k+D,D!==l&&(H=r+1)),D===l&&(F=k+l+E,E<n&&(H=r+l+1)),E===n&&(F=k+l+n+(l-D),0<D&&(H=r-1)),0===D&&0<E&&(F=k+2*l+n+(n-E),H=r-(l+1)),-1<F&&(K=0===D&&1===E?k:F+1,-1<H&&(z=r,d?(x[A+0]=z,x[A+1]=F,x[A+2]=F,x[A+
3]=K,x[A+4]=K,x[A+5]=z,x[A+6]=K,x[A+7]=H,x[A+8]=H,x[A+9]=z,x[A+10]=z,x[A+11]=K,A+=12):(x[A+0]=z,x[A+1]=F,x[A+2]=K,x[A+3]=K,x[A+4]=H,x[A+5]=z,A+=6))),++r,D<l&&E<n&&(z=E*(l+1)+D,F=z+1,K=F+(l+1),H=K-1,d?(x[m+0]=z,x[m+1]=F,x[m+2]=F,x[m+3]=K,x[m+4]=K,x[m+5]=z,x[m+6]=K,x[m+7]=H,x[m+8]=H,x[m+9]=z,x[m+10]=z,x[m+11]=K,m+=12):(x[m+0]=z,x[m+1]=F,x[m+2]=K,x[m+3]=K,x[m+4]=H,x[m+5]=z,m+=6));A-=L}f.values=x;f.numSurfaceIndices=t;f.numSkirtIndices=w;q[h]=B({},f)}g=a.getData();h=g.getVertexAttr();g.getFaces()[0].indices.terrain=
f.values;a.getBoundingInfo(0).init(h.terrain,f.values);e||(e={});e.geometry=a;e.numWithoutSkirtIndices=f.numSurfaceIndices+(c?6*(b-1)*(d?2:1):0);e.numVertsPerRow=b;return B(e,f,!0)};return{createPlanarGlobeTile:function(a,b,c,h,l,n,q){var k=b[0],x=b[1],t=b[2]-k;b=b[3]-x;var u=.1*t;a=e(a);var y=a-1,r=a-1,m=a*a,A=w.get(5*(m+(2*y+2*r))),B=A.getData().getVertexAttr().terrain.data,C,z,F=0;C=A.getBoundingInfo(0);var K=C.getBBMin(),H=C.getBBMax();f.set3(1E7,1E7,1E7,K);f.set3(-1E7,-1E7,-1E7,H);for(z=0;z<=
r;z++){var L=z/r,E=x+L*b;n&&(E<n[1]?(E=n[1],L=(E-x)/b):E>n[3]&&(E=n[3],L=(E-x)/b));for(C=0;C<=y;C++){var Q=C/y,N=k+Q*t;n&&(N<n[0]?(N=n[0],Q=(N-k)/t):N>n[2]&&(N=n[2],Q=(N-k)/t));var T=c?d(N,E,c)||0:0,N=N-h[0],U=E-h[1],T=T-h[2];g(N,U,T,K,H);B[5*F]=N;B[5*F+1]=U;B[5*F+2]=T;B[5*F+3]=Q;B[5*F+4]=L;var Z=-1;0===z&&(Z=m+C);C===y&&(Z=m+y+z);z===r&&(Z=m+y+r+(y-C));0===C&&0<z&&(Z=m+2*y+r+(r-z));-1<Z&&(B[5*Z]=N,B[5*Z+1]=U,B[5*Z+2]=T-u,B[5*Z+3]=Q,B[5*Z+4]=L,g(N,U-u,T,K,H));++F}}return D(A,a,0,l,q)},createSphericalGlobeTile:function(a,
b,c,h,q,k,t,u,m){var B=c[0],C=c[1],F=c[2],K=c[3],H=Math.max(.9,1-.5*(F-B));a=e(a);c=a-1;var L=a-1,E=a*a,Q=w.get(5*(E+(2*c+2*L))),N=Q.getData().getVertexAttr().terrain.data,J=b[2]-b[0],P=b[3]-b[1],la=F-B,F=k[0],da=k[1];k=k[2];var Y=Q.getBoundingInfo(0),V=Y.getBBMin(),Y=Y.getBBMax();f.set3(1E7,1E7,1E7,V);f.set3(-1E7,-1E7,-1E7,Y);var ba;for(ba=0;ba<=c;ba++){var T=ba/c,U=B+T*la;x[ba]=Math.sin(U);y[ba]=Math.cos(U);z[ba]=T;A[ba]=b[0]+T*J}for(B=J=0;B<=L;B++){la=B/L;ba=n(C,K,la);var U=Math.cos(ba),Z=Math.sin(ba),
G;h?(G=l/2*Math.log((1+Z)/(1-Z)),la=(G-b[1])/P):G=180*ba/Math.PI;for(ba=0;ba<=c;ba++){var T=z[ba],ja=x[ba],S=y[ba],ca=l;q&&(ca+=d(A[ba],G,q)||0);var S=S*U*ca,ja=ja*U*ca,ca=Z*ca,p=S-F,qa=ja-da,Ca=ca-k;g(p,qa,Ca,V,Y);var ma=5*J;N[ma+0]=p;N[ma+1]=qa;N[ma+2]=Ca;N[ma+3]=T;N[ma+4]=la;ma=-1;0===B&&(ma=E+ba);ba===c&&(ma=E+c+B);B===L&&(ma=E+c+L+(c-ba));0===ba&&0<B&&(ma=E+2*c+L+(L-B));-1<ma&&(S=S*H-F,ja=ja*H-da,ca=ca*H-k,g(S,ja,ca,V,Y),ma*=5,N[ma+0]=S,N[ma+1]=ja,N[ma+2]=ca,N[ma+3]=T,N[ma+4]=la);++J}}h&&(b=
!!(t&2),t&1&&r(-1,c,N,E),b&&r(1,c,N,E+c+L));return D(Q,a,h?t:0,u,m)},releaseGeometry:w.put,elevationSampler:d,_geometryObjectPool:w,supportedNumVertsPerRow:e,setSupportsUintIndices:function(a){u=a}}})},"esri/views/3d/terrain/TileRenderData":function(){define(["require","exports","../lib/glMatrix"],function(m,k,b){var a=b.vec2d;return function(){function b(){this.overlayTexOffset=a.create();this.texOffset=a.create();this.geometryInfo={geometry:null,numSurfaceIndices:0,numSkirtIndices:0,numWithoutSkirtIndices:0,
numVertsPerRow:0};this.init()}b.prototype.init=function(){this.geometryInfo.geometry=null;this.geometryInfo.numSurfaceIndices=0;this.geometryInfo.numSkirtIndices=0;this.geometryInfo.numWithoutSkirtIndices=0;this.geometryInfo.numVertsPerRow=0;this.textureReference=this.texture=this.vao=this.geometryState=null;a.set2(0,0,this.texOffset);this.texScale=1;this.overlayTexId=null;this.overlayTexScale=[1,1];this.overlayOpacity=1;this.localOrigin=null};b.prototype.updateGeometryState=function(a){return this.geometryState=
a.geometryState(this.geometryState)};return b}()})},"esri/views/3d/terrain/ResourceCounter":function(){define(["require","exports"],function(m,k){return function(){function b(){this._numTileTexturesComposited=0}Object.defineProperty(b.prototype,"numTileTexturesComposited",{get:function(){return this._numTileTexturesComposited},enumerable:!0,configurable:!0});b.prototype.incrementNumTileTexturesComposited=function(){this._numTileTexturesComposited++};b.prototype.resetNumTileTexturesComposited=function(){this._numTileTexturesComposited=
0};return b}()})},"esri/views/3d/terrain/TileRenderer":function(){define("require exports ../lib/glMatrix ../../webgl/FramebufferObject ../../webgl/VertexArrayObject ../../webgl/Texture ../../webgl/BufferObject ../../webgl/Util ../webgl-engine/lib/DefaultVertexAttributeLocations ../webgl-engine/lib/DefaultVertexBufferLayouts ../../vectorTiles/VectorTileDisplayObject ../../vectorTiles/tileRendererHelper3D ./TerrainConst".split(" "),function(m,k,b,a,c,h,g,d,e,l,f,n,u){var t=b.vec2d,r=Array(20),w=[0,
0];return function(){function b(a,b,d,f,h){this._gridTex=null;this.tileSize=256;this._context=a;this.tileSize=b;this._resourceCounter=f;this._setNeedsRender=h;a.extensions.textureFilterAnisotropic&&(this._maxAnisotropy=Math.min(8,a.parameters.maxMaxAnisotropy));b=new Float32Array(20);b[0]=-1;b[1]=-1;b[2]=0;b[3]=0;b[4]=0;b[5]=1;b[6]=-1;b[7]=0;b[8]=1;b[9]=0;b[10]=-1;b[11]=1;b[12]=0;b[13]=0;b[14]=1;b[15]=1;b[16]=1;b[17]=0;b[18]=1;b[19]=1;this._vaoQuad=new c(a,e.Default3D,{geometry:l.Pos3Tex},{geometry:g.createVertex(a,
35044,b)});this._blendLayersProgram=d.get("blendLayers")}b.prototype.dispose=function(){this._fbo&&(this._fbo.dispose(),this._fbo=null);this._vaoQuad&&(this._vaoQuad.dispose(),this._vaoQuad=null);this._gridTex&&(this._gridTex.dispose(),this._gridTex=null);this._blendLayersProgram&&(this._blendLayersProgram.dispose(),this._blendLayersProgram=null);this._context=null};b.prototype.updateTileTexture=function(a){for(var b=u.LayerClass.MAP,c=a.layerInfo[b],d=0;d<c.length;d++)c[d].pendingUpdates&=~u.TileUpdateTypes.UPDATE_TEXTURE;
if(a.renderData){var e,d=a.renderData,f,g=0,h=!0;for(f=0;f<c.length;f++){e=c[f];var l=a.parentSurface.layerViewByIndex(f,b);r[f]=l.fullOpacity;if(e.data||e.upsampleFromTile)if(g++,!l.isTransparent){h=!1;break}}f===c.length&&f--;0===g&&this._gridTex?(d.textureReference=this._gridTex,t.set2(0,0,d.texOffset),d.texScale=1):1!==g||h?(this._composeMapLayers(a,c,f,h,r),d.textureReference=null,t.set2(0,0,d.texOffset),d.texScale=1):(e=c[f],e.data?(b=e,t.set2(0,0,d.texOffset),d.texScale=1):(a=e.upsampleFromTile,
b=a.tile.layerInfo[b][f],t.set(a.offset,d.texOffset),d.texScale=a.scale),b&&(b.data instanceof HTMLImageElement&&(b.data=this._buildTexture(b.data)),d.textureReference=b.data));this._setNeedsRender()}};b.prototype.setGridImage=function(a){this._gridTex=this._buildTexture(a)};b.prototype._buildTexture=function(a){var b={target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,maxAnisotropy:this._maxAnisotropy,flipped:!0,hasMipmap:!0},c=this._context,d;if(a)try{d=new h(c,b,a)}catch(C){b.width=
b.height=this.tileSize,d=new h(c,b),console.warn("TerrainRenderer: failed to execute 'texImage2D', cross-origin image may not be loaded.")}else b.width=b.height=this.tileSize,d=new h(c,b);c.bindTexture(d);d.generateMipmap();return d};b.prototype._drawVectorData=function(a,b,c,d,e,f,g,h){void 0===h&&(h=1);n(this._context,c,a,b.renderer,b.schemeHelper,c[0],d,e,0,f,g,h)};b.prototype._drawRasterData=function(a,b,c,e){void 0===e&&(e=1);var f=this._context,g=this._blendLayersProgram,h=this._vaoQuad;f.bindProgram(g);
f.bindVAO(h);d.assertCompatibleVertexAttributeLocations(h,g);f.bindTexture(a,0);g.setUniform1i("tex",0);g.setUniform1f("scale",b);g.setUniform2f("offset",c[0],c[1]);g.setUniform1f("opacity",e);f.drawArrays(5,0,d.vertexCount(h,"geometry"))};b.prototype._composeMapLayers=function(b,c,d,e,g){var h=u.LayerClass.MAP,l=this._context;b.renderData.texture||(b.renderData.texture=this._buildTexture());var n=b.renderData.texture,q=this._fbo;q&&q.width===n.descriptor.width&&q.height===n.descriptor.height||(this._fbo=
q=a.create(l,{colorTarget:0,depthStencilTarget:1,width:n.descriptor.width,height:n.descriptor.height}));var k=l.gl;l.bindFramebuffer(q);l.setViewport(0,0,this.tileSize,this.tileSize);l.setClearColor(0,0,0,0);l.setClearDepth(1);l.clear(k.COLOR_BUFFER_BIT|k.DEPTH_BUFFER_BIT);l.setDepthTestEnabled(!1);l.setBlendFunctionSeparate(1,771,1,771);l.setBlendEquation(32774);l.setBlendingEnabled(!0);var x,t;for(e&&this._gridTex&&this._drawRasterData(this._gridTex,1,w);0<=d;d--)e=null,q=c[d],q.data?(e=q,x=w,t=
1):q.upsampleFromTile&&(t=q.upsampleFromTile,e=t.tile.layerInfo[h][d],x=t.offset,t=t.scale),e&&(e.data instanceof HTMLImageElement&&(e.data=this._buildTexture(e.data)),e.data instanceof f?(q=b.parentSurface.layerViewByIndex(d,h),this._drawVectorData(e.data,q,b.lij,n.descriptor.width,n.descriptor.height,t,x,g[d])):this._drawRasterData(e.data,t,x,g[d]));l.bindTexture(n);k.copyTexImage2D(l.gl.TEXTURE_2D,0,n.descriptor.pixelFormat,0,0,n.descriptor.width,n.descriptor.height,0);n.generateMipmap();l.bindFramebuffer(null);
l.setBlendFunctionSeparate(770,771,1,771);l.setBlendingEnabled(!1);this._resourceCounter.incrementNumTileTexturesComposited()};return b}()})},"esri/views/vectorTiles/VectorTileDisplayObject":function(){define("require exports ../../core/tsSupport/extendsHelper ../webgl/BufferObject ../2d/engine/DisplayObject ../../core/libs/gl-matrix/vec2 ../../core/libs/gl-matrix/mat4 ./RenderBucket".split(" "),function(m,k,b,a,c,h,g,d){return function(c){function e(a,b,d,e,l,k,q,x,y,m,A){var f=c.call(this)||this;
f._renderBuckets=[];f._vectorTileData=null;f._symbolUpdateData=null;f.coords=[0,0];f.tileTransform={transform:Float32Array[16],displayCoord:Float32Array[2]};f.stencilData={mask:0,reference:0};f.key=a;f.refKey=b;f.coords[0]=d[0];f.coords[1]=d[1];f.widthInPixels=e;f.coordRange=l;f.rotation=k;f._vectorTileData=q;f.styleLayers=x;f._glyphsMosaic=y;f.workerID=m;f._connection=A;f.id=a.id;f.status=3;f.tileTransform.transform=g.create();f.tileTransform.displayCoord=h.create();return f}b(e,c);e.prototype.updateSymbolData=
function(a){a&&(this._symbolUpdateData=a,this.requestRender())};e.prototype.dispose=function(){-1!==this.workerID&&this._connection&&6!==this.status&&7!==this.status&&this._connection.broadcast("destructTileData",{key:this.id,worker:this.workerID},[]);this.polygonTrianglesVertexArrayObject&&(this.polygonTrianglesVertexArrayObject.dispose(),this.polygonTrianglesVertexArrayObject=null);this.polygonOutlineVertexArrayObject&&(this.polygonOutlineVertexArrayObject.dispose(),this.polygonOutlineVertexArrayObject=
null);this.lineTrianglesVertexArrayObject&&(this.lineTrianglesVertexArrayObject.dispose(),this.lineTrianglesVertexArrayObject=null);this.lineJoinsVertexArrayObject&&(this.lineJoinsVertexArrayObject.dispose(),this.lineJoinsVertexArrayObject=null);this.iconVertexArrayObject&&(this.iconVertexArrayObject.dispose(),this.iconVertexArrayObject=null);this.textVertexArrayObject&&(this.textVertexArrayObject.dispose(),this.textVertexArrayObject=null);this.polygonTrianglesVertexBuffer&&(this.polygonTrianglesVertexBuffer.dispose(),
this.polygonTrianglesVertexBuffer=null);this.polygonTrianglesIndexBuffer&&(this.polygonTrianglesIndexBuffer.dispose(),this.polygonTrianglesIndexBuffer=null);this.polygonOutlinesVertexBuffer&&(this.polygonOutlinesVertexBuffer.dispose(),this.polygonOutlinesVertexBuffer=null);this.polygonOutlinesIndexBuffer&&(this.polygonOutlinesIndexBuffer.dispose(),this.polygonOutlinesIndexBuffer=null);this.lineVertexBuffer&&(this.lineVertexBuffer.dispose(),this.lineVertexBuffer=null);this.lineTrianglesIndexBuffer&&
(this.lineTrianglesIndexBuffer.dispose(),this.lineTrianglesIndexBuffer=null);this.lineJoinVertexBuffer&&(this.lineJoinVertexBuffer.dispose(),this.lineJoinVertexBuffer=null);this.iconVertexBuffer&&(this.iconVertexBuffer.dispose(),this.iconVertexBuffer=null);this.iconIndexBuffer&&(this.iconIndexBuffer.dispose(),this.iconIndexBuffer=null);this.textVertexBuffer&&(this.textVertexBuffer.dispose(),this.textVertexBuffer=null);this.textIndexBuffer&&(this.textIndexBuffer.dispose(),this.textIndexBuffer=null);
this._renderBuckets=[];this.status=7};e.prototype.attach=function(b){this.status=3;if(!this._vectorTileData)return!1;if(0===this._renderBuckets.length)for(var c=new Uint32Array(this._vectorTileData.bucketDataInfo),e=c.length,f=0;f<e;){var g=c[f],h=c[f+1];if(0===h)h=new d.BackgroundRenderBucket,h.layerID=g,this._renderBuckets.push(h),f+=2;else if(1===h)h=new d.FillRenderBucket,h.layerID=g,h.triangleElementStart=c[f+2],h.triangleElementCount=c[f+3],h.outlineElementStart=c[f+4],h.outlineElementCount=
c[f+5],this._renderBuckets.push(h),f+=6;else if(2===h)h=new d.LineRenderBucket,h.layerID=g,h.triangleElementStart=c[f+2],h.triangleElementCount=c[f+3],h.joinStart=c[f+4],h.joinCount=c[f+5],this._renderBuckets.push(h),f+=6;else if(3===h){h=new d.SymbolRenderBucket;h.layerID=g;h.textElementStart=c[f+2];h.textElementCount=c[f+3];h.isSDF=0!==c[f+4];g=c[f+5];if(0<g)for(var l=f+6,k=void 0,y=void 0,m=void 0,A=0;A<g;A++)k=c[l],y=c[l+1],m=c[l+2],h.markerPerPageElementsMap.set(k,[y,m]),l+=3;this._renderBuckets.push(h);
f+=6+3*g}else console.error("Bad bucket type!")}c=b.context;b=b.budget;e=new Uint32Array(this._vectorTileData.bufferDataInfo);f=e.length;for(g=h=0;g<f;g+=2,h++)if(l=e[g+1],!(0>=l||0===this._vectorTileData.bufferData[h].byteLength)){if(b&&b.done)return!1;switch(e[g]){case 2:this.polygonTrianglesVertexBuffer||(this.polygonTrianglesVertexBuffer=a.createVertex(c,35044,this._vectorTileData.bufferData[h]));break;case 6:this.polygonTrianglesIndexBuffer||(this.polygonTrianglesIndexBuffer=a.createIndex(c,
35044,new Uint32Array(this._vectorTileData.bufferData[h],0,l/4)));break;case 3:this.polygonOutlinesVertexBuffer||(this.polygonOutlinesVertexBuffer=a.createVertex(c,35044,this._vectorTileData.bufferData[h]));break;case 7:this.polygonOutlinesIndexBuffer||(this.polygonOutlinesIndexBuffer=a.createIndex(c,35044,new Uint32Array(this._vectorTileData.bufferData[h],0,l/4)));break;case 0:this.lineVertexBuffer||(this.lineVertexBuffer=a.createVertex(c,35044,this._vectorTileData.bufferData[h]));break;case 8:this.lineTrianglesIndexBuffer||
(this.lineTrianglesIndexBuffer=a.createIndex(c,35044,this._vectorTileData.bufferData[h]));break;case 1:this.lineJoinVertexBuffer||(this.lineJoinVertexBuffer=a.createVertex(c,35044,this._vectorTileData.bufferData[h]));break;case 4:this.iconVertexBuffer||(this.iconVertexBuffer=a.createVertex(c,35044,this._vectorTileData.bufferData[h]));break;case 9:this.iconIndexBuffer||(this.iconIndexBuffer=a.createIndex(c,35044,new Uint32Array(this._vectorTileData.bufferData[h],0,l/4)));break;case 5:this.textVertexBuffer||
(this.textVertexBuffer=a.createVertex(c,35044,this._vectorTileData.bufferData[h]));break;case 10:this.textIndexBuffer||(this.textIndexBuffer=a.createIndex(c,35044,new Uint32Array(this._vectorTileData.bufferData[h],0,l/4)))}}this.status=4;return!0};e.prototype.detach=function(a){};e.prototype.render=function(a){if(this.visible&&4===this.status){var b=a.context,c=a.renderer;if(b&&c){var d=a.drawphase;this._symbolUpdateData&&this._updateSymbolData(a);b.setStencilFunction(514,this.stencilData.reference,
this.stencilData.mask);var e=this.styleLayers,f=void 0!==a.layerOpacity?a.layerOpacity:1;if(0!==f){var g,h=this._renderBuckets.length,l=0;if(0===d)for(l=h-1;0<=l;l--)g=this._renderBuckets[l],3!==g.type&&g.hasData()&&c.renderBucket(b,g,a.displayLevel,a.requiredLevel,d,this,e.layers[g.layerID],f);else for(l=0;l<h;l++)g=this._renderBuckets[l],g.hasData()&&c.renderBucket(b,g,a.displayLevel,a.requiredLevel,d,this,e.layers[g.layerID],f)}}}};e.prototype._updateSymbolData=function(b){var c=new Uint32Array(this._symbolUpdateData.bucketDataInfo),
e=c.length;if(0===e)return this._symbolUpdateData=null,!0;if(1>b.budget.remaining)return this.requestRender(),!1;b=b.context;b.bindVAO(null);for(var f=new Uint32Array(this._symbolUpdateData.bufferDataInfo),g=f.length,h=0,l=0;l<g;l+=2,h++){var k=f[l+1];if(!(0>=k||0===this._symbolUpdateData.bufferData[h].byteLength))switch(f[l]){case 4:this.iconVertexBuffer&&(this.iconVertexBuffer.dispose(),this.iconVertexBuffer=null);this.iconVertexBuffer=a.createVertex(b,35044,this._symbolUpdateData.bufferData[h]);
break;case 9:this.iconIndexBuffer&&(this.iconIndexBuffer.dispose(),this.iconIndexBuffer=null);this.iconIndexBuffer=a.createIndex(b,35044,new Uint32Array(this._symbolUpdateData.bufferData[h],0,k/4));break;case 5:this.textVertexBuffer&&(this.textVertexBuffer.dispose(),this.textVertexBuffer=null);this.textVertexBuffer=a.createVertex(b,35044,this._symbolUpdateData.bufferData[h]);break;case 10:this.textIndexBuffer&&(this.textIndexBuffer.dispose(),this.textIndexBuffer=null),this.textIndexBuffer=a.createIndex(b,
35044,new Uint32Array(this._symbolUpdateData.bufferData[h],0,k/4))}}b=this._renderBuckets.length;for(f=0;f<b;f++)this._renderBuckets[f]instanceof d.SymbolRenderBucket&&(g=this._renderBuckets[f],g.markerPerPageElementsMap.clear(),g.textElementStart=0,g.textElementCount=0);for(b=0;b<e;){h=c[b];g=-1;l=this._renderBuckets.length;for(f=0;f<l;f++)if(this._renderBuckets[f].layerID===h){g=f;break}-1===g&&console.log("bucket not found");if(f=this._renderBuckets[g]){f.textElementStart=c[b+2];f.textElementCount=
c[b+3];for(var g=c[b+5],h=b+6,y=k=l=void 0,m=0;m<g;m++)l=c[h],k=c[h+1],y=c[h+2],f.markerPerPageElementsMap.set(l,[k,y]),h+=3;b+=6+3*g}else b+=7}this.iconVertexArrayObject&&(this.iconVertexArrayObject.dispose(),this.iconVertexArrayObject=null);this.textVertexArrayObject&&(this.textVertexArrayObject.dispose(),this.textVertexArrayObject=null);this._symbolUpdateData=null;return!0};return e}(c)})},"esri/views/2d/engine/DisplayObject":function(){define(["require","exports","../../../core/tsSupport/extendsHelper"],
function(m,k,b){var a=0;return function(){function b(){this.attached=!1;this._opacity=1;this._visible=!0;Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-do-"+a++})}Object.defineProperty(b.prototype,"opacity",{get:function(){return this._opacity},set:function(a){this._opacity!==a&&(this._opacity=a,this.requestRender())},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"visible",{get:function(){return this._visible},set:function(a){this._visible!==
a&&(this._visible=a,this.requestRender())},enumerable:!0,configurable:!0});b.prototype.requestRender=function(){this.parent&&this.parent.requestChildRender(this)};b.prototype.dispose=function(){};return b}()})},"esri/core/libs/gl-matrix/vec2":function(){define(["./common"],function(m){var k={create:function(){var b=new m.ARRAY_TYPE(2);b[0]=0;b[1]=0;return b},clone:function(b){var a=new m.ARRAY_TYPE(2);a[0]=b[0];a[1]=b[1];return a},fromValues:function(b,a){var c=new m.ARRAY_TYPE(2);c[0]=b;c[1]=a;return c},
copy:function(b,a){b[0]=a[0];b[1]=a[1];return b},set:function(b,a,c){b[0]=a;b[1]=c;return b},add:function(b,a,c){b[0]=a[0]+c[0];b[1]=a[1]+c[1];return b},subtract:function(b,a,c){b[0]=a[0]-c[0];b[1]=a[1]-c[1];return b}};k.sub=k.subtract;k.multiply=function(b,a,c){b[0]=a[0]*c[0];b[1]=a[1]*c[1];return b};k.mul=k.multiply;k.divide=function(b,a,c){b[0]=a[0]/c[0];b[1]=a[1]/c[1];return b};k.div=k.divide;k.ceil=function(b,a){b[0]=Math.ceil(a[0]);b[1]=Math.ceil(a[1]);return b};k.floor=function(b,a){b[0]=Math.floor(a[0]);
b[1]=Math.floor(a[1]);return b};k.min=function(b,a,c){b[0]=Math.min(a[0],c[0]);b[1]=Math.min(a[1],c[1]);return b};k.max=function(b,a,c){b[0]=Math.max(a[0],c[0]);b[1]=Math.max(a[1],c[1]);return b};k.round=function(b,a){b[0]=Math.round(a[0]);b[1]=Math.round(a[1]);return b};k.scale=function(b,a,c){b[0]=a[0]*c;b[1]=a[1]*c;return b};k.scaleAndAdd=function(b,a,c,h){b[0]=a[0]+c[0]*h;b[1]=a[1]+c[1]*h;return b};k.distance=function(b,a){var c=a[0]-b[0];b=a[1]-b[1];return Math.sqrt(c*c+b*b)};k.dist=k.distance;
k.squaredDistance=function(b,a){var c=a[0]-b[0];b=a[1]-b[1];return c*c+b*b};k.sqrDist=k.squaredDistance;k.length=function(b){var a=b[0];b=b[1];return Math.sqrt(a*a+b*b)};k.len=k.length;k.squaredLength=function(b){var a=b[0];b=b[1];return a*a+b*b};k.sqrLen=k.squaredLength;k.negate=function(b,a){b[0]=-a[0];b[1]=-a[1];return b};k.inverse=function(b,a){b[0]=1/a[0];b[1]=1/a[1];return b};k.normalize=function(b,a){var c=a[0],h=a[1],c=c*c+h*h;0<c&&(c=1/Math.sqrt(c),b[0]=a[0]*c,b[1]=a[1]*c);return b};k.dot=
function(b,a){return b[0]*a[0]+b[1]*a[1]};k.cross=function(b,a,c){a=a[0]*c[1]-a[1]*c[0];b[0]=b[1]=0;b[2]=a;return b};k.lerp=function(b,a,c,h){var g=a[0];a=a[1];b[0]=g+h*(c[0]-g);b[1]=a+h*(c[1]-a);return b};k.random=function(b,a){a=a||1;var c=2*m.RANDOM()*Math.PI;b[0]=Math.cos(c)*a;b[1]=Math.sin(c)*a;return b};k.transformMat2=function(b,a,c){var h=a[0];a=a[1];b[0]=c[0]*h+c[2]*a;b[1]=c[1]*h+c[3]*a;return b};k.transformMat2d=function(b,a,c){var h=a[0];a=a[1];b[0]=c[0]*h+c[2]*a+c[4];b[1]=c[1]*h+c[3]*
a+c[5];return b};k.transformMat3=function(b,a,c){var h=a[0];a=a[1];b[0]=c[0]*h+c[3]*a+c[6];b[1]=c[1]*h+c[4]*a+c[7];return b};k.transformMat4=function(b,a,c){var h=a[0];a=a[1];b[0]=c[0]*h+c[4]*a+c[12];b[1]=c[1]*h+c[5]*a+c[13];return b};k.forEach=function(){var b=k.create();return function(a,c,h,g,d,e){c||(c=2);h||(h=0);for(g=g?Math.min(g*c+h,a.length):a.length;h<g;h+=c)b[0]=a[h],b[1]=a[h+1],d(b,b,e),a[h]=b[0],a[h+1]=b[1];return a}}();k.str=function(b){return"vec2("+b[0]+", "+b[1]+")"};k.exactEquals=
function(b,a){return b[0]===a[0]&&b[1]===a[1]};k.equals=function(b,a){var c=b[0];b=b[1];var h=a[0];a=a[1];return Math.abs(c-h)<=m.EPSILON*Math.max(1,Math.abs(c),Math.abs(h))&&Math.abs(b-a)<=m.EPSILON*Math.max(1,Math.abs(b),Math.abs(a))};return k})},"esri/core/libs/gl-matrix/common":function(){define([],function(){var m={EPSILON:1E-6};m.ARRAY_TYPE="undefined"!==typeof Float32Array?Float32Array:Array;m.RANDOM=Math.random;m.ENABLE_SIMD=!1;m.SIMD_AVAILABLE=m.ARRAY_TYPE===Float32Array&&"SIMD"in this;m.USE_SIMD=
m.ENABLE_SIMD&&m.SIMD_AVAILABLE;m.setMatrixArrayType=function(b){m.ARRAY_TYPE=b};var k=Math.PI/180;m.toRadian=function(b){return b*k};m.equals=function(b,a){return Math.abs(b-a)<=m.EPSILON*Math.max(1,Math.abs(b),Math.abs(a))};return m})},"esri/core/libs/gl-matrix/mat4":function(){define(["./common"],function(m){var k={scalar:{},SIMD:{},create:function(){var b=new m.ARRAY_TYPE(16);b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=1;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=1;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;
return b},clone:function(b){var a=new m.ARRAY_TYPE(16);a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a},copy:function(b,a){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b},fromValues:function(b,a,c,h,g,d,e,l,f,n,k,t,r,w,q,x){var u=new m.ARRAY_TYPE(16);
u[0]=b;u[1]=a;u[2]=c;u[3]=h;u[4]=g;u[5]=d;u[6]=e;u[7]=l;u[8]=f;u[9]=n;u[10]=k;u[11]=t;u[12]=r;u[13]=w;u[14]=q;u[15]=x;return u},set:function(b,a,c,h,g,d,e,l,f,n,k,t,r,w,q,x,y){b[0]=a;b[1]=c;b[2]=h;b[3]=g;b[4]=d;b[5]=e;b[6]=l;b[7]=f;b[8]=n;b[9]=k;b[10]=t;b[11]=r;b[12]=w;b[13]=q;b[14]=x;b[15]=y;return b},identity:function(b){b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=1;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=1;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b}};k.scalar.transpose=function(b,a){if(b===a){var c=
a[1],h=a[2],g=a[3],d=a[6],e=a[7],l=a[11];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=c;b[6]=a[9];b[7]=a[13];b[8]=h;b[9]=d;b[11]=a[14];b[12]=g;b[13]=e;b[14]=l}else b[0]=a[0],b[1]=a[4],b[2]=a[8],b[3]=a[12],b[4]=a[1],b[5]=a[5],b[6]=a[9],b[7]=a[13],b[8]=a[2],b[9]=a[6],b[10]=a[10],b[11]=a[14],b[12]=a[3],b[13]=a[7],b[14]=a[11],b[15]=a[15];return b};k.SIMD.transpose=function(b,a){var c,h,g,d,e,l;c=SIMD.Float32x4.load(a,0);h=SIMD.Float32x4.load(a,4);g=SIMD.Float32x4.load(a,8);a=SIMD.Float32x4.load(a,12);d=SIMD.Float32x4.shuffle(c,
h,0,1,4,5);e=SIMD.Float32x4.shuffle(g,a,0,1,4,5);l=SIMD.Float32x4.shuffle(d,e,0,2,4,6);d=SIMD.Float32x4.shuffle(d,e,1,3,5,7);SIMD.Float32x4.store(b,0,l);SIMD.Float32x4.store(b,4,d);d=SIMD.Float32x4.shuffle(c,h,2,3,6,7);e=SIMD.Float32x4.shuffle(g,a,2,3,6,7);c=SIMD.Float32x4.shuffle(d,e,0,2,4,6);h=SIMD.Float32x4.shuffle(d,e,1,3,5,7);SIMD.Float32x4.store(b,8,c);SIMD.Float32x4.store(b,12,h);return b};k.transpose=m.USE_SIMD?k.SIMD.transpose:k.scalar.transpose;k.scalar.invert=function(b,a){var c=a[0],h=
a[1],g=a[2],d=a[3],e=a[4],l=a[5],f=a[6],n=a[7],k=a[8],t=a[9],r=a[10],w=a[11],q=a[12],x=a[13],y=a[14];a=a[15];var m=c*l-h*e,A=c*f-g*e,C=c*n-d*e,B=h*f-g*l,D=h*n-d*l,H=g*n-d*f,K=k*x-t*q,E=k*y-r*q,F=k*a-w*q,L=t*y-r*x,Q=t*a-w*x,N=r*a-w*y,J=m*N-A*Q+C*L+B*F-D*E+H*K;if(!J)return null;J=1/J;b[0]=(l*N-f*Q+n*L)*J;b[1]=(g*Q-h*N-d*L)*J;b[2]=(x*H-y*D+a*B)*J;b[3]=(r*D-t*H-w*B)*J;b[4]=(f*F-e*N-n*E)*J;b[5]=(c*N-g*F+d*E)*J;b[6]=(y*C-q*H-a*A)*J;b[7]=(k*H-r*C+w*A)*J;b[8]=(e*Q-l*F+n*K)*J;b[9]=(h*F-c*Q-d*K)*J;b[10]=(q*
D-x*C+a*m)*J;b[11]=(t*C-k*D-w*m)*J;b[12]=(l*E-e*L-f*K)*J;b[13]=(c*L-h*E+g*K)*J;b[14]=(x*A-q*B-y*m)*J;b[15]=(k*B-t*A+r*m)*J;return b};k.SIMD.invert=function(b,a){var c,h,g,d,e,l,f,n;e=SIMD.Float32x4.load(a,0);l=SIMD.Float32x4.load(a,4);f=SIMD.Float32x4.load(a,8);n=SIMD.Float32x4.load(a,12);a=SIMD.Float32x4.shuffle(e,l,0,1,4,5);h=SIMD.Float32x4.shuffle(f,n,0,1,4,5);c=SIMD.Float32x4.shuffle(a,h,0,2,4,6);h=SIMD.Float32x4.shuffle(h,a,1,3,5,7);a=SIMD.Float32x4.shuffle(e,l,2,3,6,7);d=SIMD.Float32x4.shuffle(f,
n,2,3,6,7);g=SIMD.Float32x4.shuffle(a,d,0,2,4,6);d=SIMD.Float32x4.shuffle(d,a,1,3,5,7);a=SIMD.Float32x4.mul(g,d);a=SIMD.Float32x4.swizzle(a,1,0,3,2);e=SIMD.Float32x4.mul(h,a);l=SIMD.Float32x4.mul(c,a);a=SIMD.Float32x4.swizzle(a,2,3,0,1);e=SIMD.Float32x4.sub(SIMD.Float32x4.mul(h,a),e);l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,a),l);l=SIMD.Float32x4.swizzle(l,2,3,0,1);a=SIMD.Float32x4.mul(h,g);a=SIMD.Float32x4.swizzle(a,1,0,3,2);e=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,a),e);n=SIMD.Float32x4.mul(c,
a);a=SIMD.Float32x4.swizzle(a,2,3,0,1);e=SIMD.Float32x4.sub(e,SIMD.Float32x4.mul(d,a));n=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,a),n);n=SIMD.Float32x4.swizzle(n,2,3,0,1);a=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,2,3,0,1),d);a=SIMD.Float32x4.swizzle(a,1,0,3,2);g=SIMD.Float32x4.swizzle(g,2,3,0,1);e=SIMD.Float32x4.add(SIMD.Float32x4.mul(g,a),e);f=SIMD.Float32x4.mul(c,a);a=SIMD.Float32x4.swizzle(a,2,3,0,1);e=SIMD.Float32x4.sub(e,SIMD.Float32x4.mul(g,a));f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,
a),f);f=SIMD.Float32x4.swizzle(f,2,3,0,1);a=SIMD.Float32x4.mul(c,h);a=SIMD.Float32x4.swizzle(a,1,0,3,2);f=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,a),f);n=SIMD.Float32x4.sub(SIMD.Float32x4.mul(g,a),n);a=SIMD.Float32x4.swizzle(a,2,3,0,1);f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(d,a),f);n=SIMD.Float32x4.sub(n,SIMD.Float32x4.mul(g,a));a=SIMD.Float32x4.mul(c,d);a=SIMD.Float32x4.swizzle(a,1,0,3,2);l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(g,a));f=SIMD.Float32x4.add(SIMD.Float32x4.mul(h,a),f);a=SIMD.Float32x4.swizzle(a,
2,3,0,1);l=SIMD.Float32x4.add(SIMD.Float32x4.mul(g,a),l);f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(h,a));a=SIMD.Float32x4.mul(c,g);a=SIMD.Float32x4.swizzle(a,1,0,3,2);l=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,a),l);n=SIMD.Float32x4.sub(n,SIMD.Float32x4.mul(h,a));a=SIMD.Float32x4.swizzle(a,2,3,0,1);l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(d,a));n=SIMD.Float32x4.add(SIMD.Float32x4.mul(h,a),n);c=SIMD.Float32x4.mul(c,e);c=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(c,2,3,0,1),c);c=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(c,
1,0,3,2),c);a=SIMD.Float32x4.reciprocalApproximation(c);c=SIMD.Float32x4.sub(SIMD.Float32x4.add(a,a),SIMD.Float32x4.mul(c,SIMD.Float32x4.mul(a,a)));c=SIMD.Float32x4.swizzle(c,0,0,0,0);if(!c)return null;SIMD.Float32x4.store(b,0,SIMD.Float32x4.mul(c,e));SIMD.Float32x4.store(b,4,SIMD.Float32x4.mul(c,l));SIMD.Float32x4.store(b,8,SIMD.Float32x4.mul(c,f));SIMD.Float32x4.store(b,12,SIMD.Float32x4.mul(c,n));return b};k.invert=m.USE_SIMD?k.SIMD.invert:k.scalar.invert;k.scalar.adjoint=function(b,a){var c=a[0],
h=a[1],g=a[2],d=a[3],e=a[4],l=a[5],f=a[6],n=a[7],k=a[8],t=a[9],r=a[10],w=a[11],q=a[12],x=a[13],y=a[14];a=a[15];b[0]=l*(r*a-w*y)-t*(f*a-n*y)+x*(f*w-n*r);b[1]=-(h*(r*a-w*y)-t*(g*a-d*y)+x*(g*w-d*r));b[2]=h*(f*a-n*y)-l*(g*a-d*y)+x*(g*n-d*f);b[3]=-(h*(f*w-n*r)-l*(g*w-d*r)+t*(g*n-d*f));b[4]=-(e*(r*a-w*y)-k*(f*a-n*y)+q*(f*w-n*r));b[5]=c*(r*a-w*y)-k*(g*a-d*y)+q*(g*w-d*r);b[6]=-(c*(f*a-n*y)-e*(g*a-d*y)+q*(g*n-d*f));b[7]=c*(f*w-n*r)-e*(g*w-d*r)+k*(g*n-d*f);b[8]=e*(t*a-w*x)-k*(l*a-n*x)+q*(l*w-n*t);b[9]=-(c*
(t*a-w*x)-k*(h*a-d*x)+q*(h*w-d*t));b[10]=c*(l*a-n*x)-e*(h*a-d*x)+q*(h*n-d*l);b[11]=-(c*(l*w-n*t)-e*(h*w-d*t)+k*(h*n-d*l));b[12]=-(e*(t*y-r*x)-k*(l*y-f*x)+q*(l*r-f*t));b[13]=c*(t*y-r*x)-k*(h*y-g*x)+q*(h*r-g*t);b[14]=-(c*(l*y-f*x)-e*(h*y-g*x)+q*(h*f-g*l));b[15]=c*(l*r-f*t)-e*(h*r-g*t)+k*(h*f-g*l);return b};k.SIMD.adjoint=function(b,a){var c,h,g,d,e,l,f,n;c=SIMD.Float32x4.load(a,0);h=SIMD.Float32x4.load(a,4);g=SIMD.Float32x4.load(a,8);d=SIMD.Float32x4.load(a,12);l=SIMD.Float32x4.shuffle(c,h,0,1,4,5);
e=SIMD.Float32x4.shuffle(g,d,0,1,4,5);a=SIMD.Float32x4.shuffle(l,e,0,2,4,6);e=SIMD.Float32x4.shuffle(e,l,1,3,5,7);l=SIMD.Float32x4.shuffle(c,h,2,3,6,7);h=SIMD.Float32x4.shuffle(g,d,2,3,6,7);c=SIMD.Float32x4.shuffle(l,h,0,2,4,6);h=SIMD.Float32x4.shuffle(h,l,1,3,5,7);l=SIMD.Float32x4.mul(c,h);l=SIMD.Float32x4.swizzle(l,1,0,3,2);g=SIMD.Float32x4.mul(e,l);d=SIMD.Float32x4.mul(a,l);l=SIMD.Float32x4.swizzle(l,2,3,0,1);g=SIMD.Float32x4.sub(SIMD.Float32x4.mul(e,l),g);d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,
l),d);d=SIMD.Float32x4.swizzle(d,2,3,0,1);l=SIMD.Float32x4.mul(e,c);l=SIMD.Float32x4.swizzle(l,1,0,3,2);g=SIMD.Float32x4.add(SIMD.Float32x4.mul(h,l),g);n=SIMD.Float32x4.mul(a,l);l=SIMD.Float32x4.swizzle(l,2,3,0,1);g=SIMD.Float32x4.sub(g,SIMD.Float32x4.mul(h,l));n=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,l),n);n=SIMD.Float32x4.swizzle(n,2,3,0,1);l=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(e,2,3,0,1),h);l=SIMD.Float32x4.swizzle(l,1,0,3,2);c=SIMD.Float32x4.swizzle(c,2,3,0,1);g=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,
l),g);f=SIMD.Float32x4.mul(a,l);l=SIMD.Float32x4.swizzle(l,2,3,0,1);g=SIMD.Float32x4.sub(g,SIMD.Float32x4.mul(c,l));f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,l),f);f=SIMD.Float32x4.swizzle(f,2,3,0,1);l=SIMD.Float32x4.mul(a,e);l=SIMD.Float32x4.swizzle(l,1,0,3,2);f=SIMD.Float32x4.add(SIMD.Float32x4.mul(h,l),f);n=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,l),n);l=SIMD.Float32x4.swizzle(l,2,3,0,1);f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(h,l),f);n=SIMD.Float32x4.sub(n,SIMD.Float32x4.mul(c,l));l=SIMD.Float32x4.mul(a,
h);l=SIMD.Float32x4.swizzle(l,1,0,3,2);d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(c,l));f=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,l),f);l=SIMD.Float32x4.swizzle(l,2,3,0,1);d=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,l),d);f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(e,l));l=SIMD.Float32x4.mul(a,c);l=SIMD.Float32x4.swizzle(l,1,0,3,2);d=SIMD.Float32x4.add(SIMD.Float32x4.mul(h,l),d);n=SIMD.Float32x4.sub(n,SIMD.Float32x4.mul(e,l));l=SIMD.Float32x4.swizzle(l,2,3,0,1);d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(h,
l));n=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,l),n);SIMD.Float32x4.store(b,0,g);SIMD.Float32x4.store(b,4,d);SIMD.Float32x4.store(b,8,f);SIMD.Float32x4.store(b,12,n);return b};k.adjoint=m.USE_SIMD?k.SIMD.adjoint:k.scalar.adjoint;k.determinant=function(b){var a=b[0],c=b[1],h=b[2],g=b[3],d=b[4],e=b[5],l=b[6],f=b[7],n=b[8],k=b[9],t=b[10],r=b[11],w=b[12],q=b[13],x=b[14];b=b[15];return(a*e-c*d)*(t*b-r*x)-(a*l-h*d)*(k*b-r*q)+(a*f-g*d)*(k*x-t*q)+(c*l-h*e)*(n*b-r*w)-(c*f-g*e)*(n*x-t*w)+(h*f-g*l)*(n*q-k*w)};
k.SIMD.multiply=function(b,a,c){var h=SIMD.Float32x4.load(a,0),g=SIMD.Float32x4.load(a,4),d=SIMD.Float32x4.load(a,8);a=SIMD.Float32x4.load(a,12);var e=SIMD.Float32x4.load(c,0),e=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(e,0,0,0,0),h),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(e,1,1,1,1),g),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(e,2,2,2,2),d),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(e,3,3,3,3),a))));SIMD.Float32x4.store(b,0,e);e=SIMD.Float32x4.load(c,
4);e=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(e,0,0,0,0),h),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(e,1,1,1,1),g),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(e,2,2,2,2),d),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(e,3,3,3,3),a))));SIMD.Float32x4.store(b,4,e);e=SIMD.Float32x4.load(c,8);e=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(e,0,0,0,0),h),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(e,1,1,1,1),g),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(e,
2,2,2,2),d),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(e,3,3,3,3),a))));SIMD.Float32x4.store(b,8,e);c=SIMD.Float32x4.load(c,12);h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,0,0,0,0),h),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,1,1,1,1),g),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,2,2,2,2),d),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,3,3,3,3),a))));SIMD.Float32x4.store(b,12,h);return b};k.scalar.multiply=function(b,a,c){var h=a[0],g=a[1],
d=a[2],e=a[3],l=a[4],f=a[5],n=a[6],k=a[7],t=a[8],r=a[9],w=a[10],q=a[11],x=a[12],y=a[13],m=a[14];a=a[15];var A=c[0],C=c[1],B=c[2],D=c[3];b[0]=A*h+C*l+B*t+D*x;b[1]=A*g+C*f+B*r+D*y;b[2]=A*d+C*n+B*w+D*m;b[3]=A*e+C*k+B*q+D*a;A=c[4];C=c[5];B=c[6];D=c[7];b[4]=A*h+C*l+B*t+D*x;b[5]=A*g+C*f+B*r+D*y;b[6]=A*d+C*n+B*w+D*m;b[7]=A*e+C*k+B*q+D*a;A=c[8];C=c[9];B=c[10];D=c[11];b[8]=A*h+C*l+B*t+D*x;b[9]=A*g+C*f+B*r+D*y;b[10]=A*d+C*n+B*w+D*m;b[11]=A*e+C*k+B*q+D*a;A=c[12];C=c[13];B=c[14];D=c[15];b[12]=A*h+C*l+B*t+D*x;
b[13]=A*g+C*f+B*r+D*y;b[14]=A*d+C*n+B*w+D*m;b[15]=A*e+C*k+B*q+D*a;return b};k.multiply=m.USE_SIMD?k.SIMD.multiply:k.scalar.multiply;k.mul=k.multiply;k.scalar.translate=function(b,a,c){var h=c[0],g=c[1];c=c[2];var d,e,l,f,n,k,t,r,w,q,x,m;a===b?(b[12]=a[0]*h+a[4]*g+a[8]*c+a[12],b[13]=a[1]*h+a[5]*g+a[9]*c+a[13],b[14]=a[2]*h+a[6]*g+a[10]*c+a[14],b[15]=a[3]*h+a[7]*g+a[11]*c+a[15]):(d=a[0],e=a[1],l=a[2],f=a[3],n=a[4],k=a[5],t=a[6],r=a[7],w=a[8],q=a[9],x=a[10],m=a[11],b[0]=d,b[1]=e,b[2]=l,b[3]=f,b[4]=n,
b[5]=k,b[6]=t,b[7]=r,b[8]=w,b[9]=q,b[10]=x,b[11]=m,b[12]=d*h+n*g+w*c+a[12],b[13]=e*h+k*g+q*c+a[13],b[14]=l*h+t*g+x*c+a[14],b[15]=f*h+r*g+m*c+a[15]);return b};k.SIMD.translate=function(b,a,c){var h=SIMD.Float32x4.load(a,0),g=SIMD.Float32x4.load(a,4),d=SIMD.Float32x4.load(a,8),e=SIMD.Float32x4.load(a,12);c=SIMD.Float32x4(c[0],c[1],c[2],0);a!==b&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11]);h=SIMD.Float32x4.mul(h,SIMD.Float32x4.swizzle(c,
0,0,0,0));g=SIMD.Float32x4.mul(g,SIMD.Float32x4.swizzle(c,1,1,1,1));d=SIMD.Float32x4.mul(d,SIMD.Float32x4.swizzle(c,2,2,2,2));a=SIMD.Float32x4.add(h,SIMD.Float32x4.add(g,SIMD.Float32x4.add(d,e)));SIMD.Float32x4.store(b,12,a);return b};k.translate=m.USE_SIMD?k.SIMD.translate:k.scalar.translate;k.scalar.scale=function(b,a,c){var h=c[0],g=c[1];c=c[2];b[0]=a[0]*h;b[1]=a[1]*h;b[2]=a[2]*h;b[3]=a[3]*h;b[4]=a[4]*g;b[5]=a[5]*g;b[6]=a[6]*g;b[7]=a[7]*g;b[8]=a[8]*c;b[9]=a[9]*c;b[10]=a[10]*c;b[11]=a[11]*c;b[12]=
a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};k.SIMD.scale=function(b,a,c){var h;c=SIMD.Float32x4(c[0],c[1],c[2],0);h=SIMD.Float32x4.load(a,0);SIMD.Float32x4.store(b,0,SIMD.Float32x4.mul(h,SIMD.Float32x4.swizzle(c,0,0,0,0)));h=SIMD.Float32x4.load(a,4);SIMD.Float32x4.store(b,4,SIMD.Float32x4.mul(h,SIMD.Float32x4.swizzle(c,1,1,1,1)));h=SIMD.Float32x4.load(a,8);SIMD.Float32x4.store(b,8,SIMD.Float32x4.mul(h,SIMD.Float32x4.swizzle(c,2,2,2,2)));b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};
k.scale=m.USE_SIMD?k.SIMD.scale:k.scalar.scale;k.rotate=function(b,a,c,h){var g=h[0],d=h[1];h=h[2];var e=Math.sqrt(g*g+d*d+h*h),l,f,n,k,t,r,w,q,x,y,z,A,C,B,D,H,K,E,F,L;if(Math.abs(e)<m.EPSILON)return null;e=1/e;g*=e;d*=e;h*=e;l=Math.sin(c);f=Math.cos(c);n=1-f;c=a[0];e=a[1];k=a[2];t=a[3];r=a[4];w=a[5];q=a[6];x=a[7];y=a[8];z=a[9];A=a[10];C=a[11];B=g*g*n+f;D=d*g*n+h*l;H=h*g*n-d*l;K=g*d*n-h*l;E=d*d*n+f;F=h*d*n+g*l;L=g*h*n+d*l;g=d*h*n-g*l;d=h*h*n+f;b[0]=c*B+r*D+y*H;b[1]=e*B+w*D+z*H;b[2]=k*B+q*D+A*H;b[3]=
t*B+x*D+C*H;b[4]=c*K+r*E+y*F;b[5]=e*K+w*E+z*F;b[6]=k*K+q*E+A*F;b[7]=t*K+x*E+C*F;b[8]=c*L+r*g+y*d;b[9]=e*L+w*g+z*d;b[10]=k*L+q*g+A*d;b[11]=t*L+x*g+C*d;a!==b&&(b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);return b};k.scalar.rotateX=function(b,a,c){var h=Math.sin(c);c=Math.cos(c);var g=a[4],d=a[5],e=a[6],l=a[7],f=a[8],n=a[9],k=a[10],t=a[11];a!==b&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[4]=g*c+f*h;b[5]=d*c+n*h;b[6]=e*c+k*h;b[7]=l*c+t*h;b[8]=f*c-
g*h;b[9]=n*c-d*h;b[10]=k*c-e*h;b[11]=t*c-l*h;return b};k.SIMD.rotateX=function(b,a,c){var h=SIMD.Float32x4.splat(Math.sin(c));c=SIMD.Float32x4.splat(Math.cos(c));a!==b&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);var g=SIMD.Float32x4.load(a,4);a=SIMD.Float32x4.load(a,8);SIMD.Float32x4.store(b,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(g,c),SIMD.Float32x4.mul(a,h)));SIMD.Float32x4.store(b,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,c),SIMD.Float32x4.mul(g,h)));
return b};k.rotateX=m.USE_SIMD?k.SIMD.rotateX:k.scalar.rotateX;k.scalar.rotateY=function(b,a,c){var h=Math.sin(c);c=Math.cos(c);var g=a[0],d=a[1],e=a[2],l=a[3],f=a[8],n=a[9],k=a[10],t=a[11];a!==b&&(b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=g*c-f*h;b[1]=d*c-n*h;b[2]=e*c-k*h;b[3]=l*c-t*h;b[8]=g*h+f*c;b[9]=d*h+n*c;b[10]=e*h+k*c;b[11]=l*h+t*c;return b};k.SIMD.rotateY=function(b,a,c){var h=SIMD.Float32x4.splat(Math.sin(c));c=SIMD.Float32x4.splat(Math.cos(c));
a!==b&&(b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);var g=SIMD.Float32x4.load(a,0);a=SIMD.Float32x4.load(a,8);SIMD.Float32x4.store(b,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(g,c),SIMD.Float32x4.mul(a,h)));SIMD.Float32x4.store(b,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(g,h),SIMD.Float32x4.mul(a,c)));return b};k.rotateY=m.USE_SIMD?k.SIMD.rotateY:k.scalar.rotateY;k.scalar.rotateZ=function(b,a,c){var h=Math.sin(c);c=Math.cos(c);var g=a[0],d=a[1],e=a[2],l=a[3],
f=a[4],n=a[5],k=a[6],t=a[7];a!==b&&(b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=g*c+f*h;b[1]=d*c+n*h;b[2]=e*c+k*h;b[3]=l*c+t*h;b[4]=f*c-g*h;b[5]=n*c-d*h;b[6]=k*c-e*h;b[7]=t*c-l*h;return b};k.SIMD.rotateZ=function(b,a,c){var h=SIMD.Float32x4.splat(Math.sin(c));c=SIMD.Float32x4.splat(Math.cos(c));a!==b&&(b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);var g=SIMD.Float32x4.load(a,0);a=SIMD.Float32x4.load(a,
4);SIMD.Float32x4.store(b,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(g,c),SIMD.Float32x4.mul(a,h)));SIMD.Float32x4.store(b,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,c),SIMD.Float32x4.mul(g,h)));return b};k.rotateZ=m.USE_SIMD?k.SIMD.rotateZ:k.scalar.rotateZ;k.fromTranslation=function(b,a){b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=1;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=1;b[11]=0;b[12]=a[0];b[13]=a[1];b[14]=a[2];b[15]=1;return b};k.fromScaling=function(b,a){b[0]=a[0];b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=a[1];b[6]=
0;b[7]=0;b[8]=0;b[9]=0;b[10]=a[2];b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};k.fromRotation=function(b,a,c){var h=c[0],g=c[1];c=c[2];var d=Math.sqrt(h*h+g*g+c*c),e;if(Math.abs(d)<m.EPSILON)return null;d=1/d;h*=d;g*=d;c*=d;d=Math.sin(a);a=Math.cos(a);e=1-a;b[0]=h*h*e+a;b[1]=g*h*e+c*d;b[2]=c*h*e-g*d;b[3]=0;b[4]=h*g*e-c*d;b[5]=g*g*e+a;b[6]=c*g*e+h*d;b[7]=0;b[8]=h*c*e+g*d;b[9]=g*c*e-h*d;b[10]=c*c*e+a;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};k.fromXRotation=function(b,a){var c=Math.sin(a);
a=Math.cos(a);b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=a;b[6]=c;b[7]=0;b[8]=0;b[9]=-c;b[10]=a;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};k.fromYRotation=function(b,a){var c=Math.sin(a);a=Math.cos(a);b[0]=a;b[1]=0;b[2]=-c;b[3]=0;b[4]=0;b[5]=1;b[6]=0;b[7]=0;b[8]=c;b[9]=0;b[10]=a;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};k.fromZRotation=function(b,a){var c=Math.sin(a);a=Math.cos(a);b[0]=a;b[1]=c;b[2]=0;b[3]=0;b[4]=-c;b[5]=a;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=1;b[11]=0;b[12]=0;b[13]=0;b[14]=
0;b[15]=1;return b};k.fromRotationTranslation=function(b,a,c){var h=a[0],g=a[1],d=a[2],e=a[3],l=h+h,f=g+g,n=d+d;a=h*l;var k=h*f,h=h*n,t=g*f,g=g*n,d=d*n,l=e*l,f=e*f,e=e*n;b[0]=1-(t+d);b[1]=k+e;b[2]=h-f;b[3]=0;b[4]=k-e;b[5]=1-(a+d);b[6]=g+l;b[7]=0;b[8]=h+f;b[9]=g-l;b[10]=1-(a+t);b[11]=0;b[12]=c[0];b[13]=c[1];b[14]=c[2];b[15]=1;return b};k.getTranslation=function(b,a){b[0]=a[12];b[1]=a[13];b[2]=a[14];return b};k.getRotation=function(b,a){var c=a[0]+a[5]+a[10],h=0;0<c?(h=2*Math.sqrt(c+1),b[3]=.25*h,b[0]=
(a[6]-a[9])/h,b[1]=(a[8]-a[2])/h,b[2]=(a[1]-a[4])/h):a[0]>a[5]&a[0]>a[10]?(h=2*Math.sqrt(1+a[0]-a[5]-a[10]),b[3]=(a[6]-a[9])/h,b[0]=.25*h,b[1]=(a[1]+a[4])/h,b[2]=(a[8]+a[2])/h):a[5]>a[10]?(h=2*Math.sqrt(1+a[5]-a[0]-a[10]),b[3]=(a[8]-a[2])/h,b[0]=(a[1]+a[4])/h,b[1]=.25*h,b[2]=(a[6]+a[9])/h):(h=2*Math.sqrt(1+a[10]-a[0]-a[5]),b[3]=(a[1]-a[4])/h,b[0]=(a[8]+a[2])/h,b[1]=(a[6]+a[9])/h,b[2]=.25*h);return b};k.fromRotationTranslationScale=function(b,a,c,h){var g=a[0],d=a[1],e=a[2],l=a[3],f=g+g,n=d+d,k=e+
e;a=g*f;var t=g*n,g=g*k,r=d*n,d=d*k,e=e*k,f=l*f,n=l*n,l=l*k,k=h[0],w=h[1];h=h[2];b[0]=(1-(r+e))*k;b[1]=(t+l)*k;b[2]=(g-n)*k;b[3]=0;b[4]=(t-l)*w;b[5]=(1-(a+e))*w;b[6]=(d+f)*w;b[7]=0;b[8]=(g+n)*h;b[9]=(d-f)*h;b[10]=(1-(a+r))*h;b[11]=0;b[12]=c[0];b[13]=c[1];b[14]=c[2];b[15]=1;return b};k.fromRotationTranslationScaleOrigin=function(b,a,c,h,g){var d=a[0],e=a[1],l=a[2],f=a[3],n=d+d,k=e+e,t=l+l;a=d*n;var r=d*k,d=d*t,w=e*k,e=e*t,l=l*t,n=f*n,k=f*k,f=f*t,t=h[0],q=h[1];h=h[2];var x=g[0],m=g[1];g=g[2];b[0]=(1-
(w+l))*t;b[1]=(r+f)*t;b[2]=(d-k)*t;b[3]=0;b[4]=(r-f)*q;b[5]=(1-(a+l))*q;b[6]=(e+n)*q;b[7]=0;b[8]=(d+k)*h;b[9]=(e-n)*h;b[10]=(1-(a+w))*h;b[11]=0;b[12]=c[0]+x-(b[0]*x+b[4]*m+b[8]*g);b[13]=c[1]+m-(b[1]*x+b[5]*m+b[9]*g);b[14]=c[2]+g-(b[2]*x+b[6]*m+b[10]*g);b[15]=1;return b};k.fromQuat=function(b,a){var c=a[0],h=a[1],g=a[2];a=a[3];var d=c+c,e=h+h,l=g+g,c=c*d,f=h*d,h=h*e,n=g*d,k=g*e,g=g*l,d=a*d,e=a*e;a*=l;b[0]=1-h-g;b[1]=f+a;b[2]=n-e;b[3]=0;b[4]=f-a;b[5]=1-c-g;b[6]=k+d;b[7]=0;b[8]=n+e;b[9]=k-d;b[10]=1-
c-h;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};k.frustum=function(b,a,c,h,g,d,e){var l=1/(c-a),f=1/(g-h),n=1/(d-e);b[0]=2*d*l;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=2*d*f;b[6]=0;b[7]=0;b[8]=(c+a)*l;b[9]=(g+h)*f;b[10]=(e+d)*n;b[11]=-1;b[12]=0;b[13]=0;b[14]=e*d*2*n;b[15]=0;return b};k.perspective=function(b,a,c,h,g){a=1/Math.tan(a/2);var d=1/(h-g);b[0]=a/c;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=a;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=(g+h)*d;b[11]=-1;b[12]=0;b[13]=0;b[14]=2*g*h*d;b[15]=0;return b};k.perspectiveFromFieldOfView=
function(b,a,c,h){var g=Math.tan(a.upDegrees*Math.PI/180),d=Math.tan(a.downDegrees*Math.PI/180),e=Math.tan(a.leftDegrees*Math.PI/180);a=Math.tan(a.rightDegrees*Math.PI/180);var l=2/(e+a),f=2/(g+d);b[0]=l;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=f;b[6]=0;b[7]=0;b[8]=-((e-a)*l*.5);b[9]=(g-d)*f*.5;b[10]=h/(c-h);b[11]=-1;b[12]=0;b[13]=0;b[14]=h*c/(c-h);b[15]=0;return b};k.ortho=function(b,a,c,h,g,d,e){var l=1/(a-c),f=1/(h-g),n=1/(d-e);b[0]=-2*l;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=-2*f;b[6]=0;b[7]=0;b[8]=0;b[9]=
0;b[10]=2*n;b[11]=0;b[12]=(a+c)*l;b[13]=(g+h)*f;b[14]=(e+d)*n;b[15]=1;return b};k.lookAt=function(b,a,c,h){var g,d,e,l,f,n,u,t,r=a[0],w=a[1];a=a[2];e=h[0];l=h[1];d=h[2];u=c[0];h=c[1];g=c[2];if(Math.abs(r-u)<m.EPSILON&&Math.abs(w-h)<m.EPSILON&&Math.abs(a-g)<m.EPSILON)return k.identity(b);c=r-u;h=w-h;u=a-g;t=1/Math.sqrt(c*c+h*h+u*u);c*=t;h*=t;u*=t;g=l*u-d*h;d=d*c-e*u;e=e*h-l*c;(t=Math.sqrt(g*g+d*d+e*e))?(t=1/t,g*=t,d*=t,e*=t):e=d=g=0;l=h*e-u*d;f=u*g-c*e;n=c*d-h*g;(t=Math.sqrt(l*l+f*f+n*n))?(t=1/t,l*=
t,f*=t,n*=t):n=f=l=0;b[0]=g;b[1]=l;b[2]=c;b[3]=0;b[4]=d;b[5]=f;b[6]=h;b[7]=0;b[8]=e;b[9]=n;b[10]=u;b[11]=0;b[12]=-(g*r+d*w+e*a);b[13]=-(l*r+f*w+n*a);b[14]=-(c*r+h*w+u*a);b[15]=1;return b};k.str=function(b){return"mat4("+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+", "+b[4]+", "+b[5]+", "+b[6]+", "+b[7]+", "+b[8]+", "+b[9]+", "+b[10]+", "+b[11]+", "+b[12]+", "+b[13]+", "+b[14]+", "+b[15]+")"};k.frob=function(b){return Math.sqrt(Math.pow(b[0],2)+Math.pow(b[1],2)+Math.pow(b[2],2)+Math.pow(b[3],2)+Math.pow(b[4],
2)+Math.pow(b[5],2)+Math.pow(b[6],2)+Math.pow(b[7],2)+Math.pow(b[8],2)+Math.pow(b[9],2)+Math.pow(b[10],2)+Math.pow(b[11],2)+Math.pow(b[12],2)+Math.pow(b[13],2)+Math.pow(b[14],2)+Math.pow(b[15],2))};k.add=function(b,a,c){b[0]=a[0]+c[0];b[1]=a[1]+c[1];b[2]=a[2]+c[2];b[3]=a[3]+c[3];b[4]=a[4]+c[4];b[5]=a[5]+c[5];b[6]=a[6]+c[6];b[7]=a[7]+c[7];b[8]=a[8]+c[8];b[9]=a[9]+c[9];b[10]=a[10]+c[10];b[11]=a[11]+c[11];b[12]=a[12]+c[12];b[13]=a[13]+c[13];b[14]=a[14]+c[14];b[15]=a[15]+c[15];return b};k.subtract=function(b,
a,c){b[0]=a[0]-c[0];b[1]=a[1]-c[1];b[2]=a[2]-c[2];b[3]=a[3]-c[3];b[4]=a[4]-c[4];b[5]=a[5]-c[5];b[6]=a[6]-c[6];b[7]=a[7]-c[7];b[8]=a[8]-c[8];b[9]=a[9]-c[9];b[10]=a[10]-c[10];b[11]=a[11]-c[11];b[12]=a[12]-c[12];b[13]=a[13]-c[13];b[14]=a[14]-c[14];b[15]=a[15]-c[15];return b};k.sub=k.subtract;k.multiplyScalar=function(b,a,c){b[0]=a[0]*c;b[1]=a[1]*c;b[2]=a[2]*c;b[3]=a[3]*c;b[4]=a[4]*c;b[5]=a[5]*c;b[6]=a[6]*c;b[7]=a[7]*c;b[8]=a[8]*c;b[9]=a[9]*c;b[10]=a[10]*c;b[11]=a[11]*c;b[12]=a[12]*c;b[13]=a[13]*c;b[14]=
a[14]*c;b[15]=a[15]*c;return b};k.multiplyScalarAndAdd=function(b,a,c,h){b[0]=a[0]+c[0]*h;b[1]=a[1]+c[1]*h;b[2]=a[2]+c[2]*h;b[3]=a[3]+c[3]*h;b[4]=a[4]+c[4]*h;b[5]=a[5]+c[5]*h;b[6]=a[6]+c[6]*h;b[7]=a[7]+c[7]*h;b[8]=a[8]+c[8]*h;b[9]=a[9]+c[9]*h;b[10]=a[10]+c[10]*h;b[11]=a[11]+c[11]*h;b[12]=a[12]+c[12]*h;b[13]=a[13]+c[13]*h;b[14]=a[14]+c[14]*h;b[15]=a[15]+c[15]*h;return b};k.exactEquals=function(b,a){return b[0]===a[0]&&b[1]===a[1]&&b[2]===a[2]&&b[3]===a[3]&&b[4]===a[4]&&b[5]===a[5]&&b[6]===a[6]&&b[7]===
a[7]&&b[8]===a[8]&&b[9]===a[9]&&b[10]===a[10]&&b[11]===a[11]&&b[12]===a[12]&&b[13]===a[13]&&b[14]===a[14]&&b[15]===a[15]};k.equals=function(b,a){var c=b[0],h=b[1],g=b[2],d=b[3],e=b[4],l=b[5],f=b[6],n=b[7],k=b[8],t=b[9],r=b[10],w=b[11],q=b[12],x=b[13],y=b[14];b=b[15];var z=a[0],A=a[1],C=a[2],B=a[3],D=a[4],H=a[5],K=a[6],E=a[7],F=a[8],L=a[9],Q=a[10],N=a[11],J=a[12],P=a[13],I=a[14];a=a[15];return Math.abs(c-z)<=m.EPSILON*Math.max(1,Math.abs(c),Math.abs(z))&&Math.abs(h-A)<=m.EPSILON*Math.max(1,Math.abs(h),
Math.abs(A))&&Math.abs(g-C)<=m.EPSILON*Math.max(1,Math.abs(g),Math.abs(C))&&Math.abs(d-B)<=m.EPSILON*Math.max(1,Math.abs(d),Math.abs(B))&&Math.abs(e-D)<=m.EPSILON*Math.max(1,Math.abs(e),Math.abs(D))&&Math.abs(l-H)<=m.EPSILON*Math.max(1,Math.abs(l),Math.abs(H))&&Math.abs(f-K)<=m.EPSILON*Math.max(1,Math.abs(f),Math.abs(K))&&Math.abs(n-E)<=m.EPSILON*Math.max(1,Math.abs(n),Math.abs(E))&&Math.abs(k-F)<=m.EPSILON*Math.max(1,Math.abs(k),Math.abs(F))&&Math.abs(t-L)<=m.EPSILON*Math.max(1,Math.abs(t),Math.abs(L))&&
Math.abs(r-Q)<=m.EPSILON*Math.max(1,Math.abs(r),Math.abs(Q))&&Math.abs(w-N)<=m.EPSILON*Math.max(1,Math.abs(w),Math.abs(N))&&Math.abs(q-J)<=m.EPSILON*Math.max(1,Math.abs(q),Math.abs(J))&&Math.abs(x-P)<=m.EPSILON*Math.max(1,Math.abs(x),Math.abs(P))&&Math.abs(y-I)<=m.EPSILON*Math.max(1,Math.abs(y),Math.abs(I))&&Math.abs(b-a)<=m.EPSILON*Math.max(1,Math.abs(b),Math.abs(a))};return k})},"esri/views/vectorTiles/RenderBucket":function(){define(["require","exports","../../core/tsSupport/extendsHelper","../../core/tsSupport/decorateHelper"],
function(m,k,b,a){m=function(){return function(a){this.type=a}}();k.RenderBucket=m;a=function(a){function c(){var b=a.call(this,2)||this;b.triangleElementStart=0;b.triangleElementCount=0;b.joinStart=0;b.joinCount=0;return b}b(c,a);c.prototype.hasData=function(){return 0<this.triangleElementCount||0<this.joinCount};return c}(m);k.LineRenderBucket=a;a=function(a){function c(){var b=a.call(this,1)||this;b.triangleElementStart=0;b.triangleElementCount=0;b.outlineElementStart=0;b.outlineElementCount=0;
return b}b(c,a);c.prototype.hasData=function(){return 0<this.triangleElementCount||0<this.outlineElementCount};return c}(m);k.FillRenderBucket=a;a=function(a){function c(){var b=a.call(this,3)||this;b.markerPerPageElementsMap=new Map;b.textElementStart=0;b.textElementCount=0;b.isSDF=!1;return b}b(c,a);c.prototype.hasData=function(){return 0<this.markerPerPageElementsMap.size||0<this.textElementCount};return c}(m);k.SymbolRenderBucket=a;m=function(a){function c(){return a.call(this,0)||this}b(c,a);
c.prototype.hasData=function(){return!0};return c}(m);k.BackgroundRenderBucket=m})},"esri/views/vectorTiles/tileRendererHelper3D":function(){define(["require","exports","dojo/has","../../core/libs/gl-matrix/vec3","../../core/libs/gl-matrix/mat4"],function(m,k,b,a,c){var h={extent:{xmin:0,ymin:0,xmax:0,ymax:0,spatialReference:{wkid:102100,isWrappable:!0},intersects:function(a){return!1}},center:[0,0],scale:1,resolution:1,rotation:0,width:1,height:1,size:[256,256],spatialReference:{wkid:102100,isWrappable:!0},
worldScreenWidth:1,viewpoint:{},toMap:function(a,b){return[0,0]},toScreen:function(a,b){return[0,0]},clone:function(){return null}},g=a.create();return function(a,e,l,f,n,k,t,r,w,q,x,m){w=[e[0],e[1],e[2]];for(var d=q;1>d;d*=2)w[0]--,w[1]>>=1,w[2]>>=1;e={context:a,budget:null,state:h,stationary:!0,devicePixelRatio:1,displayLevel:n.adjustLevel(k),requiredLevel:n.adjustLevel(e[0]),drawphase:0,renderer:f,layerOpacity:m};if(t!==r)throw Error("It is expected that tiles are square!");k=1/q;n=n.getSchemaShift(w,
k);m=n[1];l.tileTransform.displayCoord[0]=-1-2*k*x[0]-n[0];l.tileTransform.displayCoord[1]=1+2*k*(1-x[1]-q)+m;q=l.tileTransform.transform;c.identity(q);x=.25*k/t;g.set([x,-x,1]);c.scale(q,q,g);a.setBlendFunctionSeparate(1,771,1,771);a.setClearDepth(1);a.clear(a.gl.DEPTH_BUFFER_BIT);e.state.size=[t,r];e.state.width=t;e.state.height=r;f.setStateParams(e.state,e.devicePixelRatio,w[0]);l.attach(e);a.setFaceCullingEnabled(!1);a.setDepthFunction(515);a.setBlendingEnabled(!1);a.setDepthTestEnabled(!0);a.setDepthWriteEnabled(!0);
l.render(e);a.setDepthWriteEnabled(!1);a.setBlendingEnabled(!0);e.drawphase=1;l.render(e);e.drawphase=2;l.render(e);b("esri-vector-tiles-debug")&&f.renderTileInfo(a,l);a.setDepthWriteEnabled(!0);a.setDepthTestEnabled(!1);a.setFaceCullingEnabled(!0)}})},"esri/core/libs/gl-matrix/vec3":function(){define(["./common"],function(m){var k={create:function(){var b=new m.ARRAY_TYPE(3);b[0]=0;b[1]=0;b[2]=0;return b},clone:function(b){var a=new m.ARRAY_TYPE(3);a[0]=b[0];a[1]=b[1];a[2]=b[2];return a},fromValues:function(b,
a,c){var h=new m.ARRAY_TYPE(3);h[0]=b;h[1]=a;h[2]=c;return h},copy:function(b,a){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b},set:function(b,a,c,h){b[0]=a;b[1]=c;b[2]=h;return b},add:function(b,a,c){b[0]=a[0]+c[0];b[1]=a[1]+c[1];b[2]=a[2]+c[2];return b},subtract:function(b,a,c){b[0]=a[0]-c[0];b[1]=a[1]-c[1];b[2]=a[2]-c[2];return b}};k.sub=k.subtract;k.multiply=function(b,a,c){b[0]=a[0]*c[0];b[1]=a[1]*c[1];b[2]=a[2]*c[2];return b};k.mul=k.multiply;k.divide=function(b,a,c){b[0]=a[0]/c[0];b[1]=a[1]/c[1];
b[2]=a[2]/c[2];return b};k.div=k.divide;k.ceil=function(b,a){b[0]=Math.ceil(a[0]);b[1]=Math.ceil(a[1]);b[2]=Math.ceil(a[2]);return b};k.floor=function(b,a){b[0]=Math.floor(a[0]);b[1]=Math.floor(a[1]);b[2]=Math.floor(a[2]);return b};k.min=function(b,a,c){b[0]=Math.min(a[0],c[0]);b[1]=Math.min(a[1],c[1]);b[2]=Math.min(a[2],c[2]);return b};k.max=function(b,a,c){b[0]=Math.max(a[0],c[0]);b[1]=Math.max(a[1],c[1]);b[2]=Math.max(a[2],c[2]);return b};k.round=function(b,a){b[0]=Math.round(a[0]);b[1]=Math.round(a[1]);
b[2]=Math.round(a[2]);return b};k.scale=function(b,a,c){b[0]=a[0]*c;b[1]=a[1]*c;b[2]=a[2]*c;return b};k.scaleAndAdd=function(b,a,c,h){b[0]=a[0]+c[0]*h;b[1]=a[1]+c[1]*h;b[2]=a[2]+c[2]*h;return b};k.distance=function(b,a){var c=a[0]-b[0],h=a[1]-b[1];b=a[2]-b[2];return Math.sqrt(c*c+h*h+b*b)};k.dist=k.distance;k.squaredDistance=function(b,a){var c=a[0]-b[0],h=a[1]-b[1];b=a[2]-b[2];return c*c+h*h+b*b};k.sqrDist=k.squaredDistance;k.length=function(b){var a=b[0],c=b[1];b=b[2];return Math.sqrt(a*a+c*c+b*
b)};k.len=k.length;k.squaredLength=function(b){var a=b[0],c=b[1];b=b[2];return a*a+c*c+b*b};k.sqrLen=k.squaredLength;k.negate=function(b,a){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b};k.inverse=function(b,a){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];return b};k.normalize=function(b,a){var c=a[0],h=a[1],g=a[2],c=c*c+h*h+g*g;0<c&&(c=1/Math.sqrt(c),b[0]=a[0]*c,b[1]=a[1]*c,b[2]=a[2]*c);return b};k.dot=function(b,a){return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]};k.cross=function(b,a,c){var h=a[0],g=a[1];a=a[2];var d=
c[0],e=c[1];c=c[2];b[0]=g*c-a*e;b[1]=a*d-h*c;b[2]=h*e-g*d;return b};k.lerp=function(b,a,c,h){var g=a[0],d=a[1];a=a[2];b[0]=g+h*(c[0]-g);b[1]=d+h*(c[1]-d);b[2]=a+h*(c[2]-a);return b};k.hermite=function(b,a,c,h,g,d){var e=d*d,l=e*(2*d-3)+1,f=e*(d-2)+d,n=e*(d-1);d=e*(3-2*d);b[0]=a[0]*l+c[0]*f+h[0]*n+g[0]*d;b[1]=a[1]*l+c[1]*f+h[1]*n+g[1]*d;b[2]=a[2]*l+c[2]*f+h[2]*n+g[2]*d;return b};k.bezier=function(b,a,c,h,g,d){var e=1-d,l=e*e,f=d*d,n=l*e,l=3*d*l,e=3*f*e;d*=f;b[0]=a[0]*n+c[0]*l+h[0]*e+g[0]*d;b[1]=a[1]*
n+c[1]*l+h[1]*e+g[1]*d;b[2]=a[2]*n+c[2]*l+h[2]*e+g[2]*d;return b};k.random=function(b,a){a=a||1;var c=2*m.RANDOM()*Math.PI,h=2*m.RANDOM()-1,g=Math.sqrt(1-h*h)*a;b[0]=Math.cos(c)*g;b[1]=Math.sin(c)*g;b[2]=h*a;return b};k.transformMat4=function(b,a,c){var h=a[0],g=a[1];a=a[2];var d=c[3]*h+c[7]*g+c[11]*a+c[15],d=d||1;b[0]=(c[0]*h+c[4]*g+c[8]*a+c[12])/d;b[1]=(c[1]*h+c[5]*g+c[9]*a+c[13])/d;b[2]=(c[2]*h+c[6]*g+c[10]*a+c[14])/d;return b};k.transformMat3=function(b,a,c){var h=a[0],g=a[1];a=a[2];b[0]=h*c[0]+
g*c[3]+a*c[6];b[1]=h*c[1]+g*c[4]+a*c[7];b[2]=h*c[2]+g*c[5]+a*c[8];return b};k.transformQuat=function(b,a,c){var h=a[0],g=a[1],d=a[2];a=c[0];var e=c[1],l=c[2];c=c[3];var f=c*h+e*d-l*g,n=c*g+l*h-a*d,k=c*d+a*g-e*h,h=-a*h-e*g-l*d;b[0]=f*c+h*-a+n*-l-k*-e;b[1]=n*c+h*-e+k*-a-f*-l;b[2]=k*c+h*-l+f*-e-n*-a;return b};k.rotateX=function(b,a,c,h){var g=[],d=[];g[0]=a[0]-c[0];g[1]=a[1]-c[1];g[2]=a[2]-c[2];d[0]=g[0];d[1]=g[1]*Math.cos(h)-g[2]*Math.sin(h);d[2]=g[1]*Math.sin(h)+g[2]*Math.cos(h);b[0]=d[0]+c[0];b[1]=
d[1]+c[1];b[2]=d[2]+c[2];return b};k.rotateY=function(b,a,c,h){var g=[],d=[];g[0]=a[0]-c[0];g[1]=a[1]-c[1];g[2]=a[2]-c[2];d[0]=g[2]*Math.sin(h)+g[0]*Math.cos(h);d[1]=g[1];d[2]=g[2]*Math.cos(h)-g[0]*Math.sin(h);b[0]=d[0]+c[0];b[1]=d[1]+c[1];b[2]=d[2]+c[2];return b};k.rotateZ=function(b,a,c,h){var g=[],d=[];g[0]=a[0]-c[0];g[1]=a[1]-c[1];g[2]=a[2]-c[2];d[0]=g[0]*Math.cos(h)-g[1]*Math.sin(h);d[1]=g[0]*Math.sin(h)+g[1]*Math.cos(h);d[2]=g[2];b[0]=d[0]+c[0];b[1]=d[1]+c[1];b[2]=d[2]+c[2];return b};k.forEach=
function(){var b=k.create();return function(a,c,h,g,d,e){c||(c=3);h||(h=0);for(g=g?Math.min(g*c+h,a.length):a.length;h<g;h+=c)b[0]=a[h],b[1]=a[h+1],b[2]=a[h+2],d(b,b,e),a[h]=b[0],a[h+1]=b[1],a[h+2]=b[2];return a}}();k.angle=function(b,a){b=k.fromValues(b[0],b[1],b[2]);a=k.fromValues(a[0],a[1],a[2]);k.normalize(b,b);k.normalize(a,a);a=k.dot(b,a);return 1<a?0:Math.acos(a)};k.str=function(b){return"vec3("+b[0]+", "+b[1]+", "+b[2]+")"};k.exactEquals=function(b,a){return b[0]===a[0]&&b[1]===a[1]&&b[2]===
a[2]};k.equals=function(b,a){var c=b[0],h=b[1];b=b[2];var g=a[0],d=a[1];a=a[2];return Math.abs(c-g)<=m.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(h-d)<=m.EPSILON*Math.max(1,Math.abs(h),Math.abs(d))&&Math.abs(b-a)<=m.EPSILON*Math.max(1,Math.abs(b),Math.abs(a))};return k})},"esri/views/3d/terrain/OverlayManager":function(){define("../../../core/declare dojo/on ../support/mathUtils ../support/earthUtils ../support/projectionUtils ../support/aaBoundingRect ../lib/glMatrix ../webgl-engine/Stage ../webgl-engine/lib/Texture ../webgl-engine/lib/Util".split(" "),
function(m,k,b,a,c,h,g,d,e,l){var f=g.vec2d,n=g.vec3d,u=g.vec4d,t=l.assert,r={width:0,height:0,pixelRatio:0,views:null},w=[{viewport:u.create(),extent:u.create()}],q=[w[0],{viewport:u.create(),extent:u.create()}],x=u.create(),y=n.create(),z=[u.create(),u.create()];return m(null,{constructor:function(a,b){this._view=b;this._stage=b._stage;this._renderSR=this._overlaySR=null;this._overlaySREqualsRenderSR=!0;this.terrainSurface=a;this._renderer=this._stage.getTextureGraphicsRenderer();this._connectedLayers=
{};this._overlays=void 0;this._scale=0;this._dirty=!1},destroy:function(){for(var a in this._connectedLayers)this.unregisterLayerView(this._connectedLayers[a]);this._disposeOverlays()},hasOverlays:function(){return!!this._overlays},setSpatialReference:function(a,c){(this._overlaySR=a)?(this._renderSR=this._view.renderSpatialReference,this._overlaySREqualsRenderSR=this._overlaySR.equals(this._renderSR),this._longitudeCyclical=(this._isSpherical=c)?a.isWebMercator?new b.Cyclical(-2.0037508342788905E7,
2.0037508342788905E7):new b.Cyclical(-180,180):null):(this._disposeOverlays(),this._longitudeCyclical=null)},registerLayerView:function(a){var b=a.layer.uid;t(!this._connectedLayers[b],"layer already connected");var c=k(a,"draped-data-change",function(){this.setOverlayDirty()}.bind(this));this._connectedLayers[b]={eventHandles:[c],layerView:a};if(a.setDrapingExtent&&this._overlays)for(b=0;b<this._overlays.length;b++)a.setDrapingExtent(b,this._overlays[b].extent,this._overlaySR,2048);this.setOverlayDirty()},
unregisterLayerView:function(a){for(var b in this._connectedLayers){var c=this._connectedLayers[b];if(c.layerView===a){if(c.eventHandles)for(var d=0;d<c.eventHandles;d++)c.eventHandles[d].remove();delete this._connectedLayers[b];this.setOverlayDirty();a.destroyed||(a._overlayUpdating=!1,a._evaluateUpdatingState())}}},onElevationChange:function(a){var b=a.extent;this._view.renderCoordsHelper.fromRenderCoords(this._view.navigation.currentCamera.center,y,a.spatialReference);b[0]<=y[0]&&b[1]<=y[1]&&b[2]>
y[0]&&b[3]>y[1]&&this.setOverlayDirty()},setOverlayDirty:function(){this._dirty||(this._setOverlayUpdating(!0),this._dirty=!0)},_setOverlayUpdating:function(a){for(var b in this._connectedLayers){var c=this._connectedLayers[b].layerView;if(!a||!c.suspended&&c.hasDraped)c._overlayUpdating=a,c._evaluateUpdatingState()}if(b=this._view._graphicsView)b._overlayUpdating=a,b._evaluateUpdatingState()},updateOverlay:function(){if(this._overlaySR){var a=this._computeOverlayExtents();if(a){this._overlays||this._initOverlays();
for(var b=0;b<this._overlays.length;b++){var c;a:{c=a[b];for(var d=this._overlays[b].extent,e=1E-5*Math.max(c[2]-c[0],c[3]-c[1],d[2]-d[0],d[3]-d[1]),f=0;4>f;f++)if(Math.abs(d[f]-c[f])>e){c=!0;break a}c=!1}if(c){u.set(a[b],this._overlays[b].extent);for(var g in this._connectedLayers)c=this._connectedLayers[g].layerView,c.setDrapingExtent&&c.setDrapingExtent(b,a[b],this._overlaySR,2048)}}this._setOverlayUpdating(!1);this._drawOverlays();this.terrainSurface._updateTileOverlayParams();this._dirty=!1}}},
overlaysNeedUpdate:function(){return this._dirty&&this._overlaySR},updateOpacity:function(a){var c=1;if(this._overlays){var d=this._scale;a=this._view.renderCoordsHelper.getAltitude(a);3.5*a<d&&(c=Math.sqrt(b.clamp((a-d/10)/(d/3.5-d/10),0,1)))}return c},setOverlayParamsOfTile:function(a,b,c){a=a.extent;var d=-1;this._rectInsideRect(a,this._overlays[0].extent)?d=0:this._rectanglesOverlap(a,this._overlays[1].extent)&&(d=1);if(0<=d){var e=this._overlays[d].extent;b.overlayTexScale[0]=(a[2]-a[0])/(e[2]-
e[0]);b.overlayTexScale[1]=(a[3]-a[1])/(e[3]-e[1]);var g=a[0];if(this._longitudeCyclical){var g=this._longitudeCyclical.minimalMonotonic(e[0],g),h=this._longitudeCyclical.minimalMonotonic(e[0],a[2]);g>h&&(g=h-(a[2]-a[0]))}f.set2((g-e[0])/(e[2]-e[0]),(a[1]-e[1])/(e[3]-e[1]),b.overlayTexOffset);b.overlayTexId=this._overlays[d].texture.getId();b.overlayOpacity=void 0!==c?c:1}else b.overlayTexId=null},overlayPixelSizeInMapUnits:function(a){var b;this._overlays&&(this._overlays[0]&&this._pointIsInExtent(a,
this._overlays[0].extent)?b=this._overlays[0].extent:this._overlays[1]&&(b=this._overlays[1].extent));return b?(b[2]-b[0])/2048:0},_initOverlays:function(){this._overlays=Array(2);for(var a=0;2>a;a++){var b=new e(null,"overlay",{wrapClamp:!0,mipmap:!0});this._stage.add(d.ModelContentType.TEXTURE,b);this._overlays[a]={texture:b,extent:u.create()}}},_disposeOverlays:function(){if(this._overlays){var a=this._stage;this._overlays.forEach(function(b){a.remove(d.ModelContentType.TEXTURE,b.texture.getId())});
this._overlays=null}},_overlayExtentIncTable:[[0,-1,2,1],[0,-2,2,0],[-1,-2,1,0],[-2,-2,0,0],[-2,-1,0,1],[-2,0,0,2],[-1,0,1,2],[0,0,2,2]],_computeOverlayExtents:function(){var d=this._view.navigation.currentCamera,e=this.terrainSurface.extent,g=n.create();n.set(d.center,g);this._scale=this._view.renderCoordsHelper.getAltitude(d.eye);var h=c.vectorToPoint(g,this._renderSR,this.terrainSurface.spatialReference);(h=this.terrainSurface.getElevation(h))?this._view.renderCoordsHelper.setAltitude(h,g):this._view.navigation.getCenterIntersectManifold(d.eye,
d.center,g);var l=n.dist(d.eye,g),h=d.angleOfElevation;if(!isNaN(h)){this._overlaySREqualsRenderSR||c.vectorToVector(g,this._renderSR,g,this._overlaySR);var l=1024*d.perPixelRatio*l*2,q=!1,k=Infinity;this._isSpherical&&(this._overlaySR.isWebMercator?(l/=Math.cos(c.webMercator.y2lat(g[1])),k=this.terrainSurface.extent[3],k*=.999):(q=!0,l/=a.metersPerDegree,k=90),l>=k&&(l=k,g[1]=0,this._overlaySR.isWebMercator&&(g[0]=0)));var t=1;q&&(t=1/Math.max(.2,Math.cos(Math.abs(b.deg2rad(g[1])))),180<l*t&&(t=
180/l));var w=l*t,r=z[0];r[0]=g[0]-w;r[1]=g[1]-l;r[2]=g[0]+w;r[3]=g[1]+l;this._isSpherical&&this._shiftExtentToFitBounds(r,Infinity,k);q=z[1];u.set(r,q);6*w>e[2]-e[0]?u.set(e,q):h>.25*Math.PI?(q[0]-=w,q[1]-=l,q[2]+=w,q[3]+=l):(c.vectorToVector(d.eye,this._renderSR,y,this._overlaySR),f.subtract(g,y,x),d=-Math.atan2(x[1],x[0])+.125*Math.PI,0>d&&(d+=2*Math.PI),u.scale(this._overlayExtentIncTable[Math.floor(d/(.25*Math.PI))],2*l,x),x[0]*=t,x[2]*=t,u.add(q,x,q));this._isSpherical&&(q[0]=this._longitudeCyclical.clamp(q[0]),
q[2]=this._longitudeCyclical.clamp(q[2]),q[1]=Math.max(q[1],-k),q[3]=Math.min(q[3],k));this.opacity=1;return z}},_drawOverlays:function(){for(var a=this._overlays[0].extent[2]-this._overlays[0].extent[0],b=this._stage.getTextureGraphicsRenderer(),c=0;c<this._overlays.length;c++){var d=this._overlays[c].extent,e=this._longitudeCyclical?d[2]>this._longitudeCyclical.max:!1,f=this._longitudeCyclical?d[0]<this._longitudeCyclical.min:!1;if(e||f){r.views=q;var f=Math.round((e?this._longitudeCyclical.max-
d[0]:this._longitudeCyclical.min-d[0])/(d[2]-d[0])*2048),g=r.views[0];u.set4(0,0,f,2048,g.viewport);u.set4(d[0],d[1],this._longitudeCyclical.max,d[3],g.extent);e||(g.extent[0]+=this._longitudeCyclical.range);g=r.views[1];u.set4(f,0,2048-f,2048,g.viewport);u.set4(this._longitudeCyclical.min,d[1],d[2],d[3],g.extent);e&&(g.extent[2]-=this._longitudeCyclical.range)}else r.views=w,u.set(d,r.views[0].extent),u.set4(0,0,2048,2048,r.views[0].viewport);r.width=2048;r.height=2048;r.pixelRatio=a/(d[2]-d[0]);
b.draw(this._overlays[c].texture,r)}},_rectanglesOverlap:function(a,b){return this._longitudeCyclical?(this._longitudeCyclical.contains(b[0],b[2],a[0])||this._longitudeCyclical.contains(b[0],b[2],a[2]))&&!(a[1]>b[3]||a[3]<b[1]):!(a[0]>b[2]||a[2]<b[0]||a[1]>b[3]||a[3]<b[1])},_rectInsideRect:function(a,b){return this._longitudeCyclical?this._longitudeCyclical.contains(b[0],b[2],a[0])&&this._longitudeCyclical.contains(b[0],b[2],a[2])&&a[1]>b[1]&&a[3]<b[3]:a[0]>b[0]&&a[2]<b[2]&&a[1]>b[1]&&a[3]<b[3]},
_pointIsInExtent:function(a,b){if(this._longitudeCyclical)return this._longitudeCyclical.contains(b[0],b[2],a.x)&&a.y>=b[1]&&a.y<=b[3];var c=a.x;a=a.y;return c>b[0]&&c<b[2]&&a>b[1]&&a<b[3]},_shiftExtentToFitBounds:function(a,b,c){var d=0,e=0;a[0]<-b?d=a[0]+b:a[2]>b&&(d=b-a[2]);a[1]<-c?e=a[1]+c:a[3]>c&&(e=c-a[3]);h.offset(a,d,e)}})})},"esri/views/3d/terrain/SurfaceExtentHelper":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators dojo/_base/lang ../../../core/Accessor ../../../core/arrayUtils ../../../core/HandleRegistry ../../../geometry/support/webMercatorUtils ../../../views/3d/support/aaBoundingRect ./terrainUtils ./TerrainConst".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f,n,u){m=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}b(c,a);Object.defineProperty(c.prototype,"layerViewsExtent",{get:function(){return this._computeLayerViewsExtent()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"tiledLayersExtent",{get:function(){return this._computeTiledLayersExtent()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"spatialReference",{set:function(a){this.tilingScheme||this._set("spatialReference",
a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"tilingScheme",{set:function(a){this._set("tilingScheme",a);this._set("spatialReference",a.spatialReference)},enumerable:!0,configurable:!0});c.prototype.normalizeCtorArgs=function(a){a=h.mixin({},a);this._layers=a.layers;delete a.layers;this._layerViews=a.layerViews;delete a.layerViews;return a};return c}(c.declared(g));a([c.property({readOnly:!0})],m.prototype,"layerViewsExtent",null);a([c.property({readOnly:!0,dependsOn:["spatialReference",
"tilingScheme"]})],m.prototype,"tiledLayersExtent",null);a([c.property()],m.prototype,"spatialReference",null);a([c.property()],m.prototype,"tilingScheme",null);a([c.property()],m.prototype,"defaultTiledLayersExtent",void 0);m=a([c.subclass()],m);g=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}b(c,a);c.prototype._computeLayerViewsExtent=function(){return this._getGlobalExtent()};c.prototype._computeTiledLayersExtent=function(){return this._getGlobalExtent()};c.prototype._getGlobalExtent=
function(){return this.spatialReference.isWebMercator?u.WEBMERCATOR_WORLD_EXTENT:u.GEOGRAPHIC_WORLD_EXTENT};return c}(c.declared(m));a([c.property({dependsOn:["spatialReference"]})],g.prototype,"layerViewsExtent",void 0);g=a([c.subclass()],g);k.SurfaceExtentHelperGlobal=g;m=function(a){function c(){var b=a.call(this)||this;b._changeListeners=new e;return b}b(c,a);c.prototype.initialize=function(){this._changeListeners.add(this._layers.on("change",this.notifyChange.bind(this,"tiledLayersExtent")));
this._changeListeners.add(this._layerViews.on("change",this.notifyChange.bind(this,"layerViewsExtent")))};c.prototype.destroy=function(){this._changeListeners.destroy();this._changeListeners=null};c.prototype._computeLayerViewsExtent=function(){var a=f.create(f.NEGATIVE_INFINITY),b=this.spatialReference;this._layerViews.forEach(function(c){c.isResolved()&&((c=c.fullExtentInViewSpatialReference||c.layer.fullExtent)&&!c.spatialReference.equals(b)&&(c=l.canProject(c.spatialReference,b)?l.project(c,b):
null),c&&f.expand(a,c))});var c=f.allFinite(a)?a:null,e=this._get("layerViewsExtent");return d.equals(c,e)?e:c};c.prototype._computeTiledLayersExtent=function(){var a=this.tilingScheme;if(!a)return null;var b=this.spatialReference,c=f.create(f.NEGATIVE_INFINITY);this._layers.forEach(function(d){n.isTiledLayer(d)&&a.compatibleWith(n.getTileInfo(d))&&d.fullExtent&&d.fullExtent.spatialReference.equals(b)&&f.expand(c,d.fullExtent)});this.defaultTiledLayersExtent&&f.expand(c,this.defaultTiledLayersExtent);
var e=f.allFinite(c)?c:null,g=this._get("tiledLayersExtent");return d.equals(e,g)?g:e};return c}(c.declared(m));m=a([c.subclass()],m);k.SurfaceExtentHelperLocal=m})},"esri/views/3d/terrain/terrainUtils":function(){define("require exports ./terrainUtilsPlanar ./terrainUtilsSpherical ../../../layers/TiledLayer ../../../layers/VectorTileLayer ../../../support/basemapDefinitions".split(" "),function(m,k,b,a,c,h,g){function d(a){return a&&a.isInstanceOf(h)}function e(a){return a&&"esri.views.3d.layers.TiledLayerView3D"===
a.declaredClass}function l(a){return a&&"esri.views.3d.layers.VectorTileLayerView3D"===a.declaredClass}function f(a){return a&&"esri.views.3d.layers.ElevationLayerView3D"===a.declaredClass}function n(){t={};for(var a in g)g[a].baseMapLayers.forEach(function(a){t[a.url]=19});t["//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"]=20}var u={planar:b,spherical:a};k.weakAssert=function(a,b){a||console.warn("Terrain: "+b)};k.autoUpdateSkirtsVisibility=function(a,b){u[a.manifold].autoUpdateSkirtsVisibility(a,
b)};k.isTiledLayer=function(a){return a&&a.isInstanceOf(c)};k.isVectorTileLayer=d;k.isTiledMapLayerView=e;k.isVectorTileLayerView=l;k.isElevationLayerView=f;k.isTiledLayerView=function(a){return a&&(e(a)||f(a)||l(a))};var t=null;k.getKnownTiledServiceLevelCap=function(a){t||n();a=a&&a.replace(/https?:/,"");return a in t?t[a]:Infinity};k.prepareKnownTiledServiceLevelCaps=n;k.checkIfTileInfoSupportedForView=function(a,b,c,d){return u["local"===d||"planar"===d?"planar":"spherical"].checkIfTileInfoSupportedForViewSR(a,
b,c)};k.getTileInfo=function(a){return d(a)?a.tileInfo256:a.tileInfo}})},"esri/views/3d/terrain/terrainUtilsPlanar":function(){define("require exports ./TilingScheme ./TerrainConst ../../../core/Error ../support/aaBoundingRect ../lib/glMatrix".split(" "),function(m,k,b,a,c,h,g){function d(a,b,c,d){l.set(c,f);f[d]=b[d];d=l.subtract(f,b);var e=l.subtract(a,b,n),e=l.dot(e,d),g=l.dot(d,d);b=0>=e?b:g<=e?c:l.add(b,l.scale(d,e/g),f);a=l.subtract(a,b,f);return Math.PI/2-Math.atan(a[2]/Math.sqrt(a[0]*a[0]+
a[1]*a[1]))}function e(a,b){var c=a.getElevationBounds();a=a.extent;c=.5*(c[0]+c[1]);u[0]=a[0];u[1]=a[1];u[2]=c;t[0]=a[2];t[1]=a[3];t[2]=c;a=c=Infinity;b[0]<u[0]?c=d(b,u,t,0):b[0]>t[0]&&(c=d(b,t,u,0));b[1]<u[1]?a=d(b,u,t,1):b[1]>t[1]&&(a=d(b,t,u,1));return Math.min(c,a)}var l=g.vec3d,f=l.create(),n=l.create(),u=l.create(),t=l.create();k.autoUpdateSkirtsVisibility=function(a,b){var c,d=!0,f=a.extent,g=h.contains(f,b);g?c=a.getElevation(b):(c=a.getElevationBounds(),c=.5*(c[0]+c[1]));c>b[2]?d=!1:g||
(h.containsWithMargin(f,b,a.hideSkirtsDistanceFromExtentMargin*Math.min(f[2]-f[0],f[3]-f[1]))?e(a,b)>a.hideSkirtsMinimumCameraTilt&&(d=!1):d=!1);d!==a.skirts&&(a.skirts=d)};k.tiltOnEdge=d;k.tiltToExtentEdge=e;k.checkIfTileInfoSupportedForViewSR=function(d,e,f){if(d.spatialReference.isGeographic)return new c("tilingscheme:local-gcs-not-supported","Geographic coordinate systems are not supported in local scenes");var g=b.checkUnsupported(d);if(g)return g;var l=d.lods,g=l[0].resolution*Math.pow(2,l[0].level),
n=[g*d.size[0],g*d.size[1]],q=[d.origin.x,d.origin.y];e=h.fromExtent(e);var k=h.create();b.computeRowColExtent(e,n,q,k);n=(k[2]-k[0])*(k[3]-k[1]);n>a.MAX_ROOT_TILES?(l=l[0].scale*Math.pow(2,l[0].level),g=Math.max((e[3]-e[1])/d.size[1],(e[2]-e[0])/d.size[0])*l/g,e=Math.floor(Math.log(g)/Math.log(10)),g=Math.ceil(g/Math.pow(10,e))*Math.pow(10,e),g=new c("tilingscheme:too-many-root-tiles","Scale of level 0 of the tiling scheme (1:"+Math.floor(l).toLocaleString()+") is too large for the layer's extent. Suggested scale: 1:"+
g.toLocaleString()+".",{level0Scale:l,suggestedLevel0Scale:g,requiredNumRootTiles:n,allowedNumRootTiles:a.MAX_ROOT_TILES})):g=null;return g?g:f&&!d.spatialReference.equals(f)?new c("tilingscheme:spatial-reference-mismatch","The tiling scheme does not match the spatial reference of the local scene"):null}})},"esri/views/3d/terrain/terrainUtilsSpherical":function(){define(["require","exports","./TilingScheme","../../../core/Error"],function(m,k,b,a){k.autoUpdateSkirtsVisibility=function(a,b){};k.checkIfTileInfoSupportedForViewSR=
function(c,h,g){h=c.lods.length-1;if(c.spatialReference.isWebMercator){if(!b.makeWebMercatorAuxiliarySphere(h).compatibleWith(c))return new a("tilingscheme:incompatible-global-web-mercator","The tiling scheme is not compatible with the ArcGIS Online Web Mercator tiling scheme")}else if(c.spatialReference.isWGS84){if(!b.makeWGS84WithTileSize(c.size[1],h).compatibleWith(c))return new a("tilingscheme:incompatible-global-wgs84","The tiling scheme is not compatible with the ArcGIS Online WGS84 tiling scheme")}else return new a("tilingscheme:global-unsupported-spatial-reference",
"The tiling scheme spatial reference is not supported in global scenes");if(g&&!c.spatialReference.equals(g))return new a("tilingscheme:spatial-reference-mismatch","The tiling scheme does not match the spatial reference of the global scene")}})},"esri/layers/VectorTileLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/_base/lang ../core/accessorSupport/decorators ../core/Error ../core/MultiOriginJSONSupport ../core/urlUtils ../core/promiseUtils ../core/lang ../request ../geometry/Extent ../geometry/SpatialReference ../portal/support/jsonContext ./TiledLayer ./mixins/OperationalLayer ./mixins/PortalLayer ./mixins/ScaleRangeLayer ./mixins/ArcGISCachedService ./support/TileInfo ./support/vectorTileLayerLoader ../views/vectorTiles/style/StyleRepository ../views/vectorTiles/SchemaHelper".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f,n,u,t,r,w,q,x,y,z,A,C,B,D){m=function(a){function d(b,c){b=a.call(this)||this;b.currentStyleInfo=null;b.fullExtent=null;b.operationalLayerType="VectorTileLayer";b.tileInfo=null;b.type="vector-tile";b.url=null;return b}b(d,a);d.prototype.normalizeCtorArgs=function(a,b){return"string"===typeof a?c.mixin({},{url:a},b):a};d.prototype.load=function(){var a=this,b=this.loadFromPortal({supportedTypes:["Vector Tile Service"],supportsData:!1}).then(function(){if(a.portalItem&&
a.portalItem.id){var b=a.portalItem.itemUrl+"/resources/styles/root.json";return n(b,{query:{f:"json"}}).then(function(c){c.data&&a.read({url:b},r.createForItem(a.portalItem))})}}).always(function(){return a.loadStyle()});this.addResolvingPromise(b);return this};Object.defineProperty(d.prototype,"attributionDataUrl",{get:function(){var a=this.currentStyleInfo;return(a=a&&a.serviceUrl&&e.urlToObject(a.serviceUrl))?this._getDefaultAttribution(a.path):null},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,
"serviceUrl",{get:function(){return this.currentStyleInfo&&this.currentStyleInfo.serviceUrl||null},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"spatialReference",{get:function(){return this.tileInfo&&this.tileInfo.spatialReference||null},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"styleUrl",{get:function(){return this.currentStyleInfo&&this.currentStyleInfo.styleUrl||null},enumerable:!0,configurable:!0});d.prototype.writeStyleUrl=function(a,b){a&&e.isProtocolRelative(a)&&
(a="https:"+a);a&&!f.endsWith(a,"root.json")&&(a=e.join(a,"root.json"));b.styleUrl=a};d.prototype.readTileIndexType=function(a,b){return b.type};d.prototype.readTileIndexUrl=function(a,b){return e.join(this.serviceUrl,b.tileMap)};d.prototype.readTileServers=function(a,b){var c=this;a=b.tiles;this.serviceUrl&&a.forEach(function(a,b,d){d[b]=e.join(c.serviceUrl,a)});return a};d.prototype.readVersion=function(a,b){return b.version?parseFloat(b.version):parseFloat(b.currentVersion)};d.prototype.readTileInfo256=
function(a,b){return new A(D.create256x256CompatibleTileInfo(this.tileInfo.toJSON()))};d.prototype.loadStyle=function(a){a=a||this.url;if(this._loadingPromise&&"string"===typeof a&&this.url===a)return this._loadingPromise;var b=this._loadingPromise;this._loadingPromise=this._getSourceAndStyle(a);b&&!b.isFulfilled()&&b.cancel();return this._loadingPromise};d.prototype.getTileUrl=function(a,b,c){var d=this.tileServers[b%this.tileServers.length];return d=d.replace(/\{z\}/gi,a.toString()).replace(/\{y\}/gi,
b.toString()).replace(/\{x\}/gi,c.toString())};d.prototype.write=function(a,b){return b&&b.origin&&!this.styleUrl?(b.messages&&b.messages.push(new g("vectortilelayer:unsupported","VectorTileLayer ("+this.title+", "+this.id+") with style defined by JSON only are not supported",{layer:this})),null):this.inherited(arguments,[a,b])};d.prototype._getSourceAndStyle=function(a){var b=this;return a?C.loadMetadata(a).then(function(a){b._set("currentStyleInfo",{serviceUrl:a.serviceUrl,styleUrl:a.styleUrl,spriteUrl:a.spriteUrl,
glyphsUrl:a.glyphsUrl,style:a.style,layerDefinition:a.layerDefinition});b._set("styleRepository",new B(a.style,a));b.read(a.layerDefinition)}):l.reject(Error("invalid style!"))};d.prototype._getDefaultAttribution=function(a){var b=a.match(/^https?:\/\/(basemaps|basemapsbeta)\.arcgis\.com(\/[^\/]+)?\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/vectortileserver/i);if(b&&(a=b[3]&&b[3].toLowerCase()))for(var b=b[2]||"",c=0,d=["World_Basemap"];c<d.length;c++){var f=d[c];if(-1<f.toLowerCase().indexOf(a))return e.normalize("//static.arcgis.com/attribution/Vector"+
b+"/"+f)}};return d}(h.declared(w,q,x,y,d,z));a([h.shared({"2d":"../views/2d/layers/VectorTileLayerView2D","3d":"../views/3d/layers/VectorTileLayerView3D"})],m.prototype,"viewModulePaths",void 0);a([h.property({readOnly:!0,dependsOn:["currentStyleInfo"]})],m.prototype,"attributionDataUrl",null);a([h.property({readOnly:!0})],m.prototype,"currentStyleInfo",void 0);a([h.property({type:u,readOnly:!0})],m.prototype,"fullExtent",void 0);a([h.property({readOnly:!0,dependsOn:["currentStyleInfo"]})],m.prototype,
"serviceUrl",null);a([h.property({type:t,dependsOn:["tileInfo"],readOnly:!0})],m.prototype,"spatialReference",null);a([h.property({readOnly:!0})],m.prototype,"styleRepository",void 0);a([h.property({readOnly:!0,dependsOn:["currentStyleInfo"],json:{write:{ignoreOrigin:!0}}})],m.prototype,"styleUrl",null);a([h.writer("styleUrl")],m.prototype,"writeStyleUrl",null);a([h.property({readOnly:!0})],m.prototype,"tileIndexType",void 0);a([h.reader("tileIndexType",["tileIndexType","type"])],m.prototype,"readTileIndexType",
null);a([h.property({readOnly:!0})],m.prototype,"tileIndexUrl",void 0);a([h.reader("tileIndexUrl",["tileIndexUrl","tileMap"])],m.prototype,"readTileIndexUrl",null);a([h.property({readOnly:!0,type:A})],m.prototype,"tileInfo",void 0);a([h.property({readOnly:!0})],m.prototype,"tileServers",void 0);a([h.reader("tileServers",["tiles"])],m.prototype,"readTileServers",null);a([h.property({json:{read:!1}})],m.prototype,"type",void 0);a([h.property({json:{origins:{webDocument:{read:{source:"styleUrl"}},portalItem:{read:{source:"url"}}},
write:!1,read:!1}})],m.prototype,"url",void 0);a([h.property({readOnly:!0})],m.prototype,"version",void 0);a([h.reader("version",["version","currentVersion"])],m.prototype,"readVersion",null);a([h.property({readOnly:!0})],m.prototype,"tileInfo256",void 0);a([h.reader("tileInfo256",["tileInfo"])],m.prototype,"readTileInfo256",null);return m=a([h.subclass("esri.layers.VectorTileLayer")],m)})},"esri/portal/support/jsonContext":function(){define(["require","exports","../Portal","../../core/urlUtils"],
function(m,k,b,a){k.createForItem=function(c){return{origin:"portal-item",url:a.urlToObject(c.itemUrl),portal:c.portal||b.getDefault()}}})},"esri/layers/support/vectorTileLayerLoader":function(){define("require exports dojo/has dojo/_base/lang ../../core/promiseUtils ../../core/urlUtils ../../config ../../request".split(" "),function(m,k,b,a,c,h,g,d){function e(a){if(a){var b=h.getOrigin(a);h.canUseXhr(b)||-1!==r.indexOf(b)||r.push(b);return a}}function l(a,b,c){if(null!=b.sources){c&&-1!==c.path.indexOf("root.json")&&
(c.path=c.path.substr(0,c.path.indexOf("root.json")),a.styleUrl=c.path);var d=u(b,c),e=b.sprite,g=b.glyphs;d&&d.url&&(d=c&&c.path?c.path:d.url,b.sprite&&!h.isAbsolute(b.sprite)&&(e=h.join(d,b.sprite)),b.glyphs&&!h.isAbsolute(b.glyphs)&&(g=h.join(d,b.glyphs)));a.style=b;a.spriteUrl=e;a.glyphsUrl=g;return n(a,b,c)}if(b.hasOwnProperty("tileInfo"))return a.layerDefinition=b,a.serviceUrl=c.path,f(a,b,c)}function f(a,b,c){b=b.defaultStyles;h.isAbsolute(b)?a.styleUrl=h.normalize(b):a.styleUrl=h.normalize(h.join(c.path,
b));e(a.styleUrl);return d(h.join(a.styleUrl,"root.json"),{responseType:"json"}).then(function(b){var c=b.data.sprite,d=b.data.glyphs;c&&!h.isAbsolute(c)&&(c=h.join(a.styleUrl,c));d&&!h.isAbsolute(d)&&(d=h.join(a.styleUrl,d));a.spriteUrl=c;a.glyphsUrl=d;return a.style=b.data})}function n(a,b,f){(b=u(b,f))||c.reject("Source isn't available in the syle object!");if(b.url)return a.serviceUrl=b.url,h.isAbsolute(a.serviceUrl)||(a.serviceUrl=h.join(f.path,a.serviceUrl)),e(a.serviceUrl),d(a.serviceUrl,{query:{f:"json"},
responseType:"json"}).then(function(b){a.layerDefinition=t(b.data);return a});a.layerDefinition=t(b);return c.resolve(a)}function u(a,b){if(!a.sources)return null;var c=a.sources;a=null;if(c.esri)a=c.esri,b&&a.url&&!h.isAbsolute(a.url)&&(c=b.path.substring(0,b.path.lastIndexOf("/")),a.url=h.join(c,a.url));else{for(var d=0,e=Object.keys(c);d<e.length;d++)if(b=e[d],-1!==b.toLocaleLowerCase().indexOf("street")&&"vector"===a.type){a=c[b];break}if(!a)for(d=0,e=Object.keys(c);d<e.length&&(b=e[d],a=c[b],
"vector"!==a.type);d++);}return a}function t(a){if(a.hasOwnProperty("tileInfo"))return a;for(var b={xmin:-2.0037507067161843E7,ymin:-2.0037507067161843E7,xmax:2.0037507067161843E7,ymax:2.0037507067161843E7,spatialReference:{wkid:102100}},c=(b.xmax-b.xmin)/512,d=[],f=a.hasOwnProperty("minzoom")?parseFloat(a.minzoom):0,g=a.hasOwnProperty("maxzoom")?parseFloat(a.maxzoom):16;f<g;f++){var h=c/Math.pow(2,f);d.push({level:f,scale:Math.floor(3779.527559055118*h),resolution:h})}a.tiles.forEach(e);return{capabilities:"TilesOnly",
initialExtent:b,fullExtent:b,minScale:d[0].scale,maxScale:d[d.length-1].scale,tiles:a.tiles,tileInfo:{rows:512,cols:512,dpi:96,format:"pbf",origin:{x:-2.0037508342787E7,y:2.0037508342787E7},lods:d,spatialReference:{wkid:102100}}}}var r=g.defaults&&g.defaults.io.corsEnabledServers||g.request.corsEnabledServers;k.loadMetadata=function(b){if(!b)return c.reject("invalid input URL!");var f={layerDefinition:null,parsedUrl:null,serviceUrl:null,style:null,styleUrl:null,url:null,spriteUrl:null,glyphsUrl:null};
if("string"!==typeof b)return l(f,b,null).then(function(){return f});b=f.url=h.normalize(b);var g=f.parsedUrl=h.urlToObject(b);e(b);return d(g.path,{responseType:"json",query:a.mixin({f:"json"},g.query)}).then(function(a){return l(f,a.data,g)}).then(function(){return f})}})},"esri/views/vectorTiles/style/StyleRepository":function(){define(["require","exports","./StyleLayer"],function(m,k,b){return function(){function a(b,h){this.styleJSON=b;this.version=parseFloat(b.version);this.sprite=h?h.spriteUrl:
b.sprite;this.glyphs=h?h.glyphsUrl:b.glyphs;this.layers=(b.layers||[]).map(a._create);this._identifyRefLayers()}a.prototype._identifyRefLayers=function(){for(var a=[],b=[],g=0,d=this.layers;g<d.length;g++){var e=d[g];if(1===e.type){var l=e.sourceLayer,l=l+("|"+JSON.stringify(e.minzoom)),l=l+("|"+JSON.stringify(e.maxzoom)),l=l+("|"+JSON.stringify(e.filter));a.push({key:l,layer:e})}2===e.type&&(l=e.sourceLayer,l+="|"+JSON.stringify(e.minzoom),l+="|"+JSON.stringify(e.maxzoom),l+="|"+JSON.stringify(e.filter),
l+="|"+JSON.stringify(e.layout["line-cap"]),l+="|"+JSON.stringify(e.layout["line-join"]),b.push({key:l,layer:e}))}this._assignRefLayers(a);this._assignRefLayers(b)};a.prototype._assignRefLayers=function(a){a.sort(function(a,b){return a.key<b.key?-1:a.key>b.key?1:0});for(var b,c,d=a.length,e=0;e<d;e++){var l=a[e];if(l.key===b)l.layer.refLayerId=c;else if(b=l.key,c=l.layer.id,1===l.layer.type&&!l.layer.hasPaintProperty("fill-outline-color"))for(var f=e+1;f<d;f++){var n=a[f];if(n.key===b){if(n.layer.hasPaintProperty("fill-outline-color")){a[e]=
n;a[f]=l;c=n.layer.id;break}}else break}}};a._create=function(a,h,g){h=1-1/(g.length+1)*(1+h);switch(a.type){case "background":return new b.StyleLayer(0,a,h);case "fill":return new b.StyleLayer(1,a,h);case "line":return new b.StyleLayer(2,a,h);case "symbol":return new b.StyleLayer(3,a,h);case "raster":throw Error("Unsupported vector tile raster layer");case "circle":throw Error("Unsupported vector tile circle layer");}throw Error("Unknown vector tile layer");};return a}()})},"esri/views/vectorTiles/style/StyleLayer":function(){define(["require",
"exports","./StyleDefinition","./StyleProperty","./Filter"],function(m,k,b,a,c){m=function(){function h(a,c,e){this.type=a;this.id=c.id;this.source=c.source;this.sourceLayer=c["source-layer"];this.minzoom=c.minzoom;this.maxzoom=c.maxzoom;this.filter=c.filter;this.layout=c.layout;this.paint=c.paint;this.z=e;switch(a){case 0:this._layoutDefinition=b.StyleDefinition.backgroundLayoutDefinition;this._paintDefinition=b.StyleDefinition.backgroundPaintDefinition;break;case 1:this._layoutDefinition=b.StyleDefinition.fillLayoutDefinition;
this._paintDefinition=b.StyleDefinition.fillPaintDefinition;break;case 2:this._layoutDefinition=b.StyleDefinition.lineLayoutDefinition;this._paintDefinition=b.StyleDefinition.linePaintDefinition;break;case 3:this._layoutDefinition=b.StyleDefinition.symbolLayoutDefinition,this._paintDefinition=b.StyleDefinition.symbolPaintDefinition}this._layoutProperties=this._parseLayout(this.layout);this._paintProperties=this._parsePaint(this.paint)}h.prototype.getFeatureFilter=function(){return void 0!==this._featureFilter?
this._featureFilter:this._featureFilter=c.createFilter(this.filter)};h.prototype.hasLayoutProperty=function(a){var b=this._layoutProperties;return b&&b[a]?!0:!1};h.prototype.hasPaintProperty=function(a){var b=this._paintProperties;return b?void 0!==b[a]:!1};h.prototype.getLayoutValue=function(a,b){var c,d=this._layoutProperties;d&&(d=d[a])&&(c=d.getValue(b));a=this._layoutDefinition[a];void 0===c&&(c=a["default"]);"enum"===a.type&&(c=a.values.indexOf(c));return c};h.prototype.getPaintValue=function(a,
b){var c,d=this._paintProperties;d&&(d=d[a])&&(c=d.getValue(b));a=this._paintDefinition[a];void 0===c&&(c=a["default"]);"enum"===a.type&&(c=a.values.indexOf(c));return c};h.prototype._parseLayout=function(b){var c={},e;for(e in b)c[e]=new a(this._layoutDefinition[e],b[e]);return c};h.prototype._parsePaint=function(b){var c={},e;for(e in b)c[e]=new a(this._paintDefinition[e],b[e]);return c};return h}();k.StyleLayer=m;m=function(){return function(a,b){this.cap=a.getLayoutValue("line-cap",b);this.join=
a.getLayoutValue("line-join",b);this.miterLimit=a.getLayoutValue("line-miter-limit",b);this.roundLimit=a.getLayoutValue("line-round-limit",b)}}();k.LineLayout=m;m=function(){return function(a,b,c){this.allowOverlap=a.getLayoutValue("icon-allow-overlap",b);this.ignorePlacement=a.getLayoutValue("icon-ignore-placement",b);this.optional=a.getLayoutValue("icon-optional",b);this.rotationAlignment=a.getLayoutValue("icon-rotation-alignment",b);this.size=a.getLayoutValue("icon-size",b);this.rotate=a.getLayoutValue("icon-rotate",
b);this.padding=a.getLayoutValue("icon-padding",b);this.keepUpright=a.getLayoutValue("icon-keep-upright",b);this.offset=a.getLayoutValue("icon-offset",b);c&&1===this.rotationAlignment&&!a.hasLayoutProperty("icon-rotation-alignment")&&(this.rotationAlignment=0)}}();k.IconLayout=m;m=function(){return function(a,b,c){this.allowOverlap=a.getLayoutValue("text-allow-overlap",b);this.ignorePlacement=a.getLayoutValue("text-ignore-placement",b);this.optional=a.getLayoutValue("text-optional",b);this.rotationAlignment=
a.getLayoutValue("text-rotation-alignment",b);this.font=a.getLayoutValue("text-font",b);this.maxWidth=a.getLayoutValue("text-max-width",b);this.lineHeight=a.getLayoutValue("text-line-height",b);this.letterSpacing=a.getLayoutValue("text-letter-spacing",b);this.justify=a.getLayoutValue("text-justify",b);this.anchor=a.getLayoutValue("text-anchor",b);this.maxAngle=a.getLayoutValue("text-max-angle",b);this.size=a.getLayoutValue("text-size",b);this.rotate=a.getLayoutValue("text-rotate",b);this.padding=
a.getLayoutValue("text-padding",b);this.keepUpright=a.getLayoutValue("text-keep-upright",b);this.transform=a.getLayoutValue("text-transform",b);this.offset=a.getLayoutValue("text-offset",b);c&&1===this.rotationAlignment&&!a.hasLayoutProperty("text-rotation-alignment")&&(this.rotationAlignment=0)}}();k.TextLayout=m})},"esri/views/vectorTiles/style/StyleDefinition":function(){define(["require","exports"],function(m,k){m=function(){return function(){}}();m.backgroundLayoutDefinition={visibility:{type:"enum",
values:["visible","none"],"default":"visible"}};m.fillLayoutDefinition={visibility:{type:"enum",values:["visible","none"],"default":"visible"}};m.lineLayoutDefinition={visibility:{type:"enum",values:["visible","none"],"default":"visible"},"line-cap":{type:"enum",values:["butt","round","square"],"default":"butt"},"line-join":{type:"enum",values:["bevel","round","miter"],"default":"miter"},"line-miter-limit":{type:"number","default":2},"line-round-limit":{type:"number","default":1.05}};m.symbolLayoutDefinition=
{visibility:{type:"enum",values:["visible","none"],"default":"visible"},"symbol-placement":{type:"enum",values:["point","line"],"default":"point"},"symbol-spacing":{type:"number",minimum:1,"default":250},"symbol-avoid-edges":{type:"boolean","default":!1},"icon-image":{type:"string"},"icon-allow-overlap":{type:"boolean","default":!1},"icon-ignore-placement":{type:"boolean","default":!1},"icon-optional":{type:"boolean","default":!1},"icon-rotation-alignment":{type:"enum",values:["map","viewport"],"default":"viewport"},
"icon-size":{type:"number",minimum:0,"default":1},"icon-rotate":{type:"number","default":0},"icon-padding":{type:"number",minimum:0,"default":2},"icon-keep-upright":{type:"boolean","default":!0},"icon-offset":{type:"array",value:"number",length:2,"default":[0,0]},"text-field":{type:"string"},"text-rotation-alignment":{type:"enum",values:["map","viewport"],"default":"viewport"},"text-font":{type:"array",value:"string","default":["Open Sans Regular","Arial Unicode MS Regular"]},"text-size":{type:"number",
minimum:0,"default":16},"text-max-width":{type:"number",minimum:0,"default":10},"text-line-height":{type:"number","default":1.2},"text-letter-spacing":{type:"number","default":0},"text-justify":{type:"enum",values:["left","center","right"],"default":"center"},"text-anchor":{type:"enum",values:"center left right top bottom top-left top-right bottom-left bottom-right".split(" "),"default":"center"},"text-max-angle":{type:"number",minimum:0,"default":45},"text-rotate":{type:"number","default":0},"text-padding":{type:"number",
minimum:0,"default":2},"text-keep-upright":{type:"boolean","default":!0},"text-transform":{type:"enum",values:["none","uppercase","lowercase"],"default":"none"},"text-offset":{type:"array",value:"number",length:2,"default":[0,0]},"text-allow-overlap":{type:"boolean","default":!1},"text-ignore-placement":{type:"boolean","default":!1},"text-optional":{type:"boolean","default":!1}};m.backgroundPaintDefinition={"background-opacity":{type:"number",minimum:0,maximum:1,"default":1},"background-color":{type:"color",
"default":[0,0,0,1]},"background-pattern":{type:"string"}};m.fillPaintDefinition={"fill-opacity":{type:"number",minimum:0,maximum:1,"default":1},"fill-antialias":{type:"boolean","default":!0},"fill-color":{type:"color","default":[0,0,0,1]},"fill-outline-color":{type:"color","default":[0,0,0,0]},"fill-translate":{type:"array",value:"number",length:2,"default":[0,0]},"fill-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"},"fill-pattern":{type:"string"}};m.linePaintDefinition=
{"line-opacity":{type:"number",minimum:0,maximum:1,"default":1},"line-color":{type:"color","default":[0,0,0,1]},"line-translate":{type:"array",value:"number",length:2,"default":[0,0]},"line-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"},"line-width":{type:"number",minimum:0,"default":1},"line-gap-width":{type:"number",minimum:0,"default":0},"line-offset":{type:"number","default":0},"line-blur":{type:"number",minimum:0,"default":0},"line-dasharray":{type:"array",value:"number",
"default":[]},"line-pattern":{type:"string"}};m.symbolPaintDefinition={"icon-opacity":{type:"number",minimum:0,maximum:1,"default":1},"icon-color":{type:"color","default":[0,0,0,1]},"icon-halo-color":{type:"color","default":[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,"default":0},"icon-halo-blur":{type:"number",minimum:0,"default":0},"icon-translate":{type:"array",value:"number",length:2,"default":[0,0]},"icon-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"},"text-opacity":{type:"number",
minimum:0,maximum:1,"default":1},"text-color":{type:"color","default":[0,0,0,1]},"text-halo-color":{type:"color","default":[0,0,0,0]},"text-halo-width":{type:"number",minimum:0,"default":0},"text-halo-blur":{type:"number",minimum:0,"default":0},"text-translate":{type:"array",value:"number",length:2,"default":[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"}};m.rasterPaintDefinition={"raster-opacity":{type:"number",minimum:0,maximum:1,"default":1},"raster-hue-rotate":{type:"number",
"default":0},"raster-brightness-min":{type:"number",minimum:0,maximum:1,"default":0},"raster-brightness-max":{type:"number",minimum:0,maximum:1,"default":1},"raster-saturation":{type:"number",minimum:-1,maximum:1,"default":0},"raster-contrast":{type:"number",minimum:-1,maximum:1,"default":0},"raster-fade-duration":{type:"number",minimum:0,"default":300}};m.circlePaintDefinition={"circle-opacity":{type:"number",minimum:0,maximum:1,"default":1},"circle-radius":{type:"number",minimum:0,"default":5},
"circle-color":{type:"color","default":[0,0,0,1]},"circle-blur":{type:"number",minimum:0,"default":0},"circle-translate":{type:"array",value:"number",length:2,"default":[0,0]},"circle-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"}};k.StyleDefinition=m})},"esri/views/vectorTiles/style/StyleProperty":function(){define(["require","exports","../../../Color","../GeometryUtils"],function(m,k,b,a){return function(){function c(a,b){switch(a.type){case "number":a=!0;break;case "color":a=
!0;b=c._parseColor(b);break;case "array":a="number"===a.value;break;default:a=!1}this.getValue=a?this._interpolate(b):this._piecewise(b)}c.prototype._piecewise=function(a){var b=a.stops;return b?function(a){var c=b.length;if(0!==c){for(var d=0,f=0;f<c;f++)if(b[f][0]<=a)d=f;else break;return b[d][1]}}:function(){return a}};c.prototype._interpolate=function(b){var c=b.stops;if(c){var d=b.base||1;return function(b){for(var e,f,g=c.length,h=0;h<g;h++){var k=c[h];if(k[0]<=b)e=k;else{f=k;break}}if(e&&f){h=
f[0]-e[0];b-=e[0];b=1===d?b/h:(Math.pow(d,b)-1)/(Math.pow(d,h)-1);if(Array.isArray(e[1])){e=e[1];f=f[1];g=[];for(h=0;h<e.length;h++)g.push(a.interpolate(e[h],f[h],b));return g}return a.interpolate(e[1],f[1],b)}if(e)return e[1];if(f)return f[1]}}return function(){return b}};c._parseColor=function(a){if(Array.isArray(a))return a;if("string"===typeof a)return a=new b(a),[a.r/255,a.g/255,a.b/255,a.a||1];if(a&&a.stops)return a.stops=a.stops.map(function(a){return[a[0],c._parseColor(a[1])]}),a;throw Error("Incorrect color definition "+
a);};return c}()})},"esri/views/vectorTiles/GeometryUtils":function(){define(["require","exports"],function(m,k){function b(a,b){a%=b;return 0<=a?a:a+b}k.C_INFINITY=Number.POSITIVE_INFINITY;k.C_PI=Math.PI;k.C_2PI=2*k.C_PI;k.C_PI_BY_2=k.C_PI/2;k.C_RAD_TO_256=128/k.C_PI;k.C_256_TO_RAD=k.C_PI/128;k.C_DEG_TO_256=256/360;k.C_DEG_TO_RAD=k.C_PI/180;k.C_SQRT2=1.414213562;k.C_SQRT2_INV=1/k.C_SQRT2;var a=1/Math.LN2;k.positiveMod=b;k.radToByte=function(a){return b(a*k.C_RAD_TO_256,256)};k.degToByte=function(a){return b(a*
k.C_DEG_TO_256,256)};k.log2=function(b){return Math.log(b)*a};k.sqr=function(a){return a*a};k.clamp=function(a,b,g){return Math.min(Math.max(a,b),g)};k.interpolate=function(a,b,g){return a*(1-g)+b*g};k.between=function(a,b,g){return a>=b&&a<=g||a>=g&&a<=b}})},"esri/views/vectorTiles/style/Filter":function(){define(["require","exports"],function(m,k){m=function(){function b(a,c,h){this._op=a;"$type"===c?(this._val=h instanceof Array?h.map(function(a){return b._types.indexOf(a)}):b._types.indexOf(h),
this._op+=11):(this._key=c,this._val=h)}b.prototype.filter=function(a){switch(this._op){case 0:return this._val;case 1:return a.values[this._key]===this._val;case 2:return a.values[this._key]!==this._val;case 3:return a.values[this._key]<this._val;case 4:return a.values[this._key]>this._val;case 5:return a.values[this._key]<=this._val;case 6:return a.values[this._key]>=this._val;case 7:return-1!==this._val.indexOf(a.values[this._key]);case 8:return-1===this._val.indexOf(a.values[this._key]);case 9:for(var b=
0,h=this._val;b<h.length;b++){var g=h[b];if(g.filter(a))return!0}return!1;case 10:b=0;for(h=this._val;b<h.length;b++)if(g=h[b],!g.filter(a))return!1;return!0;case 11:b=0;for(h=this._val;b<h.length;b++)if(g=h[b],g.filter(a))return!1;return!0;case 12:return a.type===this._val;case 13:return a.type!==this._val;case 14:return a.type<this._val;case 15:return a.type>this._val;case 16:return a.type>=this._val;case 17:return a.type<=this._val;case 18:return-1!==this._val.indexOf(a.type);case 19:return-1===
this._val.indexOf(a.type)}};b.createFilter=function(a){if(!a)return new b(0,void 0,!0);var c=a[0];if(1>=a.length)return new b(0,void 0,"any"!==c);switch(c){case "\x3d\x3d":return new b(1,a[1],a[2]);case "!\x3d":return new b(2,a[1],a[2]);case "\x3e":return new b(4,a[1],a[2]);case "\x3c":return new b(3,a[1],a[2]);case "\x3e\x3d":return new b(6,a[1],a[2]);case "\x3c\x3d":return new b(5,a[1],a[2]);case "in":return new b(7,a[1],a.slice(2));case "!in":return new b(8,a[1],a.slice(2));case "any":return new b(9,
void 0,a.slice(1).map(b.createFilter.bind(this)));case "all":return new b(10,void 0,a.slice(1).map(b.createFilter.bind(this)));case "none":return new b(11,void 0,a.slice(1).map(b.createFilter.bind(this)));default:throw Error("invalid operator: "+c);}};return b}();m._types=["Unknown","Point","LineString","Polygon"];return m})},"esri/views/vectorTiles/SchemaHelper":function(){define(["require","exports","../../core/Error"],function(m,k,b){return function(){function a(a){this.lockedSchemaPixelSize=a}
a.prototype.getCompatibleLevelRowCol=function(a){var c=a[0],g=a[1];a=a[2];if(256===this.lockedSchemaPixelSize&&0<c)c--,g>>=1,a>>=1;else if(0!==c&&512!==this.lockedSchemaPixelSize)throw new b("Cannot get a compatible tile key for the locked tiling scheme!");return[c,g,a]};a.prototype.getSchemaShift=function(a,b){var c=0,d=0;256===this.lockedSchemaPixelSize&&(a[2]%2&&(c=2*b),a[1]%2&&(d=2*b));return[c,d]};a.prototype.adjustLevel=function(a){return 256===this.lockedSchemaPixelSize?0<a?a-1:0:a};a.create256x256CompatibleTileInfo=
function(a){if(!a)return null;if(256===a.rows&&256===a.cols)return a;for(var b=a.format,c=a.compressionQuality,d=a.dpi,e=a.origin,l=a.spatialReference,f=[],n,k,t=a.lods.length,m=0;m<t;m++){var w=a.lods[m];n=w.scale;k=2*w.resolution;f.push({level:w.level,scale:n,resolution:k})}return{rows:256,cols:256,dpi:d,format:b,compressionQuality:c,origin:e,spatialReference:l,lods:f}};return a}()})},"esri/views/3d/terrain/SurfaceTilingSchemeLogic":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/Accessor ../../../core/HandleRegistry ./TilingScheme ./terrainUtils".split(" "),
function(m,k,b,a,c,h,g,d,e){m=function(a){function c(){var b=a.call(this)||this;b._changeHandles=new g;return b}b(c,a);c.prototype.normalizeCtorArgs=function(a){this._layers=a.layers;this._extentHelper=a.extentHelper;this._manifold=a.manifold;return{viewSpatialReference:a.viewSpatialReference}};c.prototype.initialize=function(){var a=this;this._changeHandles.add(this._layers.on("change",function(){return a._update()}));this._changeHandles.add(this._extentHelper.watch("layerViewsExtent",function(){return a._setAdHocTilingScheme()}));
this._update();this.tilingSchemeLocked||this._setAdHocTilingScheme()};c.prototype.destroy=function(){this._changeHandles.destroy();this._changeHandles=null};c.prototype._update=function(){var a=this;this._waitTask=null;if(!this.tilingSchemeLocked){var b=this._layers.find(function(b){if(e.isTiledLayer(b))return b.isResolved()&&!a._isTileInfoSupported(e.getTileInfo(b),b.fullExtent)?!1:!b.isRejected()});if(b)if(b.isResolved()){var c=new d(e.getTileInfo(b)),b=e.getKnownTiledServiceLevelCap(b.url);Infinity>
b&&c.capMaxLod(b);this._lockTilingScheme(c)}else this._updateWhen(b)}};c.prototype._updateWhen=function(a){var b=this,c=a.always(function(){c===b._waitTask&&b._update()});this._waitTask=c};c.prototype._lockTilingScheme=function(a){var b=this;if("spherical"===this._manifold){var c=a.levels.length-1;a=a.spatialReference.isWebMercator?d.makeWebMercatorAuxiliarySphere(c):d.makeWGS84WithTileSize(a.pixelSize[0],c)}this.tilingSchemeLocked=!0;this.tilingScheme=a;this._extentHelper.tilingScheme=this.tilingScheme;
this._updateTiledLayerExtent();this._changeHandles.removeAll();this._changeHandles.add(this._extentHelper.watch("tiledLayersExtent",function(){return b._updateTiledLayerExtent()}))};c.prototype._updateTiledLayerExtent=function(){this.extent=this._extentHelper.tiledLayersExtent};c.prototype._setAdHocTilingScheme=function(){if("spherical"===this._manifold)this.tilingScheme=this._extentHelper.spatialReference.isWebMercator?d.WebMercatorAuxiliarySphere:d.makeWGS84WithTileSize(256),this.extent=this._extentHelper.layerViewsExtent;
else{var a=this._extentHelper.layerViewsExtent;a&&(this.tilingScheme=d.fromExtent(a,this._extentHelper.spatialReference),this.extent=a)}};c.prototype._isTileInfoSupported=function(a,b){return null==e.checkIfTileInfoSupportedForView(a,b,this.viewSpatialReference,this._manifold)};return c}(c.declared(h));a([c.property()],m.prototype,"tilingScheme",void 0);a([c.property()],m.prototype,"extent",void 0);a([c.property({value:!1})],m.prototype,"tilingSchemeLocked",void 0);a([c.property()],m.prototype,"viewSpatialReference",
void 0);return m=a([c.subclass()],m)})},"esri/views/3d/terrain/SphericalTile":function(){define("./TileBase ./TileGeometryFactory ../../../core/ObjectPool ../support/mathUtils ../support/earthUtils ../lib/glMatrix".split(" "),function(m,k,b,a,c,h){var g=h.vec3d,d=c.earthRadius,e=function(a,b,c,e){c=d+c;var f=Math.cos(a);e[0]=Math.cos(b)*f*c;e[1]=Math.sin(b)*f*c;e[2]=Math.sin(a)*c};c=function(a,b,c,d){m.call(this);this.tileUp=g.create();this.obb=Array(8);this._isWebMercator=!1;for(var e=0;8>e;e++)this.obb[e]=
g.create();void 0!==a&&this.init(a,b,c,d)};c.prototype=new m;c.prototype.constructor=c;c.prototype.init=function(b,c,h,k){m.prototype.init.call(this,b,c,h,k);this._isWebMercator=k.spatialReference.isWebMercator;c=this.extentWGS84Rad[0];h=this.extentWGS84Rad[1];k=this.extentWGS84Rad[2];var f=this.extentWGS84Rad[3];b=b[0];var l=a.lerp(h,f,.5),n=a.lerp(c,k,.5);this.edgeLen=(k-c)*Math.cos(0===b?0:Math.min(Math.abs(h),Math.abs(f)))*d;this.curvatureHeight=d-Math.sqrt(d*d-this.edgeLen*this.edgeLen/4);e(l,
n,0,this.centerAtSeaLevel);g.set(this.centerAtSeaLevel,this.tileUp);g.normalize(this.tileUp);this._updateOBB();this.updateRadiusAndCenter()};c.prototype.isVisible=function(a,b){if(!this.intersectsClippingArea)return!1;if(9<this.lij[0]){b=this.obb;for(var c=0;6>c;c++){for(var d=0;8>d&&!(0>a[c][0]*b[d][0]+a[c][1]*b[d][1]+a[c][2]*b[d][2]+a[c][3]);d++);if(8===d)return!1}}else if(b=this.radius,c=this.center,a[0][0]*c[0]+a[0][1]*c[1]+a[0][2]*c[2]+a[0][3]>b||a[1][0]*c[0]+a[1][1]*c[1]+a[1][2]*c[2]+a[1][3]>
b||a[2][0]*c[0]+a[2][1]*c[1]+a[2][2]*c[2]+a[2][3]>b||a[3][0]*c[0]+a[3][1]*c[1]+a[3][2]*c[2]+a[3][3]>b||a[4][0]*c[0]+a[4][1]*c[1]+a[4][2]*c[2]+a[4][3]>b||a[5][0]*c[0]+a[5][1]*c[1]+a[5][2]*c[2]+a[5][3]>b)return!1;return!0};c.prototype.computeElevationBounds=function(){m.prototype.computeElevationBounds.call(this);this._updateOBB()};c.prototype.updateRadiusAndCenter=function(){if(0===this.lij[0])g.set3(0,0,0,this.center),this.radius=d+this.elevationBounds[1];else{m.prototype.updateRadiusAndCenter.call(this);
var a=Math.max(g.dist2(this.center,this.obb[0]),g.dist2(this.center,this.obb[1]));this.radius=Math.sqrt(a)}};c.prototype._numSubdivisionsAtLevel=[128,64,32,16,16,8,8,4];c.prototype.createGeometry=function(a,b,c){var d=this._isPole(this.lij[1],this.lij[0]);a.needsUpdate=!1;return k.createSphericalGlobeTile(a.numVertsPerRow,this.extent,this.extentWGS84Rad,this._isWebMercator,a.samplerData,b,d,c)};c.prototype._updateOBB=function(){var a=this.extentWGS84Rad,b=this.obb,c;for(c=0;2>c;c++){var h=this.elevationBounds[c],
k=4*c;e(a[1],a[0],h,b[k++]);e(a[3],a[0],h,b[k++]);e(a[3],a[2],h,b[k++]);e(a[1],a[2],h,b[k++])}this._isWebMercator&&(a=this._isPole(this.lij[1],this.lij[0]),2===a?(g.set3(0,0,d,b[1]),g.set3(0,0,d,b[2]),g.set3(0,0,d,b[5]),g.set3(0,0,d,b[6])):1===a&&(g.set3(0,0,-d,b[0]),g.set3(0,0,-d,b[3]),g.set3(0,0,-d,b[4]),g.set3(0,0,-d,b[7])))};c.prototype._isPole=function(a,b){var c=0;a===(1<<b)-1&&(c+=1);0===a&&(c+=2);return c};c.Pool=new b(c);return c})},"esri/views/3d/terrain/TileBase":function(){define("./terrainUtils ./tileUtils ./TerrainConst ./TileGeometryFactory ./UpsampleInfo ./ElevationData ./TilePerLayerInfo ../support/mathUtils ../lib/glMatrix ../../../core/arrayUtils".split(" "),
function(m,k,b,a,c,h,g,d,e,l){var f=e.vec3d,n=e.vec2d,u=e.vec4d,t=e.mat4d,r=m.weakAssert,w=f.create(),q=u.create(),x=u.create(),y=f.create(),z={},A=b.LayerClass.LAYER_CLASS_COUNT,C=b.LayerClass.MAP,B=b.LayerClass.ELEVATION,D=b.TileUpdateTypes;e=function(a,b,c){this.lij=[0,0,0];this.extent=u.create();this.extentWGS84Rad=u.create();this.centerAtSeaLevel=f.create();this.center=f.create();this.tileUp=y;this.elevationBounds=n.create();this.children=[null,null,null,null];this.layerInfo=Array(A);this.intersectsClippingArea=
this.isWithinClippingArea=!0;this.clippingArea=null;this._maxTesselation=0};e.prototype.init=function(a,c,d,e){this.lij[0]=a[0];this.lij[1]=a[1];this.lij[2]=a[2];e.getExtent(a[0],a[1],a[2],this.extent,this.extentWGS84Rad);this.intersectsClippingArea=this.isWithinClippingArea=!0;this.clippingArea=null;this.radius=this.edgeLen=0;this.vlevel=a?a[0]:0;c&&c.elevationBounds?n.set(c.elevationBounds,this.elevationBounds):n.set2(0,0,this.elevationBounds);this.parent=c;for(a=0;4>a;a++)this.children[a]=null;
this.pendingUpdates=0;this.renderData=null;this.renderOrder=this.screenDepth=0;this.visible=!1;this.parentSurface=d;for(a=0;a<A;a++)if(d){c=d.numLayers(a);var f;this.layerInfo[a]?(f=this.layerInfo[a],f.length=c):(f=Array(c),this.layerInfo[a]=f);for(var h=0;h<c;h++)f[h]=g.makeEmptyLayerInfo(a,f[h]),a==B&&this.findElevationBoundsForLayer(h,-1)}else this.layerInfo[a]=null;this.computeElevationBounds();this._maxTesselation=Math.min(e.pixelSize[0],b.MAX_TILE_TESSELATION)};e.prototype.dispose=function(){for(var a=
0;a<A;a++)for(var b=this.layerInfo[a],d=0;d<b.length;d++){var e=b[d];e.upsampleFromTile&&(c.Pool.release(e.upsampleFromTile),e.upsampleFromTile=null)}};e.prototype.releaseLayerResources=function(){for(var a=this.layerInfo[b.LayerClass.MAP],c=0;c<a.length;c++)a[c].releaseResources()};e.prototype.updateScreenDepth=function(a){f.set(this.center,x);x[3]=1;t.multiplyVec4(a,x,x);this.screenDepth=x[2]/x[3]};e.prototype.shouldSplit=function(a,b){var c=this.lij[0];if(1>c)return D.SPLIT;f.subtract(this.center,
b,w);var e=f.length(w),g=this.edgeLen/(a[0]*e*2),e=this.edgeLen/(a[2]*e*2),h=a[1],l=a[3],n=a[4];a=a[5];return g<h?this.vlevel!==this.lij[0]?(this.vlevel=this.lij[0],D.VSPLITMERGE):D.NONE:c>=n?(b=c+Math.ceil(-d.log2(h/g)),b!==this.vlevel?(this.vlevel=b,D.VSPLITMERGE):D.NONE):6<c&&(f.scale(this.tileUp,f.dot(this.tileUp,w),q),f.subtract(q,w),f.length2(q)>this.radius*this.radius&&(f.scale(q,this.radius/f.length(q)),f.add(q,this.center),f.subtract(b,q,q),b=this.elevationBounds[1]-this.elevationBounds[0],
Math.min(1,(Math.abs(f.dot(q,this.tileUp))+.5*b+this.curvatureHeight)/f.length(q))*e<.1/a*l))?D.NONE:D.SPLIT};e.prototype.createElevationDataFromLERC=function(a){var c;try{c=h.createFromLERC(this.lij,this.extent,a,{noDataValue:b.ELEVATION_NODATA_VALUE})}catch(E){console.warn("Error decoding %s: %s",a.url,E.message)}return c};e.prototype.getWGS84Extent=function(){return this.extentWGS84Rad.map(d.rad2deg)};e.prototype.load=function(a){for(var b=0;b<A;b++)this.layerInfo[b]&&this._createOrUpdateAgents(0,
b);a.loadTile(this)};e.prototype.unload=function(a){this.renderData&&a.unloadTile(this);for(a=0;a<A;a++)for(var c=this.layerInfo[a],d=0;d<c.length;d++){var e=c[d];e.loadingAgent&&e.loadingAgent!==z&&(e.loadingAgent.dispose(),this.parentSurface.agentTypeByLayerIndex(d,a).Pool.release(e.loadingAgent),e.loadingAgent=null);e.pendingUpdates=0}this.pendingUpdates&=~b.TileUpdateTypes.UPDATE_GEOMETRY;this.pendingUpdates&=~b.TileUpdateTypes.UPDATE_TEXTURE};e.prototype.updateClippingStatus=function(a){l.equals(a,
this.clippingArea)||(a?(this.intersectsClippingArea=this.intersectsExtent(a),this.isWithinClippingArea=this.isWithinExtent(a)):this.isWithinClippingArea=this.intersectsClippingArea=!0,this.clippingArea=a,this.renderData&&this.updateGeometry())};e.prototype.updateVisibility=function(a,b,c){a=c||this.isVisible(a,b)&&this.intersectsClippingArea;if(a!==this.visible)for(this.visible=a,b=this.layerInfo[0],c=0;c<b.length;c++){var d=b[c];d.loadingAgent&&d.loadingAgent!==z&&d.loadingAgent.setSuspension(!a)}return a};
e.prototype.getLayerInfo=function(a,b){return this.layerInfo[b][a]};e.prototype.hasLayerData=function(a,b){return(a=this.layerInfo[b][a])&&a.data};e.prototype.tileDataAvailable=function(a,b,c){return(b=this.layerInfo[c][b].tilemap)?"unavailable"!==b.getAvailability(a.lij[1],a.lij[2]):!0};e.prototype.requestLayerData=function(a,c,d){b.TILE_LOADING_DEBUGLOG&&console.log("tile %s layer %d/%d requested by tile %s",this.lij.toString(),c,a,d.tile.lij.toString());var e=this.layerInfo[c][a];if(-1<e.waitingAgents.indexOf(d))return console.warn("agent already requested this piece of map data (tile %s, agent tile %s, layer: %d/%d)",
this.lij.toString(),d.tile.lij.toString(),c,a),!0;if(e.data)return console.warn("agent requested existing data (tile %s, agent tile %s, layer: %d/%d)",this.lij.toString(),d.tile.lij.toString(),c,a),e.waitingAgents.push(d),setTimeout(d.dataArrived.bind(d,this),0),!0;if(e.pendingUpdates&D.DECODE_LERC)return e.waitingAgents.push(d),!0;e.waitingAgents.push(d);if(!e.requestPromise){var f=this.parentSurface.requestTileData(this,a,c);a=function(){e.requestPromise===f&&(e.requestPromise=null)};e.requestPromise=
f;f.then(a,a)}return e.requestPromise?!0:!1};e.prototype.descendants=function(a){a||(a=[]);for(var b=0;4>b;b++){var c=this.children[b];c&&(c.descendants(a),a.unshift(this.children[b]))}return a};e.prototype.isLij=function(a){return this.lij[0]===a[0]&&this.lij[1]===a[1]&&this.lij[2]==a[2]};e.prototype.findByLij=function(a){if(this.isLij(a))return this;for(var b=0;4>b;b++){var c=this.children[b];if(c&&(c=c.findByLij(a)))return c}return null};e.prototype.unrequestLayerData=function(a,c,d){b.TILE_LOADING_DEBUGLOG&&
console.log("tile %s layer %d/%d canceled by tile %s",this.lij.toString(),c,a,d.tile.lij.toString());var e=this.layerInfo[c][a],f=e.waitingAgents;d=f.indexOf(d);r(-1<d,"agent has not requested this piece of map data");f[d]=f[f.length-1];f.length--;if(1>f.length){if(c===C&&(f=this.parentSurface.layerViewByIndex(a,C),m.isVectorTileLayerView(f))){e.requestPromise&&e.requestPromise.cancel("cancel");return}r(e.requestPromise||e.rawData,"no pending operations on layerInfo that agents were waiting for");
e.requestPromise&&(this.parentSurface.cancelRequest(e.requestPromise),e.requestPromise=null);b.TILE_LOADING_DEBUGLOG&&console.log("tile %s layer %d/%d request/loading canceled",this.lij.toString(),c,a)}};e.prototype.dataArrived=function(a,b,c){a=this.layerInfo[b][a];a.data=c;for(c=0;c<a.waitingAgents.length;c++)a.waitingAgents[c].dataArrived(this);a.waitingAgents.length=0};e.prototype.dataMissing=function(a,b,c){c.notInTilemap||console.error("Tile %s layer %d/%d error",this.lij.toString(),b,a);a=
this.layerInfo[b][a];for(b=0;b<a.waitingAgents.length;b++)a.waitingAgents[b].dataMissing(this);a.waitingAgents.length=0};e.prototype.updateTexture=function(a){this.renderData&&(a?this.parentSurface._renderer.updateTileTexture(this):(this.pendingUpdates|=b.TileUpdateTypes.UPDATE_TEXTURE,this.parentSurface._pendingUpdates=!0))};e.prototype.reinitializeLayer=function(a,b){a=this.layerInfo[b][a];a.loadingAgent&&a.loadingAgent!==z&&a.loadingAgent.dispose();g.makeEmptyLayerInfo(b,a);this.restartAgents(b)};
e.prototype.computeElevationBounds=function(){n.set2(Number.MAX_VALUE,-Number.MAX_VALUE,this.elevationBounds);for(var a=this.layerInfo[B],b=!1,c=0;c<a.length;c++){var d=a[c];d.elevationBounds&&(this.elevationBounds[0]=Math.min(this.elevationBounds[0],d.elevationBounds[0]),this.elevationBounds[1]=Math.max(this.elevationBounds[1],d.elevationBounds[1]),b=!0)}b||n.set2(0,0,this.elevationBounds);this.updateRadiusAndCenter()};e.prototype.updateRadiusAndCenter=function(){f.scale(this.tileUp,.5*(this.elevationBounds[0]+
this.elevationBounds[1]),q);f.add(this.centerAtSeaLevel,q,this.center)};e.prototype.findElevationBoundsForLayer=function(a,c){var d=this.layerInfo[B][a];if(!d.elevationBounds||d.elevationBounds[2]<c)if(c=this.parentSurface.layerViewByIndex(a,B),k.fallsWithinLayer(this,c,!1)){c=!1;if(d.data)n.set(d.data.bounds,q),q[2]=this.lij[0],c=!0;else{for(var e=this.parent,g=0,h=null,l=d.data;e&&(!l||g<b.ELEVATION_DESIRED_RESOLUTION_LEVEL);){g=this.vlevel-e.lij[0];h=l||h;l=e.layerInfo[B][a].data;if(!l&&h&&g>=
b.ELEVATION_DESIRED_RESOLUTION_LEVEL)break;e=e.parent}if(l=l||h)l.computeMinMaxValue(this.lij[0],this.lij[1],this.lij[2],q),Infinity!==q[0]&&(q[2]=l.level,c=!0)}c&&(d.elevationBounds?f.set(q,d.elevationBounds):d.elevationBounds=[q[0],q[1],q[2]])}};e.prototype.updateGeometry=function(){this.pendingUpdates|=b.TileUpdateTypes.UPDATE_GEOMETRY;this.parentSurface._pendingUpdates=!0};e.prototype.modifyLayers=function(a,b,c){for(var d=b.length,e=this.layerInfo[c],f=Array(d),h=0;h<e.length;h++){var l=e[h];
l.loadingAgent&&l.loadingAgent!==z&&(l.loadingAgent.dispose(),this.parentSurface.agentTypeByLayerIndex(h,c).Pool.release(l.loadingAgent),l.loadingAgent=null);l.waitingAgents.length=0}if(c===C)for(h=0;h<e.length;h++)void 0===a[h]&&e[h].releaseResources();for(h=0;h<d;h++)a=b[h],f[h]=-1<a?e[a]:g.makeEmptyLayerInfo(c);this.layerInfo[c]=f};e.prototype.restartAgents=function(a){if(this.renderData)if(this._createOrUpdateAgents(0,a),a===B){this.updateGeometry();a=this.layerInfo[a];for(var c=0;c<a.length;c++)a[c].pendingUpdates|=
b.TileUpdateTypes.UPDATE_GEOMETRY;this.parentSurface._pendingUpdates=!0}else this.updateTexture(!0)};e.prototype.updateAgents=function(a){if(this.renderData){for(var b=this.layerInfo[a],c=0;c<b.length;c++){var d=b[c];d.loadingAgent===z&&(d.loadingAgent=null)}this._createOrUpdateAgents(0,a)}};e.prototype.agentDone=function(a,b){var c=this.layerInfo[b],d=c[a];d.loadingAgent=z;d.data||d.upsampleFromTile||a<c.length-1&&this._createOrUpdateAgents(a+1,b)};e.prototype._createOrUpdateAgents=function(a,b){var c;
c=b===B?!1:!this.visible;for(var d=this.layerInfo[b];a<d.length;){var e=d[a],f=!1,g=this.parentSurface.layerViewByIndex(a,b);if(null!==e.loadingAgent&&e.loadingAgent!==z)f=e.loadingAgent.update();else if(e.loadingAgent!==z&&k.fallsWithinLayer(this,g,!1)){var h=this.parentSurface.agentTypeByLayerIndex(a,b),l=h.Pool.acquire();(f=l.init(this,a,b,c))?e.loadingAgent=l:(h.Pool.release(l),e.loadingAgent=z)}if(f&&!g.isTransparent)break;a++}};e.prototype.geometryState=function(c){var e,f=this._getElevationInfo(c?
c.samplerData:null),g=this.lij[0],h=!1;f.samplerData?(e=this.vlevel-g,e=Math.max(g-f.maxTileLevel,b.ELEVATION_DESIRED_RESOLUTION_LEVEL-e),g=this._maxTesselation,e=d.clamp((g>>e)+1,2,g+1)):e=8>g?this._numSubdivisionsAtLevel[g]+1:2;e=a.supportedNumVertsPerRow(e);g=this.clippingArea;if(!this.intersectsClippingArea||this.isWithinClippingArea)g=null;c?(c.numVertsPerRow!==e&&(c.numVertsPerRow=e,h=!0),f.changed&&(c.samplerData=f.samplerData,h=!0),l.equals(c.clippingArea,g)||(c.clippingArea=g,h=!0),c.needsUpdate=
h):c={numVertsPerRow:e,samplerData:f.samplerData,needsUpdate:!0,clippingArea:g};return c};e.prototype._getElevationInfo=function(a){for(var b=this.layerInfo[B],c=b.length,d=Array(c),e=0,f=0,g=!1,h=0;h<c;h++){var l=b[h];if(l.upsampleFromTile){var l=l.upsampleFromTile.tile,n=l.layerInfo[B][h].data;a&&a[e]===n.samplerData||(g=!0);d[e++]=n.samplerData;f=Math.max(f,l.lij[0])}else l.data&&(n=this.parentSurface.layerViewByIndex(h,B),k.fallsWithinLayer(this,n,!1)&&(a&&a[e]===l.data.samplerData||(g=!0),d[e++]=
l.data.samplerData,f=this.lij[0]))}a&&a.length!==e&&(g=!0);0<e?d.length=e:d=null;return{changed:g,samplerData:d,maxTileLevel:f}};e.prototype.isWithinExtent=function(a){var b=this.extent;return b[0]>=a[0]&&a[2]>=b[2]&&b[1]>=a[1]&&a[3]>=b[3]};e.prototype.intersectsExtent=function(a){var b=this.extent;return b[2]>=a[0]&&a[2]>=b[0]&&b[3]>=a[1]&&a[3]>=b[1]};return e})},"esri/views/3d/terrain/ElevationData":function(){define(["require","exports","../../../layers/support/rasterFormats/LercCodec","./TerrainConst",
"../support/mathUtils"],function(m,k,b,a,c){return function(){function h(a,b,c,h){this.samplerData=null;this.level=a;this.i=b;this.j=c;this.extent=h}h.prototype.computeMinMaxValue=function(b,d,e,h){var f=Infinity,g=-Infinity;b-=this.level;var l=Math.pow(2,b);if(Math.floor(d/l)===this.i&&Math.floor(e/l)===this.j&&0<b){var k=this.samplerData.width,m=this.samplerData.pixelData,w=.5*a.ELEVATION_NODATA_VALUE;b=(k-1)/l;e=(e-this.j*l)*b;d=(d-this.i*l)*b;if(1>b){var l=Math.floor(e),q=Math.floor(d),x=l+q*
k,y=m[x],z=m[x+1],A=m[x+k],x=m[x+k+1];if(y+z+A+x<w)return f=c.bilerp(y,z,A,x,e-l,d-q),g=c.bilerp(y,z,A,x,e-l+b,d-q),k=c.bilerp(y,z,A,x,e-l,d-q+b),b=c.bilerp(y,z,A,x,e-l+b,d-q+b),h[0]=Math.min(f,g,k,b),h[1]=Math.max(f,g,k,b),h;e=l;d=q;b=1}else e=Math.floor(e),d=Math.floor(d),b=Math.ceil(b);for(l=e;l<=e+b;l++)for(q=d;q<=d+b;q++)x=l+q*k,y=m[x],y<w?(f=Math.min(f,y),g=Math.max(g,y)):(f=0<f?0:f,g=0>g?0:g)}h[0]=f;h[1]=g;return h};h.createFromLERC=function(a,c,e,l){e=b.decode(e,l);a=new h(a[0],a[1],a[2],
c);a.samplerData={pixelData:e.pixelData,width:e.width,height:e.height,minValue:e.minValue,maxValue:e.maxValue,noDataValue:e.noDataValue,safeWidth:.99999999*(e.width-1),dx:(e.width-1)/(a.extent[2]-a.extent[0]),dy:(e.width-1)/(a.extent[3]-a.extent[1]),x0:a.extent[0],y1:a.extent[3]};a.bounds=[a.samplerData.minValue,-3E38<a.samplerData.maxValue?a.samplerData.maxValue:0];return a};return h}()})},"esri/views/3d/terrain/TilePerLayerInfo":function(){define(["require","exports","./TerrainConst","../../webgl/Texture",
"../../vectorTiles/VectorTileDisplayObject"],function(m,k,b,a,c){return function(){function h(a){this.waitingAgents=[];this.rawData=this.requestPromise=this.loadingAgent=this.upsampleFromTile=this.tilemapRequest=this.tilemap=this.data=null;this.pendingUpdates=0;this.elevationBounds=void 0;this.init(a)}h.prototype.init=function(a){this.waitingAgents.length=0;this.rawData=this.requestPromise=this.loadingAgent=this.upsampleFromTile=this.tilemapRequest=this.tilemap=this.data=null;this.pendingUpdates=
0;a===b.LayerClass.ELEVATION&&(this.elevationBounds=null)};h.prototype.releaseResources=function(){this.waitingAgents.length=0;this.rawData=this.requestPromise=this.loadingAgent=this.upsampleFromTile=this.tilemapRequest=this.tilemap=null;this.pendingUpdates=0;var b=this.data;b&&(b instanceof a?b.dispose():b instanceof c&&b.dispose())};h.makeEmptyLayerInfo=function(a,b){return b?(b.init(a),b):new h(a)};return h}()})},"esri/views/3d/terrain/PlanarTile":function(){define(["./TileBase","./TileGeometryFactory",
"../../../core/ObjectPool","../support/mathUtils","../lib/glMatrix"],function(m,k,b,a,c){var h=c.vec3d.createFrom(0,0,1);c=function(a,b,c,l){m.call(this);this.tileUp=h;void 0!==a&&this.init(a,b,c,l)};c.prototype=new m;c.prototype.constructor=c;c.prototype.init=function(b,c,e,h){m.prototype.init.call(this,b,c,e,h);this.edgeLen=this.extent[2]-this.extent[0];this.curvatureHeight=0;this.centerAtSeaLevel[0]=a.lerp(this.extent[0],this.extent[2],.5);this.centerAtSeaLevel[1]=a.lerp(this.extent[1],this.extent[3],
.5);this.centerAtSeaLevel[2]=0;this.updateRadiusAndCenter()};c.prototype.updateRadiusAndCenter=function(){m.prototype.updateRadiusAndCenter.call(this);var a=(this.extent[2]-this.extent[0])*Math.SQRT1_2,b=.5*(this.elevationBounds[0]-this.elevationBounds[1]);this.radius=Math.sqrt(a*a+b*b)};c.prototype.isVisible=function(a){if(!this.intersectsClippingArea)return!1;var b=this.extent[0],c=this.extent[1],g=this.elevationBounds[0],f=this.extent[2],h=this.extent[3],k=this.elevationBounds[1];return 0<a[0][0]*
(0<a[0][0]?b:f)+a[0][1]*(0<a[0][1]?c:h)+a[0][2]*(0<a[0][2]?g:k)+a[0][3]||0<a[1][0]*(0<a[1][0]?b:f)+a[1][1]*(0<a[1][1]?c:h)+a[1][2]*(0<a[1][2]?g:k)+a[1][3]||0<a[2][0]*(0<a[2][0]?b:f)+a[2][1]*(0<a[2][1]?c:h)+a[2][2]*(0<a[2][2]?g:k)+a[2][3]||0<a[3][0]*(0<a[3][0]?b:f)+a[3][1]*(0<a[3][1]?c:h)+a[3][2]*(0<a[3][2]?g:k)+a[3][3]||0<a[4][0]*(0<a[4][0]?b:f)+a[4][1]*(0<a[4][1]?c:h)+a[4][2]*(0<a[4][2]?g:k)+a[4][3]||0<a[5][0]*(0<a[5][0]?b:f)+a[5][1]*(0<a[5][1]?c:h)+a[5][2]*(0<a[5][2]?g:k)+a[5][3]?!1:!0};c.prototype._numSubdivisionsAtLevel=
[2,2,2,2,2,2,2,2];c.prototype.createGeometry=function(a,b,c){a.needsUpdate=!1;return k.createPlanarGlobeTile(a.numVertsPerRow,this.extent,a.samplerData,b,c,a.clippingArea)};c.Pool=new b(c);return c})},"esri/views/3d/terrain/TilemapOnlyTile":function(){define(["require","exports","./TerrainConst","./TilePerLayerInfo"],function(m,k,b,a){return function(){function c(a){this.lij=a;this.layerInfo=Array(b.LayerClass.LAYER_CLASS_COUNT)}c.prototype.tileDataAvailable=function(a,b,c){return(b=this.layerInfo[c][b].tilemap)?
"unavailable"!==b.getAvailability(a.lij[1],a.lij[2]):!0};c.prototype.modifyLayers=function(b,c,d){b=c.length;for(var e=this.layerInfo[d],g=Array(b),f=0;f<b;f++){var h=c[f];g[f]=-1<h?e[h]:new a(d)}this.layerInfo[d]=g};return c}()})},"esri/views/3d/terrain/MapTileAgent":function(){define(["./TileAgentBase","./tileUtils","./UpsampleInfo","../../../core/ObjectPool"],function(m,k,b,a){var c=function(){m.apply(this,arguments)};c.prototype=new m;c.prototype.constructor=c;c.prototype.dataArrived=function(a){a!==
this.tile?this._setUpsamplingTile(a):this.tile.updateTexture();this._dataRequested=null;a!==this.tile&&this._requestNext()};c.prototype._desiredMinLevelDelta=function(){return 0};c.prototype.START_LOADING_LEVEL_DELTA=4;c.prototype.SCALE_RANGE_ENABLED=!0;c.prototype._setUpsamplingTile=function(a){this._tileLayerInfo.upsampleFromTile&&this._tileLayerInfo.upsampleFromTile.tile===a||(this._tileLayerInfo.upsampleFromTile&&b.Pool.release(this._tileLayerInfo.upsampleFromTile),this._tileLayerInfo.upsampleFromTile=
k.computeUpsampleInfoForAncestor(this.tile,a),this.tile.updateTexture())};c.Pool=new a(c);return c})},"esri/views/3d/terrain/TileAgentBase":function(){define(["./UpsampleInfo","./tileUtils"],function(m,k){var b=Error("Abstract method called on TileAgentBase"),a=function(){};a.prototype.init=function(a,b,c,e){this.tile=a;this.layerIdx=b;this.layerClass=c;this._tileLayerInfo=a.getLayerInfo(b,c);this._dataRequested=null;this.suspended=e;if(!a.data)return(a=this._findAncestorWithData())?(this._setUpsamplingTile(a.tile),
m.Pool.release(a)):(this._tileLayerInfo.upsampleFromTile&&m.Pool.release(this._tileLayerInfo.upsampleFromTile),this._tileLayerInfo.upsampleFromTile=null),this._requestNext(!0)};a.prototype.dispose=function(){this._dataRequested&&(this._dataRequested.unrequestLayerData(this.layerIdx,this.layerClass,this),this._dataRequested=null);this._tileLayerInfo=this.tile=null};a.prototype.setSuspension=function(a){a!==this.suspended&&((this.suspended=a)?this._dataRequested&&(this._dataRequested.unrequestLayerData(this.layerIdx,
this.layerClass,this),this._dataRequested=null):this._tileLayerInfo.data||this.update())};a.prototype.update=function(){var a=this._findAncestorWithData();a&&this._tileLayerInfo.upsampleFromTile&&a.tile!==this._tileLayerInfo.upsampleFromTile.tile?this._setUpsamplingTile(a.tile):a&&m.Pool.release(a);return this._requestNext()};a.prototype.dataArrived=function(a){throw b;};a.prototype.dataMissing=function(a){this._dataRequested=null;this._agentDone()};a.prototype._agentDone=function(){this.tile.agentDone(this.layerIdx,
this.layerClass);this.dispose()};a.prototype._requestNext=function(a){if(this.suspended)return!0;var b=this._findNextDownload();if(this._dataRequested){if(b===this._dataRequested)return!0;this._dataRequested.unrequestLayerData(this.layerIdx,this.layerClass,this);this._dataRequested=null}b?b.requestLayerData(this.layerIdx,this.layerClass,this)&&(this._dataRequested=b):a||this._agentDone();return!!this._dataRequested};a.prototype._findNextDownload=function(){for(var a,b=this.layerIdx,c=this.layerClass,
e=this.tile.parentSurface.layerViewByIndex(b,c),l=e.minDataLevel,f=e.maxDataLevel,n=this._desiredMinLevelDelta(),m=this.START_LOADING_LEVEL_DELTA+n,t=this.SCALE_RANGE_ENABLED,r=this.tile,w=r.lij[0],q=0,x=this._tileLayerInfo.upsampleFromTile?this._tileLayerInfo.upsampleFromTile.tile.lij[0]:-1,y=this.tile.parentSurface,z=y.getTilemapTile(r),y=y.tilemapStats,A=!1;r&&(q<=m||!a)&&(!t||k.fallsWithinLayer(r,e,!1))&&r.lij[0]>=l;){var C=r.layerInfo[c][b];if(C.data&&q>=n){r.lij[0]>x&&this._setUpsamplingTile(r);
break}z&&!z.tileDataAvailable(r,b,c)?A=!0:r.lij[0]<=f&&!C.data&&(a=r);r=r.parent;z=z?z.parent:null;q++}a&&w-a.lij[0]<n&&this._tileLayerInfo.upsampleFromTile&&(a=null);!a&&A&&y.tilesNotPresent++;return a};a.prototype._findAncestorWithData=function(){return c(this.tile,this.layerIdx,this.layerClass,1,0,0,0)};var c=function(a,b,d,e,l,f,n){if(!a.parent||6<n)return null;e*=.5;l*=.5;f*=.5;a.lij[2]&1&&(l+=.5);0===(a.lij[1]&1)&&(f+=.5);return a.parent.hasLayerData(b,d)?(b=m.Pool.acquire(),b.init(a.parent,
l,f,e),b):c(a.parent,b,d,e,l,f,n+1)};a.prototype._desiredMinLevelDelta=function(){throw b;};a.prototype.START_LOADING_LEVEL_DELTA=4;a.prototype.SCALE_RANGE_ENABLED=!1;return a})},"esri/views/3d/terrain/ElevationTileAgent":function(){define(["./TileAgentBase","./TerrainConst","./UpsampleInfo","../../../core/ObjectPool"],function(m,k,b,a){var c=function(){m.apply(this,arguments)};c.prototype=new m;c.prototype.constructor=c;c.prototype.dataArrived=function(a){a!==this.tile?this._setUpsamplingTile(a):
this.updateGeometry();this._dataRequested=null;this._requestNext()};c.prototype.updateGeometry=function(){this._tileLayerInfo.pendingUpdates|=k.TileUpdateTypes.UPDATE_GEOMETRY;this.tile.updateGeometry()};c.prototype._findAncestorWithData=function(){for(var a=this.layerClass,c=this.layerIdx,d=this.tile,e=d.vlevel,l;d&&!(d.layerInfo[a][c].data&&(l=d,e-d.lij[0]>=k.ELEVATION_DESIRED_RESOLUTION_LEVEL));)d=d.parent;return l?(a=b.Pool.acquire(),a.init(l,0,0,1),a):null};c.prototype._desiredMinLevelDelta=
function(){return k.ELEVATION_DESIRED_RESOLUTION_LEVEL-(this.tile.vlevel-this.tile.lij[0])};c.prototype.START_LOADING_LEVEL_DELTA=4;c.prototype.SCALE_RANGE_ENABLED=!1;c.prototype._setUpsamplingTile=function(a){this._tileLayerInfo.upsampleFromTile&&b.Pool.release(this._tileLayerInfo.upsampleFromTile);var c=b.Pool.acquire();c.init(a,0,0,1);this._tileLayerInfo.upsampleFromTile=c;this.updateGeometry()};c.Pool=new a(c);return c})},"esri/views/3d/layers/graphics/LabelManager":function(){define("../../../../core/declare ../../../../core/watchUtils ../../support/PreallocArray ../../lib/glMatrix ../../webgl-engine/lib/Util ../../webgl-engine/materials/HUDMaterial".split(" "),
function(m,k,b,a,c,h){function g(a,b){return b.posView-a.posView}var d=a.mat4d,e=a.vec3d,l=a.vec2d,f=a.vec4d,n=c.lerp,u=c.VertexAttrConstants,t=[[-1,-1],[1,-1],[1,1],[-1,1]],r=f.create(),w=f.create(),q=f.create(),x=f.create(),y=l.create(),z=l.create(),A=f.create(),C=f.create(),B=f.create(),D=e.create(),H=l.create(),K=f.create(),E=e.create(),F=e.create(),L=d.create(),Q=e.create(),N=f.create(),J=new b(100);a=function(a,b){this.constructor=a;this.releaser=b;this.list=[];this.currentIndex=0};a.prototype.alloc=
function(){this.currentIndex>=this.list.length&&this.list.push(this.constructor.apply(this,arguments));return this.list[this.currentIndex++]};a.prototype.freeAll=function(a){a=this.currentIndex;for(var b=this.releaser,c=this.list;0<=--a;)b(c[a]);this.currentIndex=0};var P=new a(function(){return{labelGraphics:null,c3dGraphic:null,positions:[l.create(),l.create(),l.create(),l.create()],xMin:0,xMax:0,yMin:0,yMax:0,posView:0,layerView:null,labelId:0}},function(a){a.layerGraphics=null;a.c3dGraphic=null;
a.layerView=null});return m(null,{constructor:function(a){this.layerViews=[];this.view=a;this.stage=a._stage;this._deconflictTimeoutId=0;this._cameraListener=k.on(a,"navigation","targetViewChanged",this._targetViewChanged.bind(this));this._viewReadyWatcher=a.watch("ready",function(a){!a&&this._deconflictTimeoutId&&(clearTimeout(this._deconflictTimeoutId),this._deconflictTimeoutId=0)}.bind(this))},destroy:function(){this._cameraListener.remove();0!==this._deconflictTimeoutId&&(clearTimeout(this._deconflictTimeoutId),
this._deconflictTimeoutId=0);this._viewReadyWatcher.remove()},addSceneServiceLayerView:function(a){this.layerViews.push(a)},setDirty:function(){this._deconflictLabelsTimeout(10)},setInitialLabelGraphicState:function(a){a.setVisibilityFlag("VISIBILITY_LABELMANAGER",!1)},removeSceneServiceLayerView:function(a){a=this.layerViews.indexOf(a);0<=a&&this.layerViews.splice(a,1)},_drawPoly:function(a,b,c){a.beginPath();a.lineWidth="1";a.strokeStyle=c;a.moveTo(b[0][0],b[0][1]);for(c=1;4>c;c++)a.lineTo(b[c][0],
b[c][1]),a.stroke();a.lineTo(b[0][0],b[0][1]);a.stroke();a.closePath()},_tmp_vec:l.create(),_doesIntersectExistingPoly:function(a){var b=this._tmp_vec,c=a.positions,d={},e,f,g,h,n,q,k,x,t,m,u,y,r,w;for(e=Math.floor(a.xMin/this._accBinsSizeX);e<=Math.floor(a.xMax/this._accBinsSizeX);e++)if(!(0>e||e>=this._accBinsNumX))for(f=Math.floor(a.yMin/this._accBinsSizeY);f<=Math.floor(a.yMax/this._accBinsSizeY);f++)if(!(0>f||f>=this._accBinsNumY))a:for(g=this._accBins[e][f],h=0;h<g.length;h++)if(n=g.data[h],
null==d[n.labelId]){d[n.labelId]=!0;n=n.positions;this._accNumTests++;for(x=0;2>x;x++)b:for(q=0===x?c:n,k=0===x?n:c,r=0;4>r;r++){t=q[r];m=q[(r+1)%4];u=q[(r+2)%4];b[0]=m[0]-t[0];b[1]=m[1]-t[1];m=l.normalize(b);y=m[1];m[1]=m[0];m[0]=-y;y=m[0]*t[0]+m[1]*t[1];w=m[0]*u[0]+m[1]*u[1]<y;for(t=0;4>t;t++)if(u=k[t],u=m[0]*u[0]+m[1]*u[1],w&&u<y||!w&&u>y)continue b;continue a}return!0}return!1},_accBinsNumX:15,_accBinsNumY:20,_accBinsSizeX:0,_accBinsSizeY:0,_accBins:null,_accNumTests:0,_initBins:function(a,c){var d,
e,f;if(null==this._accBins)for(this._accBins=[],d=0;d<this._accBinsNumX;d++)for(this._accBins.push([]),f=this._accBins[this._accBins.length-1],e=0;e<this._accBinsNumY;e++)f.push(new b(10));for(d=0;d<this._accBinsNumX;d++)for(e=0;e<this._accBinsNumY;e++)this._accBins[d][e].clear();this._accBinsSizeX=a/this._accBinsNumX;this._accBinsSizeY=c/this._accBinsNumY;this._accNumTests=0},_addToBins:function(a){var b,c;for(b=Math.floor(a.xMin/this._accBinsSizeX);b<=Math.floor(a.xMax/this._accBinsSizeX);b++)if(!(0>
b||b>=this._accBinsNumX))for(c=Math.floor(a.yMin/this._accBinsSizeY);c<=Math.floor(a.yMax/this._accBinsSizeY);c++)0>c||c>=this._accBinsNumY||this._accBins[b][c].push(a)},_accDrawDebug:function(a){var b=[l.create(),l.create(),l.create(),l.create()],c=0,d,e,f,g,h,n,q;for(d=0;d<this._accBinsNumX;d++)for(e=0;e<this._accBinsNumY;e++)f=this._accBins[d][e],c+=f.length,g=d*this._accBinsSizeX,h=(d+1)*this._accBinsSizeX,n=e*this._accBinsSizeY,q=(e+1)*this._accBinsSizeY,b[0][0]=g,b[0][1]=n,b[1][0]=h,b[1][1]=
n,b[2][0]=h,b[2][1]=q,b[3][0]=g,b[3][1]=q,a.fillText(f.length.toFixed(),g+5,n+15),this._drawPoly(a,b,"blue");a.fillText("total totalShownLabels: "+c,70,40)},_targetViewChanged:function(){this._deconflictLabelsTimeout()},_deconflictLabelsTimeout:function(a){a=a||200;0===this._deconflictTimeoutId&&(this._deconflictTimeoutId=setTimeout(this._deconflictLabels.bind(this),a))},_deconflictLabels:function(){var a=this.view;clearTimeout(this._deconflictTimeoutId);this._deconflictTimeoutId=0;P.freeAll();var b=
a.navigation.targetCamera,c=b.viewMatrix,k=1/Math.tan(b.fovX/2),m=b.projectionMatrix,X=b.fullWidth,aa=b.fullHeight;J.clear();for(var R={},ia=!1,ga=0;ga<this.layerViews.length;ga++){var ha=this.layerViews[ga];if(null!=ha.layerLabelsEnabled&&ha.layerLabelsEnabled()&&null!=ha.getGraphics3DGraphics&&null!=ha.getGraphics3DGraphicsKeys){ia||(this._initBins(X,aa),ia=!0);for(var la=ha.getGraphics3DGraphics(),da=ha.getGraphics3DGraphicsKeys(),Y=0;Y<da.length;Y++){var V=la[da[Y]];if(!(null==V._labelGraphics||
1>V._labelGraphics.length)&&V.areVisibilityFlagsSet(void 0,"VISIBILITY_LABELMANAGER")){var ba=V._labelGraphics[0],T=ba.stageObject,U=T.getGeometryRecord(0);if(null!=U){var Z=U.materials[0];if(null!=Z&&Z instanceof h&&null!=U.origin){var a=c,T=T.getCenter(),G=U.origin.vec3;f.set4(T[0]-G[0],T[1]-G[1],T[2]-G[2],1,r);d.translate(a,G,L);a=L;d.multiplyVec4(a,r,w);for(var ja=U.geometry.getData().getVertexAttr()[u.AUXPOS1],G=0;3>G;G++)w[G]+=ja.data[G];d.multiplyVec4(m,w,q);f.scale(q,1/Math.abs(q[3]),x);l.set2(n(0,
X,.5+.5*x[0]),n(0,aa,.5+.5*x[1]),H);if(-1>x[0]||-1>x[1]||-1>x[2]||1<=x[0]||1<=x[1]){a=!1;for(U=0;U<V._labelGraphics.length;U++)a=a||V._labelGraphics[U].setVisibilityFlag("VISIBILITY_LABELMANAGER",!1);a&&(R[ha]=!0)}else{G=Z.getParams();Z=U.geometry.getData().getVertexAttr()[u.SIZE].data;l.subtract(G.anchorPos,[.5,.5],y);l.scale(G.screenOffset,.5,z);U=P.alloc();if(G.direction){var S=e.set3(ba.geometry.normal[0],ba.geometry.normal[1],ba.geometry.normal[2],E),ja=e.normalize(e.subtract(b.eye,b.center,
A),A),ca=e.normalize(e.set(G.direction,F)),p,ba=0;e.scale(ca,e.dot(ca,ja),D);e.subtract(ja,D,D);e.normalize(D);p=Math.abs(e.dot(D,S));.985>Math.abs(e.dot(ja,ca))&&.5>p?.422>p?(ja=ca,p=S,ba=.5):(ja=ca,p=Q,e.cross(ca,D,p),ba=e.dot(p,S)/2):(ja=ca,p=e.normalize(e.cross(S,ca)));S=e.dist(b.eye,T)/k/b.width*2;T=S*G.screenMinMaxSize[0];ca=S*G.screenMinMaxSize[1];G.worldScale?(S=1,0<T&&T>Z[1]&&(S=T/Z[1]),0<ca&&Z[1]>ca&&(S=ca/Z[1])):S=.5*q[3]/X;for(G=0;4>G;G++)f.set(r,N),e.add(N,e.scale(ja,t[G][0]*Z[0]*S,C)),
e.add(N,e.scale(p,(t[G][1]+ba)*Z[1]*S,B)),d.multiplyVec4(a,N,A),T=d.multiplyVec4(m,A,C),f.scale(T,1/Math.abs(T[3]),T),U.positions[G][0]=n(0,X,.5+.5*T[0]),U.positions[G][1]=aa-n(0,aa,.5+.5*T[1])}else if(G.worldScale)for(S=e.dist(b.eye,T)/k/b.width*2,T=S*G.screenMinMaxSize[0],ca=S*G.screenMinMaxSize[1],S=1,0<T&&T>Z[1]&&(S=T/Z[1]),0<ca&&Z[1]>ca&&(S=ca/Z[1]),G=0;4>G;G++)K[0]=w[0]+(.5*t[G][0]-y[0])*Z[0]*S,K[1]=w[1]+(.5*t[G][1]-y[1])*Z[1]*S,T=d.multiplyVec4(m,K,A),f.scale(T,1/Math.abs(T[3]),T),U.positions[G][0]=
n(0,X,.5+.5*T[0])+z[0],U.positions[G][1]=aa-n(0,aa,.5+.5*T[1])-z[1];else for(a=e.dist(b.eye,r),G=0;4>G;G++)U.positions[G][0]=H[0]+(.5*t[G][0]-y[0])*Z[0]+z[0],U.positions[G][1]=aa-H[1]+(.5*t[G][1]+y[1])*Z[1]-z[1];a=w[2];V.areVisibilityFlagsSet("VISIBILITY_LABELMANAGER",void 0)&&(a*=.7);U.labelId=J.length;U.xMin=Number.MAX_VALUE;U.yMin=Number.MAX_VALUE;U.xMax=-Number.MAX_VALUE;U.yMax=-Number.MAX_VALUE;for(Z=0;4>Z;Z++)U.xMin=Math.min(U.positions[Z][0],U.xMin),U.yMin=Math.min(U.positions[Z][1],U.yMin),
U.xMax=Math.max(U.positions[Z][0],U.xMax),U.yMax=Math.max(U.positions[Z][1],U.yMax);U.labelGraphics=V._labelGraphics;U.c3dGraphic=V;U.posView=a;U.layerView=ha;J.push(U)}}}}}}}J.sort(g);for(ga=0;ga<J.length;ga++){b=J.data[ga];a=!1;ha=b.layerView;if(this._doesIntersectExistingPoly(b))for(G=0;G<b.labelGraphics.length;G++)a=a||b.labelGraphics[G].setVisibilityFlag("VISIBILITY_LABELMANAGER",!1);else for(this._addToBins(b),G=0;G<b.labelGraphics.length;G++)a=a||b.labelGraphics[G].setVisibilityFlag("VISIBILITY_LABELMANAGER",
!0);a&&b.c3dGraphic.isDraped()&&(R[ha]=!0);Object.keys(R).forEach(function(a){a.emit&&a.emit("draped-data-change")})}}})})},"esri/views/3d/layers/GraphicsView3D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../layers/GraphicsView ./graphics/Graphics3DCore ./graphics/Graphics3DSpatialIndex ./graphics/Graphics3DElevationAlignment ../support/PromiseLightweight ../../../core/promiseUtils".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f){m=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b.graphicsCore=null;b.spatialIndex=null;b.elevation=null;b.supportsDraping=!0;b._overlayUpdating=!1;b._eventHandles=[];return b}b(c,a);Object.defineProperty(c.prototype,"graphics",{set:function(a){a!==this.loadedGraphics&&(this.loadedGraphics=a);this._set("graphics",a)},enumerable:!0,configurable:!0});c.prototype.initialize=function(){var a=this;this.mockLayerId="__sceneView.graphics-"+Date.now().toString(16);
this.spatialIndex=new d;this.spatialIndex.whenLoaded().then(function(){return a.deferredInitialize()})};c.prototype.deferredInitialize=function(){var a=this;if(!this.destroyed){this.loadedGraphics=this.graphics;this.graphicsCore=new g;this.elevation=new e;var b={id:this.mockLayerId};this.spatialIndex.initialize(this,b,this.view.spatialReference,this.graphicsCore);this.elevation.initialize(this,function(b,c,d){a.spatialIndex.intersects(b,c,d)},this.graphicsCore,this.view.basemapTerrain);this.graphicsCore.initialize(this,
b,this.elevation,null,this.spatialIndex,null,null,null,this.view.basemapTerrain);this._eventHandles.push(this.view.watch("clippingArea",function(){return a.updateClippingExtent()}));this.updateClippingExtent();this.view.resourceController.registerIdleFrameWorker(this,{needsUpdate:this._needsIdleUpdate,idleFrame:this._idleUpdate})}};c.prototype.destroy=function(){this._eventHandles.forEach(function(a){return a.remove()});this._eventHandles=null;this.view.resourceController.deregisterIdleFrameWorker(this);
this.spatialIndex&&(this.spatialIndex.destroy(),this.spatialIndex=null);this.elevation&&(this.elevation.destroy(),this.elevation=null);this.graphicsCore&&(this.graphicsCore.destroy(),this.graphicsCore=null);this.loadedGraphics=null};c.prototype.getGraphicsFromStageObject=function(a,b){var c=a.getMetadata().graphicId,d=null;this.loadedGraphics&&this.loadedGraphics.some(function(a){return a.uid===c?(d=a,!0):!1});a=new l.Promise;null!==d?a.done(d):a.reject();return a};c.prototype.whenGraphicBounds=function(a){var b=
this;return this.spatialIndex?this.spatialIndex.whenLoaded().then(function(){return b.graphicsCore?b.graphicsCore.whenGraphicBounds(a):f.reject()}):f.reject()};c.prototype._needsIdleUpdate=function(){return this.elevation.needsIdleUpdate()};c.prototype._idleUpdate=function(a){this.elevation.idleUpdate(a)};c.prototype._notifySuspendedChange=function(){};c.prototype._notifyDrapedDataChange=function(){this.view.basemapTerrain&&this.view.basemapTerrain.overlayManager.setOverlayDirty()};c.prototype._evaluateUpdatingState=
function(){if(this.elevation){var a;a=0+this.elevation.numNodesUpdating();a+=this.graphicsCore.numNodesUpdating();this.updating=a=(a=(a=0<a||this._overlayUpdating)||this.spatialIndex.isUpdating())||this.graphicsCore.needsIdleUpdate()}else this.updating=!1};c.prototype.updateClippingExtent=function(){this.graphicsCore.setClippingExtent(this.view.clippingArea,this.view.spatialReference)&&this.graphicsCore.recreateAllGraphics()};return c}(c.declared(h));a([c.property()],m.prototype,"graphics",null);
a([c.property()],m.prototype,"loadedGraphics",void 0);a([c.property({value:!0})],m.prototype,"updating",void 0);a([c.property({value:!1})],m.prototype,"suspended",void 0);return m=a([c.subclass("esri.views.3d.layers.GraphicsView3D")],m)})},"esri/views/layers/GraphicsView":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../../core/Accessor ../../core/Collection ../../Graphic".split(" "),function(m,
k,b,a,c,h,g,d){m=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b.graphics=null;b.renderer=null;b.view=null;return b}b(c,a);return c}(c.declared(h));a([c.property({type:g.ofType(d)})],m.prototype,"graphics",void 0);a([c.property()],m.prototype,"renderer",void 0);a([c.property()],m.prototype,"view",void 0);return m=a([c.subclass("esri.views.layers.GraphicsView")],m)})},"esri/views/3d/layers/graphics/Graphics3DCore":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/watchUtils ../../../../core/arrayUtils ../../../../core/Error ../../../../core/Logger ../../../../core/promiseUtils ../../support/projectionUtils ../../../../renderers/UniqueValueRenderer ../../../../renderers/support/rendererConversion ../../../../renderers/support/diffUtils ../../../../geometry/Point ../../../../geometry/Extent ../../webgl-engine/Stage ../../webgl-engine/lib/Util ../../webgl-engine/lib/Layer ../../webgl-engine/lib/FloatingBoxLocalOriginFactory ../../../../symbols/WebStyleSymbol ../../../../symbols/support/symbolConversion ../../lib/glMatrix ./Graphics3DGraphic ./Graphics3DSymbol ./Graphics3DWebStyleSymbol ./graphicUtils ./Graphics3DOwner ./ElevationQuery ../../support/aaBoundingBox ../../support/mathUtils dojo/Deferred".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f,n,u,t,r,w,q,x,y,z,A,C,B,D,H,K,E,F,L,Q,N){m=C.vec3d;var J=new t,P=m.create(),I=d.getLogger("esri.views.3d.LayerView3D");d=function(){function d(){this.graphics={};this.graphicsDrapedIds={};this.graphicsBySymbol={};this.graphicsKeys=[];this.symbols={};this.graphicsWithoutSymbol={};this.computedExtent=null;this.symbolCreationContext=new E.Graphics3DSymbolCreationContext;this.hasDraped=!1;this.updatingGraphicIds=new Set;this.graphicTransformFunc=this.onComputedExtentChange=
this.stage=this.labelStageLayer=this.stageLayer=this.tilingSchemeHandle=this.lastFastUpdate=null;this.eventHandles=[];this.elevationQueryService=this.labeling=this.spatialIndex=this.scaleVisibility=this.elevation=this.layer=this.layerView=this.viewSR=null;this.whenGraphics3DGraphicRequests={}}d.prototype.initialize=function(a,b,e,f,g,h,l,n,q){var k=this;this.layerView=a;this.layer=b;this.viewSR=a.view.spatialReference;this.elevation=e;this.scaleVisibility=f;this.spatialIndex=g;this.labeling=h;this.onComputedExtentChange=
l;this.graphicTransformFunc=n;this.elevationQueryService=new F.ElevationQuery(this.viewSR,function(){return k.layerView.view.map.ground},{maximumAutoTileRequests:4});this.initializeStage(this.layerView.view,this.layer.id);this.symbolCreationContext.sharedResources=this.layerView.view.sharedSymbolResources;this.symbolCreationContext.renderer=this.layer.renderer;this.symbolCreationContext.stage=this.stage;this.symbolCreationContext.streamDataSupplier=this.layerView.view.sharedSymbolResources.streamDataSupplier;
this.symbolCreationContext.renderSpatialReference=this.layerView.view.renderSpatialReference;this.symbolCreationContext.renderCoordsHelper=this.layerView.view.renderCoordsHelper;this.symbolCreationContext.layer=this.layer;this.symbolCreationContext.layerView=this.layerView;this.symbolCreationContext.layerOrder=0;this.symbolCreationContext.localOriginFactory=d.createLocalOriginFactory();this.symbolCreationContext.elevationProvider=q;this.tilingSchemeHandle=c.when(q,"tilingScheme",function(a){a.spatialReference.equals(k.symbolCreationContext.overlaySR)||
(k.symbolCreationContext.overlaySR=q.spatialReference,k.recreateAllGraphics())});this.eventHandles.push(this.layerView.watch("suspended",function(){return k.suspendedChange()}));this.eventHandles.push(c.on(a,"loadedGraphics","change",function(a){return k.graphicsCollectionChanged(a)},function(){k.clearSymbolsAndGraphics();k.graphicsCollectionChanged({added:k.layerView.loadedGraphics.toArray(),removed:[]})}));this.validateRenderer(this.layer.renderer)};d.prototype.destroy=function(){var a=this;this.clear();
if(this.stage){var b=[this.stageLayer.getId()];this.labelStageLayer&&b.push(this.labelStageLayer.getId());this.stage.removeFromViewContent(b);b.forEach(function(b){return a.stage.remove(w.ModelContentType.LAYER,b)});this.stage=this.labelStageLayer=this.stageLayer=null}this.tilingSchemeHandle&&(this.tilingSchemeHandle.remove(),this.tilingSchemeHandle=null);this.eventHandles.forEach(function(a){return a.remove()});this.layerView=this.labeling=this.scaleVisibility=this.viewSR=this.onComputedExtentChange=
this.eventHandles=null;for(var c in this.whenGraphics3DGraphicRequests)this.whenGraphics3DGraphicRequests[c].reject(new g("graphic:layer-destroyed","Layer has been destroyed"));this.whenGraphics3DGraphicRequests=null};d.prototype.clear=function(){var a=!1,b;for(b in this.graphics){var c=this.graphics[b],a=a||c.isDraped();c.destroy()}this.graphics={};this.graphicsKeys=null;for(var d in this.symbols)(b=this.symbols[d])&&b.destroy();this.symbols={};this.graphicsBySymbol={};this.graphicsWithoutSymbol=
{};this.hasDraped=!1;a&&this.layerView._notifyDrapedDataChange()};d.prototype.initializeStage=function(a,b){this.stage=a._stage;this.stageLayer=new x(b,{state:this.layerView.suspended?"HIDDEN":"VISIBLE"},b);this.stage.add(w.ModelContentType.LAYER,this.stageLayer);a=[this.stageLayer.getId()];this.labeling&&(this.labelStageLayer=new x(b,{state:this.layerView.suspended?"HIDDEN":"IGNORED"},b+"_labels"),this.stage.add(w.ModelContentType.LAYER,this.labelStageLayer),a.push(this.labelStageLayer.getId()));
this.stage.addToViewContent(a)};d.prototype.setDrawingOrder=function(a){this.symbolCreationContext.layerOrder=a;var b={},c={},d;for(d in this.graphics)this.graphics[d].setDrawOrder(a,b,c);for(var e in c)(c=this.symbols[e])&&c.setDrawOrder(a,b);q.objectEmpty(b)||(this.stage.getTextureGraphicsRenderer().updateRenderOrder(b),this.layerView._notifyDrapedDataChange())};d.prototype.suspendedChange=function(){!0===this.layerView.suspended?(this.stageLayer.setState("HIDDEN"),this.labelStageLayer&&this.labelStageLayer.setState("HIDDEN"),
this.hideAllGraphics()):!1===this.layerView.suspended&&(this.stageLayer.setState("VISIBLE"),this.labelStageLayer&&this.labelStageLayer.setState("IGNORED"),this.updateAllGraphicsVisibility())};d.prototype.getGraphics3DGraphics=function(){return this.graphics};d.prototype.getGraphics3DGraphicById=function(a){return this.graphics[a]};d.prototype.getGraphics3DGraphicsKeys=function(){null===this.graphicsKeys&&(this.graphicsKeys=Object.keys(this.graphics));return this.graphicsKeys};d.prototype.getSymbolUpdateType=
function(){var a=0,b=0,c=0,d;for(d in this.symbols){var e=this.symbols[d];e&&(e=e.getFastUpdateStatus(),a+=e.loading,c+=e.fast,b+=e.slow)}return 0<a?"unknown":0<=c&&0===b?"fast":0<=b&&0===c?"slow":"mixed"};d.prototype.numNodesUpdating=function(){return this.updatingGraphicIds.size};d.prototype.needsIdleUpdate=function(){return!!this.lastFastUpdate&&500<performance.now()-this.lastFastUpdate};d.prototype.idleUpdate=function(a){a.done()||(this.lastFastUpdate&&(this.labeling&&this.labeling.updateLabelingInfo(),
this.lastFastUpdate=null),this.layerView._evaluateUpdatingState())};d.prototype.whenGraphics3DGraphic=function(a){var b=this.graphics[a.uid];if(b)return e.resolve(b);b=this.whenGraphics3DGraphicRequests[a.uid];b||(b=new N,this.whenGraphics3DGraphicRequests[a.uid]=b);return b.promise};d.prototype.boundsForGraphics3DGraphic=function(c){return a(this,void 0,void 0,function(){var a,d,e,f,g,h,n,q,k;return b(this,function(b){switch(b.label){case 0:return a=this.layerView.view.spatialReference,d=this.layerView.view.renderSpatialReference,
e=this.layerView.view.basemapTerrain.spatialReference,f=function(b,c,e){return l.bufferToBuffer(b,d,c,b,a,c,e)},g=function(b,c,d){return l.bufferToBuffer(b,e,c,b,a,c,d)},[4,c.getProjectedBoundingBox(f,g,this.elevationQueryService)];case 1:h=b.sent();if(!h)return[2,null];n=h.boundingBox;h.requiresDrapedElevation&&(q=this.symbolCreationContext.elevationProvider)&&(L.center(n,P),J.x=P[0],J.y=P[1],J.z=void 0,J.spatialReference=a,k=q.getElevation(J)||0,n[2]=Math.min(n[2],k),n[5]=Math.max(n[5],k));return[2,
n]}})})};d.prototype.whenGraphicBounds=function(a){var b=this;return c.whenOnce(this.layerView,"loadedGraphics").then(function(){if(b.layerView.loadedGraphics.some(function(b){return b===a}))return b.whenGraphics3DGraphic(a);throw new g("internal:graphic-not-part-of-view","Graphic is not part of this view");}).then(function(a){return b.boundsForGraphics3DGraphic(a)})};d.prototype.graphicsCollectionChanged=function(a){var b=this.graphicTransformFunc?this.graphicTransformFunc(a.added):a.added;this.add(b);
this.remove(a.removed)};d.prototype.graphicUpdateHandler=function(a){var b=this.graphics[a.graphic.uid];if(b)switch(a.property){case "visible":b.setVisibilityFlag("VISIBILITY_GRAPHIC",a.newValue)&&(b.isDraped()&&this.layerView._notifyDrapedDataChange(),this.labeling&&this.layerView.view.labelManager.setDirty())}};d.prototype.beginGraphicUpdate=function(a){this.updatingGraphicIds.add(a.uid);this.layerView.get("symbolsUpdating")||this.layerView.set("symbolsUpdating",!0);this.layerView._evaluateUpdatingState()};
d.prototype.endGraphicUpdate=function(a){a&&this.updatingGraphicIds.delete(a.uid);this.layerView.get("symbolsUpdating")&&0===this.updatingGraphicIds.size&&(this.layerView.view.flushDisplayModifications(),this.layerView.set("symbolsUpdating",!1));this.layerView._evaluateUpdatingState()};d.prototype.expandComputedExtent=function(a){var b,c,e,f,g,h;if("point"===a.type)b=c=a.x,e=f=a.y,a.z&&(g=h=a.z);else if("polygon"===a.type||"polyline"===a.type||"multipoint"===a.type){h=a.extent;if(!h)return;b=h.xmin;
c=h.xmax;e=h.ymin;f=h.ymax;g=h.zmin;h=h.zmax}var n=this.viewSR,q=d.tmpVec;!a.spatialReference.equals(n)&&l.xyzToVector(b,e,0,a.spatialReference,q,n)&&(b=q[0],e=q[1],l.xyzToVector(c,f,0,a.spatialReference,q,n),c=q[0],f=q[1]);Q.isFinite(b)&&Q.isFinite(c)&&Q.isFinite(e)&&Q.isFinite(f)&&((n=this.computedExtent)?(n.xmin=Math.min(b,n.xmin),n.xmax=Math.max(c,n.xmax),n.ymin=Math.min(e,n.ymin),n.ymax=Math.max(f,n.ymax)):this.computedExtent=n=new r(b,e,c,f,a.spatialReference),Q.isFinite(g)&&!Q.isFinite(h)&&
(n.zmin=null!=n.zmin?Math.min(g,n.zmin):g,n.zmax=null!=n.zmax?Math.max(h,n.zmax):h),this.onComputedExtentChange&&this.onComputedExtentChange())};d.prototype.updateHasDraped=function(){this.hasDraped=!1;for(var a in this.graphicsDrapedIds)if(this.graphicsDrapedIds.hasOwnProperty(a)){this.hasDraped=!0;break}};d.prototype.elevationInfoChange=function(){this.labeling&&this.labeling.elevationInfoChange();for(var a in this.graphicsBySymbol){var b=this.symbols[a],c=this.graphicsBySymbol[a];if(b&&b.layerPropertyChanged("elevationInfo",
c))for(var d in c)for(var e=c[d],b=e.graphic,e=e._labelGraphics,f=0;f<e.length;f++){var g=e[f];g.graphics3DSymbolLayer.updateGraphicElevationInfo(b,g)}else this.recreateSymbol(a)}};d.prototype.clearSymbolsAndGraphics=function(){this.clear();this.elevation&&this.elevation.clear();this.labeling&&this.labeling.clear()};d.prototype.recreateAllGraphics=function(){this.clearSymbolsAndGraphics();this.computedExtent=null;this.onComputedExtentChange&&this.onComputedExtentChange();this.layerView.loadedGraphics&&
this.layerView.view.basemapTerrain.tilingScheme&&this.add(this.layerView.loadedGraphics.toArray())};d.prototype.recreateSymbol=function(a){var b=this.graphicsBySymbol[a],c=[],d=!1,e;for(e in b){var f=b[e];f.isDraped()&&(delete this.graphicsDrapedIds[e],d=!0);c.push(f.graphic);f.destroy();delete this.graphics[e]}this.graphicsBySymbol[a]={};(b=this.symbols[a])&&b.destroy();delete this.symbols[a];this.updateHasDraped();d&&this.layerView._notifyDrapedDataChange();this.add(c)};d.prototype.add=function(a){if(this.layerView.view.basemapTerrain&&
this.layerView.view.basemapTerrain.tilingScheme){for(var b=a.length,c=Array(b),d=Array(b),e=Array(b),f=0;f<b;f++){var g=a[f],h=g.geometry;h&&(this.expandComputedExtent(h),(h=this.layerView.getRenderingInfo?this.layerView.getRenderingInfo(g):{symbol:g.symbol})&&h.symbol?(d[f]=h.symbol,e[f]=h,(h=this.getOrCreateGraphics3DSymbol(d[f],h.renderer))?(c[f]=h,this.beginGraphicUpdate(g)):this.graphicsWithoutSymbol[g.uid]=g):this.graphicsWithoutSymbol[g.uid]=g)}for(f=0;f<b;f++)this.waitForSymbol(c[f],d[f],
a[f],e[f])}};d.prototype.waitForSymbol=function(a,b,c,d){var e=this;a&&a.then(function(){e.graphicsBySymbol[b.id]||(e.graphicsBySymbol[b.id]={});e.createGraphics3DGraphic(a,c,d);e.endGraphicUpdate(c);e.labeling&&e.layerView.view.labelManager.setDirty()},function(){e.endGraphicUpdate(c)})};d.prototype.remove=function(a){for(var b=!1,c=a.length,d=0;d<c;d++){var e=a[d].uid,f=this.graphics[e];if(f){f.isDraped()&&(delete this.graphicsDrapedIds[e],b=!0);var g=f.graphics3DSymbol.symbol.id;f.destroy();delete this.graphics[e];
delete this.graphicsBySymbol[g][e];delete this.graphicsWithoutSymbol[e];this.graphicsKeys=null}}this.updateHasDraped();b&&this.layerView._notifyDrapedDataChange();this.labeling&&this.layerView.view.labelManager.setDirty()};d.prototype.createGraphics3DSymbol=function(a,b){a=A.to3D(a,!0,!1);if(a.symbol){var c=void 0;b&&b.backgroundFillSymbol&&(b=A.to3D(b.backgroundFillSymbol,!1,!0),b.symbol&&(c=b.symbol.symbolLayers));return new D(a.symbol,this.symbolCreationContext,c)}return null};d.prototype.getOrCreateGraphics3DSymbol=
function(a,b){var c=this,d=this.symbols[a.id];void 0===d&&(d=a instanceof z?new H(a,function(a){return c.createGraphics3DSymbol(a,b)}):this.createGraphics3DSymbol(a,b),this.symbols[a.id]=d);return d};d.prototype.createGraphics3DGraphic=function(a,b,c){!this.graphics[b.uid]&&(c=a.createGraphics3DGraphic(b,c),this.graphics[b.uid]=c,this.graphicsKeys=null,this.graphicsBySymbol[a.symbol.id][b.uid]=c,c.initialize(this.stageLayer,this.stage),c.isDraped()&&(this.hasDraped=this.graphicsDrapedIds[b.uid]=!0,
this.layerView._notifyDrapedDataChange()),c.centroid=null,"point"!==b.geometry.type&&c instanceof B&&(c.centroid=K.computeCentroid(b.geometry,this.viewSR)),a=this.scaleVisibility&&this.scaleVisibility.scaleRangeActive(),this.spatialIndex&&this.spatialIndex.shouldAddToSpatialIndex(b,c,a)&&this.spatialIndex.addGraphicToSpatialIndex(b,c),this.labeling&&this.labeling.layerLabelsEnabled()&&this.labeling.createLabelsForGraphic(b,c),a&&this.scaleVisibility.updateGraphicScaleVisibility(b,c),c.setVisibilityFlag("VISIBILITY_GRAPHIC",
b.visible&&!this.layerView.suspended),a=this.whenGraphics3DGraphicRequests[b.uid])&&(delete this.whenGraphics3DGraphicRequests[b.uid],a.resolve(c))};d.prototype.rendererChange=function(a){var b=this.symbolCreationContext.renderer;this.validateRenderer(a);this.symbolCreationContext.renderer=a;var c=u.diff(b,a);c&&("complete"===c.type?this.recreateAllGraphics():"partial"===c.type&&(this.applyRendererDiff(c,a,b)?this.volatileGraphicsUpdated():this.recreateAllGraphics()))};d.prototype.diffHasSymbolChange=
function(a){for(var b in a.diff)switch(b){case "visualVariables":break;case "defaultSymbol":break;case "uniqueValueInfos":break;default:return!0}return!1};d.prototype.applySymbolSetDiff=function(a,b,c,d){var e=!1;a=a||[];b=b||[];for(var f=[],g=0;g<b.length;g++){var h=b[g],l=this.graphicsBySymbol[h.id],n;for(n in l){var q=l[n],k=q.graphic;if(h!==d.defaultSymbol||c.getSymbol(k)!==d.defaultSymbol)q.isDraped&&(delete this.graphicsDrapedIds[n],e=!0),a.length||c.defaultSymbol?f.push(k):this.graphicsWithoutSymbol[n]=
k,q.destroy(),delete l[n],delete this.graphics[n],this.graphicsKeys=null}h.destroy();delete this.graphicsBySymbol[h.id];delete this.symbols[h.id]}if(a.length||f.length){for(n in this.graphicsWithoutSymbol)f.push(this.graphicsWithoutSymbol[n]);this.graphicsWithoutSymbol={};this.add(f)}this.updateHasDraped();e&&this.layerView._notifyDrapedDataChange();this.labeling&&this.layerView.view.labelManager.setDirty()};d.prototype.applyUniqueValueRendererDiff=function(a,b,c){var d=a.diff.defaultSymbol,e=a.diff.uniqueValueInfos;
if(d||e){var f=e?e.added.map(function(a){return a.symbol}):[],g=e?e.removed.map(function(a){return a.symbol}):[];if(e)for(var h=0;h<e.changed.length;h++)f.push(e.changed[h].newValue.symbol),g.push(e.changed[h].oldValue.symbol);d?(c.defaultSymbol&&g.push(c.defaultSymbol),b.defaultSymbol&&f.push(b.defaultSymbol)):c.defaultSymbol&&f.length&&g.push(c.defaultSymbol);this.applySymbolSetDiff(f,g,b,c);delete a.diff.defaultSymbol;delete a.diff.uniqueValueInfos;return!0}return!1};d.prototype.applyRendererDiff=
function(a,b,c){var d=!1;if(this.diffHasSymbolChange(a))return!1;if(b instanceof f&&c instanceof f&&this.applyUniqueValueRendererDiff(a,b,c)&&0===Object.keys(a.diff).length)return!0;for(var e in this.graphicsBySymbol)if(c=this.symbols[e]){var g=this.graphicsBySymbol[e];if(!c.applyRendererDiff(a,b,g))return!1;if(!d)for(var h in g)if(g[h].isDraped()){this.layerView._notifyDrapedDataChange();d=!0;break}}return!0};d.prototype.opacityChange=function(){var a=!1,b;for(b in this.graphicsBySymbol){var c=this.symbols[b];
if(c){var d=this.graphicsBySymbol[b];c.layerPropertyChanged("opacity");if(!a)for(var e in d)if(d[e].isDraped()){this.layerView._notifyDrapedDataChange();a=!0;break}}}};d.prototype.setClippingExtent=function(a,b){var c=this.symbolCreationContext.clippingExtent,d=[];l.extentToBoundingRect(a,d,b)?this.symbolCreationContext.clippingExtent=[d[0],d[1],-Infinity,d[2],d[3],Infinity]:this.symbolCreationContext.clippingExtent=null;return!h.equals(this.symbolCreationContext.clippingExtent,c)};d.prototype.updateAllGraphicsVisibility=
function(){var a=this;if(this.layerView.loadedGraphics){var b=!1;this.layerView.loadedGraphics.forEach(function(c){var d=a.getGraphics3DGraphicById(c.uid);if(d){var e=d.setVisibilityFlag("VISIBILITY_GRAPHIC",c.visible);a.scaleVisibility&&(c=a.scaleVisibility.updateGraphicScaleVisibility(c,d),e=e||c);e&&d.isDraped()&&(b=!0)}});b&&this.layerView._notifyDrapedDataChange();this.layerView.view.labelManager.setDirty()}};d.prototype.hideAllGraphics=function(){var a=this;if(this.layerView.loadedGraphics){var b=
!1;this.layerView.loadedGraphics.forEach(function(c){(c=a.getGraphics3DGraphicById(c.uid))&&c.setVisibilityFlag("VISIBILITY_GRAPHIC",!1)&&c.isDraped()&&(b=!0)});b&&this.layerView._notifyDrapedDataChange();this.layerView.view.labelManager.setDirty()}};d.prototype.validateRenderer=function(a){(a=n.validateTo3D(a))&&I.warn("Renderer for layer '"+(this.layer.title?this.layer.title+", ":"")+", id:"+this.layer.id+"' is not supported in a SceneView",a.message)};d.prototype.volatileGraphicsUpdated=function(){this.labeling&&
(this.lastFastUpdate=performance.now());this.stageLayer.invalidateSpatialQueryAccelerator();this.layerView._evaluateUpdatingState()};d.createLocalOriginFactory=function(){return new y(5E6,16)};return d}();d.tmpVec=C.vec3d.create();return d})},"esri/renderers/support/rendererConversion":function(){define(["require","exports","../../core/Error","../../symbols/support/symbolConversion"],function(m,k,b,a){function c(a,c){if(!c)return null;c=Array.isArray(c)?c:[c];if(0<c.length){var d=c.map(function(a){return a.details.symbol.type||
a.details.symbol.declaredClass}).filter(function(a){return!!a});d.sort();var e=[];d.forEach(function(a,b){0!==b&&a===d[b-1]||e.push(a)});return new b("renderer-conversion-3d:unsupported-symbols","Renderer contains symbols ("+e.join(", ")+") which are not supported in 3D",{renderer:a,symbolErrors:c})}return null}function h(b){var d=b.uniqueValueInfos.map(function(b){return a.to3D(b.symbol).error}).filter(function(a){return!!a}),g=a.to3D(b.defaultSymbol);g.error&&d.unshift(g.error);return c(b,d)}function g(b){var d=
b.classBreakInfos.map(function(b){return a.to3D(b.symbol).error}).filter(function(a){return!!a}),g=a.to3D(b.defaultSymbol);g.error&&d.unshift(g.error);return c(b,d)}k.validateTo3D=function(d){return d?"simple"===d.type?c(d,a.to3D(d.symbol).error):"uniqueValue"===d.type?h(d):"classBreaks"===d.type?g(d):new b("renderer-conversion-3d:unsupported-renderer","Unsupported renderer of type '"+(d.type||d.declaredClass)+"'",{renderer:d}):null}})},"esri/views/3d/webgl-engine/lib/Layer":function(){define("require exports dojo/has ./IdGen ./Octree ./PerformanceTimer ./Util ./gl-matrix ./ModelContentType".split(" "),
function(m,k,b,a,c,h,g,d,e){var l=d.vec3d;m=function(){function a(b,c,d){this._parentStages=[];this._children=[];this.id=a._idGen.gen(d);this.name=b;c=c||{};this.group=c.group||"";this.state=c.state||"VISIBLE";this.interaction=c.interaction||"PICKABLE";this.translation=l.create(c.translation);this._extent=[l.createFrom(0,0,0),l.createFrom(1E3,1E3,1E3)];this._extentDirty=!0}a.prototype.getId=function(){return this.id};a.prototype.getParentStages=function(){return this._parentStages};a.prototype.addParentStage=
function(a){-1===this._parentStages.indexOf(a)&&this._parentStages.push(a)};a.prototype.removeParentStage=function(a){a=this._parentStages.indexOf(a);-1<a&&this._parentStages.splice(a,1)};a.prototype.getName=function(){return this.name};a.prototype.getGroup=function(){return this.group};a.prototype.getState=function(){return this.state};a.prototype.getInteraction=function(){return this.interaction};a.prototype.getTranslation=function(){return this.translation};a.prototype.getObjectIds=function(){return this._children.map(function(a){return a.getId()})};
a.prototype.getObjects=function(){return this._children};a.prototype.setState=function(a){this.state=a};a.prototype.getExtent=function(){this._updateExtent();return this._extent};a.prototype.addObject=function(a){this._children.push(a);a.addParentLayer(this);this.notifyDirty("layObjectAdded",a);this._invalidateExtent();this._spatialAccelerator&&this._spatialAccelerator.add(a)};a.prototype.hasObject=function(a){return-1<this._children.indexOf(a)};a.prototype.removeObject=function(a){return null!=g.arrayRemove(this._children,
a)?(a.removeParentLayer(this),this.notifyDirty("layObjectRemoved",a),this._invalidateExtent(),this._spatialAccelerator&&this._spatialAccelerator.remove(a),!0):!1};a.prototype.replaceObject=function(a,b){var c=this._children.indexOf(a);g.assert(-1<c,"Layer.replaceObject: layer doesn't contain specified object");this._children[c]=b;a.removeParentLayer(this);b.addParentLayer(this);this.notifyDirty("layObjectReplaced",[a,b]);this._invalidateExtent();this._spatialAccelerator&&(this._spatialAccelerator.remove(a),
this._spatialAccelerator.add(b))};a.prototype.notifyObjectBBChanged=function(a,b){this._spatialAccelerator&&this._spatialAccelerator.update(a,b)};a.prototype.getCenter=function(){this._updateExtent();var a=l.create();return l.lerp(this._extent[0],this._extent[1],.5,a)};a.prototype.getBSRadius=function(){this._updateExtent();return.5*l.dist(this._extent[0],this._extent[1])};a.prototype.getSpatialQueryAccelerator=function(){if(this._spatialAccelerator)return this._spatialAccelerator;if(50<this._children.length)return this._createOctree(),
this._spatialAccelerator};a.prototype.invalidateSpatialQueryAccelerator=function(){this._spatialAccelerator=null};a.prototype.notifyDirty=function(a,b,c,d){c=c||e.LAYER;d=d||this;for(var f=0;f<this._parentStages.length;f++)this._parentStages[f].notifyDirty(c,d,a,b)};a.prototype._createOctree=function(){for(var a=this.getExtent(),b=0,d=0;3>d;d++)b=Math.max(b,a[1][d]-a[0][d]);d=l.create();l.lerp(a[0],a[1],.5,d);this._spatialAccelerator=new c(d,1.2*b);this._spatialAccelerator.add(this._children)};a.prototype._invalidateExtent=
function(){this._extentDirty=!0};a.prototype._updateExtent=function(){if(this._extentDirty)if(0===this._children.length)this._extent=[[0,0,0],[0,0,0]];else{var a=this._children[0];this._extent=[l.create(a.getBBMin()),l.create(a.getBBMax())];for(a=0;a<this._children.length;++a)for(var b=this._children[a],c=b.getBBMin(),b=b.getBBMax(),d=0;3>d;++d)this._extent[0][d]=Math.min(this._extent[0][d],c[d]),this._extent[1][d]=Math.max(this._extent[1][d],b[d]);this._extentDirty=!1}};return a}();m._idGen=new a;
return m})},"esri/views/3d/webgl-engine/lib/Octree":function(){define("require exports ./gl-matrix ./Util dojo/has ./PerformanceTimer".split(" "),function(m,k,b,a,c,h){function g(a,b,c){c=c||a;c[0]=a[0]+b;c[1]=a[1]+b;c[2]=a[2]+b;return c}var d=b.vec3d;m=function(){function b(a,b,c){this._maximumObjectsPerNode=10;this._maximumDepth=20;this._autoResize=!0;this._outsiders=[];c&&(void 0!==c.maximumObjectsPerNode&&(this._maximumObjectsPerNode=c.maximumObjectsPerNode),void 0!==c.maximumDepth&&(this._maximumDepth=
c.maximumDepth),void 0!==c.autoResize&&(this._autoResize=c.autoResize));isNaN(a[0])||isNaN(a[1])||isNaN(a[2])||isNaN(b)?this._root=new e(null,d.createFrom(0,0,0),.5):this._root=new e(null,a,b/2)}Object.defineProperty(b.prototype,"center",{get:function(){return this._root.center},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"size",{get:function(){return 2*this._root.halfSize},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"root",{get:function(){return this._root.node},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"outsiders",{get:function(){return this._outsiders.slice()},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"maximumObjectsPerNode",{get:function(){return this._maximumObjectsPerNode},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"maximumDepth",{get:function(){return this._maximumDepth},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"autoResize",{get:function(){return this._autoResize},
enumerable:!0,configurable:!0});b.prototype.add=function(a){a=this._objectOrObjectsArray(a);this._grow(a);for(var b=e.acquire(),c=0;c<a.length;c++){var d=a[c];b.init(this._root);0===d.getBSRadius()||isNaN(d.getBSRadius())||!this._autoResize&&!this._fitsInsideTree(this._boundingSphereFromObject(d,w))?this._outsiders.push(d):this._add(d,b)}e.release(b)};b.prototype.remove=function(b,c){b=this._objectOrObjectsArray(b);for(var d=e.acquire(),f=!0,g=0;g<b.length;g++){var f=b[g],h=this._boundingSphereFromObject(c||
f,w);0===h.radius||isNaN(h.radius)||!this._autoResize&&!this._fitsInsideTree(h)?f=null!=a.arrayRemove(this._outsiders,f):(d.init(this._root),f=this._remove(f,h,d))}e.release(d);this._shrink();return f};b.prototype.update=function(a,b){this.remove(a,b);this.add(a)};b.prototype.forEachAlongRay=function(b,c,d){this._forEachTest(function(d){g(d.center,2*-d.halfSize,u);g(d.center,2*d.halfSize,t);return a.rayBoxTest(b,c,u,t)},d)};b.prototype.forEachInBoundingBox=function(a,b,c){this._forEachTest(function(c){for(var d=
2*c.halfSize,e=0;3>e;e++)if(c.center[e]+d<a[e]||c.center[e]-d>b[e])return!1;return!0},c)};b.prototype.forEachNode=function(a){this._forEachNode(this._root,function(b){return a(b.node,b.center,2*b.halfSize)})};b.prototype._forEachTest=function(a,b){this._outsiders.forEach(b);this._forEachNode(this._root,function(c){return a(c)?(c=c.node,c.terminals.forEach(b),null!==c.residents&&c.residents.forEach(b),!0):!1})};b.prototype._forEachNode=function(a,b){a=e.acquire().init(a);for(var c=[a];0!==c.length;){a=
c.pop();if(b(a)&&!a.isLeaf())for(var d=0;d<a.node.children.length;d++)a.node.children[d]&&c.push(e.acquire().init(a).advance(d));e.release(a)}};b.prototype._objectOrObjectsArray=function(a){Array.isArray(a)||(f[0]=a,a=f);return a};b.prototype._remove=function(b,c,d){r.length=0;d.advanceTo(c,function(a,b){r.push(a.node,b)})?(b=null!=a.arrayRemove(d.node.terminals,b),d=0===d.node.terminals.length):(b=null!=a.arrayRemove(d.node.residents,b),d=0===d.node.residents.length);if(d)for(d=r.length-2;0<=d&&
this._purge(r[d],r[d+1]);d-=2);return b};b.prototype._nodeIsEmpty=function(a){if(0!==a.terminals.length)return!1;if(null!==a.residents)return 0===a.residents.length;for(var b=0;b<a.children.length;b++)if(a.children[b])return!1;return!0};b.prototype._purge=function(a,b){0<=b&&(a.children[b]=null);return this._nodeIsEmpty(a)?(null===a.residents&&(a.residents=[]),!0):!1};b.prototype._add=function(a,b){b.advanceTo(this._boundingSphereFromObject(a,w))?b.node.terminals.push(a):(b.node.residents.push(a),
b.node.residents.length>this._maximumObjectsPerNode&&b.depth<this._maximumDepth&&this._split(b))};b.prototype._split=function(a){var b=a.node.residents;a.node.residents=null;for(var c=0;c<b.length;c++){var d=e.acquire().init(a);this._add(b[c],d);e.release(d)}};b.prototype._grow=function(a){if(0!==a.length&&this._autoResize&&(a=this._boundingSphereFromObjects(a,this._boundingSphereFromObject,q),!isNaN(a.radius)&&0!==a.radius&&!this._fitsInsideTree(a)))if(this._nodeIsEmpty(this._root.node))d.set(a.center,
this._root.center),this._root.halfSize=1.25*a.radius;else{var b=e.acquire();this._rootBoundsForRootAsSubNode(a,b);this._placingRootViolatesMaxDepth(b)?this._rebuildTree(a,b):this._growRootAsSubNode(b);e.release(b)}};b.prototype._rebuildTree=function(a,b){var c=this;d.set(b.center,x.center);x.radius=b.halfSize;a=this._boundingSphereFromObjects([a,x],function(a){return a},y);b=e.acquire().init(this._root);this._root.initFrom(null,a.center,1.25*a.radius);this._forEachNode(b,function(a){c.add(a.node.terminals);
null!==a.node.residents&&c.add(a.node.residents);return!0});e.release(b)};b.prototype._placingRootViolatesMaxDepth=function(a){var b=0;this._forEachNode(this._root,function(a){b=Math.max(b,a.depth);return!0});return b+Math.log(a.halfSize/this._root.halfSize)*Math.LOG2E>this._maximumDepth};b.prototype._rootBoundsForRootAsSubNode=function(a,b){var c=a.radius,d=a.center;a=-Infinity;for(var e=this._root.center,f=this._root.halfSize,g=0;3>g;g++){var h=Math.max(0,Math.ceil((e[g]-f-(d[g]-c))/(2*f))),l=Math.max(0,
Math.ceil((d[g]+c-(e[g]+f))/(2*f)))+1;a=Math.max(a,Math.pow(2,Math.ceil(Math.log(h+l)*Math.LOG2E)));z[g].min=h;z[g].max=l}for(g=0;3>g;g++)h=z[g].min,l=z[g].max,c=(a-(h+l))/2,h+=Math.ceil(c),l+=Math.floor(c),n[g]=e[g]-f-h*f*2+(l+h)*f;return b.initFrom(null,n,a*f,0)};b.prototype._growRootAsSubNode=function(a){var b=this._root.node;d.set(this._root.center,q.center);q.radius=this._root.halfSize;this._root.init(a);a.advanceTo(q,null,!0);a.node.children=b.children;a.node.residents=b.residents;a.node.terminals=
b.terminals};b.prototype._shrink=function(){if(this._autoResize)for(;;){var a=this._findShrinkIndex();if(-1===a)break;this._root.advance(a);this._root.depth=0}};b.prototype._findShrinkIndex=function(){if(0!==this._root.node.terminals.length||this._root.isLeaf())return-1;for(var a=null,b=this._root.node.children,c=0,d=0;d<b.length&&null==a;)c=d++,a=b[c];for(;d<b.length;)if(b[d++])return-1;return c};b.prototype._fitsInsideTree=function(a){var b=this._root.center,c=this._root.halfSize,d=a.center;return a.radius<=
c&&d[0]>=b[0]-c&&d[0]<=b[0]+c&&d[1]>=b[1]-c&&d[1]<=b[1]+c&&d[2]>=b[2]-c&&d[2]<=b[2]+c};b.prototype._boundingSphereFromObject=function(a,b){d.set(a.getCenter(),b.center);b.radius=a.getBSRadius();return b};b.prototype._boundingSphereFromObjects=function(a,b,c){if(1===a.length){var e=b(a[0],q);d.set(e.center,c.center);c.radius=e.radius}else{u[0]=Infinity;u[1]=Infinity;u[2]=Infinity;t[0]=-Infinity;t[1]=-Infinity;t[2]=-Infinity;for(var f=0;f<a.length;f++){var e=b(a[f],q),g=u,h=e.center,l=e.radius;g[0]=
Math.min(g[0],h[0]-l);g[1]=Math.min(g[1],h[1]-l);g[2]=Math.min(g[2],h[2]-l);g=t;h=e.center;e=e.radius;g[0]=Math.max(g[0],h[0]+e);g[1]=Math.max(g[1],h[1]+e);g[2]=Math.max(g[2],h[2]+e)}d.scale(d.add(u,t,c.center),.5);c.radius=Math.max(t[0]-u[0],t[1]-u[1],t[2]-u[2])/2}return c};return b}();var e=function(){function a(a,b,c,e){void 0===c&&(c=0);void 0===e&&(e=0);this.center=d.create();this.initFrom(a,b,c,0)}a.prototype.init=function(a){return this.initFrom(a.node,a.center,a.halfSize,a.depth)};a.prototype.initFrom=
function(b,c,e,f){void 0===b&&(b=null);void 0===e&&(e=this.halfSize);void 0===f&&(f=this.depth);this.node=b||a.createEmptyNode();c&&d.set(c,this.center);this.halfSize=e;this.depth=f;return this};a.prototype.advance=function(b){var c=this.node.children[b];c||(c=a.createEmptyNode(),this.node.children[b]=c);this.node=c;this.halfSize/=2;this.depth++;b=l[b];this.center[0]+=b[0]*this.halfSize;this.center[1]+=b[1]*this.halfSize;this.center[2]+=b[2]*this.halfSize;return this};a.prototype.advanceTo=function(a,
b,c){for(void 0===c&&(c=!1);;){if(this.isTerminalFor(a))return b&&b(this,-1),!0;if(this.isLeaf()&&!c)return b&&b(this,-1),!1;this.isLeaf()&&(this.node.residents=null);var d=this._childIndex(a);b&&b(this,d);this.advance(d)}};a.prototype.isLeaf=function(){return null!=this.node.residents};a.prototype.isTerminalFor=function(a){return a.radius>this.halfSize/2};a.prototype._childIndex=function(a){a=a.center;for(var b=this.center,c=0,d=0;3>d;d++)b[d]<a[d]&&(c|=1<<d);return c};a.createEmptyNode=function(){return{children:[null,
null,null,null,null,null,null,null],terminals:[],residents:[]}};a.acquire=function(){if(0===this._pool.length)return new a;var b=this._pool[this._pool.length-1];this._pool.length--;return b};a.release=function(a){this._pool.push(a)};return a}();e._pool=[];var l=[[-1,-1,-1],[1,-1,-1],[-1,1,-1],[1,1,-1],[-1,-1,1],[1,-1,1],[-1,1,1],[1,1,1]],f=[null],n=d.create(),u=d.create(),t=d.create(),r=[],w={center:d.create(),radius:0},q={center:d.create(),radius:0},x={center:d.create(),radius:0},y={center:d.create(),
radius:0},z=[{min:0,max:0},{min:0,max:0},{min:0,max:0}];return m})},"esri/views/3d/webgl-engine/lib/FloatingBoxLocalOriginFactory":function(){define(["require","exports","./gl-matrix"],function(m,k,b){var a=b.vec3d;m=function(){function b(a,b){this._origins=[];this._boxSize=a;this._maxNumOrigins=b}b.prototype.getOrigin=function(g){for(var d=this._origins.length,e,h=!1,f=Number.MAX_VALUE,n=0;n<d;n++){var k=this._origins[n];a.subtract(g,k.vec3,c);c[0]=Math.abs(c[0]);c[1]=Math.abs(c[1]);c[2]=Math.abs(c[2]);
var m=c[0]+c[1]+c[2];m<f&&(e=k,f=m,h=c[0]<this._boxSize&&c[1]<this._boxSize&&c[2]<this._boxSize)}h||e&&null!=this._maxNumOrigins&&!(this._origins.length<this._maxNumOrigins)||(d=b.OFFSET,e={vec3:[g[0]+d,g[1]+d,g[2]+d],id:b.ORIGIN_PREFIX+this._origins.length},this._origins.push(e));return e};return b}();m.OFFSET=1.11;m.ORIGIN_PREFIX="fb_";var c=a.create();return m})},"esri/views/3d/layers/graphics/Graphics3DGraphic":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/asyncUtils ../../../../core/ObjectPool ../../support/aaBoundingBox ../../support/aaBoundingRect".split(" "),
function(m,k,b,a,c,h,g,d){var e=new h(Array,function(a){return g.set(a,g.ZERO)},null,10,5),l=d.create();return function(){function f(a,b,c){this.graphics3DSymbol=b;this.graphic=a;this._graphics=c;this._labelGraphics=[];this.addedToSpatialIndex=!1}f.prototype.initialize=function(a,b){this._graphics.forEach(function(c){c&&c.initialize(a,b)})};f.prototype.clearLabelGraphics=function(){this._labelGraphics.forEach(function(a){return a.destroy()});this._labelGraphics.length=0};f.prototype.addLabelGraphic=
function(a,b,c){this._labelGraphics.push(a);a.initialize(b,c)};f.prototype.isDraped=function(){for(var a=0;a<this._graphics.length;a++){var b=this._graphics[a];if(b&&b.isDraped())return!0}return!1};f.prototype.areVisibilityFlagsSet=function(a,b){for(var c=!0,d=0;d<this._graphics.length;d++){var e=this._graphics[d];e&&(c=c&&e.areVisibilityFlagsSet(a,b))}for(d=0;d<this._labelGraphics.length;d++)(e=this._labelGraphics[d])&&(c=c&&e.areVisibilityFlagsSet(a,b));return c};f.prototype.setVisibilityFlag=function(a,
b){var c=!1,d=function(d){d&&(c=d.setVisibilityFlag(a,b)||c)};this._graphics.forEach(d);this._labelGraphics.forEach(d);return c};f.prototype.destroy=function(){var a=function(a){a&&a.destroy()};this._graphics.forEach(a);this._graphics.length=0;this._labelGraphics.forEach(a);this._labelGraphics.length=0};f.prototype.getBSRadius=function(){return this._graphics.reduce(function(a,b){return Math.max(a,b.getBSRadius())},0)};f.prototype.getCenterObjectSpace=function(){return this._graphics[0].getCenterObjectSpace()};
f.prototype.getProjectedBoundingBox=function(f,h,k,m){return a(this,void 0,void 0,function(){var n=this;return b(this,function(q){switch(q.label){case 0:return m||(m={boundingBox:null,requiresDrapedElevation:!1}),m.boundingBox?g.set(m.boundingBox,g.NEGATIVE_INFINITY):m.boundingBox=g.create(g.NEGATIVE_INFINITY),m.requiresDrapedElevation=!1,[4,c.forEach(this._graphics,function(c){return a(n,void 0,void 0,function(){var a,d,l;return b(this,function(b){switch(b.label){case 0:if(!c)return[2];a=c.isDraped()?
h:f;d=e.acquire();return[4,c.getProjectedBoundingBox(a,k,d)];case 1:return l=b.sent(),isFinite(l[2])&&isFinite(l[5])||(m.requiresDrapedElevation=!0),l&&g.expand(m.boundingBox,d),e.release(d),[2]}})})})];case 1:return q.sent(),g.allFinite(m.boundingBox)||d.allFinite(g.toRect(m.boundingBox,l))?[2,m]:[2,null]}})})};f.prototype.mustAlignToTerrain=function(){for(var a=this._graphics.length,b=0;b<a;b++){var c=this._graphics[b];if(c&&c.mustAlignToTerrain())return!0}a=this._labelGraphics.length;for(b=0;b<
a;b++)if((c=this._labelGraphics[b])&&c.mustAlignToTerrain())return!0;return!1};f.prototype.alignWithElevation=function(a,b){for(var c=this._graphics.length,d=0;d<c;d++){var e=this._graphics[d];e&&e.alignWithElevation(a,b)}c=this._labelGraphics.length;for(d=0;d<c;d++)(e=this._labelGraphics[d])&&this._labelGraphics[d].alignWithElevation(a,b)};f.prototype.setDrawOrder=function(a,b,c){c[this.graphics3DSymbol.symbol.id]=!0;for(var d=this._graphics.length,e=0;e<d;e++){var f=this._graphics[e];f&&f.setDrawOrder(a+
(1-(1+e)/d),b,c)}};return f}()})},"esri/core/asyncUtils":function(){define(["require","exports","./tsSupport/generatorHelper","./tsSupport/awaiterHelper","./promiseUtils"],function(m,k,b,a,c){k.forEach=function(h,g,d){return a(this,void 0,void 0,function(){return b(this,function(a){switch(a.label){case 0:return[4,c.eachAlways(h.map(function(a,b){return g.apply(d,[a,b])}))];case 1:return a.sent(),[2]}})})};k.map=function(h,g,d){return a(this,void 0,void 0,function(){var a;return b(this,function(b){switch(b.label){case 0:return[4,
c.eachAlways(h.map(function(a,b){return g.apply(d,[a,b])}))];case 1:return a=b.sent(),[2,a.map(function(a){return a.value})]}})})}})},"esri/views/3d/layers/graphics/Graphics3DSymbol":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../support/PromiseLightweight ./Graphics3DGraphic ./Graphics3DSymbolLayerFactory".split(" "),function(m,k,b,a,c,h){return function(a){function d(b,c,d){var e=a.call(this)||this;e.symbol=b;b=b.symbolLayers;d&&(b=d.concat(b));d=b.length;e.childGraphics3DSymbols=
Array(b.length);e.childGraphics3DSymbolPromises=Array(b.length);for(var f=c.layerOrder,g=0,l=0,k=!1,q=function(a,b){b&&(this.childGraphics3DSymbols[a]=b,l++);g--;!this.isRejected()&&k&&1>g&&(0<l?this.resolve():this.reject())},x=0;x<d;x++){var m=b.getItemAt(x);!1!==m.enabled&&(c.layerOrder=f+(1-(1+x)/d),c.layerOrderDelta=1/d,m=h.make(m,c,m._ignoreDrivers))&&(g++,e.childGraphics3DSymbolPromises[x]=m,m.then(q.bind(e,x,m),q.bind(e,x,null)))}c.layerOrder=f;k=!0;!e.isRejected()&&1>g&&(0<l?e.resolve():e.reject());
return e}b(d,a);d.prototype.createGraphics3DGraphic=function(a,b,d){for(var e=Array(this.childGraphics3DSymbols.length),f=0;f<this.childGraphics3DSymbols.length;f++){var g=this.childGraphics3DSymbols[f];g&&(e[f]=g.createGraphics3DGraphic(a,b))}return new c(a,d||this,e)};d.prototype.layerPropertyChanged=function(a,b){for(var c=this.childGraphics3DSymbols.length,d=0;d<c;d++){var e=this.childGraphics3DSymbols[d];if(e&&!e.layerPropertyChanged(a,b,d))return!1}return!0};d.prototype.applyRendererDiff=function(a,
b,c){return this.isResolved()?this.childGraphics3DSymbols.reduce(function(d,e,f){return d&&(!e||e.applyRendererDiff(a,b,c,f))},!0):!1};d.prototype.getFastUpdateStatus=function(){var a=0,b=0,c=0;this.childGraphics3DSymbolPromises.forEach(function(d){d&&!d.isFulfilled()?a++:d&&d.isFastUpdatesEnabled()?c++:d&&b++});return{loading:a,slow:b,fast:c}};d.prototype.setDrawOrder=function(a,b){for(var c=this.childGraphics3DSymbols.length,d=1/c,e=0;e<c;e++){var g=this.childGraphics3DSymbols[e];g&&g.setDrawOrder(a+
(1-(1+e)/c),d,b)}};d.prototype.destroy=function(){this.isFulfilled()||this.reject();for(var a=0;a<this.childGraphics3DSymbolPromises.length;a++)this.childGraphics3DSymbolPromises[a]&&this.childGraphics3DSymbolPromises[a].destroy()};return d}(a.Promise)})},"esri/views/3d/layers/graphics/Graphics3DSymbolLayerFactory":function(){define("./Graphics3DIconSymbolLayer ./Graphics3DObjectSymbolLayer ./Graphics3DLineSymbolLayer ./Graphics3DPathSymbolLayer ./Graphics3DFillSymbolLayer ./Graphics3DExtrudeSymbolLayer ./Graphics3DTextSymbolLayer ../../webgl-engine/lib/Util".split(" "),
function(m,k,b,a,c,h,g,d){var e=d.assert,l={Icon:m,Object:k,Line:b,Path:a,Fill:c,Extrude:h,Text:g};return{make:function(a,b,c){var d=l[a.type];e(d,"unknown symbol type "+a.type);return new d(a,b,c)}}})},"esri/views/3d/layers/graphics/Graphics3DLineSymbolLayer":function(){define("../../../../core/declare ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./Graphics3DDrapedGraphicLayer ./ElevationAligners ./Graphics3DSymbolCommonCode ./lineUtils ../../../../core/screenUtils ../../../../geometry/Polygon ../../lib/glMatrix ../../webgl-engine/Stage ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/RenderGeometry".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f,n,u,t){var r=l.vec3d,w=l.mat4d;return m([k],{_prepareResources:function(){var a=this.symbol,b=this._isPropertyDriven("size")||this._isPropertyDriven("color")||this._isPropertyDriven("opacity"),c={idHint:this._getStageIdHint(),width:this._getWidth(a),color:this._getMaterialOpacityAndColor()};if(b||1.5<=c.width)this._isPropertyDriven("size")&&(c.width=0),c.miterLimit=a.miterLimit,c.join=a.join,this._isNativeLineMaterial=!1,this._material=g.createRibbonMaterial(c);else if(0<
c.width)this._isNativeLineMaterial=!0,this._material=g.createNativeMaterial(c);else{this.reject();return}this._context.stage.add(f.ModelContentType.MATERIAL,this._material);this.resolve()},_getWidth:function(a){return null!=a.size?d.pt2px(a.size):1},destroy:function(){this.isFulfilled()||this.reject();this._material&&(this._context.stage.remove(f.ModelContentType.MATERIAL,this._material.getId()),this._material=null)},createGraphics3DGraphic:function(a,b){var c=a.geometry;if("polyline"!==c.type&&"polygon"!==
c.type&&"extent"!==c.type)return this._logWarning("unsupported geometry type for line symbol: "+c.type),null;var c="polygon"===c.type||"extent"===c.type?"rings":"paths",e="graphic"+a.uid,f=this._getVertexOpacityAndColor(b,Float32Array,255),g=0;b.size&&this._isPropertyDriven("size")&&(g=h.getSingleSizeDriver(b.size),g=d.pt2px(g));b=this._getGraphicElevationInfo(a);return b.mode===h.ELEV_MODES.ON_THE_GROUND?this._createAsOverlay(a,c,f,g,b,e):this._createAs3DShape(a,c,f,g,b,e,a.uid)},layerPropertyChanged:function(a,
b,d){if("opacity"===a)return this._isNativeLineMaterial?(b=this._material.getColor(),b[3]=this._getMaterialOpacity(),this._material.setColor(b)):(b=this._material.getParameterValues(),b.color[3]=this._getMaterialOpacity(),this._material.setParameterValues({color:b.color})),!0;if("elevationInfo"===a){a=this._elevationInfo.mode;this._updateElevationInfo();var e=this._elevationInfo.mode;if(null==a||null==e)return!1;var f=h.ELEV_MODES;if(a===f.ON_THE_GROUND&&e===f.ON_THE_GROUND)return!0;if(a!==e&&(a===
f.ON_THE_GROUND||e===f.ON_THE_GROUND))return!1;a=e===f.RELATIVE_TO_GROUND?c.perVertexElevationAligner:null;var e=this._context.elevationProvider,f=this._context.renderCoordsHelper,g;for(g in b){var l=b[g],n=l._graphics[d];n&&(l=l.graphic,n.elevationAligner=a,n.elevationInfo.set(this._getGraphicElevationInfo(l)),c.perVertexElevationAligner(n,e,f))}return!0}return!1},_getOutlineGeometry:function(a,b){return a._outlineSegments?g.createOutlineGeometryFromSegments(b,a._outlineSegments):b},_getGeometry:function(a){a=
a.geometry;"extent"===a.type&&(a=e.fromExtent(a));return a},_createAs3DShape:function(a,d,e,f,l,k,m){var q=this._getGeometry(a),x=q.hasZ,t=this._getOutlineGeometry(q,q[d]);if(0<t.length){a=[];for(var y=[],A=[],z=r.create(),B=Array(6),q=h.getGeometryVertexData3D(t,x,q.spatialReference,this._context.renderSpatialReference,this._context.elevationProvider,l),x=q.geometryData.outlines,t=q.eleVertexData,C=q.vertexData,J=0;J<x.length;++J){var P=x[J],I=P.index,O=P.count;if(this._context.clippingExtent&&(h.computeBoundingBox(t,
I,O,B),h.boundingBoxClipped(B,this._context.clippingExtent)))continue;h.chooseOrigin(C,I,O,z);h.subtractCoordinates(C,I,O,z);P=new Float64Array(t.buffer,3*I*t.BYTES_PER_ELEMENT,3*O);I=new Float64Array(C.buffer,3*I*C.BYTES_PER_ELEMENT,3*O);I=g.createPolylineGeometry(I,P,"rings"===d,e,f);I=new u(I,k+"path"+J);I.singleUse=!0;a.push(I);y.push([this._material]);I=w.identity();w.translate(I,z,I);A.push(I)}if(0<a.length)return d=new n({geometries:a,materials:y,transformations:A,castShadow:!1,metadata:{layerId:this._context.layer.id,
graphicId:m},idHint:k}),e=null,l.mode===h.ELEV_MODES.RELATIVE_TO_GROUND&&(e=c.perVertexElevationAligner),l=new b(this,d,a,null,null,e,l),l.alignedTerrainElevation=q.terrainElevation,l}return null},_createAsOverlay:function(b,c,d,e,f,l){var n=this._getGeometry(b);this._material.setRenderPriority(this._symbolLayerOrder);var k=this._getOutlineGeometry(n,n[c]);if(0<k.length){b=[];for(var q=Array(6),m=r.create(),k=h.getGeometryVertexDataDraped(k,n.spatialReference,this._context.overlaySR),n=k.vertexData,
k=k.geometryData.outlines,x=0;x<k.length;++x){var y=k[x],u=y.index,y=y.count;h.computeBoundingBox(n,u,y,q);if(!h.boundingBoxClipped(q,this._context.clippingExtent)){h.chooseOrigin(n,u,y,m);h.subtractCoordinates(n,u,y,m);h.setZ(n,u,y,this._getDrapedZ());y=new Float64Array(n.buffer,3*u*n.BYTES_PER_ELEMENT,3*y);u=w.identity();w.translate(u,m,u);var y=g.createPolylineGeometry(y,null,"rings"===c,d,e),A=new t(y);A.material=this._material;A.center=[.5*(q[0]+q[3]),.5*(q[1]+q[4]),0];A.bsRadius=.5*Math.sqrt((q[3]-
q[0])*(q[3]-q[0])+(q[4]-q[1])*(q[4]-q[1]));A.transformation=u;A.name=l;A.uniqueName=l+"#"+y.id;b.push(A)}}return new a(this,b,null,null,q,f)}return null}})})},"esri/views/3d/layers/graphics/lineUtils":function(){define("require exports ../../webgl-engine/materials/RibbonLineMaterial ../../webgl-engine/materials/NativeLineMaterial ../../webgl-engine/lib/GeometryData ../../webgl-engine/lib/Util".split(" "),function(m,k,b,a,c,h){function g(a){var b=a.length;return a[0]===a[b-3]&&a[1]===a[b-2]&&a[2]===
a[b-1]}var d=h.VertexAttrConstants;k.createRibbonMaterial=function(a){var c={width:a.width,color:a.color,miterLimit:a.miterLimit,polygonOffset:!0};"miter"===a.join||"bevel"===a.join?c.join=a.join:(c.join="miter",a.join&&console.warn("unsupported join type for line symbol: "+a.join));return new b(c,a.idHint+"_ribbonlinemat")};k.createNativeMaterial=function(b){return new a(b.width,b.color,b.idHint+"_nativelinemat")};k.createOutlineGeometryFromSegments=function(a,b){for(var c=[],d=0;d<b.length;d++)for(var e=
a[d],g=0;g<b[d].length;g++){for(var h=b[d][g],l=[],q=h[0];q<h[1];q++)l.push(e[q]);0<l.length&&c.push(l)}return c};k.isClosed=g;k.createPolylineGeometry=function(a,b,f,h,k){var e,l,n;if(f=f&&!g(a)){f=new Float32Array(a.length+3);for(l=0;l<a.length;l++)f[l]=a[l];l=f.length;f[l-3]=a[0];f[l-2]=a[1];f[l-1]=a[2];e=a.length/3+1;l=new Uint32Array(2*(e-1));n=new Uint32Array(2*(e-1))}else e=a.length/3,l=new Uint32Array(2*(e-1)),n=new Uint32Array(2*(e-1)),f=a;a=new Float32Array(1);a[0]=k;for(var q=k=0,m=0;m<
e-1;m++)l[k++]=m,l[k++]=m+1,n[q++]=0,n[q++]=0;k={};e={};k[d.POSITION]=l;k[d.COLOR]=n;k[d.SIZE]=n;e[d.POSITION]={size:3,data:f};e[d.COLOR]={size:4,data:h};e[d.SIZE]={size:1,data:a};b&&(k.mapPos=l,e.mapPos={size:3,data:b});return new c(e,k,c.DefaultOffsets,"line")}})},"esri/views/3d/webgl-engine/materials/NativeLineMaterial":function(){define("./internal/MaterialUtil ../lib/Util ../lib/gl-matrix ../lib/RenderSlot ../lib/DefaultVertexBufferLayouts ../../../webgl/Util".split(" "),function(m,k,b,a,c,h){var g=
b.vec3d,d=b.vec2d,e=b.mat4d,l=k.VertexAttrConstants,f=g.create(),n=g.create(),u=g.create(),t=g.create(),r=d.create(),w=d.create(),q=g.create(),x=g.create(),y=function(a,b,d,D){"string"===typeof d&&(D=d,d=void 0);m.basicMaterialConstructor(this,D);this.lineType=d||y.LINES;var A=c.Pos3,B=h.getStride(A)/4;this.canBeMerged=this.lineType===y.LINES;this.setColor=function(a){b=a;this.notifyDirty("matChanged")};this.getColor=function(){return b};this.dispose=function(){};this.getOutputAmount=function(a){a=
a/2+1;if(this.lineType===y.STRIP)return a*B;if(this.lineType===y.LINES)return(2*a-2)*B};this.getVertexBufferLayout=function(){return A};this.fillInterleaved=function(a,b,c,d,e,f){a=a.vertexAttr[l.POSITION].data;if(b||this.lineType===y.LINES)for(d=a.length/3,c=0;c<d;c++){var g=3*c,h=a[g],n=a[g+1],k=a[g+2];if(b)var g=h,q=n,h=b[0]*g+b[4]*q+b[8]*k+b[12],n=b[1]*g+b[5]*q+b[9]*k+b[13],k=b[2]*g+b[6]*q+b[10]*k+b[14];e[f++]=h;e[f++]=n;e[f++]=k;this.lineType===y.LINES&&0!==c&&c!==d-1&&(e[f++]=h,e[f++]=n,e[f++]=
k)}else for(c=0;c<a.length;c++)e[f++]=a[c]};this.intersect=function(a,b,c,d,h,l,m){if(d.isSelection){b=a.getData().getVertexAttr("position").position.data;a=Number.MAX_VALUE;var y,A;h=d.camera;l=d.point;for(var z=0;z<b.length-5;z+=3){f[0]=b[z];f[1]=b[z+1];f[2]=b[z+2];e.multiplyVec3(c,f);n[0]=b[z+3];n[1]=b[z+4];n[2]=b[z+5];e.multiplyVec3(c,n);h.projectPoint(f,r);h.projectPoint(n,w);if(0>r[2]&&0<w[2])g.subtract(f,n,u),y=h.frustumPlanes,A=-(g.dot(y[4],f)+y[4][3]),y=A/g.dot(u,y[4]),g.scale(u,y,u),g.add(f,
u,f),h.projectPoint(f,r);else if(0<r[2]&&0>w[2])g.subtract(n,f,u),y=h.frustumPlanes,A=-(g.dot(y[4],n)+y[4][3]),y=A/g.dot(u,y[4]),g.scale(u,y,u),g.add(n,u,n),h.projectPoint(n,w);else if(0>r[2]&&0>w[2])continue;y=k.projectVectorVector2D(r,w,l);y<a&&(a=y,g.set(f,q),g.set(n,x))}c=d.p0;d=d.p1;2>a&&(a=k.linelineDistance3D(q,x,c,d),b=Number.MAX_VALUE,a[0]&&(g.subtract(a[2],c,t),a=g.length(t),g.scale(t,1/a),b=a/g.dist(c,d)),m(b,t))}};this.getGLMaterials=function(){return{color:z,depthShadowMap:void 0,normal:void 0,
depth:void 0,highlight:void 0}};this.getAllTextureIds=function(){return[]}};y.STRIP=1;y.LINES=2;var z=function(b,c){m.basicGLMaterialConstructor(this,b);var d=c.get("simple"),e=b.getColor();this.beginSlot=function(b){return b===a.OPAQUE_MATERIAL};this.getProgram=function(){return d};this.bind=function(a,b){a.bindProgram(d);d.setUniform4fv("color",e);a.setBlendingEnabled(1>e[3]);a.setBlendFunctionSeparate(a.gl.SRC_ALPHA,a.gl.ONE_MINUS_SRC_ALPHA,a.gl.ONE,a.gl.ONE_MINUS_SRC_ALPHA);a.setDepthTestEnabled(!0)};
this.release=function(a){1>e[3]&&a.setBlendingEnabled(!1)};this.bindView=function(a,b){m.bindView(b.origin,b.view,d)};this.bindInstance=function(a,b){d.setUniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){a=a.gl;return b.lineType===y.STRIP?a.LINE_STRIP:a.LINES}};return y})},"esri/views/3d/layers/graphics/Graphics3DPathSymbolLayer":function(){define("../../../../core/declare ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./Graphics3DSymbolCommonCode ./ElevationInfo ../../support/projectionUtils ../../../../views/3d/lib/glMatrix ../../webgl-engine/Stage ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/materials/Material ../../webgl-engine/lib/Util".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f,n,u){var t=g.vec3d,r=g.mat4d,w=u.assert,q=t.create(),x={},y={verticalDistanceToGround:0,terrainElevation:0};m=m([k],{_prepareResources:function(){var a="c3dsymbol"+this.symbol.id,b=this._getMaterialOpacityAndColor(),c=t.create(b),b=b[3],c={diffuse:c,ambient:c,opacity:b,transparent:1>b||this._isPropertyDriven("opacity"),vertexColors:this._isPropertyDriven("color")||this._isPropertyDriven("opacity")};this._material=new n(c,a+"_3dlinemat");this._context.stage.add(d.ModelContentType.MATERIAL,
this._material);this.resolve()},destroy:function(){this.isFulfilled()||this.reject();this._material&&(this._context.stage.remove(d.ModelContentType.MATERIAL,this._material.getId()),this._material=null)},createGraphics3DGraphic:function(a,b){var c=a.geometry;if("polyline"!==c.type)return this._logWarning("unsupported geometry type for path symbol: "+c.type),null;var c="polygon"===c.type?"rings":"paths",d="graphic"+a.uid,e=this._getGraphicElevationInfo(a);return this._createAs3DShape(a,c,b,e,d,a.uid)},
layerPropertyChanged:function(b,c,d){if("opacity"===b)return c=this._getMaterialOpacity(),d=1>c||this._isPropertyDriven("opacity"),this._material.setParameterValues({opacity:c,transparent:d}),!0;if("elevationInfo"===b){this._updateElevationInfo();b=this._context.elevationProvider;var e=this._context.renderCoordsHelper,f=a.ELEV_MODES.ABSOLUTE_HEIGHT,g;for(g in c){var h=c[g],l=h._graphics[d];l&&(h=this._getGraphicElevationInfo(h.graphic),l.elevationAligner=h.mode!==f?A:null,l.elevationInfo.set(h),A(l,
b,e))}return!0}return!1},_getPathSize:function(b,c){b=b.size&&this._isPropertyDriven("size")?a.getSingleSizeDriver(b.size):this.symbol.size||this.symbol.width||1;return b/=this._context.renderCoordsHelper.unitInMeters},_createAs3DShape:function(c,d,g,n,k,q){var m=c.geometry,x=m.hasZ,y=m[d];if(0<y.length){d=[];c=[];for(var w=[],u=t.create(),z=this._context.renderSpatialReference===h.SphericalRenderSpatialReference,B=Array(6),C=this._getPathSize(g,this.symbol),m=a.getGeometryVertexData3D(y,x,m.spatialReference,
this._context.renderSpatialReference,this._context.elevationProvider,n),x=m.geometryData.outlines,y=m.eleVertexData,K=m.vertexData,D=0;D<x.length;++D){var E=x[D],H=E.index,aa=E.count;if(this._context.clippingExtent&&(a.computeBoundingBox(y,H,aa,B),a.boundingBoxClipped(B,this._context.clippingExtent)))continue;a.chooseOrigin(K,H,aa,u);a.subtractCoordinates(K,H,aa,u);E=new Float64Array(y.buffer,3*H*y.BYTES_PER_ELEMENT,3*aa);H=a.flatArrayToArrayOfArrays(K,H,aa);H=f.createTubeGeometry(H,.5*C,10,z,u);
H.getVertexAttr().mapPos={size:3,data:E};this._material.getParams().vertexColors&&(E=this._getVertexOpacityAndColor(g),H=f.addVertexColors(H,E,!0));E=new l(H,k+"path"+D);E.singleUse=!0;d.push(E);c.push([this._material]);E=r.identity();r.translate(E,u,E);w.push(E)}if(0<d.length)return g=new e({geometries:d,materials:c,transformations:w,castShadow:!0,metadata:{layerId:this._context.layer.id,graphicId:q},idHint:k}),k=null,n.mode!==a.ELEV_MODES.ABSOLUTE_HEIGHT&&(k=A),n=new b(this,g,d,null,null,k,n),n.alignedTerrainElevation=
m.terrainElevation,n}return null}});var z=u.VertexAttrConstants,A=function(b,d,e){for(var f=b.stageObject,g=b.elevationInfo,h=f.getGeometryRecords(),l=h.length,n=g.mode!==c.MODES.ABSOLUTE_HEIGHT,k=0,m=0;m<l;m++){var t=h[m].geometry,u=[h[m].transformation[12],h[m].transformation[13],h[m].transformation[14]],r=t.getData().getVertexAttr(),A=r[z.POSITION].data,B=r.zOffset.data,r=r.mapPos.data,C=r.length/3;w(A.length/3===10*C+2,"unexpected tube geometry");var D=0,X=0;x.spatialReference=d.spatialReference;
for(var aa=0,R=0;R<C;R++){x.x=r[3*R];x.y=r[3*R+1];x.z=r[3*R+2];var ia=a.computeElevation(d,x,g,n?y:null);n&&(aa+=y.terrainElevation);var ga=10;0!==R&&R!==C-1||ga++;for(var ha=0;ha<ga;ha++)q[0]=A[D]+u[0],q[1]=A[D+1]+u[1],q[2]=A[D+2]+u[2],e.setAltitude(ia+B[X],q,0),A[D]=q[0]-u[0],A[D+1]=q[1]-u[1],A[D+2]=q[2]-u[2],D+=3,X+=1;t.invalidateBoundingInfo()}f.geometryVertexAttrsUpdated(m);k+=aa/C}b.alignedTerrainElevation=k/l};return m})},"esri/views/3d/layers/graphics/Graphics3DFillSymbolLayer":function(){define("../../../../core/declare ../../../../core/screenUtils ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./Graphics3DDrapedGraphicLayer ./ElevationAligners ./Graphics3DSymbolCommonCode ./lineUtils ./graphicUtils ../../../../geometry/Polygon ../../../../Color ../../lib/glMatrix ../../support/aaBoundingBox ../../webgl-engine/Stage ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryData ../../webgl-engine/lib/RenderGeometry ../../webgl-engine/materials/ColorMaterial ../../webgl-engine/lib/Util ./earcut/earcut".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f,n,u,t,r,w,q,x,y,z,A){var C=z.VertexAttrConstants;z=n.vec3d;var B=n.mat4d;m=m([b],{_prepareResources:function(){this._prepareFillResources();this._prepareOutlineResources();this.resolve()},_prepareFillResources:function(){var a=this._getStageIdHint(),b=this._getMaterialOpacityAndColor(),b={color:b,transparent:1>b[3]||this._isPropertyDriven("opacity"),polygonOffset:!1,vertexColors:!0};this._material=new y(b,a+"_colormat");this._context.stage.add(t.ModelContentType.MATERIAL,
this._material)},_prepareOutlineResources:function(){var a=this.symbol.outline;if(this._hasOutline=!!(a&&a.size&&a.color))a={idHint:this._getStageIdHint()+"_outline",color:this._getOutlineColor(),width:k.pt2px(this.symbol.outline.size)},2<a.width?(this._outlineMaterial=d.createRibbonMaterial(a),this._isOutlineNativeLineMaterial=!1):(this._outlineMaterial=d.createNativeMaterial(a),this._isOutlineNativeLineMaterial=!0),this._context.stage.add(t.ModelContentType.MATERIAL,this._outlineMaterial)},destroy:function(){this.isFulfilled()||
this.reject();this._material&&(this._context.stage.remove(t.ModelContentType.MATERIAL,this._material.getId()),this._material=null);this._outlineMaterial&&(this._context.stage.remove(t.ModelContentType.MATERIAL,this._outlineMaterial.getId()),this._outlineMaterial=null)},createGraphics3DGraphic:function(a,b){var c=a.geometry;if("polyline"!==c.type&&"polygon"!==c.type&&"extent"!==c.type)return this._logWarning("unsupported geometry type for fill symbol: "+c.type),null;c="graphic"+a.uid;b=this._getVertexOpacityAndColor(b,
Uint8Array,255);var d=this._getGraphicElevationInfo(a);return d.mode===g.ELEV_MODES.ON_THE_GROUND?this._createAsOverlay(a,b,d,c):this._createAs3DShape(a,b,d,c,a.uid)},layerPropertyChanged:function(a,b,c){if("opacity"===a)return b=this._material.getColor(),b[3]=this._getMaterialOpacity(),this._material.setColor(b),this._material.setTransparent(1>b[3]),this._outlineMaterial&&(this._isOutlineNativeLineMaterial?(b=this._outlineMaterial.getColor(),b[3]=this._getOutlineOpacity(),this._outlineMaterial.setColor(b)):
(b=this._outlineMaterial.getParameterValues(),b.color[3]=this._getOutlineOpacity(),this._outlineMaterial.setParameterValues({color:b.color}))),!0;if("elevationInfo"===a){a=this._elevationInfo.mode;this._updateElevationInfo();var d=this._elevationInfo.mode;if(null==a||null==d)return!1;var e=g.ELEV_MODES;if(a===e.ON_THE_GROUND&&d===e.ON_THE_GROUND)return!0;if(a!==d&&(a===e.ON_THE_GROUND||d===e.ON_THE_GROUND))return!1;a=d===e.RELATIVE_TO_GROUND?h.perVertexElevationAligner:null;var d=this._context.elevationProvider,
e=this._context.renderCoordsHelper,f;for(f in b){var l=b[f],n=l._graphics[c];n&&(l=l.graphic,n.elevationAligner=a,n.elevationInfo.set(this._getGraphicElevationInfo(l)),h.perVertexElevationAligner(n,d,e))}return!0}return!1},setDrawOrder:function(a,b,c){this._material&&(this._material.setRenderPriority(a+b/2),c[this._material.getId()]=!0);this._outlineMaterial&&(this._outlineMaterial.setRenderPriority(a),c[this._outlineMaterial.getId()]=!0)},_createAs3DShape:function(b,c,d,e,f){var l=this._getPolyGeometry(b),
n=l.hasZ;b=!1;var k;null!=l.rings?(b=!0,k=l.rings):k=l.paths;if(0===k.length)return this._logWarning("no paths found for line symbol"),null;k=this._getOutlineGeometry(l,k);l=g.getGeometryVertexData3D(k,n,l.spatialReference,this._context.renderSpatialReference,this._context.elevationProvider,d);E.idHint=e;E.color=c;E.isRings=b;E.data=l;var q;this._hasOutline&&(q=new l.vertexData.constructor(l.vertexData));E.outNum=0;E.outGeometries=[];E.outTransforms=[];E.outMaterials=[];this._createAs3DShapeFill(E);
E.data.vertexData=q;this._createAs3DShapeOutline(E);if(0===E.outNum)return null;c=new r({geometries:E.outGeometries,materials:E.outMaterials,transformations:E.outTransforms,castShadow:!1,metadata:{layerId:this._context.layer.id,graphicId:f},idHint:e});e=null;d.mode===g.ELEV_MODES.RELATIVE_TO_GROUND&&(e=h.perVertexElevationAligner);d=new a(this,c,E.outGeometries,null,null,e,d);d.alignedTerrainElevation=l.terrainElevation;return d},_createAs3DShapeFill:function(a){for(var b=a.data.geometryData.polygons,
c=a.data.eleVertexData,d=a.data.vertexData,e=0;e<b.length;++e){var f=b[e],h=f.count,l=f.index;if(this._context.clippingExtent&&(g.computeBoundingBox(c,l,h,D),g.boundingBoxClipped(D,this._context.clippingExtent)))continue;var n=new Float64Array(c.buffer,3*l*c.BYTES_PER_ELEMENT,3*h),k=new Float64Array(d.buffer,3*l*d.BYTES_PER_ELEMENT,3*h),f=f.holeIndices.map(function(a){return a-l}),f=A(n,f,3);0!==f.length&&(g.chooseOrigin(d,l,h,H),g.subtractCoordinates(d,l,h,H),h=this._createFillGeometry(f,0,k,n,a.color,
!1),h=new w(h,a.idHint),h.singleUse=!0,n=B.identity(),B.translate(n,H,n),a.outGeometries.push(h),a.outMaterials.push([this._material]),a.outTransforms.push(n),a.outNum++)}},_createAs3DShapeOutline:function(a){if(this._hasOutline)for(var b=a.data.geometryData.outlines,c=a.data.eleVertexData,e=a.data.vertexData,f=0;f<b.length;++f){var h=b[f],l=h.index,n=h.count;if(this._context.clippingExtent&&(g.computeBoundingBox(c,l,n,D),g.boundingBoxClipped(D,this._context.clippingExtent)))continue;g.chooseOrigin(e,
l,n,H);g.subtractCoordinates(e,l,n,H);h=new Float64Array(c.buffer,3*l*c.BYTES_PER_ELEMENT,3*n);l=new Float64Array(e.buffer,3*l*e.BYTES_PER_ELEMENT,3*n);l=d.createPolylineGeometry(l,h,a.isRings,K,0);l=new w(l,a.idHint+"outline"+f);l.singleUse=!0;h=B.identity();B.translate(h,H,h);a.outGeometries.push(l);a.outMaterials.push([this._outlineMaterial]);a.outTransforms.push(h);a.outNum++}},_createAsOverlay:function(a,b,d,e){var f=this._getPolyGeometry(a);a=!1;var h;null!=f.rings?(a=!0,h=f.rings):h=f.paths;
h=this._getOutlineGeometry(f,h);if(0===h.length)return null;this._material.setRenderPriority(this._symbolLayerOrder+this._symbolLayerOrderDelta/2);this._hasOutline&&this._outlineMaterial.setRenderPriority(this._symbolLayerOrder);f=g.getGeometryVertexDataDraped(h,f.spatialReference,this._context.overlaySR);E.idHint=e;E.color=b;E.isRings=a;E.data=f;var l;this._hasOutline&&(l=new f.vertexData.constructor(f.vertexData));E.outNum=0;E.outGeometries=[];E.outBoundingBox=u.create(u.NEGATIVE_INFINITY);this._createAsOverlayFill(E);
E.data.vertexData=l;this._createAsOverlayOutline(E);return 0<E.outNum?new c(this,E.outGeometries,null,null,E.outBoundingBox,d):null},_createAsOverlayFill:function(a){for(var b=a.data.vertexData,c=a.data.geometryData.polygons,d=0;d<c.length;++d){var e=c[d],f=e.count,h=e.index,l=new Float64Array(b.buffer,3*h*b.BYTES_PER_ELEMENT,3*f),e=e.holeIndices.map(function(a){return a-h}),l=A(l,e,3);if(0!==l.length&&(g.computeBoundingBox(b,h,f,D),!g.boundingBoxClipped(D,this._context.clippingExtent))){u.expand(a.outBoundingBox,
D);g.chooseOrigin(b,h,f,H);g.subtractCoordinates(b,h,f,H);g.setZ(b,h,f,this._getDrapedZ());f=B.identity();B.translate(f,H,f);l=this._createFillGeometry(l,h,b,null,a.color);e=new x(l);e.material=this._material;var n=D;e.center=[.5*(n[0]+n[3]),.5*(n[1]+n[4]),0];e.bsRadius=.5*Math.sqrt((n[3]-n[0])*(n[3]-n[0])+(n[4]-n[1])*(n[4]-n[1]));e.transformation=f;e.name=a.idHint;e.uniqueName=a.idHint+"#"+l.id;a.outGeometries.push(e);a.outNum++}}},_createAsOverlayOutline:function(a){if(this._hasOutline)for(var b=
a.data.vertexData,c=a.data.geometryData.outlines,e=0;e<c.length;++e){var f=c[e],h=f.index,f=f.count;g.computeBoundingBox(b,h,f,D);if(!g.boundingBoxClipped(D,this._context.clippingExtent)){u.expand(a.outBoundingBox,D);g.chooseOrigin(b,h,f,H);g.subtractCoordinates(b,h,f,H);g.setZ(b,h,f,this._getDrapedZ());f=new Float64Array(b.buffer,3*h*b.BYTES_PER_ELEMENT,3*f);h=B.identity();B.translate(h,H,h);var f=d.createPolylineGeometry(f,null,a.isRings,K,0),l=new x(f);l.material=this._outlineMaterial;var n=D;
l.center=[.5*(n[0]+n[3]),.5*(n[1]+n[4]),0];l.bsRadius=.5*Math.sqrt((n[3]-n[0])*(n[3]-n[0])+(n[4]-n[1])*(n[4]-n[1]));l.transformation=h;l.name=a.idHint+"outline";l.uniqueName=a.idHint+"outline#"+f.id;a.outGeometries.push(l);a.outNum++}}},_getOutlineGeometry:function(a,b){return a._outlineSegments?d.createOutlineGeometryFromSegments(b,a._outlineSegments):b},_getOutlineOpacity:function(){return this._getLayerOpacity()*this.symbol.outline.color.a},_getOutlineColor:function(){var a=this.symbol.outline.color,
b=this._getOutlineOpacity();return e.mixinColorAndOpacity(f.toUnitRGB(a),b)},_getPolyGeometry:function(a){a=a.geometry;"extent"===a.type&&(a=l.fromExtent(a));return a},_createFillGeometry:function(a,b,c,d,e){for(var f=a.length,g=new Uint32Array(f),h=new Uint32Array(f),l=0;l<f;l++)g[l]=a[l]+b,h[l]=0;a={};b={};a[C.POSITION]=g;a[C.COLOR]=h;b[C.POSITION]={size:3,data:c};b[C.COLOR]={size:4,data:e};d&&(b.mapPos={size:3,data:d},a.mapPos=g);return new q(b,a)}});var D=u.create(),H=z.create(),K=new Float32Array([255,
255,255,255]),E={idHint:null,color:null,isRings:!1,data:null,outNum:0,outBoundingBox:null,outGeometries:null,outMaterials:null,outTransforms:null};return m})},"esri/views/3d/layers/graphics/earcut/earcut":function(){define([],function(){function m(e,f,g){g=g||2;var l=f&&f.length,n=l?f[0]*g:e.length,q=k(e,0,n,g,!0),m=[];if(!q)return m;var x,y,w,u;if(l){var r=g,l=[],A,z,P;u=0;for(A=f.length;u<A;u++)z=f[u]*r,P=u<A-1?f[u+1]*r:e.length,z=k(e,z,P,r,!1),z===z.next&&(z.steiner=!0),l.push(d(z));l.sort(c);
for(u=0;u<l.length;u++){f=l[u];r=q;if(r=h(f,r))f=t(r,f),b(f,f.next);q=b(q,q.next)}}if(e.length>80*g){x=w=e[0];y=l=e[1];for(r=g;r<n;r+=g)u=e[r],f=e[r+1],u<x&&(x=u),f<y&&(y=f),u>w&&(w=u),f>l&&(l=f);w=Math.max(w-x,l-y)}a(q,m,g,x,y,w);return m}function k(a,b,c,d,e){var g;if(e===0<x(a,b,c,d))for(e=b;e<c;e+=d)g=r(e,a[e],a[e+1],g);else for(e=c-d;e>=b;e-=d)g=r(e,a[e],a[e+1],g);g&&f(g,g.next)&&(w(g),g=g.next);return g}function b(a,b){if(!a)return a;b||(b=a);var c;do if(c=!1,a.steiner||!f(a,a.next)&&0!==l(a.prev,
a,a.next))a=a.next;else{w(a);a=b=a.prev;if(a===a.next)return null;c=!0}while(c||a!==b);return b}function a(c,d,h,k,q,m,x){if(c){if(!x&&m){var y=c,r=y;do null===r.z&&(r.z=g(r.x,r.y,k,q,m)),r.prevZ=r.prev,r=r.nextZ=r.next;while(r!==y);r.prevZ.nextZ=null;r.prevZ=null;var y=r,A,z,B,C,D,H,I=1;do{r=y;B=y=null;for(C=0;r;){C++;z=r;for(A=D=0;A<I&&(D++,z=z.nextZ,z);A++);for(H=I;0<D||0<H&&z;)0===D?(A=z,z=z.nextZ,H--):0!==H&&z?r.z<=z.z?(A=r,r=r.nextZ,D--):(A=z,z=z.nextZ,H--):(A=r,r=r.nextZ,D--),B?B.nextZ=A:y=
A,A.prevZ=B,B=A;r=z}B.nextZ=null;I*=2}while(1<C)}for(y=c;c.prev!==c.next;){r=c.prev;z=c.next;if(m)a:{B=c;H=k;var O=q,ea=m;C=B.prev;D=B;I=B.next;if(0<=l(C,D,I))B=!1;else{var W=C.x>D.x?C.x>I.x?C.x:I.x:D.x>I.x?D.x:I.x,fa=C.y>D.y?C.y>I.y?C.y:I.y:D.y>I.y?D.y:I.y;A=g(C.x<D.x?C.x<I.x?C.x:I.x:D.x<I.x?D.x:I.x,C.y<D.y?C.y<I.y?C.y:I.y:D.y<I.y?D.y:I.y,H,O,ea);H=g(W,fa,H,O,ea);for(O=B.nextZ;O&&O.z<=H;){if(O!==B.prev&&O!==B.next&&e(C.x,C.y,D.x,D.y,I.x,I.y,O.x,O.y)&&0<=l(O.prev,O,O.next)){B=!1;break a}O=O.nextZ}for(O=
B.prevZ;O&&O.z>=A;){if(O!==B.prev&&O!==B.next&&e(C.x,C.y,D.x,D.y,I.x,I.y,O.x,O.y)&&0<=l(O.prev,O,O.next)){B=!1;break a}O=O.prevZ}B=!0}}else a:if(B=c,C=B.prev,D=B,I=B.next,0<=l(C,D,I))B=!1;else{for(A=B.next.next;A!==B.prev;){if(e(C.x,C.y,D.x,D.y,I.x,I.y,A.x,A.y)&&0<=l(A.prev,A,A.next)){B=!1;break a}A=A.next}B=!0}if(B)d.push(r.i/h),d.push(c.i/h),d.push(z.i/h),w(c),y=c=z.next;else if(c=z,c===y){if(!x)a(b(c),d,h,k,q,m,1);else if(1===x){x=d;y=h;r=c;do z=r.prev,B=r.next.next,!f(z,B)&&n(z,r,r.next,B)&&u(z,
B)&&u(B,z)&&(x.push(z.i/y),x.push(r.i/y),x.push(B.i/y),w(r),w(r.next),r=c=B),r=r.next;while(r!==c);c=r;a(c,d,h,k,q,m,2)}else if(2===x)a:{x=c;do{for(y=x.next.next;y!==x.prev;){if(r=x.i!==y.i){r=x;z=y;B=void 0;if(B=r.next.i!==z.i&&r.prev.i!==z.i){B=void 0;b:{B=r;do{if(B.i!==r.i&&B.next.i!==r.i&&B.i!==z.i&&B.next.i!==z.i&&n(B,B.next,r,z)){B=!0;break b}B=B.next}while(B!==r);B=!1}B=!B}C=void 0;if(C=B&&u(r,z)&&u(z,r)){B=r;C=!1;D=(r.x+z.x)/2;z=(r.y+z.y)/2;do B.y>z!==B.next.y>z&&D<(B.next.x-B.x)*(z-B.y)/
(B.next.y-B.y)+B.x&&(C=!C),B=B.next;while(B!==r)}r=C}if(r){c=t(x,y);x=b(x,x.next);c=b(c,c.next);a(x,d,h,k,q,m);a(c,d,h,k,q,m);break a}y=y.next}x=x.next}while(x!==c)}break}}}}function c(a,b){return a.x-b.x}function h(a,b){var c=b,d=a.x,f=a.y,g=-Infinity,h;do{if(f<=c.y&&f>=c.next.y){var l=c.x+(f-c.y)*(c.next.x-c.x)/(c.next.y-c.y);if(l<=d&&l>g){g=l;if(l===d){if(f===c.y)return c;if(f===c.next.y)return c.next}h=c.x<c.next.x?c:c.next}}c=c.next}while(c!==b);if(!h)return null;if(d===g)return h.prev;b=h;for(var l=
h.x,n=h.y,k=Infinity,q,c=h.next;c!==b;)d>=c.x&&c.x>=l&&e(f<n?d:g,f,l,n,f<n?g:d,f,c.x,c.y)&&(q=Math.abs(f-c.y)/(d-c.x),(q<k||q===k&&c.x>h.x)&&u(c,a)&&(h=c,k=q)),c=c.next;return h}function g(a,b,c,d,e){a=32767*(a-c)/e;b=32767*(b-d)/e;a=(a|a<<8)&16711935;a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;b=(b|b<<8)&16711935;b=(b|b<<4)&252645135;b=(b|b<<2)&858993459;return(a|a<<1)&1431655765|((b|b<<1)&1431655765)<<1}function d(a){var b=a,c=a;do b.x<c.x&&(c=b),b=b.next;while(b!==a);return c}function e(a,b,c,d,
e,f,g,h){return 0<=(e-g)*(b-h)-(a-g)*(f-h)&&0<=(a-g)*(d-h)-(c-g)*(b-h)&&0<=(c-g)*(f-h)-(e-g)*(d-h)}function l(a,b,c){return(b.y-a.y)*(c.x-b.x)-(b.x-a.x)*(c.y-b.y)}function f(a,b){return a.x===b.x&&a.y===b.y}function n(a,b,c,d){return f(a,b)&&f(c,d)||f(a,d)&&f(c,b)?!0:0<l(a,b,c)!==0<l(a,b,d)&&0<l(c,d,a)!==0<l(c,d,b)}function u(a,b){return 0>l(a.prev,a,a.next)?0<=l(a,b,a.next)&&0<=l(a,a.prev,b):0>l(a,b,a.prev)||0>l(a,a.next,b)}function t(a,b){var c=new q(a.i,a.x,a.y),d=new q(b.i,b.x,b.y),e=a.next,f=
b.prev;a.next=b;b.prev=a;c.next=e;e.prev=c;d.next=c;c.prev=d;f.next=d;d.prev=f;return d}function r(a,b,c,d){a=new q(a,b,c);d?(a.next=d.next,a.prev=d,d.next.prev=a,d.next=a):(a.prev=a,a.next=a);return a}function w(a){a.next.prev=a.prev;a.prev.next=a.next;a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function q(a,b,c){this.i=a;this.x=b;this.y=c;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}function x(a,b,c,d){for(var e=0,f=c-d;b<c;b+=d)e+=(a[f]-a[b])*(a[b+
1]+a[f+1]),f=b;return e}m.deviation=function(a,b,c,d){var e=b&&b.length,f=Math.abs(x(a,0,e?b[0]*c:a.length,c));if(e)for(var e=0,g=b.length;e<g;e++)f-=Math.abs(x(a,b[e]*c,e<g-1?b[e+1]*c:a.length,c));for(e=b=0;e<d.length;e+=3){var g=d[e]*c,h=d[e+1]*c,l=d[e+2]*c;b+=Math.abs((a[g]-a[l])*(a[h+1]-a[g+1])-(a[g]-a[h])*(a[l+1]-a[g+1]))}return 0===f&&0===b?0:Math.abs((b-f)/f)};m.flatten=function(a){for(var b=a[0][0].length,c={vertices:[],holes:[],dimensions:b},d=0,e=0;e<a.length;e++){for(var f=0;f<a[e].length;f++)for(var g=
0;g<b;g++)c.vertices.push(a[e][f][g]);0<e&&(d+=a[e-1].length,c.holes.push(d))}return c};return m})},"esri/views/3d/layers/graphics/Graphics3DExtrudeSymbolLayer":function(){define("../../../../core/declare ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./Graphics3DSymbolCommonCode ./ElevationInfo ../../../../geometry/Polygon ../../support/projectionUtils ../../lib/glMatrix ../../webgl-engine/Stage ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryData ../../webgl-engine/materials/Material ../../webgl-engine/lib/Util ./earcut/earcut".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f,n,u,t,r){function w(a,b,c,d,e,f,g,h,l,n,k,q,m,t){var r=c.length/3,u=0;k+=2*d.count;var w=d.index,y=d.count,A=l,C=k;z.set(m,B);var p=0<q?1:-1,w=3*w,F=A;m=3*F;for(var K=A+y,A=3*K,Q=0;Q<y;++Q)t&&(B[0]=a[w+0],B[1]=a[w+1],B[2]=a[w+2],z.normalize(B)),e[m+0]=a[w+0],e[m+1]=a[w+1],e[m+2]=a[w+2],f[m+0]=b[w+0],f[m+1]=b[w+1],f[m+2]=b[w+2],g[m+0]=-p*B[0],g[m+1]=-p*B[1],g[m+2]=-p*B[2],h[F]=0,e[A+0]=a[w+0]+q*B[0],e[A+1]=a[w+1]+q*B[1],e[A+2]=a[w+2]+q*B[2],f[A+0]=b[w+0],f[A+1]=b[w+1],
f[A+2]=b[w+2],g[A+0]=p*B[0],g[A+1]=p*B[1],g[A+2]=p*B[2],h[K]=q,m+=3,A+=3,w+=3,F+=1,K+=1;w=0;m=3*C;A=3*(C+r);m=3*(C+r);A=3*C;a=D;b=H;0>q&&(a=H,b=D);for(Q=0;Q<r;++Q)n[m+0]=c[w+a[0]],n[m+1]=c[w+a[1]],n[m+2]=c[w+a[2]],n[A+0]=c[w+b[0]]+y,n[A+1]=c[w+b[1]]+y,n[A+2]=c[w+b[2]]+y,m+=3,A+=3,w+=3;l+=2*d.count;k=k+2*r-(2*d.count+2*r);x(e,f,h,g,u,d.pathLengths[0],d.count,l,n,k,q);l+=4*d.pathLengths[0];k+=2*d.pathLengths[0];u+=d.pathLengths[0];for(c=1;c<d.pathLengths.length;++c)x(e,f,h,g,u,d.pathLengths[c],d.count,
l,n,k,q),l+=4*d.pathLengths[c],k+=2*d.pathLengths[c],u+=d.pathLengths[c]}function q(a,b,c,d,e,f,g){d[f]=d[g];g*=3;f*=3;a[f+0]=a[g+0];a[f+1]=a[g+1];a[f+2]=a[g+2];b[f+0]=b[g+0];b[f+1]=b[g+1];b[f+2]=b[g+2];c[f+0]=e[0];c[f+1]=e[1];c[f+2]=e[2]}function x(a,b,c,d,e,f,g,h,l,n,k){var m=e,x=e+1,t=e+g,r=e+g+1,w=h,u=h+1,y=h+2*f;h=h+2*f+1;0>k&&(m=e+g+1,r=e);n*=3;for(var A=0;A<f;++A){A===f-1&&(0<k?(x=e,r=e+g):(x=e,m=e+g));var B=a,p=m,C=x,K=t,D=F,p=3*p,C=3*C,K=3*K;z.set3(B[p++],B[p++],B[p++],L);z.set3(B[C++],B[C++],
B[C++],Q);z.set3(B[K++],B[K++],B[K++],N);z.subtract(Q,L,J);z.subtract(N,L,P);z.cross(P,J,D);z.normalize(D,D);q(a,b,d,c,F,w,m);q(a,b,d,c,F,u,x);q(a,b,d,c,F,y,t);q(a,b,d,c,F,h,r);l[n++]=w;l[n++]=y;l[n++]=h;l[n++]=w;l[n++]=h;l[n++]=u;m++;x++;t++;r++;w+=2;u+=2;y+=2;h+=2}}var y=t.VertexAttrConstants,z=d.vec3d,A=d.mat4d,C=z.create(),B=z.create(),D=[0,2,1],H=[0,1,2],K={},E={verticalDistanceToGround:0,terrainElevation:0};m=m([k],{_prepareResources:function(){var a=this._getStageIdHint(),b=this._getMaterialOpacityAndColor(),
c=z.create(b),b=b[3],c={diffuse:c,ambient:c,opacity:b,transparent:1>b||this._isPropertyDriven("opacity"),vertexColors:!0};this._material=new u(c,a+"_3dlinemat");this._context.stage.add(e.ModelContentType.MATERIAL,this._material);this.resolve()},destroy:function(){this.isFulfilled()||this.reject();this._material&&this._context.stage.remove(e.ModelContentType.MATERIAL,this._material.getId())},createGraphics3DGraphic:function(a,b){var c=a.geometry;if("polygon"!==c.type&&"extent"!==c.type)return this._logWarning("unsupported geometry type for extrude symbol: "+
c.type),null;var c="polygon"===c.type||"extent"===c.type?"rings":"paths",d="graphic"+a.uid,e=this._getVertexOpacityAndColor(b,Float32Array,255),f=this._getGraphicElevationInfo(a);return this._createAs3DShape(a,c,b,e,f,d,a.uid)},layerPropertyChanged:function(b,c,d){if("opacity"===b)return c=this._getMaterialOpacity(),d=1>c||this._isPropertyDriven("opacity"),this._material.setParameterValues({opacity:c,transparent:d}),!0;if("elevationInfo"===b){this._updateElevationInfo();b=this._context.elevationProvider;
var e=this._context.renderCoordsHelper,f=a.ELEV_MODES.ABSOLUTE_HEIGHT,g;for(g in c){var h=c[g],l=h._graphics[d];l&&(h=this._getGraphicElevationInfo(h.graphic),l.elevationAligner=h.mode!==f?ea:null,l.elevationInfo.set(h),ea(l,b,e))}return!0}return!1},_getExtrusionSize:function(b,c){b=b.size&&this._isPropertyDriven("size")?a.getSingleSizeDriver(b.size):this.symbol.size||1;return b/=this._context.renderCoordsHelper.unitInMeters},_createAs3DShape:function(c,d,e,n,k,q,m){var x=c.geometry;"extent"===x.type&&
(x=h.fromExtent(x));var t=x[d],u=x.hasZ;if(0<t.length){d=[];c=[];var y=[],B=z.create(),C=Array(6),F=this._context.renderSpatialReference===g.SphericalRenderSpatialReference;e=this._getExtrusionSize(e,this.symbol.size);var K=z.create();F||this._context.renderCoordsHelper.worldUpAtPosition(null,K);for(var x=a.getGeometryVertexData3D(t,u,x.spatialReference,this._context.renderSpatialReference,this._context.elevationProvider,k),t=x.geometryData.polygons,u=x.eleVertexData,Q=x.vertexData,G=Q.length/3,L=
new Float64Array(18*G),D=new Float64Array(18*G),N=new Float64Array(18*G),G=new Float64Array(6*G),p=0,I=0;I<t.length;++I){var E=t[I],J=E.count,O=E.index;if(this._context.clippingExtent&&(a.computeBoundingBox(u,O,J,C),a.boundingBoxClipped(C,this._context.clippingExtent)))continue;var H=new Float64Array(u.buffer,3*O*L.BYTES_PER_ELEMENT,3*J),ra=E.holeIndices.map(function(a){return a-O}),H=r(H,ra,3);if(0<H.length){a.chooseOrigin(Q,O,J,B);var ra=new Uint32Array(6*J+2*H.length),P=6*J,R=new Float64Array(L.buffer,
3*p*L.BYTES_PER_ELEMENT,3*P),ia=new Float64Array(D.buffer,3*p*D.BYTES_PER_ELEMENT,3*P),ga=new Float64Array(N.buffer,3*p*N.BYTES_PER_ELEMENT,3*P),W=new Float64Array(G.buffer,1*p*G.BYTES_PER_ELEMENT,1*P);w(Q,u,H,E,R,ga,ia,W,0,ra,0,e,K,F);a.subtractCoordinates(R,0,P,B);p+=6*J;E=this._createExtrudeGeometry(ra,{positions:R,elevation:ga,normals:ia,heights:W},n);E=new f(E,q+"path"+I);E.singleUse=!0;d.push(E);c.push([this._material]);E=A.identity();A.translate(E,B,E);y.push(E)}}return 0<d.length?(n=new l({geometries:d,
materials:c,transformations:y,castShadow:!0,metadata:{layerId:this._context.layer.id,graphicId:m},idHint:q}),q=null,k.mode!==a.ELEV_MODES.ABSOLUTE_HEIGHT&&(q=ea),k=new b(this,n,d,null,null,q,k),k.alignedTerrainElevation=x.terrainElevation,k):null}this._logWarning("no paths found for extrusion symbol");return null},_createExtrudeGeometry:function(a,b,c){for(var d=a.length,e=new Uint32Array(d),f=0;f<d;f++)e[f]=0;d={};f={};d[y.POSITION]=a;d[y.NORMAL]=a;d[y.COLOR]=e;f[y.POSITION]={size:3,data:b.positions};
f[y.NORMAL]={size:3,data:b.normals};f[y.COLOR]={size:4,data:c};f[y.SIZE]={size:1,data:b.heights};b.elevation&&(f.mapPos={size:3,data:b.elevation},d.mapPos=a);return new n(f,d)}});var F=z.create(),L=z.create(),Q=z.create(),N=z.create(),J=z.create(),P=z.create(),I=z.create(),O=z.create(),ea=function(b,d,e){var f=b.stageObject,g=b.elevationInfo,h=e.setAltitude;K.spatialReference=d.spatialReference;for(var l=f.getGeometryRecords(),n=l.length,k=g.mode!==c.MODES.ABSOLUTE_HEIGHT,q=0,m=0;m<n;m++){var x=l[m].geometry,
t=l[m].transformation;O[0]=t[12];O[1]=t[13];O[2]=t[14];x.invalidateBoundingInfo();for(var r=x.getData().getVertexAttr(),x=r[y.POSITION].data,t=r[y.SIZE].data,r=r.mapPos.data,w=x.length/3,u=0,A=0,B=!1,z=0,F=0;F<w;F++){K.x=r[A];K.y=r[A+1];K.z=r[A+2];I[0]=x[u];I[1]=x[u+1];I[2]=x[u+2];var p=a.computeElevation(d,K,g,k?E:null);k&&(z+=E.terrainElevation);C[0]=x[u]+O[0];C[1]=x[u+1]+O[1];C[2]=x[u+2]+O[2];h(p+t[u/3],C,0);x[u]=C[0]-O[0];x[u+1]=C[1]-O[1];x[u+2]=C[2]-O[2];p=.01/e.unitInMeters;if(Math.abs(I[0]-
x[u])>p||Math.abs(I[1]-x[u+1])>p||Math.abs(I[2]-x[u+2])>p)B=!0;A+=3;u+=3}B&&f.geometryVertexAttrsUpdated(m);q+=z/w}b.alignedTerrainElevation=q/n};return m})},"esri/views/3d/layers/graphics/Graphics3DTextSymbolLayer":function(){define("../../../../core/declare ../../../../core/screenUtils ../../../../Color ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./ElevationAligners ./Graphics3DSymbolCommonCode ./Graphics3DIconSymbolLayer ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/TextTexture ../../webgl-engine/materials/HUDMaterial".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f,n){var u=[1,1,1],t=[0,0,1],r=h.perObjectElevationAligner;m=m([a],{_prepareResources:function(){var a=this.symbol;this._anchor=-1<d.VALID_ANCHOR_STRINGS.indexOf(a.anchor)?a.anchor:"center";this.resolve()},destroy:function(){this.isFulfilled()||this.reject()},createGraphics3DGraphic:function(a,b,c,d){var e=a.geometry,f=!1;if("polyline"===e.type)e=g.placePointOnPolyline(e),f=!0;else if("polygon"===e.type)e=g.placePointOnPolygon(e);else if("extent"===e.type)e=e.get("center");
else if("point"!==e.type)return this._logWarning("unsupported geometry type for text symbol: "+e.type),null;var h=this._context.layer.id+"_label_"+a.uid,l=b.text||this.symbol.text;if(!l||1>l.length)return null;var n=this._getGraphicElevationInfo(a);return this._createAs3DShape(this.symbol,e,l,n,h,a.uid,b,c,d,f)},layerPropertyChanged:function(a,b,c){if("opacity"===a)console.warn("layer opacity change not yet implemented in Graphics3DTextSymbolLayer");else if("elevationInfo"===a){this._updateElevationInfo();
if(b)for(var d in b){a=b[d];var e=a._graphics[c];e&&this.updateGraphicElevationInfo(a.graphic,e)}return!0}return!1},updateGraphicElevationInfo:function(a,b){var c=this._context;a=this._getGraphicElevationInfo(a);b.elevationAligner=a.mode!==g.ELEV_MODES.ABSOLUTE_HEIGHT?r:null;b.elevationInfo.set(a);r(b,c.elevationProvider,c.renderCoordsHelper)},_defaultElevationInfoNoZ:function(){return w},_getGraphicElevationInfo:function(a){var b=this.inherited(arguments);b.mode===g.ELEV_MODES.ON_THE_GROUND?(b.mode=
g.ELEV_MODES.RELATIVE_TO_GROUND,b.offset=1/this._context.renderCoordsHelper.unitInMeters,b.featureExpression={value:0}):b.mode!==g.ELEV_MODES.RELATIVE_TO_GROUND||0!==b.offset||a.geometry.get("hasZ")||(b.offset=1/this._context.renderCoordsHelper.unitInMeters);return b},_createAs3DShape:function(a,d,m,r,w,C,B,D,H,K){var q=B.centerOffset||[0,0,0,1],x=B.screenOffset||[0,0],y=B.translation||[0,0,0,0],A=B.anchor||this._anchor||"center";this._anchor=A;var z=a.material?b.toUnitRGB(a.material.color):u,J={shadowColor:.35<
.299*z[0]+.587*z[1]+.114*z[2]?"black":"white",shadowBlur:1};B=null!=H;a=new f(m,{size:k.pt2px(a.size)||12,color:z,font:{family:a.font&&a.font.family?a.font.family:"Arial",weight:a.font&&a.font.weight?a.font.weight:"normal",style:a.font&&a.font.style?a.font.style:"normal"},canvasStyle:J},w,B);z=B?H.addTextTexture(a):null;J=this._getMaterialOpacity();x={textureId:B?z.texture.getId():a.getId(),texCoordScale:a.getTexcoordScale(),occlusionTest:!0,screenOffset:x,anchorPos:A,polygonOffset:!0,color:[1,1,
1,J],transparent:1>J};K&&(x.shaderPolygonOffset=1E-4);K=null;A=JSON.stringify(x);null!=D?(K=D.getMaterial(A),null==K?(K=new n(x,w),D.addMaterial(A,K)):B&&K.setTextureDirty()):K=new n(x,w);B=[K];K=[a.getTextWidth(),a.getTextHeight()];q=l.createPointGeometry(t,y,void 0,K,q,z?z.uvMinMax:null);q=[new e(q,w)];w=g.createStageObjectForPoint.call(this,d,q,[B],null,null,r,w,this._context.layer.id,C,!0);C=null;r.mode!==g.ELEV_MODES.ABSOLUTE_HEIGHT&&(C=h.perObjectElevationAligner);r=new c(this,w.object,q,null==
D?B:null,null==H?[a]:null,C,r);r.alignedTerrainElevation=w.terrainElevation;r.metadata={labelText:m};g.extendPointGraphicElevationInfo(r,d,this._context.elevationProvider);return r}});var w={mode:g.ELEV_MODES.RELATIVE_TO_GROUND,offset:0};return m})},"esri/views/3d/webgl-engine/lib/TextTexture":function(){define("require exports ./Texture ./Util ../../../webgl/Texture ../../../webgl/enums".split(" "),function(m,k,b,a,c,h){return function(){function g(a,b,c){this._idHint=c;this._text=a;this._textLines=
a.split(/\r?\n/);this._params=b||{color:[0,0,0]};this._params.size=this._params.size||18;this._params.font=this._params.font||{family:"Arial"};this._params.font.family=this._params.font.family||"Arial";this._params.font.weight=this._params.font.weight||"normal";this._params.font.style=this._params.font.style||"normal";this._fillStyle="rgb("+this._params.color.map(function(a){return Math.floor(255*a)}).toString()+")"}g.prototype.getId=function(){null==this._id&&(this._id=b.idGen.gen(this._idHint));
return this._id};g.prototype.getParams=function(){return this._params};g.prototype.getString=function(){return this._text};g.prototype.initializeThroughRender=function(b,e){var d=this._create2DCanvas(),f=d.getContext("2d");f.save();var g=this.getTextWidth(),h=this.getTextHeight();d.setAttribute("width",g.toString());d.setAttribute("height",h.toString());e.samplingMode=9729;e.wrapMode=33071;e.flipped=!0;this._params.enableMipmapping&&(g=a.nextHighestPowerOfTwo(g),h=a.nextHighestPowerOfTwo(h),e.hasMipmap=
!0,e.samplingMode=9985);this.renderText(1,g,h,f);b=new c(b,e,d);this._params.enableMipmapping&&this._renderMipmap(b);f.restore();return b};g.prototype.getTextWidth=function(){var a=this._create2DCanvas().getContext("2d");this._setTextProperties(a,this._params.size);var b=0,c;for(c in this._textLines){var f=a.measureText(this._textLines[c]).width;f>b&&(b=f)}c=this._params.font;if("italic"===c.style||"oblique"===c.style||"string"===typeof c.weight&&("bold"===c.weight||"bolder"===c.weight)||"number"===
typeof c.weight&&600<c.weight)b+=.3*a.measureText("A").width;return b};g.prototype.getTextHeight=function(){return this.getLineHeight()*this._textLines.length};g.prototype.getTexcoordScale=function(){if(this._params.enableMipmapping){var b=this.getTextHeight(),c=this.getTextWidth();return[c/a.nextHighestPowerOfTwo(c),b/a.nextHighestPowerOfTwo(b)]}return[1,1]};g.prototype.getLineHeight=function(){return Math.floor(1.275*this._params.size)};g.prototype.setUnloadFunc=function(a){this._unloadFunc=a};
g.prototype.unload=function(){this._unloadFunc&&(this._unloadFunc(this._id),this._unloadFunc=null)};g.prototype.renderText=function(a,b,c,f,g,h){void 0===g&&(g=0);void 0===h&&(h=0);c=this.getLineHeight()*a;this._setTextProperties(f,this._params.size*a);a="center"===f.textAlign?.5*b:"right"===f.textAlign?b:0;a+=g;g=0+h;for(var d in this._textLines)f.fillText(this._textLines[d],a,g),g+=c};g.prototype._create2DCanvas=function(){null==g._textCanvas2D&&(g._textCanvas2D=document.createElement("canvas"),
g._textCanvas2D.setAttribute("id","canvas2d"),g._textCanvas2D.setAttribute("width","1024"),g._textCanvas2D.setAttribute("height","1024"),g._textCanvas2D.setAttribute("style","display:none"));return g._textCanvas2D};g.prototype._setTextProperties=function(b,c){b.fillStyle=this._fillStyle;var d=this._params.font;b.font=d.style+" "+d.weight+" "+c+"px "+d.family;b.textAlign="left";b.textBaseline="top";this._params.canvasStyle&&a.mergeObjects(b,this._params.canvasStyle,b)};g.prototype._renderMipmap=function(a){var b=
this._create2DCanvas(),c=b.getContext("2d"),d=parseInt(b.getAttribute("width"),10)/2,g=parseInt(b.getAttribute("height"),10)/2,h=.5,k=1;do b.setAttribute("width",d.toString()),b.setAttribute("height",g.toString()),this.renderText(h,d,g,c),a.updateData(k,0,0,d,g,b),h*=.5,d*=.5,g*=.5,k++;while(1<d&&1<g)};return g}()})},"esri/views/3d/layers/graphics/Graphics3DWebStyleSymbol":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../support/PromiseLightweight"],function(m,
k,b,a){return function(a){function c(b,c){var d=a.call(this)||this;d.symbol=null;d.graphics3DSymbol=null;d.symbol=b;b.fetchSymbol().then(function(a){if(d.isRejected())throw Error();d.graphics3DSymbol=c(a)}).then(function(){if(d.isRejected())throw Error();d.graphics3DSymbol.then(function(){d.isRejected()||d.resolve()},function(a){d.isRejected()||d.reject(a)})}).otherwise(function(a){d.isRejected()||d.reject(a)});return d}b(c,a);c.prototype.createGraphics3DGraphic=function(a,b){return this.graphics3DSymbol.createGraphics3DGraphic(a,
b,this)};c.prototype.layerPropertyChanged=function(a,b){return this.graphics3DSymbol.layerPropertyChanged(a,b)};c.prototype.applyRendererDiff=function(a,b,c){return this.graphics3DSymbol.applyRendererDiff(a,b,c)};c.prototype.getFastUpdateStatus=function(){return this.graphics3DSymbol?this.graphics3DSymbol.getFastUpdateStatus():{loading:1,fast:0,slow:0}};c.prototype.setDrawOrder=function(a,b){return this.graphics3DSymbol.setDrawOrder(a,b)};c.prototype.destroy=function(){this.isFulfilled()||this.reject();
this.graphics3DSymbol&&this.graphics3DSymbol.destroy()};return c}(a.Promise)})},"esri/views/3d/layers/graphics/Graphics3DOwner":function(){define(["require","exports"],function(m,k){m=function(){return function(){this.localOriginFactory=this.layerView=this.layer=this.overlaySR=this.renderCoordsHelper=this.renderSpatialReference=this.clippingExtent=this.layerOrderDelta=this.layerOrder=this.stage=this.renderer=this.elevationProvider=this.streamDataSupplier=this.sharedResources=null}}();k.Graphics3DSymbolCreationContext=
m})},"esri/views/3d/layers/graphics/ElevationQuery":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper dojo/Deferred dojo/_base/lang ../../../../core/Scheduler ../../../../geometry/Multipoint".split(" "),function(m,k,b,a,c,h,g,d){m=function(){function e(a,b,c){this.spatialReference=a;this._getElevationQueryProvider=b;this._queries=[];this._isScheduled=!1;this._queryOptions=h.mixin({},c,{ignoreInvisibleLayers:!0})}e.prototype.queryElevation=
function(d,e){return a(this,void 0,void 0,function(){var a;return b(this,function(b){a=new c;this._queries.push({x:d,y:e,result:a});this._scheduleDoQuery();return[2,a.promise]})})};e.prototype._scheduleDoQuery=function(){var a=this;this._isScheduled||(g.schedule(function(){return a._doQuery()}),this._isScheduled=!0)};e.prototype._doQuery=function(){return a(this,void 0,void 0,function(){var a,c,e,g,h,k,m;return b(this,function(b){switch(b.label){case 0:this._isScheduled=!1;a=this._queries;this._queries=
[];c=a.map(function(a){return[a.x,a.y]});e=new d({points:c,spatialReference:this.spatialReference});g=this._getElevationQueryProvider();if(!g)return a.forEach(function(a,b){return a.result.reject()}),[2];b.label=1;case 1:return b.trys.push([1,3,,4]),[4,g.queryElevation(e,this._queryOptions)];case 2:return h=b.sent(),[3,4];case 3:return k=b.sent(),a.forEach(function(a){return a.result.reject(k)}),[2];case 4:return m=h.geometry.points,a.forEach(function(a,b){return a.result.resolve(m[b][2])}),[2]}})})};
return e}();k.ElevationQuery=m})},"esri/views/3d/layers/graphics/Graphics3DSpatialIndex":function(){define("require exports dojo/Deferred ../../../../processors/SpatialIndex ../../../../geometry/SpatialReference ../../../../geometry/support/webMercatorUtils".split(" "),function(m,k,b,a,c,h){return function(){function g(){var c=this;this.spatialIndex=new a;this.spatialIndexNumPendingQueries=this.spatialIndexNumGraphics=0;this.graphicsCore=this.viewSR=this.layer=this.layerView=null;this._readyDfd=new b;
var e=function(a){return a.workerClient&&a.workerClient.worker};if(e(this.spatialIndex))this._readyDfd.resolve();else this.spatialIndex.on("start",function(){e(c.spatialIndex)&&c._readyDfd.resolve()})}g.prototype.initialize=function(a,b,c,f){this.layerView=a;this.layer=b;this.viewSR=c;this.graphicsCore=f};g.prototype.destroy=function(){this.spatialIndex&&(this.spatialIndex.destroy(),this.spatialIndex=null);this.graphicsCore=this.layerView=this.viewSR=null};g.prototype.numNodesUpdating=function(){return 0};
g.prototype.isUpdating=function(){return 0<this.spatialIndexNumPendingQueries};g.prototype.hasGraphics=function(){return 0<this.spatialIndexNumGraphics};g.prototype.intersects=function(a,b,c){var d=this;this.hasGraphics()&&(this.spatialIndexNumPendingQueries++,this.spatialIndex.intersects(a,void 0,void 0,!0).then(function(a){d.spatialIndexNumPendingQueries--;c(a.results,a.results.length);d.layerView._evaluateUpdatingState()}))};g.prototype.shouldAddToSpatialIndex=function(a,b,c){return c||b.mustAlignToTerrain()};
g.prototype.addGraphicsToSpatialIndex=function(a){if(this.layerView.loadedGraphics)for(var b=this.layerView.loadedGraphics.toArray(),c=b.length,d=0;d<c;d++){var g=b[d],h=this.graphicsCore.getGraphics3DGraphicById(g.uid);h&&!h.addedToSpatialIndex&&this.shouldAddToSpatialIndex(g,h,a)&&this.addGraphicToSpatialIndex(g,h)}};g.prototype.addGraphicToSpatialIndex=function(a,b){var d=a.geometry.spatialReference,e=this.viewSR,g={id:a.uid,geometry:null};if(d.equals(e))g.geometry=a.geometry.toJSON();else{var k=
void 0;if(d.wkid===c.WGS84.wkid&&e.isWebMercator)k=h.geographicToWebMercator(a.geometry);else if(d.isWebMercator&&e.wkid===c.WGS84.wkid)k=h.webMercatorToGeographic(a.geometry);else return console.warn("Cannot convert graphic geometry to map spatial reference, elevation and scale updates are disabled"),!1;g.geometry=k.toJSON()}this.spatialIndexNumGraphics++;this.spatialIndex.runProcess([g],this.layer.id);return b.addedToSpatialIndex=!0};g.prototype.whenLoaded=function(){return this._readyDfd.promise};
return g}()})},"esri/processors/SpatialIndex":function(){define("../core/declare dojo/Deferred dojo/_base/lang ./Processor ../workers/WorkerClient ../layers/FeatureLayer".split(" "),function(m,k,b,a,c,h){return m([a],{declaredClass:"esri.processors.SpatialIndex",index:null,indexType:"rtree",autostart:!1,constructor:function(a){a=a||{};var d=!1!==a.autostart;b.mixin(this,a);this.workerCallback=["./scripts/helpers","./scripts/indexInterface","./indexWorker"];if(!this.fetchWithWorker){var e=this;this.workerClient=
new c("./mutableWorker",function(a){this.workerClient=a;this.workerCallback.push("./libs/"+this.indexType);this.workerClient.importScripts(this.workerCallback).then(function(){e._attachedSystem=!0;d&&e.start()})}.bind(this))}this._featCache={}},destroy:function(){this.workerClient&&this.workerClient.terminate()},addLayer:function(a,b){if(a.graphics&&a.graphics.length||b||a.isInstanceOf(h)){var c=this.workerClient;if(!this._attachedSystem&&c.worker){var d=this;this.inherited(arguments,[a,!0]);c.importScripts("./libs/"+
this.indexType).then(function(){d.runProcess(a.graphics,a.id);d._attachedSystem=!0})}else this.inherited(arguments,[a])}},unsetMap:function(){this.stop();this.workerClient.terminate();this.fetchWithWorker||(this.workerClient=new c(this.workerCallback,function(){}));this.inherited(arguments);this.start()},removeLayer:function(a){this.inherited(arguments)},runProcess:function(a,b){if(a&&a.length){var c=this,d=this.workerClient,f=a[0]._graphicsLayer;b||0===b||(b=f?f.id:"rawFeatures_"+Object.keys(this._featCache).length);
this._featCache[b]||(this._featCache[b]={});for(var g,h,k=[],m=a.length,w=f&&f.objectIdField;m--;)h=a[m],g=h.attributes&&w?h.attributes[w]:h.id,null!=g&&this._featCache[b][g]||(this._featCache[b][g]=1,h.declaredClass?k.push({id:g,geometry:h.geometry.toJSON(!0),attributes:h.attributes}):k.push(h));d.postMessage({insert:k,system:this.indexType,options:this.indexOptions,idField:f&&f.objectIdField,layerId:b}).then(function(a){f&&f.emit("process-end",{processor:c,results:{insert:a.insert}})});f&&f.emit("process-start",
{processor:this})}},_sendFeaturesFromLayer:function(a,b){b=b.graphic;var c=this.workerClient,d=this,f=b.attributes[a.objectIdField];this._featCache[a.id]||(this._featCache[a.id]={});this._featCache[a.id][f]||(this._featCache[a.id][f]=1,c.postMessage({insert:[{attributes:b.attributes,geometry:b.geometry.toJSON(!0)}],system:this.indexType,options:this.indexOptions,idField:a.objectIdField,layerId:a.id}).then(function(b){a.emit("process-end",{processor:d,results:{insert:b.insert}})}),a.emit("process-start",
{processor:d}))},_notifyProcessStart:function(a,b){},_sendFeaturesFromTask:function(a,b){b=b.featureSet.features;var c=[],d=this.workerClient,f=this,g=b.length,h,k;for(this._featCache[a.id]||(this._featCache[a.id]={});g--;)k=b[g],h=k.attributes[a.objectIdField],this._featCache[a.id][h]||(this._featCache[a.id][h]=1,c.push(k));d.postMessage({insert:c,system:this.indexType,options:this.indexOptions,idField:a.objectIdField,layerId:a.id}).then(function(b){a.emit("process-end",{processor:f,results:{insert:b.insert}})});
a.emit("process-start",{processor:f})},get:function(){},intersects:function(a,b,c,h){return"rtree"!=this.indexType?(console.error("Index.intersects only works with rtree indexes"),a=new k,a.reject({message:"Index.intersects only works with rtree indexes"}),a.promise):this.workerClient.postMessage({search:a,layerId:b,returnNode:c,onlyIds:h})},within:function(a,b,c){if("rtree"!=this.indexType)return console.error("Index.within only works with rtree indexes"),a=new k,a.reject({message:"Index.within only works with rtree indexes"}),
a.promise},nearest:function(a){return"kdtree"!=this.indexType?(console.error("Index.nearest only works with kdtree indexes"),a=new k,a.reject({message:"Index.nearest only works with kdtree indexes"}),a.promise):this.workerClient.postMessage({search:a})}})})},"esri/processors/Processor":function(){define("../core/sniff ../core/declare dojo/_base/lang dojo/_base/array dojo/Evented ../workers/RequestClient ../layers/GraphicsLayer".split(" "),function(m,k,b,a,c,h,g){return k([c],{declaredClass:"esri.processors.Processor",
layers:null,results:null,passFeatures:!0,drawFeatures:!0,requireWorkerSupport:!0,fetchWithWorker:!1,workerCallback:null,workerClient:null,_started:null,_handlers:null,constructor:function(a){a=a||{};b.mixin(this,a);m("esri-workers")||!1===this.requireWorkerSupport&&!1===a.requireWorkerSupport?(this._handlers={},this._notifyProcessStart=b.hitch(this,this._notifyProcessStart),this._sendFeaturesFromTask=b.hitch(this,this._sendFeaturesFromTask),this._sendFeaturesFromLayer=b.hitch(this,this._sendFeaturesFromLayer),
!1!==a.autostart&&this.start()):(console.log("Browser doesn't support workers \x26 worker support is required for this processor"),this.addLayer=this.setMap=this.start=this.runProcess=function(){},this._disabled=!0)},addLayer:function(a,c){var d=a._task,e=this._handlers[a.id]=[],g="complete";!1===this.drawFeatures&&(a._params.drawMode=!1);this.fetchWithWorker?(this.workerClient||(this.workerClient=h.getClient(this.workerCallback)),d.requestOptions={workerOptions:{worker:this.workerClient}},this.passFeatures&&
e.push(d.on(g,b.partial(this._notifyProcessStart,a)))):this.passFeatures?(g=this.drawFeatures?"graphic-draw":"graphic-add",e.push(a.on(g,b.partial(this._sendFeaturesFromLayer,a)))):e.push(d.on(g,b.partial(this._sendFeaturesFromTask,a)));!0!==c&&a.graphics&&this.runProcess(a.graphics,a.id)},removeLayer:function(b){a.forEach(this._handlers[b.id],function(a){a.remove()});delete this._handlers[b.id]},setMap:function(b){if(this.map)if(b!=this.map)this.unsetMap();else return;var c=this;a.forEach(this.layers,
c.removeLayer);a.forEach(b.graphicsLayerIds,function(a){c.addLayer(b.findLayerById(a))});this._handlers.map=[b.on("layer-add",function(a){a=a.layer;a.isInstanceOf(g)&&c.addLayer(a)}),b.on("layer-remove",function(a){a=a.layer;a.isInstanceOf(g)&&c.removeLayer(a)})];this.map=b},unsetMap:function(){this.map&&(a.forEach(this._handlers.map,function(a){a.remove()}),delete this._handlers.map,a.forEach(this.layers,this.removeLayer),this.map=null)},start:function(){this.map?this.setMap(this.map):this.layers&&
(b.isArray(this.layers)||(this.layers=[this.layers]),a.forEach(this.layers,this.addLayer));this._started=!0;this.emit("start",{processor:this});console.log("processor started")},stop:function(){this._started=!1;for(var a in this._handlers)this._handlers.hasOwnProperty(a)&&(this._handlers[a].remove(),delete this._handlers[a]);this.emit("stop",{processor:this});console.log("processor stopped")},runProcess:function(a,b){},_sendFeaturesFromTask:function(){},_sendFeaturesFromLayer:function(){},_notifyProcessStart:function(){}})})},
"esri/workers/RequestClient":function(){define(["../core/declare","dojo/_base/xhr","../config","./WorkerClient"],function(m,k,b,a){function c(a,b){var c=new h;c.addWorkerCallback(a,b);g.unshift({id:b?a+"::"+b:a,client:c});g.length>d&&g.pop().client.terminate();return c}var h=m([a],{declaredClass:"esri.workers.RequestClient",constructor:function(){this.setWorker(["./mutableWorker","./requestWorker"],function(){})},get:function(a){return this._send("GET",a)},post:function(a){return this._send("POST",
a)},_send:function(a,b){b=k._ioSetArgs(b);b.xhr=null;var c=b.ioArgs,d=c.url;delete c.url;delete c.args;this.postMessage({method:a,url:d,options:c}).then(this._getSuccessHandler(b),this._getErrorHandler(b),this._getProgressHandler(b));return b},_addHeaderFunctions:function(a){a.getResponseHeader=function(b){var c,d=a.headers;Object.keys(d).forEach(function(a){if(a.toLowerCase()==b.toLowerCase())return c=d[a],!1});return c};a.getAllResponseHeaders=function(){var b=[],c=a.headers;Object.keys(c).forEach(function(a){b.push(a+
": "+c[a])});return b=b.join("\n")};return a},_getSuccessHandler:function(a){var b=this,c=a.ioArgs;return function(d){a.xhr=b._addHeaderFunctions(d);d=a.xhr.getResponseHeader("content-type");("xml"==c.handleAs||-1<d.indexOf("xml"))&&"string"==typeof a.xhr.response&&(a.xhr.response=(new DOMParser).parseFromString(a.xhr.response,"text/xml"));a.resolve(a.xhr.response,a.xhr)}},_getErrorHandler:function(a){return function(b){a.reject(b)}},_getProgressHandler:function(a){return function(b){a.progress(b)}}}),
g=[],d=b.request.maxWorkers,e=new h;h.getClient=function(a,b){if(a){var d;g.some(function(c){c.id==(b?a+"::"+b:a)&&(d=c.client);return!0});return d||c(a,b)}return e};h.setLimit=function(a){d=b.request.maxWorkers=a};return h})},"esri/workers/WorkerClient":function(){define("dojo/Evented ../core/declare dojo/Deferred dojo/_base/lang dojo/request ../core/sniff ../core/urlUtils require".split(" "),function(m,k,b,a,c,h,g,d){var e=window.Blob||window.webkitBlob||window.mozBlob,l=window.URL||window.webkitURL||
window.mozURL;return k([m],{declaredClass:"esri.workers.WorkerClient",worker:null,_queue:null,constructor:function(b,c){this._isIE=h("ie");this._queue={};this._acceptMessage=a.hitch(this,this._acceptMessage);this._errorMessage=a.hitch(this,this._errorMessage);b&&this.setWorker(b,function(a){this.worker=a;c(this)}.bind(this))},setWorker:function(a,b){if(a instanceof Array){var c=a;a=c.shift()}var d=this._getUrl(a);a=!g.hasSameOrigin(g.makeAbsolute(d),location.href);var f;if(!1===d)return console.log("Can not resolve worker path"),
!1;this.worker&&(f=this.worker,f.removeEventListener("message",this._acceptMessage,!1),f.removeEventListener("error",this._errorMessage,!1),f.terminate(),f=null);if(a){a=this._getUrl("./mutableWorker",!0);try{this._getRemoteText(a,function(a){a=l.createObjectURL(new e([a],{type:"text/javascript"}));b(this._createWorker(a,d))}.bind(this))}catch(w){try{a=g.getProxyUrl(a).path+"?"+encodeURI(a),this._useProxy=!0,b(this._createWorker(a,c))}catch(q){return console.log("Can not create worker"),!1}}}else b(this._createWorker(d,
c))},_createWorker:function(a,b){a=new Worker(a);a.addEventListener("message",this._acceptMessage,!1);a.addEventListener("error",this._errorMessage,!1);this.worker=a;b&&this.importScripts(b);return a},postMessage:function(a,c){if(a instanceof Array||"object"!=typeof a)a={data:a};var d=Math.floor(64E9*Math.random()).toString(36);a.msgId=d;d=this._queue[d]=new b;this.worker?(c?this.worker.postMessage(a,c):this.worker.postMessage(a),this.emit("start-message",{target:this,message:a})):d.reject({message:"No worker was set."});
return d.promise},terminate:function(){var a=Object.keys(this._queue);this.worker&&this.worker.terminate();for(var b=a.length-1;0<=b;b--)this._queue[a[b]].cancel("terminated"),delete this._queue[a[b]]},addWorkerCallback:function(c,d){var e=this._getUrl(c,!0);return!1===e?(d=new b,d.reject({message:"Could not load text from "+c}),d.promise):this.postMessage({action:"add-callback",url:e,cbName:d||"main"}).then(a.hitch(this,function(a){a.target=this;this.emit("callback-added",a)}))},importScripts:function(b){Array.isArray(b)||
(b=[b]);b=b.map(function(a){a=this._getUrl(a,!0);this._useProxy&&!g.hasSameOrigin(a,location.href)&&(a=g.getProxyUrl(a).path+"?"+encodeURI(a));return a},this);return this.postMessage({action:"import-script",url:b}).then(a.hitch(this,function(a){a.target=this;this.emit("scripts-imported",a)}))},_acceptMessage:function(a){var b=a.data,c=b.msgId;if(b.status&&"debug"==b.status)console[b.showAs||"debug"](b);else if(c&&c in this._queue){var d=this._queue[c];"progress"==b.status?d.progress(a.data):("error"==
b.status?d.reject(a.data):d.resolve(a.data),delete this._queue[c])}this.emit("message",{message:a.data,event:a,target:this})},_errorMessage:function(a){this.onerror||this.onError?this.onerror?this.onerror(a):this.onError(a):console.log("Worker Error: "+a.message+"\nIn "+a.filename+" on "+a.lineno)},_getUrl:function(a,b){if(!a)return console.error("can not resolve empty path"),!1;a.match(/\.js$/)||(a+=".js");a=d.toUrl(a);return b?g.makeAbsolute(a):a},_getRemoteText:function(a,b){(a=this._getUrl(a))&&
c.get(a,{sync:!1,handleAs:"text",headers:{"X-Requested-With":"","Content-Type":"text/plain"}}).then(function(a){b(a)})},_startBlobWorker:function(){var a=this._xdSource;a||(a=this._getUrl("./mutableWorker"),a=new e(["if(!self._mutable){importScripts('"+a+"');}"],{type:"text/javascript"}),a=this._xdSource=l.createObjectURL(a));try{return new Worker(a)}catch(n){return console.log(n.message),!1}}})})},"esri/layers/GraphicsLayer":function(){define("../core/Accessor ../core/Collection ../core/promiseUtils ./Layer ./mixins/ScaleRangeLayer ../Graphic dojo/_base/lang".split(" "),
function(m,k,b,a,c,h,g){var d=m.createSubclass({properties:{layer:null,layerView:null,graphics:null}});return a.createSubclass([c],{declaredClass:"esri.layers.GraphicsLayer",viewModulePaths:{"2d":"../views/2d/layers/GraphicsLayerView2D","3d":"../views/3d/layers/FeatureLayerView3D"},getDefaults:function(a){return g.mixin(this.inherited(arguments),{graphics:[]})},destroy:function(){this.removeAll()},_gfxHdl:null,properties:{elevationInfo:null,graphics:{type:k.ofType(h),set:function(a){var b=this._get("graphics");
b||(a.forEach(function(a){a.layer=this},this),this._gfxHdl=a.on("change",function(a){var b,c,d;d=a.added;for(b=0;c=d[b];b++)c.layer=this;d=a.removed;for(b=0;c=d[b];b++)c.layer=null}.bind(this)),this._set("graphics",a),b=a);b.removeAll();b.addMany(a)}},type:"graphics"},add:function(a){this.graphics.add(a);return this},addMany:function(a){this.graphics.addMany(a);return this},removeAll:function(){this.graphics.removeAll();return this},createGraphicsController:function(a){return b.resolve(new d({layer:this,
layerView:a.layerView,graphics:this.graphics}))},remove:function(a){this.graphics.remove(a)},removeMany:function(a){this.graphics.removeMany(a)},graphicChanged:function(a){this.emit("graphic-update",a)}})})},"esri/views/3d/layers/graphics/Graphics3DElevationAlignment":function(){define(["require","exports"],function(m,k){return function(){function b(){this.elevationDirtyGraphicsQueue=[];this.elevationDirtyGraphicsSet={};this.elevationUpdateEventHandle=null;this.eventHandles=[];this.updateElevation=
!1;this.graphicsCore=this.layerView=null}b.prototype.initialize=function(a,b,h,g){var c=this;this.layerView=a;this.graphicsCore=h;this.elevationChangedCallback=b;this.elevationUpdateEventHandle=g.on("elevation-change",function(a){return c.elevationUpdateHandler(a)});this.eventHandles.push(this.layerView.watch("suspended",function(){return c.suspendedChange()}))};b.prototype.destroy=function(){this.elevationDirtyGraphicsSet=this.elevationDirtyGraphicsQueue=null;this.elevationUpdateEventHandle&&(this.elevationUpdateEventHandle.remove(),
this.elevationUpdateEventHandle=null);this.eventHandles.forEach(function(a){return a.remove()});this.elevationChangedCallback=this.graphicsCore=this.layerView=this.eventHandles=null};b.prototype.clear=function(){this.elevationDirtyGraphicsSet={};this.elevationDirtyGraphicsQueue=[]};b.prototype.suspendedChange=function(){!0===this.layerView.suspended?this.updateElevation=!1:!1===this.layerView.suspended&&this.updateElevation&&this.markAllGraphicsElevationDirty()};b.prototype.isUpdating=function(){return 0<
this.elevationDirtyGraphicsQueue.length};b.prototype.numNodesUpdating=function(){return this.elevationDirtyGraphicsQueue.length};b.prototype.needsIdleUpdate=function(){return this.layerView.view.basemapTerrain&&0<this.elevationDirtyGraphicsQueue.length};b.prototype.idleUpdate=function(a){if(!a.done()){var b=this.layerView.view,h=this.elevationDirtyGraphicsQueue.length;if(0<h){for(var g=this.graphicsCore.stageLayer.getId(),d=this.graphicsCore.labelStageLayer?this.graphicsCore.labelStageLayer.getId():
null,e=0,l=0,l=0;l<h;l++){var f=this.elevationDirtyGraphicsQueue[l],n=this.graphicsCore.graphics[f];n&&n.alignWithElevation(b.basemapTerrain,b.renderCoordsHelper);delete this.elevationDirtyGraphicsSet[f];e++;if(20<=e){b._stage.processDirtyLayer(g);null!=d&&b._stage.processDirtyLayer(d);if(a.done())break;e=0}}b._stage.processDirtyLayer(g);null!=d&&b._stage.processDirtyLayer(d);this.elevationDirtyGraphicsQueue.splice(0,l+1);b.labelManager.setDirty();this.layerView._evaluateUpdatingState()}}};b.prototype.markAllGraphicsElevationDirty=
function(){for(var a in this.graphicsCore.graphics)this.markGraphicElevationDirty(this.graphicsCore.graphics[a].graphic.uid);this.layerView._evaluateUpdatingState()};b.prototype.markGraphicElevationDirty=function(a){this.elevationDirtyGraphicsSet[a]||(this.elevationDirtyGraphicsSet[a]=!0,this.elevationDirtyGraphicsQueue.push(a))};b.prototype.elevationUpdateHandler=function(a){var b=this,h=a.extent;this.layerView.suspended?this.updateElevation||(a=this.graphicsCore.computedExtent)&&h[2]>a.xmin&&h[0]<
a.xmax&&h[3]>a.ymin&&h[1]<a.ymax&&(this.updateElevation=!0):-Infinity===h[0]?this.markAllGraphicsElevationDirty():this.elevationChangedCallback(h,a.spatialReference,function(a,c){for(var d=!1,g=0;g<c;g++){var f=a[g],h=b.graphicsCore.graphics[f];h&&h.mustAlignToTerrain()&&(b.markGraphicElevationDirty(f),d=!0)}d&&b.layerView._evaluateUpdatingState()})};return b}()})},"esri/views/3d/navigation/spherical/NavigationSpherical":function(){define("../Navigation ./ConstraintsSpherical ./AnimationSpherical ./actions/PanSpherical ./actions/ZoomSpherical ./actions/RotateSpherical ../../webgl-engine/lib/Camera ../../support/earthUtils ../../lib/glMatrix".split(" "),
function(m,k,b,a,c,h,g,d,e){var l=e.vec3d,f=e.mat4d,n=l.create(),u=l.create(),t=f.create();return m.createSubclass([k,b],{declaredClass:"esri.views.3d.navigation.spherical.NavigationSpherical",initialize:function(){this.pan=new a({navigation:this});this.zoom=new c({navigation:this});this.rotate=new h({navigation:this});this._intersectTerrainSelector.enableBackfacesTerrain=!1},getInitialCamera:function(){return new g(l.createFrom(4*d.earthRadius,0,0),l.createFrom(d.earthRadius,0,0),l.createFrom(0,
0,1))},fixTargetUpVector:function(){this.cameras.target.computeUpOnSphere()},setPoiAuto:function(a,b){a=this.picker.pickAlongRay(this.cameras.target.eye,this.cameras.target.center,null,a);this.picker.pickedIntersectionPoint(a,n)&&(this.setCameraFromEyeAndCenter(this.cameras.target.eye,n,{animate:!1}),l.set(this.cameras.target.center,this.cameras.current.center),b&&this.setCurrentToTarget())},rotateCameraWithPointsOnSphere:function(a,b,c,d,e){var g;null==e&&(e=l.length(a));g=Math.abs(l.length(b)-e);
1E-4<=g&&(console.error("[NavigationSpherical.rotateCameraWithPointsOnSphere: invalid radius for target point (got "+e+", but expected "+l.length(b)+")"),e=l.length(b));g=Math.abs(l.length(a)-e);1E-4<=g&&(console.error("[NavigationSpherical.rotateCameraWithPointsOnSphere]: invalid radius for source point (got "+e+", but expected "+l.length(a)+", "+a+")"),e=l.length(a));a=this.rotationFromPointsOnSphere(a,b,e,u);f.identity(t);f.rotate(t,a,u);f.multiplyVec3(t,c.eye,d.eye);f.multiplyVec3(t,c.center,
d.center);f.multiplyVec3(t,c.up,d.up)},rotationFromPointsOnSphere:function(a,b,c,d){l.cross(a,b,d);return-Math.acos(1-l.dist2(a,b)/(2*c*c))}})})},"esri/views/3d/navigation/Navigation":function(){define(["../../../core/Accessor","../../../core/Evented","../../../core/watchUtils","./Picker","./mixins/CamerasMixin"],function(m,k,b,a,c){return m.createSubclass([c,k],{properties:{interacting:{get:function(){return this._interacting},readOnly:!0},renderCoordsHelper:{},renderUnitInMeters:{dependsOn:["renderCoordsHelper"],
get:function(){return this.renderCoordsHelper?this.renderCoordsHelper.unitInMeters:1}},picker:{},constraints:{},pan:{},zoom:{},rotate:{}},initialize:function(){this._mapCoordsHelperHandle=b.init(this.view,"mapCoordsHelper",function(a){this.mapCoordsHelper=a}.bind(this));this._renderCoordsHelperHandle=b.init(this.view,"renderCoordsHelper",this.updateRenderCoordsHelper.bind(this));this.picker=new a(this,this.view);this._interacting=!1},destroy:function(){this._mapCoordsHelperHandle.remove();this._renderCoordsHelperHandle.remove()},
updateRenderCoordsHelper:function(a){this.renderCoordsHelper=a;this.inherited(arguments)},begin:function(a){this.pan&&this.pan.continuous&&this.pan.continuous.stop();this.pan&&this.pan.momentum&&(this.pan.momentum=null);this._interacting=!0;this.notifyChange("interacting")},end:function(a){this._interacting=!1;this.notifyChange("interacting")}})})},"esri/views/3d/navigation/Picker":function(){define(["../../../core/declare","../support/RenderCoordsHelper","../lib/glMatrix","../webgl-engine/lib/Selector"],
function(m,k,b,a){var c=b.vec3d,h=c.create(),g=c.create();return m([],{constructor:function(b,c){this.navigation=b;this.pickAlongRay=c._pickRay.bind(c);this.createPickRay=c._pickRayWithBeginPoint.bind(c);this.selector=new a},pickPointInScreen:function(a,b){return this.pickedIntersectionPoint(this.pickInScreen(a,!1),b)},pickFreePointInScreen:function(a,b){this.createPickRay(a,void 0,this.navigation.currentCamera.viewMatrix,h,g);b||(b=c.create());c.subtract(g,h);c.normalize(g);var d=this.navigation.view.dataExtent;
a=Math.max(d.xmax-d.xmin,d.ymax-d.ymin,8*Math.max(d.xmax-d.xmin,d.ymax-d.ymin));var e=this.navigation.currentCamera,n=Math.max(0,d.xmin-e.eye[0],e.eye[0]-d.xmax),d=Math.max(0,d.ymin-e.eye[1],e.eye[1]-d.ymax),n=Math.sqrt(n*n+d*d),d="global"==this.navigation.view.viewingMode?k.Spherical.prototype.getAltitude(e.eye):k.Planar.prototype.getAltitude(e.eye),e=this.navigation._getTerrainElevationBelowCamera(e),e=a/Math.max(1,Math.pow(Math.max(0,Math.log(a/(Math.abs(d-e)+Number.MIN_VALUE))),2)),e=Math.max(e,
Math.min(n,a));c.scale(g,e);c.add(h,g,b)},pickInScreen:function(a,b){this.createPickRay(a,void 0,this.navigation.currentCamera.viewMatrix,h,g);b&&c.set(this.navigation.currentCamera.eye,h);return this.pickAlongRay(h,g,a,a,null,null,this.selector)},pickedIntersectionPoint:function(a,b){if(!a)return!1;b||(b=c.create());return a.getMinResult().getIntersectionPoint(b)}})})},"esri/views/3d/navigation/mixins/CamerasMixin":function(){define("../../../../core/Accessor ../../../../core/Evented ../../webgl-engine/lib/Camera ../../support/mathUtils ../../lib/glMatrix dojo/on".split(" "),
function(m,k,b,a,c,h){var g=c.vec4d.create();return m.createSubclass([k],{declaredClass:"esri.views.3d.navigation.mixins.CamerasMixin",properties:{targetCamera:{get:function(){return this.cameras.target}},currentCamera:{get:function(){return this.cameras.current}},windowSize:{set:function(a){var b=a[0],c=a[1],d=!1,g=this.cameras.target.x-this.cameras.target.padding[3],h=this.cameras.target.y-this.cameras.target.padding[2];if(this.cameras.target.width+g!==b||this.cameras.target.height+h!==c)this.cameras.target.width=
b-g,this.cameras.target.height=c-h,this.targetChanged(),d=!0;g=this.cameras.current.x-this.cameras.current.padding[3];h=this.cameras.current.y-this.cameras.current.padding[2];if(this.cameras.current.width+g!==b||this.cameras.current.height+h!==c)this.cameras.current.width=b-g,this.cameras.current.height=c-h,this.currentChanged(),d=!0;d&&this.currentHasReachedTarget()&&this.currentReachedTarget();this._set("windowSize",a)}},padding:{set:function(b){var c=!1,d=!1;g[0]=b.top;g[1]=b.right;g[2]=b.bottom;
g[3]=b.left;a.vectorEquals(this.cameras.current.padding,g)||(this.cameras.current.padding=g,d=!0);a.vectorEquals(this.cameras.target.padding,g)||(this.cameras.target.padding=g,c=!0);c&&this.targetChanged();d&&this.currentChanged();this.currentHasReachedTarget()&&(c||d)&&this.currentReachedTarget()}}},initialize:function(){var a=this.getInitialCamera();this.cameras={current:a,target:a.copy()}},currentHasReachedTarget:function(){return this.cameras.current.equals(this.cameras.target)},currentHasAlmostReachedTarget:function(){return this.cameras.current.almostEquals(this.cameras.target,
5E-4/this.renderUnitInMeters)},setCamera:function(a,b){this.pan&&this.pan.continuous&&this.pan.continuous.stop();this.pan&&this.pan.momentum&&(this.pan.momentum=null);this.cameras.target.copyFrom(a);var c=!(b&&b.internalUpdate)||!this._targetCameraChangedByElevationUpdate;c&&this._targetCameraBeforeElevationUpdate.copyFrom(a);this._targetCameraAnimated.copyFrom(this.cameras.target);this.applyConstraints(this._targetCameraAnimated,!0);a=!1;this.constrainTargetEyeByElevation()&&(a=!0);this.applyConstraints(this.cameras.target,
!0)&&(a=!0);this.fixTargetUpVector();this.currentHasReachedTarget()?(this.targetChanged(),a&&c&&(this._targetCameraChangedByElevationUpdate=!0),this.currentReachedTarget()):(void 0===b||void 0===b.animate||b.animate?this.targetAnimatedChanged(!1,b,!0):(this.targetAndCurrentChanged(!0),a=!0),a&&c&&(this._targetCameraChangedByElevationUpdate=!0),this._autoUpdateTiltConstraint())},getTargetCamera:function(){console.warn("[Navigation.getTargetCamera()] deprecated; use .targetCamera instead");return this.targetCamera},
getCurrentCamera:function(){console.warn("[Navigation.getCurrentCamera()] deprecated; use .currentCamera instead");return this.currentCamera},_cameraFromEyeCenterUp:function(a,b,c){var d=this.cameras.target.copy();d.eye=a;d.center=b;d.up=c;return d},setCameraFromEyeAndCenter:function(a,b,c){this.setCamera(this._cameraFromEyeCenterUp(a,b,this.cameras.target.up),c)},setCameraFromEyeCenterAndUp:function(a,b,c,f){this.setCamera(this._cameraFromEyeCenterUp(a,b,c),f)},_cameraEvents:{},_prepareCameraEvent:function(a,
c){var d=this._cameraEvents[a];d||(d={camera:new b},this._cameraEvents[a]=d);d.camera.copyFrom(c);return d},emitWithCamera:function(a,b){h.emit(this,a,this._prepareCameraEvent(a,b))},targetChanged:function(a){this.inherited(arguments);this.cameras.target.markViewDirty();var b=this._prepareCameraEvent("targetViewChanged",this.cameras.target);b.interruptedAnimation=!!a;b.finishedAnimation=!1;h.emit(this,"targetViewChanged",b)},targetAnimatedChanged:function(a,b,c){this.targetChanged(a);this.startAnimation(b,
c)},targetAndCurrentChanged:function(a){this.targetChanged(a);this.setCurrentToTarget(!1,a)},currentChanged:function(){this.inherited(arguments);this.cameras.current.markViewDirty();this.emitWithCamera("currentViewChanged",this.cameras.current)},currentReachedTarget:function(a,b){this.inherited(arguments);this.currentChanged();if(!(this.pan&&this.pan.continuous&&this.pan.continuous.active)){var c=this._prepareCameraEvent("currentViewReachedTarget",this.cameras.current);c.finishedAnimation=!!a;c.interruptedAnimation=
!!b;h.emit(this,"currentViewReachedTarget",c)}},setCurrentToTarget:function(a,b){this.cameras.current.copyFrom(this.cameras.target);this.currentReachedTarget(a,b)}})})},"esri/views/3d/navigation/spherical/ConstraintsSpherical":function(){define("../mixins/ConstraintsMixin ../../support/mathUtils ../../support/earthUtils ../../lib/glMatrix ../../constraints/SceneViewAltitudeConstraint ../../constraints/SceneViewTiltConstraint ../../webgl-engine/lib/Util".split(" "),function(m,k,b,a,c,h,g){var d=a.vec3d,
e=d.create();return m.createSubclass({declaredClass:"esri.views.3d.navigation.spherical.ConstraintsSpherical",defaultConstraints:{tilt:new m.Tilt({min:function(){return k.deg2rad(h.MAX_DEFAULT)},max:k.makePiecewiseLinearFunction([[4E3,k.deg2rad(h.MIN_DEFAULT)],[5E4,k.deg2rad(88)],[6E6,k.deg2rad(88)],[2E7,k.deg2rad(h.MAX_DEFAULT)]])}),altitude:new m.Altitude({min:function(){return c.MIN_DEFAULT},max:function(){return c.MAX_DEFAULT}}),collision:new m.Collision},initialize:function(){this.captainNemoAltitudeThreshold=
2E4;this.captainNemoElevationThreshold=-500},limitAltitude:function(a,c,g,h){d.scale(g,a/h,e);d.subtract(c,e,e);var f=this.renderCoordsHelper.getAltitude(e),l=this.constraints.altitude.apply(this,f);if(1E-6<Math.abs(f-l)){var k=d.length(c);c=d.dot(g,c)/(k*h);if(.9999<Math.abs(c))return a+(l-f);f=l+b.earthRadius;a=-2*k*c;k=a*a-4*(-(f*f)+k*k);if(0>k)return this.minPoiDist;k=Math.sqrt(k);return k<a?(a-k)/2:(k-a)/2}return a},limitTiltByAltitudeConstraints:function(a,c,e,g){c=d.length(c);var f=c*c,h=e*
e,l=Math.sqrt(f+h-2*c*e*Math.cos(Math.PI-a))-b.earthRadius,n=this.constraints.altitude.min(),m=this.constraints.altitude.max(),u;(void 0===g||0<g)&&l<n?u=n:(void 0===g||0>g)&&l>m&&(u=m);void 0!==u&&(a=u+b.earthRadius,a=Math.PI-k.acos((-(a*a)+f+h)/(2*c*e)));return a},distanceToSilhouette:function(a,c,e,g,h){h||(h={maxFarNearRatio:0,distance:0});a=d.dot(a.eye,a.eye);c=b.earthRadius*b.earthRadius;h.maxFarNearRatio=this.maxFarNearRatio;this.isNemoMode(a,g)?(g=b.earthRadius+g,h.distance=Math.sqrt(a-g*
g)):a>c?(h.maxFarNearRatio=k.clamp(2E4-(Math.log(Math.sqrt(a)-b.earthRadius)-7.983)/9.011*19E3,1E3,2E4),h.distance=Math.sqrt(a-c)):h.distance=this.maxFarNearRatio*this.minNearDistance;h.distance*=1.2;return h},isNemoMode:function(a,c){var d=b.earthRadius+this.captainNemoAltitudeThreshold;return a<d*d&&c<this.captainNemoElevationThreshold},intersectManifold:function(a,c,d,e){return g.raySphereClosestPositive(a,c,b.earthRadius+d,e)},getFallbackCenterAlongViewDirection:function(a,c,e){var f=d.dot(a,
a),g=b.earthRadius*b.earthRadius,f=f>g?Math.sqrt(f-g)/3:1;d.subtract(c,a,e);d.scale(e,f/d.length(e),e);d.add(e,a)}})})},"esri/views/3d/navigation/mixins/ConstraintsMixin":function(){define("../../../../core/Accessor ../../../../core/watchUtils ../../../../geometry/Point ../../support/mathUtils ../../lib/glMatrix ../../constraints/SceneViewAltitudeConstraint ../../webgl-engine/lib/Camera ../../webgl-engine/lib/IntervalUtilities ../../webgl-engine/lib/Selector".split(" "),function(m,k,b,a,c,h,g,d,e){function l(b){return new H.Tilt({min:function(){return.01},
max:function(){return a.deg2rad(b.tilt.max)}})}function f(a){return new H.Altitude({min:function(){return a.altitude.min},max:function(){return a.altitude.max}})}var n=c.vec3d,u=c.mat4d,t=new b,r=n.create(),w=n.create(),q=u.create(),x=n.create(),y=n.create(),z=n.create(),A=new g,C=n.create(),B={tilt:0,distance:0},D={distance:0,maxFarNearRatio:0},H=m.createSubclass([],{declaredClass:"esri.views.3d.navigation.mixins.ConstraintsMixin",properties:{userConstraints:{set:function(a){this._disconnectUserConstraints();
this._connectUserConstraints(a);this._set("userConstraints",a)}},elevationProvider:{value:null,set:function(a){null!==this._elevationChangeHandle&&(this._elevationChangeHandle.remove(),this._elevationChangeHandle=null);null!==this._elevationChangeTileHandle&&(this._elevationChangeTileHandle.remove(),this._elevationChangeTileHandle=null);null!==a&&(this._elevationChangeHandle=a.on("elevation-change",this._elevationChangeHandler.bind(this)),this._elevationChangeTileHandle=a.on("elevation-change-tile",
this._elevationChangeTileHandler.bind(this)));this._set("elevationProvider",a)}},minPoiDist:{get:function(){return this._minPoiDistInMeters/this.renderUnitInMeters},dependsOn:["renderUnitInMeters"]},cameraElevationMargin:{get:function(){return this._cameraElevationMarginInMeters/this.renderUnitInMeters},dependsOn:["renderUnitInMeters"]},minNearDistance:{get:function(){return this._minNearDistanceInMeters/this.renderUnitInMeters},dependsOn:["renderUnitInMeters"]},renderUnitInMeters:{},constraintsEnabled:{value:!0}},
constructor:function(){this._userConstraints=null;this._userConstraintsHandles=[];this._clipDistanceHandles=[];this._tiltHandles=[];this._altitudeHandles=[];this.constraints={tilt:this.defaultConstraints.tilt,altitude:this.defaultConstraints.altitude,collision:this.defaultConstraints.collision};this._tiltModeHandler=this._tiltModeHandler.bind(this);this._tiltMaxHandler=this._tiltMaxHandler.bind(this);this._altitudeModeHandler=this._altitudeModeHandler.bind(this);this._altitudeMinMaxHandler=this._altitudeMinMaxHandler.bind(this);
this._clipDistanceModeHandler=this._clipDistanceModeHandler.bind(this);this._clipDistanceNearFarHandler=this._clipDistanceNearFarHandler.bind(this);this._collisionEnabledHandler=this._collisionEnabledHandler.bind(this);this.enableElevationUpdates=!0;this.updateTargetByElevationUpdates=H.UPDATE_TARGET_BY_ELEVATION_UPDATES_DEFAULT;this._recomputeTargetEyeForElevationChange=this._recomputeTargetCenterForElevationChange=!1;this._elevationChangeTileHandle=this._elevationChangeHandle=null;this._autoAltitudeConstraints=
{min:h.MIN_DEFAULT,max:h.MAX_DEFAULT};this.maxFarNearRatio=2E4;this._minNearDistanceInMeters=2;this._minPoiDistInMeters=4;this._cameraElevationMarginInMeters=5;this._intersectTerrainSelector=new e;this._intersectTerrainSelector.enableInvisibleTerrain=!0},initialize:function(){this._targetCameraBeforeElevationUpdate=this.cameras.current.copy();this._targetCameraChangedByElevationUpdate=!1;this._sceneExtentChangeHandle=this.view.watch("dataExtent",function(a){this._dataExtentChanged()}.bind(this))},
_dataExtentChanged:function(){this.view.ready&&(this._updateAltitudeConstraintFromExtent(this.view.dataExtent),this._reapplyConstraints(),this._camerasChanged())},_updateAutoAltitudeConstraints:function(a){},updateRenderCoordsHelper:function(a,b){this.inherited(arguments);this._userConstraints&&"auto"!==this._userConstraints.altitude.mode||(this.constraints.altitude=H.Altitude.scale(this.defaultConstraints.altitude,a.unitInMeters));this._userConstraints&&"auto"!==this._userConstraints.tilt.mode||
(this.constraints.tilt=H.Tilt.scale(this.defaultConstraints.tilt,a.unitInMeters));this._updateAltitudeConstraintFromExtent(this.view.dataExtent);this._reapplyConstraints();this._camerasChanged()},_updateAltitudeConstraintFromExtent:function(a){0<a.xmax-a.xmin&&(this._updateAutoAltitudeConstraints(a),this._userConstraints&&"auto"!==this._userConstraints.altitude.mode||this._autoUpdateAltitudeConstraint())},destroy:function(){this._disconnectUserConstraints();this._sceneExtentChangeHandle.remove()},
_updateTargetCenterForElevation:function(a){this._recomputeTargetCenterForElevationChange=!1;if(a||this.enableElevationUpdates&&this.updateTargetByElevationUpdates)if(this._targetCameraChangedByElevationUpdate?a=this._targetCameraBeforeElevationUpdate:(a=this.cameras.target,this._targetCameraBeforeElevationUpdate.copyFrom(a)),(a=this.getCameraIntersectTerrain(a.eye,a.center,a.up,.02))&&!a.equals(this.cameras.target))return this.setCamera(a,{internalUpdate:!0}),this._targetCameraChangedByElevationUpdate=
!0;return!1},_updateTargetCenterForElevationWhenIdle:function(){var a=this.isAnimating,b=!1;if(!(this.pan&&this.pan.continuous&&this.pan.continuous.active||this.pan.active||this.zoom.active||this.rotate.active||a)&&this._recomputeTargetCenterForElevationChange){var c=this._targetCameraChangedByElevationUpdate;this._updateTargetCenterForElevation()&&(b=!0);this._targetCameraChangedByElevationUpdate=c}!a&&this._recomputeTargetEyeForElevationChange&&this._updateTargetEyeForElevationChange()&&(b=!0);
return b},step:function(){this._updateTargetCenterForElevationWhenIdle();this.inherited(arguments)},applyConstraints:function(a,b){if(!this.constraintsEnabled)return!1;var c=this._cameraElevationAngle(a,B),d=this.constraints.tilt.min(c.distance),e=this.constraints.tilt.max(c.distance),f=0;!b&&c.tilt>e?f=c.tilt-e:c.tilt<d&&(f=c.tilt-d);b=!1;.01<Math.abs(f)&&(n.cross(r,a.up,w),u.identity(q),u.rotate(q,f,w),u.multiplyVec3(q,r),n.add(a.center,r,a.eye),u.multiplyVec3(q,a.up),b=!0);n.subtract(a.center,
a.eye,x);f=a.distance;c=this.limitAltitude(f,a.center,x,f);f!==c&&(n.scale(x,-c/f),n.add(a.center,x,a.eye),b=!0);this._autoUpdateTiltConstraint(e);return b},limitTiltByConstraints:function(a,b,c,d){if(!this.constraintsEnabled)return a;var e=this.constraints.tilt.min(c),f=this.constraints.tilt.max(c);(void 0===d||0<d)&&a>=f?a=f:(void 0===d||0>d)&&a<=e&&(a=e);a=this.limitTiltByAltitudeConstraints(a,b,c,d);this._autoUpdateTiltConstraint(f);return a},_autoUpdateAltitudeConstraint:function(){var a=this._userConstraints&&
this._userConstraints.altitude;a&&"auto"===a.mode&&a.autoUpdate(this.constraints.altitude.min(this),this.constraints.altitude.max(this))},_autoUpdateTiltConstraint:function(b){var c=this._userConstraints&&this._userConstraints.tilt;void 0===b&&(b=this.constraints.tilt.max(this.cameras.target.distance));c&&"auto"===c.mode&&c.autoUpdate(a.rad2deg(b))},_disconnectUserConstraints:function(){if(this._userConstraints){this._userConstraintsHandles.forEach(function(a){a.remove()});this._userConstraints=null;
this._userConstraintsHandles.length=0;var a=this.renderUnitInMeters;this.constraints.tilt=H.Tilt.scale(this.defaultConstraints.tilt,a);this.constraints.altitude=H.Altitude.scale(this.defaultConstraints.altitude,a)}},_connectUserConstraints:function(a){a&&(this._userConstraints=a,this._userConstraintsHandles.push(k.init(a,"tilt.mode",this._tiltModeHandler),k.init(a,"clipDistance.mode",this._clipDistanceModeHandler),k.init(a,"altitude.mode",this._altitudeModeHandler),k.init(a,"collision.enabled",this._collisionEnabledHandler)))},
_camerasChanged:function(){var a=this._targetCameraChangedByElevationUpdate;this.targetChanged();this._targetCameraChangedByElevationUpdate=a;this.currentChanged();this.currentHasReachedTarget()&&this.currentReachedTarget()},_reapplyConstraints:function(){var a=!1;this.applyConstraints(this.cameras.current)&&(a=!0);this.applyConstraints(this.cameras.target)&&(a=!0);a&&this._camerasChanged()},_userConstraintsChanged:function(){this._reapplyConstraints()},_altitudeMinMaxHandler:function(a,b,c){this._userConstraintsChanged()},
_tiltMaxHandler:function(a,b,c){this._userConstraintsChanged()},_tiltModeHandler:function(a){this._tiltHandles.forEach(function(a){a.remove()});this._tiltHandles.length=0;"auto"===a?this.constraints.tilt=H.Tilt.scale(this.defaultConstraints.tilt,this.renderUnitInMeters):(this._tiltHandles.push(this._userConstraints.watch("tilt.max",this._tiltMaxHandler)),this.constraints.tilt=l(this._userConstraints));this._tiltMaxHandler()},_altitudeModeHandler:function(a){this._altitudeHandles.forEach(function(a){a.remove()});
this._altitudeHandles.length=0;"auto"===a?(this.constraints.altitude=H.Altitude.scale(this.defaultConstraints.altitude,this.renderUnitInMeters),this._autoUpdateAltitudeConstraint()):(this._altitudeHandles.push(this._userConstraints.watch("altitude.min",this._altitudeMinMaxHandler),this._userConstraints.watch("altitude.max",this._altitudeMinMaxHandler)),this.constraints.altitude=f(this._userConstraints));this._altitudeMinMaxHandler()},_collisionEnabledHandler:function(a,b,c){this.constraints.collision=
new H.Collision(this._userConstraints.collision.enabled);this._userConstraintsChanged()},_clipDistanceNearFarHandler:function(a,b,c){"auto"!==this._userConstraints.clipDistance.mode&&(this.cameras.target.near=this._userConstraints.clipDistance.near,this.cameras.target.far=this._userConstraints.clipDistance.far,this.cameras.current.near=this._userConstraints.clipDistance.near,this.cameras.current.far=this._userConstraints.clipDistance.far);this._camerasChanged()},_clipDistanceModeHandler:function(a){this._clipDistanceHandles.forEach(function(a){a.remove()});
this._clipDistanceHandles.length=0;"auto"!==a&&this._clipDistanceHandles.push(this._userConstraints.watch(["clipDistance.near","clipDistance.far"],this._clipDistanceNearFarHandler));this._clipDistanceNearFarHandler()},_updateAutoNearFar:function(a){var b=this._userConstraints&&this._userConstraints.clipDistance;if(!b||"auto"===b.mode){var c=this.renderUnitInMeters,d=this.distanceToSilhouette(a,this.view.dataExtent,c,this._getTerrainElevationBelowCamera(a),D);a.far=d.distance/c;a.far/d.maxFarNearRatio>
this.minNearDistance?a.near=a.far/d.maxFarNearRatio:(a.near=this.minNearDistance,a.far=a.near*d.maxFarNearRatio);b&&a===this.cameras.current&&b.autoUpdate(a.near,a.far)}},constrainTargetEyeByElevation:function(){var a=!1,b=this.elevationProvider;b&&b.spatialReference&&(a=this.cameras.target,b=this._getTerrainElevationBelowCamera(a),a=this._applyElevationConstraint(a.eye,b,this.cameraElevationMargin));return a},constrainTargetEyeByElevationAndMoveLookAt:function(){n.set(this.cameras.target.eye,z);
this.constrainTargetEyeByElevation()&&(n.subtract(z,this.cameras.target.eye),n.subtract(this.cameras.target.center,z))},targetChanged:function(a){this.inherited(arguments);this._targetCameraChangedByElevationUpdate=!1;this._updateAutoNearFar(this.cameras.target);this.currentHasReachedTarget()&&this.currentReachedTarget()},currentChanged:function(){this._updateAutoNearFar(this.cameras.current);this.inherited(arguments)},_applyElevationConstraint:function(a,b,c){if(!this.constraintsEnabled)return!1;
var d=this.renderCoordsHelper,e=d.getAltitude(a);return this.constraints.collision.enabled&&e-b<c?(d.setAltitude(b+c,a,0),!0):!1},_cameraElevationAngle:function(a,b){b=b||{tilt:0,distance:0};this.renderCoordsHelper.worldUpAtPosition(a.center,y);n.subtract(a.eye,a.center,r);a=n.length(r);var c=Math.acos(n.dot(r,y)/a/n.length(y));b.tilt=c;b.distance=a;return b},_elevationChangeTileHandler:function(a){if(this.enableElevationUpdates&&this._targetCameraChangedByElevationUpdate&&this.constraintsEnabled){var b=
!1,c=a.tile.extent;a=this.renderCoordsHelper.fromRenderCoords(this._targetCameraBeforeElevationUpdate.eye,t,a.spatialReference);c[0]<=a.x&&c[1]<=a.y&&c[2]>a.x&&c[3]>a.y&&(A.copyFrom(this.cameras.target),this.cameras.target.copyFrom(this._targetCameraBeforeElevationUpdate),this.constrainTargetEyeByElevation(),this.applyConstraints(this.cameras.target),b=!A.equals(this.cameras.target));b&&(this.isAnimating?this.targetChanged():this.targetAnimatedChanged(!1,{internalUpdate:!0}),this._targetCameraChangedByElevationUpdate=
!0)}},_elevationChangeHandler:function(a){var b=a.extent;a=a.spatialReference;var c=this.renderCoordsHelper.fromRenderCoords(this.cameras.target.eye,a);this._deferredUpdateTargetEyeForElevationChange(b,c,a);this._deferredUpdateTargetCenterForElevationChange(b,c,a)},_isPositionWithinExtent:function(a,b){return b[0]<=a.x&&b[1]<=a.y&&b[2]>a.x&&b[3]>a.y},_deferredUpdateTargetEyeForElevationChange:function(a,b){this.enableElevationUpdates&&this.constraintsEnabled&&this._isPositionWithinExtent(b,a)&&(this.isAnimating?
this._recomputeTargetEyeForElevationChange=!0:this._updateTargetEyeForElevationChange())},_updateTargetEyeForElevationChange:function(){this._recomputeTargetEyeForElevationChange=!1;var a=this.cameras.target;this._targetCameraChangedByElevationUpdate||this._targetCameraBeforeElevationUpdate.copyFrom(a);var b=this._getTerrainElevationBelowCamera(a);if(a=this._applyElevationConstraint(a.eye,b,this.cameraElevationMargin))this.isAnimating?this.targetChanged():this.targetAnimatedChanged(!1,{internalUpdate:!0}),
this._targetCameraChangedByElevationUpdate=!0;return a},_deferredUpdateTargetCenterForElevationChange:function(a,b,c){if(this.enableElevationUpdates&&!this._recomputeTargetCenterForElevationChange){var e=this.renderCoordsHelper.fromRenderCoords(this.cameras.target.center,c);c=Math.max(e.y,b.y);var f=Math.min(e.y,b.y);b=d.intersectIntervals([[Math.min(e.x,b.x),Math.max(e.x,b.x)]],[[a[0],a[2]]]);a=d.intersectIntervals([[f,c]],[[a[1],a[3]]]);0<b.length&&0<a.length&&(this._recomputeTargetCenterForElevationChange=
!0)}},_getTerrainElevationBelowCamera:function(a){var b=this.elevationProvider;return b&&b.spatialReference?(a=this.renderCoordsHelper.fromRenderCoords(a.eye,this.elevationProvider.spatialReference),this.elevationProvider.getElevation(a)||0):0},getCenterIntersectTerrain:function(a,b,c){c||(c=n.create());n.set(b,c);var d=this.picker.pickAlongRay(a,c,null,null,null,!1,this._intersectTerrainSelector);this.picker.pickedIntersectionPoint(d,c)||this.getCenterIntersectManifold(a,b,c)||this.getFallbackCenterAlongViewDirection(a,
b,c);return c},getCenterIntersectManifold:function(a,b,c){n.subtract(b,a,r);return this.intersectManifold(a,r,0,c)},getCameraIntersectTerrain:function(a,b,c,d){var e=this.cameras.current.copy();a&&(e.eye=a);b&&(e.center=b);c&&(e.up=c);this.getCenterIntersectTerrain(e.eye,e.center,C);n.dist2(e.eye,C)<this.minPoiDist&&this.constraintsEnabled&&(a=this.constraints.collision.enabled,n.set(e.viewForward,r),n.scale(r,this.minPoiDist),a?n.subtract(C,r,e.eye):n.add(e.eye,r,C),b=this.renderCoordsHelper,c=b.getAltitude(e.eye),
a&&c<this.cameraElevationMargin&&(n.subtract(C,e.eye,r),b.setAltitude(this.cameraElevationMargin,e.eye),n.add(e.eye,r,C)),e.markViewDirty());0<d?(a=n.dist(e.eye,e.center),n.dist(C,e.center)>a*d&&(e.center=C)):e.center=C;return e}});H.UPDATE_TARGET_BY_ELEVATION_UPDATES_DEFAULT=!0;H.Tilt=function(a){this.min=a.min;this.max=a.max};H.Tilt.scale=function(a,b){return 1===b?a:new H.Tilt({min:function(c){return a.min(c*b)},max:function(c){return a.max(c*b)}})};H.Tilt.prototype.apply=function(b,c){return a.clamp(b,
this.min(c),this.max(c))};H.Altitude=function(a){this.min=a.min;this.max=a.max};H.Altitude.scale=function(a,b){return 1===b?a:new H.Altitude({min:function(c){return a.min(c)/b},max:function(c){return a.max(c)/b}})};H.Altitude.prototype.apply=function(b,c){return a.clamp(c,this.min(b),this.max(b))};H.Collision=function(a){this.enabled=null!=a?a:!0};return H})},"esri/views/3d/navigation/spherical/AnimationSpherical":function(){define(["../mixins/AnimationMixin","../../lib/glMatrix","../../support/mathUtils"],
function(m,k,b){function a(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];a=b[3]-a[3];return c*c+d*d+e*e+a*a}function c(b,c){return Math.sqrt(a(b,c))}function h(a){this.interpolate=function(a,c,d){d=Math.min(9*d,.3);b.slerpOrLerp(a.center,c.center,d,a.center,1E-4);b.slerpOrLerp(a.eye,c.eye,d,a.eye,1E-4);b.slerp(a.up,c.up,d);a.fov=b.lerp(a.fov,c.fov,d);a.padding=e.lerp(a.padding,c.padding,d,l);a.computeUpOnSphere()}}function g(a,g,h){g=g||250;h=h||g;var f=0,k=0,n=0,q=0,m=function(b,c,d,e,f){return a.easeInOutInterpLinear(h,
g,b,c,d,e,f)},u=function(a,c,e,f){var l=d.dist(a,c);if(.1>l)return d.set(c,a),0;f=Math.min(f+h*e,Math.min(Math.sqrt(l*h),g));b.slerpOrLerp(a,c,Math.min(f/l*e,1),a,1E-4);return f};this.interpolate=function(a,d,g){f=u(a.eye,d.eye,g,f);k=u(a.center,d.center,g,k);q=u(a.padding,d.padding,g,q,{dist:c,lerp:function(a,b,c){return e.lerp(a,b,c,l)},set:function(b){a.padding=b}});n=m(a.fov,d.fov,g,n,{dist:function(a,b){return Math.abs(b-a)},lerp:b.lerp,set:function(b){a.fov=b}});a.computeUpOnSphere()}}var d=
k.vec3d,e=k.vec4d,l=e.create();return m.createSubclass({declaredClass:"esri.views.3d.navigation.spherical.AnimationSpherical",constructor:function(){this.interpolationTypes={linear:h,easeInOut:g}}})})},"esri/views/3d/navigation/mixins/AnimationMixin":function(){define(["../../../../core/Accessor","dojo/on","dojo/_base/lang","../../animation/pointToPoint/Animation","../../../animation/easing"],function(m,k,b,a,c){a=a.default;return m.createSubclass([],{declaredClass:"esri.views.3d.navigation.mixins.AnimationMixin",
properties:{interpolation:{set:function(a){if("string"===typeof a){var b=this.interpolationTypes[a];b?this._set("interpolation",new b(this)):console.error("[AnimationMixin] Invalid interpolation type "+a)}else this._set("interpolation",a)}},isAnimating:!1},initialize:function(){this._pointToPointAnimation=new a(this.view.viewingMode);this._targetCameraAnimated=this.cameras.current.copy();this.animationId=0},getDefaults:function(){return{interpolation:"linear"}},easeInOutInterpLinear:function(a,b,
c,e,l,f,k){var d=k.dist(c,e);if(d<.1/this.renderUnitInMeters)return k.set(e,c),0;f=Math.min(f+a*l,Math.min(Math.sqrt(d*a),b));k.set(k.lerp(c,e,Math.min(f/d*l,1)),c);return f},step:function(a){this.inherited(arguments);var b=this.currentHasReachedTarget();this._stepTimeAnimation(a/1E3,b);b&&this.pan.updateContinuous(a)},startAnimation:function(a,b){this.animationId++;this._startTimeAnimation(a,b);this.animationStarted()},_stepTimeAnimation:function(a,b){this.isAnimating&&(b?this.setCurrentToTarget(!0):
(b=this._pointToPointAnimation,b.step(a,this.cameras.current),b.finished?(this.isAnimating=!1,this._updateTargetCenterForElevationWhenIdle()||(this.isAnimating=!0,this.setCurrentToTarget(!0))):this.currentChanged()))},_startTimeAnimation:function(a,g){this.isAnimating=!0;var d={};a&&a.internalUpdate?(d.apex=null,d.duration=.3,d.easing=c.outExpo):d.apex={maximumDistance:this.view.constraints.altitude.max/6};a=b.mixin(d,"object"===typeof a?a:null);this._pointToPointAnimation.update(this.cameras.current,
g?this._targetCameraAnimated:this.cameras.target,a)},animationStarted:function(){k.emit(this,"animationStarted")},stop:function(){this.pan&&this.pan.continuous&&this.pan.continuous.stop();this.pan&&this.pan.momentum&&(this.pan.momentum=null);this.currentHasAlmostReachedTarget()?this.currentReachedTarget(!1,!0):(this.cameras.target.copyFrom(this.cameras.current),this.targetAndCurrentChanged(!0))},currentReachedTarget:function(){this.inherited(arguments);this.isAnimating=!1}})})},"esri/views/3d/animation/pointToPoint/Animation":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../animation/pointToPoint/Animation ./Camera ../../lib/glMatrix ../../webgl-engine/lib/Camera".split(" "),
function(m,k,b,a,c,h,g){var d=h.vec3d,e=d.create();m=function(){function b(b){this.animation=new a.Animation(function(){return new c.default(b)});this._current=new c.default(b)}Object.defineProperty(b.prototype,"finished",{get:function(){return this.currentTime>=this.animation.time},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"time",{get:function(){return this.animation.time},enumerable:!0,configurable:!0});b.prototype.update=function(a,b,c){var f=this.animation.definition.source,
g=this.animation.definition.target,h=d.subtract(b.center,a.center,e),l=d.length(h);1E-5<=l?(h[0]/=l,h[1]/=l,h[2]/=l):(h[0]=0,h[1]=1,h[0]=0);d.set(h,f.lookAtDirection);d.set(h,g.lookAtDirection);f.copyFromRenderCamera(a);g.copyFromRenderCamera(b);this._current.copyFrom(f);this.animation.update(f,g,c);this.currentTime=0};b.prototype.cameraAt=function(a,b){a=this.animation.cameraAt(a,this._current);b||(b=new g);a.copyToRenderCamera(b);return b};b.prototype.step=function(a,b){this.finished||(this.currentTime+=
a,this.currentTime>=this.time&&(this.currentTime=this.time));return this.cameraAt(this.currentTime/this.time,b)};return b}();k.Animation=m;Object.defineProperty(k,"__esModule",{value:!0});k.default=m})},"esri/views/animation/pointToPoint/Animation":function(){define("require exports ../easing ./Definition ./Settings ./apex/Path".split(" "),function(m,k,b,a,c,h){var g={zoom:0,pan:0,rotate:0};m=function(){function d(b){this.createCamera=b;this.time=0;this.definition=new a.Definition(b);this.path=new h.Path}
d.prototype.update=function(a,b,c){this.definition.update(a,b,c);this.path.update(this.definition,c);this.time=this._applyTimeSettings(this.path.time,c);this.settings=c};d.prototype.cameraAt=function(a,c){c||(c=this.createCamera());a=Math.min(Math.max(0,a),1);a=this.settings.easing?this.settings.easing(a,1E3*this.time):1<=this.time?b.inOutCoastQuad(a):b.outExpo(a);a=this.path.interpolateComponentsAt(a,g);c.interpolate(this.definition.source,this.definition.target,a);return c};d.prototype._applyTimeSettings=
function(a,b){var d=null!=b.speedFactor?b.speedFactor:1;null!=b.duration?a=b.duration:null!=b.speedFactor&&(a/=d);return a=Math.min(Math.max(null!=b.minDuration?b.minDuration:c.defaultSettings.minDuration/d,a),null!=b.maxDuration?b.maxDuration:c.defaultSettings.maxDuration/d)};return d}();k.Animation=m;Object.defineProperty(k,"__esModule",{value:!0});k.default=m})},"esri/views/animation/pointToPoint/Definition":function(){define(["require","exports","./Settings"],function(m,k,b){m=function(){function a(a){this.createCamera=
a;this.compared={sourceZoom:0,targetZoom:0,pan:0,rotate:0};this.settings={desiredScreenFlow:b.defaultSettings.desiredScreenFlow};this.source=a();this.target=a()}a.prototype.clone=function(){var b=new a(this.createCamera);b.copyFrom(this);return b};a.prototype.copyFrom=function(a){this.update(a.source,a.target,a.settings)};a.prototype.update=function(a,h,g){this.source!==a&&this.source.copyFrom(a);this.target!==h&&this.target.copyFrom(h);this.settings.desiredScreenFlow=null!=g.desiredScreenFlow?g.desiredScreenFlow:
b.defaultSettings.desiredScreenFlow;this.compared=this.source.compareTo(this.target,this.compared);this.desiredPixelFlow=this.settings.desiredScreenFlow*this.target.size;this.halfWindowSize=this.target.size/2};a.prototype.halfWindowPanAtZoom=function(a){a=this.target.pixelsPerPanAtZoom(a);return this.halfWindowSize/a};Object.defineProperty(a.prototype,"hasZoom",{get:function(){return 1E-5<Math.abs(this.compared.sourceZoom-this.compared.targetZoom)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"hasPan",{get:function(){return 1E-9<this.compared.pan},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasRotate",{get:function(){return 1E-9<this.compared.rotate},enumerable:!0,configurable:!0});return a}();k.Definition=m;Object.defineProperty(k,"__esModule",{value:!0});k.default=m})},"esri/views/animation/pointToPoint/Settings":function(){define(["require","exports"],function(m,k){k.defaultSettings={desiredScreenFlow:2,minDuration:.5,maxDuration:8}})},"esri/views/animation/pointToPoint/apex/Path":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../easing ../Path ../Segment ./planning".split(" "),
function(m,k,b,a,c,h,g){m=function(c){function d(a,b){var d=c.call(this)||this;d._preallocSegments=[new h.default,new h.default,new h.default];d.update(a,b);return d}b(d,c);d.prototype.update=function(a,b){if(a){this.definition?this.definition.copyFrom(a):this.definition=a.clone();var c=null;b&&b.apex&&(c=g.optimalDistance(a,b.apex));this.segments.length=0;this._descensionSegment=this._ascensionSegment=null;null==c?this._updateWithoutApex():this._updateWithApex(c,b.apex)}};d.prototype.segmentInterpolateComponentsAt=
function(b,c,d){d=b.interpolateComponentsAt(c,d);b===this._ascensionSegment?d.zoom=a.outQuad(d.zoom):b===this._descensionSegment&&(d.zoom=a.inQuad(d.zoom));return d};d.prototype._updateWithApex=function(a,b){var c=this._preallocSegments,d=c[0],e=c[1],c=c[2],f=null!=b.ascensionFactor?b.ascensionFactor:.5;b=Math.min(1-f,null!=b.ascensionFactor?b.descensionFactor:.5);var g=1-f-b;d.definition?d.definition.copyFrom(this.definition):d.definition=this.definition.clone();d.definition.compared.targetZoom=
a;d.definition.compared.pan=this.definition.compared.pan*f;d.definition.compared.rotate=this.definition.compared.rotate*f;d.update();this._ascensionSegment=d;this.segments.push(d);0<g&&(e.definition?e.definition.copyFrom(this.definition):e.definition=this.definition.clone(),e.definition.copyFrom(this.definition),e.definition.compared.sourceZoom=a,e.definition.compared.targetZoom=a,e.definition.compared.pan=this.definition.compared.pan*g,e.definition.compared.rotate=this.definition.compared.rotate*
g,e.update(),this.segments.push(e));c.definition?c.definition.copyFrom(this.definition):c.definition=this.definition.clone();c.definition.compared.sourceZoom=a;c.definition.compared.pan=this.definition.compared.pan*b;c.definition.compared.rotate=this.definition.compared.rotate*b;c.update();this._descensionSegment=c;this.segments.push(c)};d.prototype._updateWithoutApex=function(){var a=this._preallocSegments[0];a.update(this.definition);this.segments.push(a)};return d}(c.default);k.Path=m;Object.defineProperty(k,
"__esModule",{value:!0});k.default=m})},"esri/views/animation/pointToPoint/Path":function(){define(["require","exports"],function(m,k){m=function(){function b(){this.segments=[]}Object.defineProperty(b.prototype,"time",{get:function(){return this.segments.reduce(function(a,b){return a+b.time},0)},enumerable:!0,configurable:!0});b.prototype.interpolateComponentsAt=function(a,b){a=Math.min(Math.max(a,0),1);a*=this.time;for(var c=0,g=0,d=this.definition,e=0;e<this.segments.length;e++){var l=this.segments[e],
f=l.definition;if(a<=l.time||e===this.segments.length-1)return b=this.segmentInterpolateComponentsAt(l,a/l.time,b),b.pan=d.hasPan?(c+f.compared.pan*b.pan)/d.compared.pan:1,b.rotate=d.hasRotate?(g+f.compared.rotate*b.rotate)/d.compared.rotate:1,a=b.zoom*(f.compared.targetZoom-f.compared.sourceZoom)+f.compared.sourceZoom,c=this.segments[0].definition.compared.sourceZoom,g=this.segments[this.segments.length-1].definition.compared.targetZoom,b.zoom=d.hasZoom?(a-c)/(g-c):1,b;a-=l.time;c+=f.compared.pan;
g+=f.compared.rotate}};b.prototype.segmentInterpolateComponentsAt=function(a,b,h){return a.interpolateComponentsAt(b,h)};return b}();k.Path=m;Object.defineProperty(k,"__esModule",{value:!0});k.default=m})},"esri/views/animation/pointToPoint/Segment":function(){define(["require","exports"],function(m,k){m=function(){function b(a){a&&this.update(a)}b.prototype.update=function(a){a&&(this.definition?this.definition.copyFrom(a):this.definition=a.clone());this._updatePrecomputedVariables();this._updatePixelFlow()};
b.prototype._updatePrecomputedVariables=function(){var a=this.definition,b=a.compared,h=b.sourceZoom,g=b.targetZoom;this._sl=h>g?1:-1;this._panPixelsAtSource=b.pan*a.source.pixelsPerPanAtZoom(h);a=(a.source.pixelsPerRotateAtZoom(h)+a.target.pixelsPerRotateAtZoom(g))/2;this._rotatePixels=b.rotate*a};b.prototype._updatePixelFlow=function(){var a=this.definition.compared.sourceZoom,b=this.definition.compared.targetZoom,h=this.definition.hasZoom,g=this.definition.hasPan,d=this.definition.hasRotate,e,
l;e=g&&h?(b/a-1)/(-1/(this._sl*this.definition.halfWindowSize)*Math.LN2*this._panPixelsAtSource):0;l=h&&d?Math.log(a/b)/Math.LN2*this._sl*this.definition.halfWindowSize/this._rotatePixels:0;this._rotatePixelFlow=this._panPixelFlow=this._zoomPixelFlow=0;a=this.definition.desiredPixelFlow;h&&g&&d?(b=e+l+e*l,this._zoomPixelFlow=e*l/b*a,this._panPixelFlow=l/b*a,this._rotatePixelFlow=e/b*a):h&&g?(b=1+e,this._zoomPixelFlow=e/b*a,this._panPixelFlow=1/b*a):h&&d?(b=1+l,this._zoomPixelFlow=l/b*a,this._rotatePixelFlow=
1/b*a):g&&d?(e=this._panPixelsAtSource/this._rotatePixels,b=1+e,this._panPixelFlow=e/b*a,this._rotatePixelFlow=1/b*a):g?this._panPixelFlow=a:h?this._zoomPixelFlow=a:d&&(this._rotatePixelFlow=a);this.time=d?this.rotateTime:h?this.zoomTime:g?this.panTime:0};Object.defineProperty(b.prototype,"zoomTime",{get:function(){return this.definition.hasZoom?Math.log(this.definition.compared.sourceZoom/this.definition.compared.targetZoom)/Math.LN2*this._sl*this.definition.halfWindowSize/this._zoomPixelFlow:0},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"panTime",{get:function(){if(this.definition.hasPan){if(this.definition.hasZoom){var a=-1/(this._sl*this.definition.halfWindowSize)*Math.LN2;return Math.log(this._zoomPixelFlow/this._panPixelFlow*this._panPixelsAtSource*a+1)/(a*this._zoomPixelFlow)}return this._panPixelsAtSource/this._panPixelFlow}return 0},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"rotateTime",{get:function(){return this.definition.hasRotate?
this._rotatePixels/this._rotatePixelFlow:0},enumerable:!0,configurable:!0});b.prototype._interpolateComponentsZoom=function(a){if(this.definition.hasZoom){var b=this.definition.compared.sourceZoom,h=this.definition.compared.targetZoom;return(b*Math.pow(b/h,-a)-b)/(h-b)}return a};b.prototype._interpolateComponentsPan=function(a){if(this.definition.hasPan&&this.definition.hasZoom){var b=-1/(this._sl*this.definition.halfWindowSize)*this._zoomPixelFlow;return 1/this._panPixelsAtSource*this._panPixelFlow*
(Math.pow(2,b*a*this.time)-1)/(b*Math.LN2)}return a};b.prototype._interpolateComponentsRotate=function(a){return a};b.prototype.interpolateComponentsAt=function(a,b){a=Math.min(Math.max(a,0),1);var c=this._interpolateComponentsZoom(a),g=this._interpolateComponentsPan(a);a=this._interpolateComponentsRotate(a);b?(b.zoom=c,b.pan=g,b.rotate=a):b={zoom:c,pan:g,rotate:a};return b};return b}();k.Segment=m;Object.defineProperty(k,"__esModule",{value:!0});k.default=m})},"esri/views/animation/pointToPoint/apex/planning":function(){define(["require",
"exports","./functions"],function(m,k,b){function a(a,b){var c=Math.max(a.compared.sourceZoom,a.compared.targetZoom);a=a.source.zoomAtPixelsPerPan(a.desiredPixelFlow/a.compared.pan)/2;return a<c?null!=b.maximumDistance?c+(b.maximumDistance-c)/2:1.5*c:b.maximumDistance?Math.min(b.maximumDistance,a):a}k.optimalDistance=function(c,h){var g=a(c,h),d={ascensionFactor:null!=h.ascensionFactor?h.ascensionFactor:.5,descensionFactor:null!=h.descensionFactor?h.descensionFactor:.5},e=0===d.ascensionFactor,l=
0===d.descensionFactor,f=e?b.tAscensionZoomOnly:b.tAscensionZoomPan,k=e?b.dtAscensionZoomOnly:b.dtAscensionZoomPan,m=e?b.ddtAscensionZoomOnly:b.ddtAscensionZoomPan,t=l?b.tDescensionZoomOnly:b.tDescensionZoomPan,r=l?b.dtDescensionZoomOnly:b.dtDescensionZoomPan,w=l?b.ddtDescensionZoomOnly:b.ddtDescensionZoomPan,e=function(a){return f(c,d,a)+b.tPanion(c,d,a)+t(c,d,a)},l=function(a){return k(c,d,a)+b.dtPanion(c,d,a)+r(c,d,a)},q=function(a){return m(c,d,a)+b.ddtPanion(c,d,a)+w(c,d,a)},x=e(g),y=b.tBaseLine(c),
z=h.maximumIterations||20,A=null!=h.maximumDistance?h.maximumDistance:Infinity;for(h=0;h<z;h++){var C=(l(g)+1E-6)/q(g);if(isNaN(C)||g>=A&&0>C){if(!isFinite(A))return null;g=A;x=e(g);break}g-=C;if(g<c.compared.sourceZoom||g<c.compared.targetZoom)return null;C=e(g);if(.005>=Math.abs(C-x)/x)break;x=C}return x>.7*y?null:g<c.compared.sourceZoom||g<c.compared.targetZoom?null:g}})},"esri/views/animation/pointToPoint/apex/functions":function(){define(["require","exports"],function(m,k){k.tAscensionZoomPan=
function(b,a,c){var h=b.halfWindowPanAtZoom(c-b.compared.sourceZoom);return-b.halfWindowSize*(a.ascensionFactor*Math.LN2*b.compared.pan+h)*Math.log(b.compared.sourceZoom/c)/(b.desiredPixelFlow*Math.LN2*h)};k.dtAscensionZoomPan=function(b,a,c){var h=1/c,g=Math.log(b.compared.sourceZoom*h),d=1/b.desiredPixelFlow,e=1/Math.LN2;c-=b.compared.sourceZoom;var l=1/c;a=(a.ascensionFactor*Math.LN2*b.compared.pan+b.halfWindowPanAtZoom(c))/b.halfWindowPanAtZoom(1);return b.halfWindowSize*h*d*e*l*a-b.halfWindowSize*
g*d*e*l+b.halfWindowSize*g*d*e*a/(c*c)};k.ddtAscensionZoomPan=function(b,a,c){var h=c-b.compared.sourceZoom,g=1/h,d=1/c,e=Math.log(b.compared.sourceZoom*d);a=(a.ascensionFactor*Math.LN2*b.compared.pan+b.halfWindowPanAtZoom(h))/b.halfWindowPanAtZoom(1);return b.halfWindowSize*g*(-2*g*d*a+2*g*e+2*d-2*e*a/(h*h)-a/(c*c))/(b.desiredPixelFlow*Math.LN2)};k.tAscensionZoomOnly=function(b,a,c){return-b.halfWindowSize*Math.log(b.compared.sourceZoom/c)/(b.desiredPixelFlow*Math.LN2)};k.dtAscensionZoomOnly=function(b,
a,c){return b.halfWindowSize/(c*b.desiredPixelFlow*Math.LN2)};k.ddtAscensionZoomOnly=function(b,a,c){return-b.halfWindowSize/(c*c*b.desiredPixelFlow*Math.LN2)};k.tPanion=function(b,a,c){return-b.compared.pan*b.halfWindowSize*(a.ascensionFactor+a.descensionFactor-1)/(b.desiredPixelFlow*b.halfWindowPanAtZoom(c))};k.dtPanion=function(b,a,c){return b.compared.pan*b.halfWindowSize*(a.ascensionFactor+a.descensionFactor-1)/(b.desiredPixelFlow*b.halfWindowPanAtZoom(c*c))};k.ddtPanion=function(b,a,c){return-2*
b.compared.pan*b.halfWindowSize*(a.ascensionFactor+a.descensionFactor-1)/(b.desiredPixelFlow*b.halfWindowPanAtZoom(c*c*c))};k.tDescensionZoomPan=function(b,a,c){return b.halfWindowSize*(-b.halfWindowPanAtZoom(c)-a.descensionFactor*Math.LN2*b.compared.pan+b.halfWindowPanAtZoom(b.compared.targetZoom))*Math.log(c/b.compared.targetZoom)/(b.desiredPixelFlow*Math.LN2*b.halfWindowPanAtZoom(-c+b.compared.targetZoom))};k.dtDescensionZoomPan=function(b,a,c){var h=Math.log(c/b.compared.targetZoom),g=1/b.desiredPixelFlow,
d=1/Math.LN2,e=-c+b.compared.targetZoom,l=1/e;a=(-b.halfWindowPanAtZoom(c)-a.descensionFactor*Math.LN2*b.compared.pan+b.halfWindowPanAtZoom(b.compared.targetZoom))/b.halfWindowPanAtZoom(1);return-b.halfWindowSize*h*g*d*l+b.halfWindowSize*h*g*d*a/(e*e)+b.halfWindowSize*g*d*l*a/c};k.ddtDescensionZoomPan=function(b,a,c){var h=c-b.compared.targetZoom,g=1/h,d=1/c,e=Math.log(c/b.compared.targetZoom);a=(b.halfWindowPanAtZoom(c)+a.descensionFactor*Math.LN2*b.compared.pan-b.halfWindowPanAtZoom(b.compared.targetZoom))/
b.halfWindowPanAtZoom(1);return b.halfWindowSize*g*(-2*g*d*a-2*g*e+2*d+2*e*a/(h*h)-a/(c*c))/(b.desiredPixelFlow*Math.LN2)};k.tDescensionZoomOnly=function(b,a,c){return b.halfWindowSize*Math.log(c/b.compared.targetZoom)/(b.desiredPixelFlow*Math.LN2)};k.dtDescensionZoomOnly=function(b,a,c){return b.halfWindowSize/(c*b.desiredPixelFlow*Math.LN2)};k.ddtDescensionZoomOnly=function(b,a,c){return-b.halfWindowSize/(c*c*b.desiredPixelFlow*Math.LN2)};k.tBaseLine=function(b){var a=Math.LN2*b.compared.pan,c=
b.halfWindowPanAtZoom(b.compared.sourceZoom-b.compared.targetZoom),h=b.halfWindowSize*Math.log(b.compared.sourceZoom/b.compared.targetZoom)/(b.desiredPixelFlow*Math.LN2*c);return b.compared.sourceZoom<=b.compared.targetZoom?h*(a-c):h*(a+c)}})},"esri/views/3d/animation/pointToPoint/Camera":function(){define(["require","exports","../../lib/glMatrix","../../support/mathUtils"],function(m,k,b,a){var c=a.angle,h=a.lerp,g=a.slerpOrLerp,d=b.vec3d,e=b.mat3d,l=d.create(),f=d.create(),n=d.create(),u=d.create(),
t=d.create(),r=d.createFrom(0,0,1),w=d.createFrom(0,1,0),q=d.createFrom(1,0,0),x=e.create();m=function(){function a(a){void 0===a&&(a="global");this.viewingMode=a;this.center=d.create();this.distance=this.yaw=this.pitch=0;this.lookAtDirection=d.create(w)}a.prototype.pixelsPerPanAtZoom=function(a){return this.size/2/(this._zoomToPanScale*a)};a.prototype.zoomAtPixelsPerPan=function(a){return this.size/2/(this._zoomToPanScale*a)};a.prototype.pixelsPerRotateAtZoom=function(a){return this.size/2/Math.max(Math.cos(Math.abs(this.pitch)),
.5)};a.prototype.compareTo=function(a,b){b||(b={pan:0,rotate:0,sourceZoom:0,targetZoom:0});if("global"===this.viewingMode){var e=d.length(this.center),f=d.length(a.center),e=(e+f)/2;b.pan=c(this.center,a.center)*e}else b.pan=d.dist(this.center,a.center);e=Math.abs(a.yaw-this.yaw);e>=Math.PI&&(e=2*Math.PI-e);b.rotate=Math.max(e,Math.abs(a.pitch-this.pitch));b.sourceZoom=this.distance;b.targetZoom=a.distance;return b};a.prototype.interpolate=function(a,b,c){"global"===this.viewingMode?g(a.center,b.center,
c.pan,this.center,y):d.lerp(a.center,b.center,c.pan,this.center);this.distance=h(a.distance,b.distance,c.zoom);this.pitch=h(a.pitch,b.pitch,c.rotate);a=a.yaw;b=b.yaw;Math.abs(b-a)>=Math.PI&&(a+=2*(a<b?1:-1)*Math.PI);this.yaw=h(a,b,c.rotate)};a.prototype.copyFrom=function(a){d.set(a.center,this.center);this.pitch=a.pitch;this.yaw=a.yaw;this.distance=a.distance;d.set(a.lookAtDirection,this.lookAtDirection);this.size=a.size;this.copyFromCommon(a);this.viewingMode=a.viewingMode};a.prototype.copyFromRenderCamera=
function(a){var b=this._lookAtOrientation(a.center,x);d.set(a.center,this.center);e.multiplyVec3(b,d.subtract(a.center,a.eye,u));e.multiplyVec3(b,a.up,t);this.distance=d.length(u);u[0]/=this.distance;u[1]/=this.distance;u[2]/=this.distance;this.pitch=this._eyeUpToPitch(u,t);this.yaw=this._eyeUpToYaw(u,t);this.size=Math.sqrt(a.width*a.width+a.height*a.height);this.copyFromCommon(a)};a.prototype.copyFromCommon=function(a){this.fov=a.fov;this._zoomToPanScale=Math.atan(.5*this.fov)};a.prototype.copyToRenderCamera=
function(a){var b=this._lookAtOrientation(this.center,x);e.transpose(b);this._axisAngleVec3(q,this.pitch-Math.PI/2,w,u);this._axisAngleVec3(r,this.yaw,u);this._axisAngleVec3(q,this.pitch-Math.PI/2,r,t);this._axisAngleVec3(r,this.yaw,t);d.scale(u,this.distance);e.multiplyVec3(b,u);e.multiplyVec3(b,t);a.center=this.center;a.eye=d.subtract(this.center,u,u);a.up=t};a.prototype._axisAngleVec3=function(a,b,c,e){void 0===e&&(e=c);var g=Math.cos(b);b=Math.sin(b);d.scale(c,g,l);d.scale(d.cross(a,c,f),b);d.scale(a,
(1-g)*d.dot(a,c),n);return d.add(d.add(l,f,e),n,e)};a.prototype._lookAtOrientation=function(a,b){this._upAtLookAt(a,n);d.normalize(d.cross(this.lookAtDirection,n,l));0===l[0]&&0===l[1]&&0===l[2]&&d.set(q,l);d.normalize(d.cross(n,l,f));b||(b=e.create());b[0]=l[0];b[1]=f[0];b[2]=n[0];b[3]=l[1];b[4]=f[1];b[5]=n[1];b[6]=l[2];b[7]=f[2];b[8]=n[2];return b};a.prototype._upAtLookAt=function(a,b){return"local"===this.viewingMode?d.set(r,b):d.normalize(a,b)};a.prototype._eyeUpToPitch=function(a,b){return Math.PI-
c(r,a)};a.prototype._eyeUpToYaw=function(a,b){return c(q,d.normalize(d.cross(.5>Math.abs(b[2])?b:a,r,f)),r)};return a}();var y=1E-4;Object.defineProperty(k,"__esModule",{value:!0});k.default=m})},"esri/views/3d/navigation/spherical/actions/PanSpherical":function(){define("./ActionSpherical ../../mixins/PanMixin ../../../lib/glMatrix ../../../support/earthUtils ../../../support/mathUtils ../../../webgl-engine/lib/Util ../../ContinuousAction ../../NavigationConstants ../../../webgl-engine/lib/Camera ./Momentum".split(" "),
function(m,k,b,a,c,h,g,d,e,l){var f=b.vec2d,n=b.vec3d,u=b.vec4d,t=b.mat4d,r=n.create(),w=n.create(),q=n.create(),x=n.create(),y=n.create(),z=n.create(),A=t.create(),C=d.Pan.Mode,B=d.Pan.Direction,D=d.Pan.Vertical;return m.createSubclass([k],{declaredClass:"esri.views.3d.navigation.spherical.actions.PanSpherical",constructor:function(){this._panMode=0;this._plane=u.create();this.momentum=null;this._momentumEstimator=new l.ScreenspaceMomentumEstimator(.05,500,12,.82);this._momentumDirection=n.create();
this.momentumEnabled=!0;this._momentumInitialCamera=new e;this.continuous=new g},begin:function(b,c){this.inherited(arguments);this._momentumEstimator.reset();this.pickPointInScreen(b,this._navPickPoint)?this._navSphereRadius=n.length(this._navPickPoint):(this._navSphereRadius=n.length(this.targetCamera.center),this._navSphereRadius<.9*a.earthRadius&&(this._navSphereRadius=a.earthRadius),this.createPickRay(b,b,this.currentCamera.viewMatrix,r,w),n.subtract(w,this.currentCamera.eye),this.intersectManifold(this.currentCamera.eye,
w,this._navSphereRadius-a.earthRadius,this._navPickPoint)||this.closestPointOnSphereSilhouette(this.currentCamera.eye,r,this._navSphereRadius,this._navPickPoint));var d=!1;this.renderCoordsHelper.getAltitude(this.currentCamera.eye)<D.ELEVATION_THRESHOLD&&(this._navSphereRadius>n.length(this.currentCamera.eye)?d=!0:(n.normalize(n.subtract(this.targetCamera.eye,this._navPickPoint,q)),d=Math.abs(.5*Math.PI-Math.acos(n.dot(this._navPickPoint,q)/n.length(this._navPickPoint)))<D.ANGLE_THRESHOLD));d?(this._panMode=
C.VERTICAL,n.normalize(n.subtract(this.targetCamera.eye,this.targetCamera.center,q)),this.updatePlane(this._navPickPoint,q)):(this._panMode=C.HORIZONTAL,d=void 0===c?h.performance.now():c,this._momentumEstimator.add(b[0],b[1],this._navPickPoint,.001*d));f.set(b,this._dragLastPoint);f.set(b,this._dragBeginPoint);this._mouseDownCamera.copyFrom(this.targetCamera)},update:function(b,c){if(this._panMode===C.HORIZONTAL){if(0>=this._navSphereRadius)return;this.createPickRay(b,this._dragBeginPoint,this._mouseDownCamera.viewMatrix,
r,w);n.subtract(w,this._mouseDownCamera.eye);this.intersectManifold(this._mouseDownCamera.eye,w,this._navSphereRadius-a.earthRadius,this._targetOnSphere)||this.closestPointOnSphereSilhouette(this._mouseDownCamera.eye,r,this._navSphereRadius,this._targetOnSphere);this.rotateCameraWithPointsOnSphere(this._navPickPoint,this._targetOnSphere,this._mouseDownCamera,this.targetCamera,this._navSphereRadius);var d=void 0===c?h.performance.now():c;this._momentumEstimator.add(b[0],b[1],this._targetOnSphere,.001*
d)}else{this.createPickRay(this._dragLastPoint,this._dragBeginPoint,this.currentCamera.viewMatrix,r,w);n.subtract(w,r);if(!h.rayPlane(r,w,this._plane,x))return;this.createPickRay(b,this._dragBeginPoint,this.currentCamera.viewMatrix,r,w);n.subtract(w,r);if(!h.rayPlane(r,w,this._plane,y))return;n.subtract(y,x);n.subtract(this.targetCamera.eye,y);n.subtract(this.targetCamera.center,y);f.set(b,this._dragLastPoint)}this.constrainTargetEyeByElevationAndMoveLookAt();f.set(b,this._dragLastPoint);this.fixTargetUpVector();
this.targetAndCurrentChanged();this.inherited(arguments)},end:function(a,b){this._panMode===C.HORIZONTAL&&this._initiateMomentumPanning(a,b);this._navSphereRadius=0;this.inherited(arguments)},_initiateMomentumPanning:function(a,b){if(0>=this._navSphereRadius)return this.setPoiAuto(a,!0),!1;this.update(a,b);this.momentumEnabled&&(this.momentum=this._momentumEstimator.evaluateMomentum());if(this.momentum)return this._momentumInitialVelocity=this.rotationFromPointsOnSphere(this.momentum.dataOldest,this.momentum.dataNewest,
this._navSphereRadius,this._momentumDirection)/this.momentum.dataTimeDelta,this._momentumElapsed=0,this._momentumInitialCamera.copyFrom(this.currentCamera),this.animationStarted(),!0;this.currentReachedTarget();return!1},beginContinuous:function(a){var b=0===this.continuous.status;this.momentum=null;b&&(this.navigation.begin(this),this.active=!0,this.emit("begin"));this.inherited(arguments);this.setCurrentToTarget();b&&n.set3(0,0,0,this.continuous.direction);this.continuous.status&a||(this.continuous.status|=
a,a&(B.LEFT|B.RIGHT|B.FORWARD|B.BACKWARD)?(this._computePanAxis(a,z),n.add(this.continuous.direction,z)):(b=this.continuous.status&(B.UP|B.DOWN),this.continuous.radiusChange=b===B.UP?1:b===B.DOWN?-1:0),this.continuous.velocity=this._computePanVelocity());this.continuous.timer=0},updateContinuous:function(a){if(this.continuous){var b=0,c=null,d=!1;if(this.momentum)this._momentumElapsed+=.001*a,b=this.momentum.valueFromInitialVelocity(this._momentumInitialVelocity,this._momentumElapsed),c=this._momentumDirection,
t.identity(A),t.rotate(A,b,c),t.multiplyVec3(A,this._momentumInitialCamera.eye,this.targetCamera.eye),t.multiplyVec3(A,this._momentumInitialCamera.center,this.targetCamera.center),t.multiplyVec3(A,this._momentumInitialCamera.up,this.targetCamera.up),this.applyConstraints(this.targetCamera),this.constrainTargetEyeByElevationAndMoveLookAt(),this.fixTargetUpVector(),this.momentum.isFinished(this._momentumElapsed)?(this.momentum=null,this.targetAndCurrentChanged(!0)):this.targetAndCurrentChanged();else{var b=
this.continuous.step(a),c=this.continuous.direction,d=.01<n.dot(this.continuous.direction,this.continuous.direction),e=this.targetCamera;if(0<Math.abs(this.continuous.radiusChange)){a=1+b*this.continuous.radiusChange;var f=e.viewForward,e=n.normalize(e.center,w);(-.999<n.dot(f,e)||0>this.continuous.radiusChange)&&n.scale(this.targetCamera.center,a);n.scale(this.targetCamera.eye,a);this.continuous.velocity=this._computePanVelocity();d||(this.applyConstraints(this.targetCamera),this.constrainTargetEyeByElevationAndMoveLookAt(),
this.fixTargetUpVector(),this.targetAndCurrentChanged())}}d&&(t.identity(A),t.rotate(A,b,c),t.multiplyVec3(A,this.targetCamera.eye),t.multiplyVec3(A,this.targetCamera.center),t.multiplyVec3(A,this.targetCamera.up),this.applyConstraints(this.targetCamera),this.constrainTargetEyeByElevationAndMoveLookAt(),this.fixTargetUpVector(),this.targetAndCurrentChanged());this.emit("update")}},endContinuous:function(a){this.continuous.status&=~a;this.momentum=null;if(0===this.continuous.status)this.continuous.stop(),
this.continuous.radiusChange=0,this.active=!1,this.emit("end"),this.navigation.end(this);else if(a&(B.LEFT|B.RIGHT|B.FORWARD|B.BACKWARD))this._computePanAxis(a,z),n.subtract(this.continuous.direction,z),.01>n.length(this.continuous.direction)&&n.set3(0,0,0,this.continuous.direction);else{var b=this.continuous.status&(B.UP|B.DOWN);this.continuous.radiusChange=b==B.UP?1:b==B.DOWN?-1:0}this.inherited(arguments)},_computePanAxis:function(a,b){n.subtract(this.targetCamera.center,this.targetCamera.eye,
b);n.cross(b,this.targetCamera.up);if(a===B.LEFT||a===B.RIGHT)n.normalize(b),n.cross(b,this.targetCamera.center);a!==B.RIGHT&&a!==B.FORWARD||n.negate(b);n.normalize(b)},_computePanVelocity:function(){var b=.5*Math.abs(n.length(this.targetCamera.eye)-a.earthRadius),b=c.clamp(b,1,2*a.earthRadius);return c.acos(1-b*b/(2*a.earthRadius*a.earthRadius))},updatePlane:function(a,b){u.set4(b[0],b[1],b[2],-n.dot(b,a),this._plane)}})})},"esri/views/3d/navigation/spherical/actions/ActionSpherical":function(){define(["../../Action",
"../../../support/mathUtils","../../../lib/glMatrix"],function(m,k,b){var a=b.vec3d,c=b.mat4d,h=a.create(),g=c.create();return m.createSubclass({declaredClass:"esri.views.3d.navigation.spherical.actions.ActionSpherical",constructor:function(){this._targetOnSphere=a.create();this._navSphereRadius=0},closestPointOnSphereSilhouette:function(b,e,l,f){a.cross(b,e,h);a.cross(h,b,f);a.scale(f,1/a.length(f)*l);b=-k.asin(l/a.length(b));c.identity(g);c.rotate(g,b,h);c.multiplyVec3(g,f)},rotateCameraWithPointsOnSphere:function(a,
b,c,f,g){return this.navigation.rotateCameraWithPointsOnSphere(a,b,c,f,g)},rotationFromPointsOnSphere:function(a,b,c,f){return this.navigation.rotationFromPointsOnSphere(a,b,c,f)}})})},"esri/views/3d/navigation/Action":function(){define(["../../../core/Accessor","../../../core/Evented","../webgl-engine/lib/Camera","../lib/glMatrix","dojo/on"],function(m,k,b,a,c){var h=a.vec3d,g=a.vec2d;return m.createSubclass([k],{properties:{type:{},navigation:{},picker:{readOnly:!0,aliasOf:"navigation.picker"},
currentCamera:{aliasOf:"navigation.currentCamera"},targetCamera:{aliasOf:"navigation.targetCamera"},constraints:{readOnly:!0,aliasOf:"navigation.constraints"},renderCoordsHelper:{readOnly:!0,aliasOf:"navigation.renderCoordsHelper"},minPoiDist:{readOnly:!0,aliasOf:"navigation.minPoiDist"}},constructor:function(){this._tmpEvent={type:null,phase:null,x:void 0,y:void 0};this._mouseDownCamera=new b;this._navPickPoint=h.create();this._dragLastPoint=g.create();this._dragBeginPoint=g.create();this.active=
!1},initialize:function(){var a=this;["minPoiDist","renderCoordsHelper","constraints","picker"].forEach(function(b){this.navigation.watch(b,function(){a.notifyChange(b)})}.bind(this))},emit:function(a,b,g){this._tmpEvent.type=this.type;this._tmpEvent.phase=a;this._tmpEvent.x=b;this._tmpEvent.y=g;c.emit(this,a,this._tmpEvent);c.emit(this.navigation,this.type,this._tmpEvent)},intersectManifold:function(a,b,c,f){return this.navigation.intersectManifold(a,b,c,f)},fixTargetUpVector:function(){return this.navigation.fixTargetUpVector()},
setPoiAuto:function(a,b){return this.navigation.setPoiAuto(a,b)},normalizeCoordinate:function(a,b){b[0]=a[0]/this.currentCamera.width;b[1]=a[1]/this.currentCamera.height},worldUpAtPosition:function(a,b){return this.renderCoordsHelper.worldUpAtPosition(a,b)},applyConstraints:function(a,b){return this.navigation.applyConstraints(a,b)},constrainTargetEyeByElevation:function(a){return this.navigation.constrainTargetEyeByElevation(a)},constrainTargetEyeByElevationAndMoveLookAt:function(){return this.navigation.constrainTargetEyeByElevationAndMoveLookAt()},
targetAndCurrentChanged:function(a){return this.navigation.targetAndCurrentChanged(a)},targetAnimatedChanged:function(a,b){return this.navigation.targetAnimatedChanged(a,b)},currentReachedTarget:function(a){return this.navigation.currentReachedTarget(a)},setCurrentToTarget:function(){return this.navigation.setCurrentToTarget()},animationStarted:function(){return this.navigation.animationStarted()},limitAltitude:function(a,b,c,f){return this.navigation.limitAltitude(a,b,c,f)},limitTiltByConstraints:function(a,
b,c,f){return this.navigation.limitTiltByConstraints(a,b,c,f)},createPickRay:function(a,b,c,f,g){return this.picker.createPickRay(a,b,c,f,g)},pickAlongRay:function(a,b,c,f,g,h){return this.picker.pickAlongRay(a,b,c,f,g,h)},pickPointInScreen:function(a,b){return this.picker.pickPointInScreen(a,b)},pickFreePointInScreen:function(a,b){return this.picker.pickFreePointInScreen(a,b)},pickInScreen:function(a){return this.picker.pickInScreen(a)}})})},"esri/views/3d/navigation/mixins/PanMixin":function(){define(["../../../../core/declare"],
function(m){return m([],{declaredClass:"esri.views.3d.navigation.mixins.PanMixin",type:"pan",begin:function(k){this.navigation.begin(this);this.active=!0;this.emit("begin")},update:function(k){this.emit("update")},end:function(k){this.active=!1;this.emit("end");this.navigation.end(this)},beginContinuous:function(k){},updateContinuous:function(k){},endContinuous:function(k){}})})},"esri/views/3d/navigation/ContinuousAction":function(){define(["../../../core/Accessor","../lib/glMatrix"],function(m,
k){var b=k.vec3d;return m.createSubclass({properties:{active:{get:function(){return 0!==this.velocity},dependsOn:["velocity"],readOnly:!0},velocity:{}},constructor:function(){this.direction=b.create();this.status=this.timer=this.velocity=0},stop:function(){this.status=this.velocity=this.timer=0;b.set3(0,0,0,this.direction)},step:function(a){var b;a*=.001;0<this.timer?(a=Math.min(a,this.timer),b=this.velocity*a*(1-a/(2*this.timer)),this.velocity*=1-a/this.timer,this.timer-=a):b=this.velocity*a;return b}})})},
"esri/views/3d/navigation/spherical/actions/Momentum":function(){define(["require","exports","../../../../navigation/Momentum"],function(m,k,b){k.ScreenspaceMomentumEstimator=b.ScreenspaceMomentumEstimator;k.ScreenspaceMomentum=b.ScreenspaceMomentum})},"esri/views/3d/navigation/spherical/actions/ZoomSpherical":function(){define(["./ActionSpherical","../../mixins/ZoomMixin","../../../lib/glMatrix","../../../support/earthUtils"],function(m,k,b,a){var c=b.vec2d,h=b.vec3d,g=b.mat4d,d=h.create(),e=h.create(),
l=h.create(),f=g.create(),n=h.create(),u=h.create();return m.createSubclass([k],{declaredClass:"esri.views.3d.navigation.spherical.actions.ZoomSpherical",constructor:function(){},begin:function(b){this.inherited(arguments);this.pickPointInScreen(b,this._navPickPoint)?this._navSphereRadius=h.length(this._navPickPoint):(this._navSphereRadius=h.length(this.targetCamera.center),this._navSphereRadius<.9*a.earthRadius&&(this._navSphereRadius=a.earthRadius),this.createPickRay(b,b,this.currentCamera.viewMatrix,
d,e),h.subtract(e,this.currentCamera.eye),this.intersectManifold(this.currentCamera.eye,e,this._navSphereRadius-a.earthUtils,this._navPickPoint)||(this._navSphereRadius=0));this._mouseDownCamera.copyFrom(this.targetCamera)},update:function(b){var k=this.targetCamera;k.eye=this._mouseDownCamera.eye;k.center=this._mouseDownCamera.center;k.up=this._mouseDownCamera.up;h.subtract(k.center,k.eye,l);var n=h.length(l);this.normalizeCoordinate(b,d);var q=12*(d[1]-this.normalizedAnchorPoint[1]);b=n*Math.pow(2,
q);0>q&&b<this.navigation.minPoiDist&&(b=this.navigation.minPoiDist);b=this.limitAltitude(b,k.center,l,n,0>q?-1:1);1E-6>Math.abs(n-b)||(0<this._navSphereRadius&&b<n&&(q=1-(1-b/n)*(1-this._navSphereRadius/h.length(k.center)),h.scale(k.center,q)),h.scale(l,-b/n),h.add(k.center,l,k.eye),n=!1,0<this._navSphereRadius&&(g.lookAt(k.eye,k.center,k.up,f),this.createPickRay(this._dragBeginPoint,this._dragBeginPoint,f,d,e),h.normalize(h.subtract(e,k.eye)),this.intersectManifold(k.eye,e,this._navSphereRadius-
a.earthRadius,this._targetOnSphere)||(this.closestPointOnSphereSilhouette(k.eye,d,this._navSphereRadius,this._targetOnSphere),n=!0),this.rotateCameraWithPointsOnSphere(this._navPickPoint,this._targetOnSphere,k,k,this._navSphereRadius),this.fixTargetUpVector()),this.applyConstraints(k),this.constrainTargetEyeByElevation(),this.targetAndCurrentChanged(),c.set(this._dragBeginPoint,this._dragLastPoint),n&&(g.lookAt(k.eye,k.center,k.up,f),this._dragLastPoint=this.currentCamera.projectPoint(this._navPickPoint,
f)),k=this._toYDownCoord(this._dragLastPoint),this.emit("update",k[0],k[1]))},stepAtPoint:function(b,c,l,k){h.set(c,u);c=h.length(u);h.subtract(this.targetCamera.eye,this.targetCamera.center,n);var q=h.length(n),m=q*b,m=(b=1>=b)&&m<this.minPoiDist?this.minPoiDist:this.limitAltitude(m,u,n,-q,b?-1:1);b=m/q;1E-6>Math.abs(q-m)||(k&&(q=h.length(this.targetCamera.center),h.scale(this.targetCamera.center,(c+b*(q-c))/q)),h.scale(n,b),h.add(this.targetCamera.center,n,this.targetCamera.eye),k&&l&&(g.lookAt(this.targetCamera.eye,
this.targetCamera.center,this.targetCamera.up,f),this.createPickRay(l,l,f,d,e),h.normalize(h.subtract(e,this.targetCamera.eye)),this.intersectManifold(this.targetCamera.eye,e,c-a.earthRadius,this._targetOnSphere)?this.rotateCameraWithPointsOnSphere(u,this._targetOnSphere,this.targetCamera,this.targetCamera,c):k=!1),this.applyConstraints(this.targetCamera),this.constrainTargetEyeByElevation(),k&&this.fixTargetUpVector(),this.navigation.currentHasAlmostReachedTarget()?this.targetAndCurrentChanged():
this.targetAnimatedChanged(!1,{internalUpdate:!0}))}})})},"esri/views/3d/navigation/mixins/ZoomMixin":function(){define(["../../../../core/declare","../../lib/glMatrix"],function(m,k){var b=k.vec2d,a=k.vec3d,c=a.create();return m([],{declaredClass:"esri.views.3d.navigation.mixins.ZoomMixin",type:"zoom",constructor:function(){this.normalizedAnchorPoint=b.create();this._lastStepAnimationId=-1},begin:function(a){this.navigation.begin(this);b.set(a,this._dragBeginPoint);this.normalizeCoordinate(a,this.normalizedAnchorPoint);
a=this._toYDownCoord(this._dragBeginPoint);this.active=!0;this.emit("begin",a[0],a[1])},update:function(a){},end:function(a){this.active=!1;a=this._toYDownCoord(this._dragBeginPoint);this.emit("end",a[0],a[1]);this.navigation.end(this)},stepScreen:function(b,g){this.active||(a.set(this.currentCamera.center,c),0<b&&(this.pickPointInScreen(g,c)||"local"!==this.navigation.view.viewingMode||this.pickFreePointInScreen(g,c)),this.step(Math.pow(.6,b),c,g))},step:function(b,c,d){if(!this.active){this.navigation.begin(this);
this.navigation.currentHasAlmostReachedTarget()||this.navigation.animationId===this._lastStepAnimationId?this.targetCamera.copyFrom(this.currentCamera):this.navigation.stop();var e=1E-6<a.dist(c,this.targetCamera.center);this.stepAtPoint(b,c,d,e);this._lastStepAnimationId=this.navigation.animationId;this.navigation.end(this)}},stepAtPoint:function(a,b,c,e){},_toYDownCoord:function(a){return[a[0],this.currentCamera.height-a[1]]}})})},"esri/views/3d/navigation/spherical/actions/RotateSpherical":function(){define(["./ActionSpherical",
"../../mixins/RotateMixin"],function(m,k){return m.createSubclass([k],{declaredClass:"esri.views.3d.navigation.spherical.actions.RotateSpherical"})})},"esri/views/3d/navigation/mixins/RotateMixin":function(){define(["../../../../core/declare","../../lib/glMatrix","../../support/mathUtils","../NavigationConstants"],function(m,k,b,a){var c=k.vec2d,h=k.vec3d,g=k.mat4d,d=h.create(),e=h.create(),l=c.create(),f=g.create(),n=h.create(),u=[3,1.5],t=a.Rotate.PivotPoint;return m([],{declaredClass:"esri.views.3d.navigation.mixins.RotateMixin",
type:"rotate",constructor:function(){this._rotLastPoint=c.create()},begin:function(a,b){void 0===b&&(b=t.POI);this.navigation.begin(this);this.active=!0;this.emit("begin");this.setPoiAuto(a);this.normalizeCoordinate(a,this._rotLastPoint)},update:function(a,b){void 0===b&&(b=t.POI);var c,d;switch(b){case t.EYE:c=this.targetCamera.center;d=this.targetCamera.eye;break;default:c=this.targetCamera.eye,d=this.targetCamera.center,b!==t.POI&&console.error("[RotateMixin.update]: invalid pivot specified")}this._applyRotation(a,
b,c,d);this.constrainTargetEyeByElevation();this.fixTargetUpVector();this.targetAndCurrentChanged();this.emit("update")},_applyRotation:function(a,k,q,m){this.renderCoordsHelper.worldUpAtPosition(m,d);this.normalizeCoordinate(a,l);a=(l[1]-this._rotLastPoint[1])*u[k-1];var x=(l[0]-this._rotLastPoint[0])*u[k-1];h.subtract(q,m,e);var r=h.length(e),w=b.acos(h.dot(e,d)/r);k===t.POI?a=this.limitTiltByConstraints(w+a,m,r)-w:(w=.5*Math.PI-w,r=.495*Math.PI,a=w-Math.max(-r,Math.min(r,w+-.5*a)));g.identity(f);
h.cross(this.targetCamera.up,e,n);k==t.POI&&(x=-x);g.rotate(f,x,d);g.rotate(f,a,n);g.multiplyVec3(f,e);h.add(m,e,q);g.multiplyVec3(f,this.targetCamera.up);c.set(l,this._rotLastPoint)},end:function(a){this.active=!1;this.emit("end");this.navigation.end(this)}})})},"esri/views/3d/navigation/planar/NavigationPlanar":function(){define("../Navigation ./ConstraintsPlanar ./AnimationPlanar ./actions/PanPlanar ./actions/RotatePlanar ./actions/ZoomPlanar ../../webgl-engine/lib/Camera ../../lib/glMatrix".split(" "),
function(m,k,b,a,c,h,g,d){var e=d.vec3d,l=e.create(),f=e.create(),n=e.create(),u=e.create();return m.createSubclass([k,b],{declaredClass:"esri.views.3d.navigation.planar.NavigationPlanar",initialize:function(){this.pan=new a({navigation:this});this.zoom=new h({navigation:this});this.rotate=new c({navigation:this})},getInitialCamera:function(){return new g(e.createFrom(0,0,100),e.createFrom(0,0,0),e.createFrom(0,1,0))},fixTargetUpVector:function(){var a=this.renderCoordsHelper.worldUp,b=this.cameras.target;
e.direction(b.center,b.eye,u);var c=e.dot(u,a);.9999>=Math.abs(c)&&(e.scale(u,c,u),e.subtract(a,u,b.up),e.normalize(b.up))},setPoiAuto:function(a,b){a=this.picker.pickAlongRay(this.cameras.target.eye,this.cameras.target.center,null,a);if(a.getMinResult().getIntersectionPoint(l)&&a.getMaxResult().getIntersectionPoint(f)){var c=5/this.renderUnitInMeters;b=a.getMinResult().dist-c;var c=a.getMaxResult().dist+c,d=e.dist(this.cameras.target.eye,this.cameras.target.center);if(d<=b||d>=c){if(a.getMinResult().object){a.getMaxResult().dist=
void 0;a.intersectObject(a.getMinResult().object);if(void 0===a.getMaxResult().dist){console.error("[NavigationPlanar.setPoiAuto] Did not obtain maximum intersection distance");return}a.getMaxResult().getIntersectionPoint(f);e.lerp(l,f,.5,n)}else e.set(l,n);this.setCameraFromEyeAndCenter(this.cameras.target.eye,n,{animate:!1})}}}})})},"esri/views/3d/navigation/planar/ConstraintsPlanar":function(){define("../mixins/ConstraintsMixin ../../support/mathUtils ../../support/earthUtils ../../support/RenderCoordsHelper ../../constraints/SceneViewTiltConstraint ../../lib/glMatrix ../../webgl-engine/lib/Util ../../../../geometry/support/scaleUtils".split(" "),
function(m,k,b,a,c,h,g,d){var e=h.vec3d,l=h.vec4d,f=l.create(),n=e.create(),u=e.create();return m.createSubclass({declaredClass:"esri.views.3d.navigation.planar.ConstraintsPlanar",defaultConstraints:{tilt:new m.Tilt({min:function(){return k.deg2rad(c.MAX_DEFAULT)},max:k.makePiecewiseLinearFunction([[4E3,k.deg2rad(c.MIN_DEFAULT)],[1E4,k.deg2rad(88)],[6E6,k.deg2rad(88)]])}),altitude:new m.Altitude({min:function(a){return a._autoAltitudeConstraints.min},max:function(a){return a._autoAltitudeConstraints.max}}),
collision:new m.Collision},_updateAutoAltitudeConstraints:function(a){var b=Math.max(a.xmax-a.xmin,a.ymax-a.ymin);a.hasZ&&(b=Math.max(b,a.zmax-a.zmin));b=3*b/Math.atan((this._targetCameraBeforeElevationUpdate||this.targetCamera)._fov/2);a=d.getUnitValueForSR(a.spatialReference);this._autoAltitudeConstraints.min=0;this._autoAltitudeConstraints.max=b*a},limitAltitude:function(a,b,c,d){return this.constraints.altitude.apply(this,a)},limitTiltByAltitudeConstraints:function(a,b,c,d){return a},distanceToSilhouette:function(c,
d,f,g,h){h||(h={maxFarNearRatio:0,distance:0});h.maxFarNearRatio=this.maxFarNearRatio;var l=a.Planar.prototype.getAltitude(c.eye),q=l*=f;g=l-g;var m=this.elevationProvider?this.elevationProvider.getElevationBounds():null;m&&(l=0<=g?q-f*m[0]:f*m[1]-q);q=Math.max(d.xmax-d.xmin,d.ymax-d.ymin,8*Math.max(d.xmax-d.xmin,d.ymax-d.ymin));e.subtract(c.center,c.eye,u);n[0]=0<u[0]?d.xmax:d.xmin;n[1]=0<u[1]?d.ymax:d.ymin;n[2]=0<u[2]?q/2:-q/2;e.subtract(n,c.eye);e.normalize(u);c=1.1*e.dot(n,u)*f;m=l+b.earthRadius;
m=Math.sqrt(m*m-b.earthRadius*b.earthRadius);d=Math.max(d.xmax-d.xmin,d.ymax-d.ymin);var x=1E-4*d*f;f=k.clamp((l-x)/(.001*d*f-x),0,1);h.distance=k.lerp(m,c,f*f*f);h.maxFarNearRatio=2E4;h.distance*=Math.max(Math.log(Math.abs(g)),1);h.distance=Math.min(h.distance,Math.max(34064E4,q));return h},intersectManifold:function(a,b,c,d){var h=this.renderCoordsHelper.worldUp;l.set4(h[0],h[1],h[2],c,f);return!g.rayPlane(a,b,f,d)||0>e.dot(e.subtract(d,a,n),b)?!1:!0},getFallbackCenterAlongViewDirection:function(a,
b,c){e.set(b,c)}})})},"esri/views/3d/navigation/planar/AnimationPlanar":function(){define(["../mixins/AnimationMixin","../../lib/glMatrix","../../support/mathUtils"],function(m,k,b){function a(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];a=b[3]-a[3];return c*c+d*d+e*e+a*a}function c(b,c){return Math.sqrt(a(b,c))}function h(a){this.interpolate=function(a,c,f){f=Math.min(5*f,.3);d.lerp(a.eye,c.eye,f);d.lerp(a.center,c.center,f);d.lerp(a.up,c.up,f);a.fov=b.lerp(a.fov,c.fov,f);a.padding=e.lerp(a.padding,
c.padding,f,l)}}function g(a,g,h){g=g||250;h=h||g;var f=0,k=0,n=0,q=0,m=0,y=function(b,c,d,e,f){return a.easeInOutInterpLinear(h,g,b,c,d,e,f)};this.interpolate=function(a,g,h){f=y(a.eye,g.eye,h,f,d);k=y(a.center,g.center,h,k,d);n=y(a.up,g.up,h,n,d);m=y(a.padding,g.padding,h,m,{dist:c,lerp:function(a,b,c){return e.lerp(a,b,c,l)},set:function(b){a.padding=b}});q=y(a.fov,g.fov,h,q,{dist:function(a,b){return Math.abs(b-a)},lerp:b.lerp,set:function(b){a.fov=b}})}}var d=k.vec3d,e=k.vec4d,l=e.create();return m.createSubclass({declaredClass:"esri.views.3d.navigation.planar.AnimationPlanar",
constructor:function(){this.interpolationTypes={linear:h,easeInOut:g}}})})},"esri/views/3d/navigation/planar/actions/PanPlanar":function(){define(["./ActionPlanar","../../mixins/PanMixin","../../../lib/glMatrix","../../../webgl-engine/lib/Util"],function(m,k,b,a){var c=b.vec2d,h=b.vec3d,g=h.create(),d=h.create(),e=h.create(),l=h.create(),f=h.create(),n=h.create(),u=Math.PI/9,t=h.create(),r=h.create();return m.createSubclass([k],{declaredClass:"esri.views.3d.navigation.planar.actions.PanPlanar",begin:function(a){this.inherited(arguments);
this.pickPointInScreen(a,g)||this.pickFreePointInScreen(a,g);h.normalize(h.subtract(this.targetCamera.eye,this.targetCamera.center,d));this.renderCoordsHelper.worldUpAtPosition(a,n);var b=h.dot(d,n);0>b&&(h.negate(d),b=-b);var f=Math.asin(b);f>=u?h.set(n,d):(h.subtract(d,h.scale(n,b,e)),h.normalize(d),f>u&&(h.lerp(d,n,(f-u)/(u-u)),h.normalize(d)));this.updatePlane(g,d);c.set(a,this._dragLastPoint);c.set(a,this._dragBeginPoint)},update:function(a){this._intersectPanPlane(this._dragLastPoint,this._dragBeginPoint,
t)&&this._intersectPanPlane(a,this._dragBeginPoint,r)&&(h.subtract(r,t),h.subtract(this.targetCamera.eye,r),h.subtract(this.targetCamera.center,r),c.set(a,this._dragLastPoint),this.constrainTargetEyeByElevationAndMoveLookAt(),this.targetAndCurrentChanged())},_intersectPanPlane:function(b,c,d){this.createPickRay(b,c,this.currentCamera.viewMatrix,l,f);h.subtract(f,l);return a.rayPlane(l,f,this._plane,d)},end:function(a){this.setPoiAuto(a,!0);this._navSphereRadius=0;this.inherited(arguments)}})})},"esri/views/3d/navigation/planar/actions/ActionPlanar":function(){define(["../../Action",
"../../../lib/glMatrix"],function(m,k){var b=k.vec3d,a=k.vec4d;return m.createSubclass({declaredClass:"esri.views.3d.navigation.planar.actions.ActionPlanar",constructor:function(){this._plane=a.create()},updatePlane:function(c,h){a.set4(h[0],h[1],h[2],-b.dot(h,c),this._plane)}})})},"esri/views/3d/navigation/planar/actions/RotatePlanar":function(){define(["./ActionPlanar","../../mixins/RotateMixin"],function(m,k){return m.createSubclass([k],{declaredClass:"esri.views.3d.navigation.planar.actions.RotatePlanar"})})},
"esri/views/3d/navigation/planar/actions/ZoomPlanar":function(){define(["./ActionPlanar","../../mixins/ZoomMixin","../../../lib/glMatrix","../../../webgl-engine/lib/Util"],function(m,k,b,a){var c=b.vec2d,h=b.vec3d,g=h.create(),d=h.create(),e=h.create(),l=h.create(),f=h.create(),n=h.create();return m.createSubclass([k],{declaredClass:"esri.views.3d.navigation.planar.actions.ZoomPlanar",begin:function(a){this.inherited(arguments);this.pickPointInScreen(a,f)||this.pickFreePointInScreen(a,f);h.normalize(h.subtract(this.targetCamera.eye,
this.targetCamera.center,l));0>l[1]&&h.negate(l);this.updatePlane(f,l)},update:function(b){h.set(this.targetCamera.center,n);this.createPickRay(this._dragBeginPoint,this._dragBeginPoint,this.currentCamera.viewMatrix,g,d);h.subtract(d,g);a.rayPlane(g,d,this._plane,n);this.normalizeCoordinate(b,g);b=4*(this.normalizedAnchorPoint[1]-g[1]);c.set(g,this.normalizedAnchorPoint);this._applyZoom(n,b);b=this._toYDownCoord(this._dragLastPoint);this.emit("update",b[0],b[1])},_applyZoom:function(a,b){h.subtract(a,
this.targetCamera.eye,e);var c=h.length(e),d=c*(1-b);0<=b&&d<this.minPoiDist&&(d=this.minPoiDist);d=this.limitAltitude(d,a,e,c,0<=b?-1:1);1E-6>Math.abs(c-d)||(b=-(d-c)/c,h.scale(e,b),h.add(this.targetCamera.eye,e),h.lerp(this.targetCamera.center,a,b),this.fixTargetUpVector(),this.targetAndCurrentChanged())},stepAtPoint:function(a,b,c,d){h.set(b,n);h.subtract(n,this.targetCamera.eye,e);b=h.length(e);c=b*a;(a=1>=a)&&c<this.minPoiDist&&(c=this.minPoiDist);c=this.limitAltitude(c,n,e,b,a?-1:1);a=c/b;1E-6<=
Math.abs(b-c)&&(h.scale(e,c/b),h.subtract(n,e,this.targetCamera.eye),h.lerp(this.targetCamera.center,n,1-a),this.constrainTargetEyeByElevation(),this.fixTargetUpVector(),this.targetAnimatedChanged(!1,{internalUpdate:!0}))}})})},"esri/views/3d/support/Frustum":function(){define(["../../../core/declare","../lib/glMatrix","../support/earthUtils","../webgl-engine/lib/Util"],function(m,k,b,a){var c=k.vec3d,h=k.vec4d;return m([],{constructor:function(){this.planes=Array(6);this.points=Array(8);this.lines=
Array(12);this.origin=c.create();this.direction=c.create();this.dirty=!1;this._altitude=null;for(var a=0;6>a;a++)this.planes[a]=h.create();for(a=0;8>a;a++)this.points[a]=c.create();for(a=0;12>a;a++)this.lines[a]={origin:null,direction:c.create(),endpoint:null}},_makeLine:function(a,b,e){a.origin=b;a.endpoint=e;c.direction(e,b,a.direction)},update:function(b){if(this.dirty){a.matrix2frustumPlanes(b.viewMatrix,b.projectionMatrix,this.points,this.planes);for(var d=0;4>d;d++){var e=d,g=d+4;this._makeLine(this.lines[d],
this.points[e],this.points[g]);this._makeLine(this.lines[d+4],this.points[e],3===d?this.points[0]:this.points[e+1]);this._makeLine(this.lines[d+8],this.points[g],3===d?this.points[4]:this.points[g+1])}c.set(b.eye,this.origin);c.set(b.viewForward,this.direction);this._altitude=null;this.dirty=!1}},altitude:function(){return null!=this._altitude?this._altitude:this._altitude=c.length(this.origin)-b.earthRadius}})})},"esri/views/ui/3d/DefaultUI3D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../DefaultUI dojo/_base/lang".split(" "),
function(m,k,b,a,c,h,g){m=function(a){function c(){return a.call(this)||this}b(c,a);c.prototype.getDefaults=function(){return g.mixin(this.inherited(arguments),{components:["attribution","zoom","navigation-toggle","compass"]})};return c}(c.declared(h));return m=a([c.subclass("esri.views.ui.3d.DefaultUI3D")],m)})},"esri/layers/graphics/controllers/I3SOnDemandController":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper dojo/promise/all ../../../views/3d/support/ResourceController ../../../core/sql/WhereClause ../../../views/3d/layers/i3s/I3SNodeLoader ../../../views/3d/layers/i3s/I3SIndexTraversal ../../../views/3d/layers/i3s/I3SUtil ../../../views/3d/layers/i3s/I3SLodHandling ../../../views/3d/layers/i3s/I3SViewportQueries ../../../layers/SceneLayer ../../../layers/IntegratedMeshLayer ../../../core/accessorSupport/decorators ../../../core/Accessor ../../../core/Evented ../../../core/Promise ../../../core/Logger ../../../core/watchUtils ../../../core/HandleRegistry ../../../views/3d/support/PromiseLightweight ../../../views/3d/support/projectionUtils ../../../views/3d/lib/glMatrix".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f,n,u,t,r,w,q,x,y,z,A,C,B,D){function H(a,b){for(var c=0;c<a.length;c++)if(a[c].name===b)return[c,a[c]];return[-1,void 0]}var K=D.vec3d,E=y.getLogger("esri.layers.SceneService");m=function(a){function k(b){var c=a.call(this)||this;c.nodeIndex={};c.screenSizeFactor=0;c.updating=!1;c.updatingPercentage=0;c._lodFactorProperty=null;c._isIdle=!1;c._numNodesLoading=0;c._progressMaxNumNodes=1;c._animFrameFunctionQueue=[[],[]];c._requiredAttributesDirty=!0;c._updatesDisabled=
!1;c._restartNodeLoading=!1;c._handles=new A;c._bundleLoadedCallback=function(a,b,d,e,f,g,h,l){c._lodHandling.lodSwapBundleLoaded(a,b,l);c.layerViewRequiredFunctions.addBundle(a,b,d,e,f,g,h);null!=c.layerViewOptionalFunctions.setPolygonOffset&&(b=c._lodHandling.shouldSetPolygonOffset(a))&&c.layerViewOptionalFunctions.setPolygonOffset(a,b)};return c}b(k,a);Object.defineProperty(k.prototype,"isMeshPyramid",{get:function(){return"mesh-pyramids"===this.layer.profile||"MeshPyramid"===this.layer.store.lodType},
enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"streamDataSupplier",{get:function(){return this.layerView.view.resourceController.registerClient(this.layerView,h.ClientType.SCENE,{addUrlToken:this.addUrlToken,trackRequests:!0})},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"parsedDefinitionExpression",{get:function(){if(this.layer&&this.layer.definitionExpression)try{var a=g.create(this.layer.definitionExpression);return a.isStandardized()?a:(E.error("definitionExpression is using non standard function"),
null)}catch(N){return E.error("Failed to parse definitionExpression: "+N),null}else return null},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"definitionExpressionFields",{get:function(){if(this.parsedDefinitionExpression){var a=this.parsedDefinitionExpression.getFields();return l.findFieldsCaseInsensitive(a,this.layer.fields)}return null},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"crsVertex",{get:function(){return l.getVertexCrs(this.layer)},enumerable:!0,
configurable:!0});Object.defineProperty(k.prototype,"crsIndex",{get:function(){return l.getIndexCrs(this.layer)},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"rootNodeVisible",{get:function(){var a=this._rootNodeId&&this.nodeIndex[this._rootNodeId];return a&&this._viewportQueries?this._viewportQueries.isNodeVisible(a):!0},enumerable:!0,configurable:!0});k.prototype.initialize=function(){var a=this;this.updateEventListener={needsUpdate:function(){return a._needsAnimationFrameHandler()},
idleFrame:function(b){return a._animationFrameHandler(b)},idleBegin:function(){a._startNodeLoading();a._updateIdleState(!0)},idleEnd:function(){a.cancelNodeLoading();a._updateIdleState(!1)}};this.updateEventListenerWhileSuspended={idleBegin:function(){return a._startNodeLoadingWhileSuspended()}};this._lodHandling=new f(this.layerViewRequiredFunctions,this.layerViewOptionalFunctions,function(){return a._evaluateUpdatingState()});this.layerView._controller=this;var b=this.layer;this._defaultGeometrySchema=
b.store.defaultGeometrySchema;this._fields=b.fields;this._attributeStorageInfo=b.attributeStorageInfo;this._rootNodeUrl=b.store.rootNode;b=this._rootNodeUrl.split("/");this._rootNodeId=b[b.length-1];this.layer instanceof u?"mesh"===this.layer.geometryType?this._lodFactorProperty="qualitySettings.sceneService.3dObject.lodFactor":"point"===this.layer.geometryType&&(this._lodFactorProperty="qualitySettings.sceneService.point.lodFactor"):this.layer instanceof t&&(this._lodFactorProperty="qualitySettings.sceneService.integratedMesh.lodFactor");
b=c([this.layer,this.layerView]).then(function(){if(!a.destroyed&&a.layerView&&!a.layerView.destroyed){a.setClippingArea(a.layerView.view.clippingArea);var b=a.layerView.view.resourceController,c=!1;a._handles.add(z.init(a.layerView,"suspended",function(d){null!=a.layerView.setVisibility&&a.layerView.setVisibility(!d);c&&b.deregisterIdleFrameWorker(a);d?b.registerIdleFrameWorker(a,a.updateEventListenerWhileSuspended):b.registerIdleFrameWorker(a,a.updateEventListener);c=!0}),"layerview");a._lodFactorProperty&&
a._handles.add(a.layerView.view.watch(a._lodFactorProperty,function(){return a._qualityChanged()}),"quality")}});this.addResolvingPromise(b)};k.prototype.destroy=function(){this.layerView.view.resourceController.deregisterIdleFrameWorker(this);this.layerView.view.resourceController.deregisterClient(this.layerView);this._handles.destroy();this._nodeLoader=null};k.prototype._modifyNumNodesLoading=function(a){this._numNodesLoading+=a};k.prototype._getRequiredAttributes=function(){if(null==this._attributeStorageInfo||
!this._fields)return[];var a=Object.create(null);this.layer.renderer&&this.layer.renderer.collectRequiredFields(a);this.layer.labelsVisible&&this.layer.labelingInfo&&this.layer.labelingInfo.forEach(function(b){b._collectRequiredFields(a)});if(null!=this.definitionExpressionFields)for(var b=0,c=this.definitionExpressionFields;b<c.length;b++)a[c[b]]=!0;var d=this._attributeStorageInfo,e=this._fields;return Object.keys(a).map(function(a){var b=H(d,a)[0],c=H(e,a)[1];return{index:b,name:a,field:c,attributeStorageInfo:d[b]}}).filter(function(a){return-1!==
a.index&&null!=a.field})};k.prototype._requiredFieldsChange=function(){this._requiredAttributesDirty=!0;this.restartNodeLoading()};k.prototype._labelingChanged=function(){var a=this._getRequiredAttributes();a.length===this._requiredAttributes.length&&this._requiredAttributes.every(function(b){return-1!==H(a,b.name)[0]})||this._requiredFieldsChange()};k.prototype.setClippingArea=function(a){var b=[];B.extentToBoundingBox(a,b,this.layerView.view.renderSpatialReference)?this._clippingArea=b:this._clippingArea=
null};k.prototype._qualityChanged=function(){this.restartNodeLoading()};k.prototype.updateClippingArea=function(a){this.setClippingArea(a);this.restartNodeLoading()};k.prototype.queueAnimationFrameFunctionCall=function(a,b,c,d,e){null!=this._nodeLoader&&(this._animFrameFunctionQueue[e||0].push({fct:a,that:b,args:c,cancelFunc:d}),this._evaluateUpdatingState())};k.prototype.getBaseUrl=function(){return l.addTrailingSlash(this.layer.parsedUrl.path)};k.prototype.updateElevationChanged=function(a,b,c){l.findIntersectingNodes(a,
b,this.nodeIndex.root,this.crsIndex,this.nodeIndex,c);for(a=0;a<c.length;a++)b=c.data[a],b.computedMbs&&(b.computedMbs[3]=-1);c.length&&this.restartNodeLoading()};k.prototype.restartNodeLoading=function(){this._restartNodeLoading=!0;this._evaluateUpdatingState()};k.prototype._needsAnimationFrameHandler=function(){return!0};k.prototype._animationFrameHandler=function(a){this._restartNodeLoading&&(this.cancelNodeLoading(),this._startNodeLoading());if(null!=this._nodeLoader){for(var b;0<this._animFrameFunctionQueue[0].length&&
!a.done();)b=this._animFrameFunctionQueue[0].shift(),b.fct.apply(b.that,b.args);b=5-this._numNodesLoading;for(null!=this._indexLoader&&0<b&&this._indexLoader.continueTraversal(b);0<this._animFrameFunctionQueue[1].length&&!a.done();)b=this._animFrameFunctionQueue[1].shift(),b.fct.apply(b.that,b.args);this._evaluateUpdatingState();this._lodHandling.lodGlobalHandling()}};k.prototype._evaluateUpdatingState=function(){var a=null!=this._indexLoader?this._indexLoader.getQueueSize()+3*this._numNodesLoading:
0,b=!(!(0<a||this._indexLoader&&this._indexLoader.isLoading()||this._nodeLoader&&this._nodeLoader.isLoadingAttributes||this._restartNodeLoading||0<this._animFrameFunctionQueue[0].length||0<this._animFrameFunctionQueue[1].length||this._lodHandling&&this._lodHandling.requiresLODGlobalHandling)&&this._isIdle);0===a&&(this._progressMaxNumNodes=1);this._progressMaxNumNodes=Math.max(a,this._progressMaxNumNodes);b!==this._get("updating")&&this._set("updating",b);a=100*a/this._progressMaxNumNodes;a!==this._get("updatingPercentage")&&
this._set("updatingPercentage",a)};k.prototype._initViewData=function(){var a=this.layerView.view,b=a.navigation.targetCamera,c=a.renderCoordsHelper;this.camPos=b.eye;this.screenSizeFactor=1/b.perPixelRatio;this._poi=K.create();var d=K.create(),e=K.create();K.subtract(b.center,b.eye,d);K.normalize(d);c.worldUpAtPosition(b.center,e);d=Math.acos(K.dot(e,d))-.5*Math.PI;K.lerp(b.eye,b.center,Math.max(0,Math.min(1,d/(.5*Math.PI))),this._poi);d=this._lodFactorProperty&&this.layerView.view.get(this._lodFactorProperty)||
1;e=this.layerViewOptionalFunctions.traversalOptions.elevationInfo;this._viewportQueries=new n(this.crsIndex,c,b,this._clippingArea,null!=this.layerViewOptionalFunctions.traversalOptions?this.layerViewOptionalFunctions.traversalOptions.errorMetricPreference:null,e?a.basemapTerrain:null,e,{screenspaceErrorBias:d,maxDistance:25E7,angleDependentLoD:.5>d});this.notifyChange("rootNodeVisible")};k.prototype._startNodeLoadingWhileSuspended=function(){var a=this;this._initViewData();this._removeInvisibleNodes(function(b){return a._viewportQueries.isNodeVisible(b)})};
k.prototype._startNodeLoading=function(){var a=this;this._restartNodeLoading=!1;if(!this._updatesDisabled&&null!=this.streamDataSupplier){this._initViewData();var b=null!=this.layerViewOptionalFunctions.getTexturePrefetchFunctions?this.layerViewOptionalFunctions.getTexturePrefetchFunctions():void 0,c=this.isMeshPyramid&&null!=this._defaultGeometrySchema&&null!=this._defaultGeometrySchema.ordering;null!=this.layerViewOptionalFunctions.getLoadedAttributes&&this._requiredAttributesDirty&&(this._requiredAttributes=
this._getRequiredAttributes(),this._requiredAttributesDirty=!1,this._handles.add([this.layer.watch("renderer",function(){return a._requiredFieldsChange()}),this.layer.watch("definitionExpression",function(){return a._requiredFieldsChange()}),this.layer.watch("labelsVisible",function(){return a._labelingChanged()}),this.layer.watch("labelingInfo",function(){return a._labelingChanged()})],"requiredAttributes"));this._nodeLoader=new d(this.streamDataSupplier,this._bundleLoadedCallback,this.queueAnimationFrameFunctionCall.bind(this),
void 0,this.layerView.view.renderCoordsHelper,this.crsIndex,b?b._calcDesiredTextureLOD:void 0,b?b._imageIsPartOfTextureBundle:void 0,b?b._matId2Meta:void 0,b?b._texId2Meta:void 0,b?b.useCompressedTextures:void 0,E,this._defaultGeometrySchema,this._requiredAttributes,c);this._indexLoader=new e(this.getBaseUrl(),this._rootNodeUrl,this._rootNodeId,this._poi,this.nodeIndex,this.streamDataSupplier,this._viewportQueries,function(b,c){return a._processNodeIndexDocument(b,c)},function(b){return a._lodHandling.finishedLevel(b)},
this.layerViewOptionalFunctions._nodeDebugVisualizer,E,this.layerViewOptionalFunctions.traversalOptions);this._indexLoader.start();b=this._removeInvisibleNodes(function(b){return a._indexLoader.nodeIsVisible(b)});c=null!=this.layerViewOptionalFunctions.traversalOptions&&!0===this.layerViewOptionalFunctions.traversalOptions.perLevelTraversal?"perLevel":this.isMeshPyramid?"global":"swap";this._lodHandling.startNodeLoading(this._indexLoader.nodeIsVisible.bind(this._indexLoader),this._indexLoader.nodeTraversalState.bind(this._indexLoader),
c,this.nodeIndex,b,this._rootNodeId);this.layerViewOptionalFunctions.additionalStartNodeLoadingHandler&&this.layerViewOptionalFunctions.additionalStartNodeLoadingHandler();this._evaluateUpdatingState()}};k.prototype.isNodeLoading=function(){return null!=this._nodeLoader&&null!=this._indexLoader};k.prototype.cancelNodeLoading=function(){if(this.isNodeLoading()){this._indexLoader.cancel();this._nodeLoader.cancel();this.streamDataSupplier.cancelAll();for(var a=0;a<this._animFrameFunctionQueue.length;a++)for(var b=
0;b<this._animFrameFunctionQueue[a].length;b++)void 0!==this._animFrameFunctionQueue[a][b].cancelFunc&&this._animFrameFunctionQueue[a][b].cancelFunc();this._numNodesLoading=0;this._animFrameFunctionQueue=[[],[]];this._indexLoader=this._nodeLoader=void 0;this._lodHandling.cancelNodeLoading();this.layerViewOptionalFunctions.additionalCancelNodeLoadingHandler&&this.layerViewOptionalFunctions.additionalCancelNodeLoadingHandler();this._evaluateUpdatingState()}};k.prototype._removeInvisibleNodes=function(a){for(var b=
{},c=this.layerViewRequiredFunctions.getAddedNodeIDs(),d=0;d<c.length;d++){var e=c[d],f=this.nodeIndex[e];this._isNodeVisibleWithParents(f,a)?b[e]=f:this._removeNodeData(f)}return b};k.prototype._isNodeVisibleWithParents=function(a,b){var c=a;do a=b(c),c=c.parentNode,c=null!=c?this.nodeIndex[c.id]:null;while(a&&null!=c);return a};k.prototype._removeNodeData=function(a){this._lodHandling.setLodGlobalDirty();this.layerViewRequiredFunctions.removeNodeData(a)};k.prototype._processNodeIndexDocument=function(a,
b){var c=this,d=new C.Promise;if(null!=a.featureData&&0<a.featureData.length)if(this.layerViewRequiredFunctions.areAllBundlesLoaded(a)){var e=this.layerViewOptionalFunctions.getLoadedAttributes,e=null!=e?e(a):void 0;null!=e&&e!==this._requiredAttributes&&(this._nodeLoader.loadAttributes(a,a.baseUrl,this._requiredAttributes).then(function(b){c.layerViewOptionalFunctions.setAttributeData(a,c._requiredAttributes,b);c._evaluateUpdatingState()}).catch(function(b){c.layerViewOptionalFunctions.setAttributeData(a,
c._requiredAttributes,{})}).then(function(){c._evaluateUpdatingState()}),this._evaluateUpdatingState());this._lodHandling.shouldLoadNode(a,b)&&(b=this._lodHandling.lodSwapBuildInfoForNode(a))&&null==b.swapPairs&&this._lodHandling.lodSwapBundleLoaded(a,null,b)}else if(this._lodHandling.shouldLoadNode(a,b)){b=this._lodHandling.lodSwapBuildInfoForNode(a);if(this.layerViewRequiredFunctions.isOverMemory())return d.done(),d;this._modifyNumNodesLoading(1);for(var e=[],f=0;f<a.featureData.length;f++)this.layerViewRequiredFunctions.isBundleAlreadyAddedToStage(a,
f)||e.push(f);this.queueAnimationFrameFunctionCall(this._nodeLoader.loadNodeData,this._nodeLoader,[a,e,d,null!=this.layerViewOptionalFunctions.getTexturePrefetchFunctions,b],void 0,1);d.then(function(){return c._modifyNumNodesLoading(-1)},function(){return c._modifyNumNodesLoading(-1)});return d}d.done();return d};k.prototype._updateIdleState=function(a){a!==this._isIdle&&(this._isIdle=a,this._evaluateUpdatingState())};return k}(r.declared(w,x,q));a([r.property({readOnly:!0})],m.prototype,"isMeshPyramid",
null);a([r.property({readOnly:!0})],m.prototype,"streamDataSupplier",null);a([r.property({readOnly:!0,dependsOn:["layer.definitionExpression"]})],m.prototype,"parsedDefinitionExpression",null);a([r.property({readOnly:!0,dependsOn:["parsedDefinitionExpression"]})],m.prototype,"definitionExpressionFields",null);a([r.property({readOnly:!0})],m.prototype,"crsVertex",null);a([r.property({readOnly:!0})],m.prototype,"crsIndex",null);a([r.property({readOnly:!0})],m.prototype,"nodeIndex",void 0);a([r.property()],
m.prototype,"camPos",void 0);a([r.property()],m.prototype,"screenSizeFactor",void 0);a([r.property()],m.prototype,"layerView",void 0);a([r.property()],m.prototype,"layerViewRequiredFunctions",void 0);a([r.property()],m.prototype,"layerViewOptionalFunctions",void 0);a([r.property()],m.prototype,"layer",void 0);a([r.property()],m.prototype,"addUrlToken",void 0);a([r.property({readOnly:!0})],m.prototype,"updating",void 0);a([r.property({readOnly:!0})],m.prototype,"updatingPercentage",void 0);a([r.property({readOnly:!0})],
m.prototype,"rootNodeVisible",null);return m=a([r.subclass("esri.layers.graphics.controllers.I3SOnDemandController")],m)})},"esri/core/sql/WhereClause":function(){define("require exports ./WhereGrammar dojo/Deferred dojo/promise/all ../../moment ../../geometry/geometryEngineAsync".split(" "),function(m,k,b,a,c,h,g){function d(a){return!0===a?!0:!1}function e(a){return null!==a?!0!==a:null}function l(a,b){if(null==a)return null;for(var c=!1,d=0;d<b.length;d++){var e=b[d];if(null==e)c=null;else if(a===
e){c=!0;break}}return c}function f(a,b,c){if(null==a)return null;for(var d="",e=0,f=0;f<b.length;f++){var g=b.charAt(f);switch(e){case 0:g===c?e=1:d=0<="-[]/{}()*+?.\\^$|".indexOf(g)?d+("\\"+g):"%"===g?d+".*":"_"===g?d+".":d+g;break;case 1:d=0<="-[]/{}()*+?.\\^$|".indexOf(g)?d+("\\"+g):d+g,e=0}}return(new RegExp("^"+d+"$")).test(a)}function n(a){return a instanceof Date?a.valueOf():a}function u(a,b,c){if(null==b||null==c)return null;b=n(b);c=n(c);switch(a){case "\x3c\x3e":return b!==c;case "\x3d":return b===
c;case "\x3e":return b>c;case "\x3c":return b<c;case "\x3e\x3d":return b>=c;case "\x3c\x3d":return b<=c}}var t;(function(a){(function(a){a[a.Standardised=0]="Standardised";a[a.SqlServer=1]="SqlServer";a[a.Oracle=2]="Oracle";a[a.Postgres=3]="Postgres";a[a.PGDB=4]="PGDB";a[a.FILEGDB=5]="FILEGDB";a[a.NotEvaluated=6]="NotEvaluated"})(a.FeatureServiceDatabaseType||(a.FeatureServiceDatabaseType={}));a.errback=function(a){return function(b){a.reject(b)}};a.callback=function(a,b){return function(){for(var c=
[],d=0;d<arguments.length;d++)c[d]=arguments[d];try{a.apply(null,c)}catch(A){b.reject(A)}}};a.convertSquareUnitsToCode=function(a){if(void 0===a)return null;if("number"===typeof a)return a;switch(a.toLowerCase()){case "meters":case "meter":return 109404;case "miles":case "mile":return 109413;case "kilometers":case "kilometer":case "km":return 109414}return null};a.convertLinearUnitsToCode=function(a){if(void 0===a)return null;if("number"===typeof a||"number"===typeof a)return a;switch(a.toLowerCase()){case "meters":case "meter":return 9001;
case "miles":case "mile":return 9035;case "kilometers":case "kilometer":case "km":return 9036}return null}})(t||(t={}));var r="extract abs ceiling floor log log10 power round truncate char_length concat lower substring upper".split(" ");return function(){function k(){this.child2=this.child1=this.parameters=this.parseTree=null}k.create=function(a){var c=new k;try{c.parseTree=b.parse(a)}catch(y){throw Error("Invalid Expression: "+a);}return c};k.assemble=function(a,b){var c=new k;c.child1=a;c.child2=
b;return c};k.prototype.isStandardized=function(){return this.getFunctions().every(function(a){return 0<=r.indexOf(a.toLowerCase())})};k.prototype.findVariables=function(){var a=[];this.findAllVariables(this.parseTree,a);return this.dedup(a)};k.prototype.setVariablesDictionary=function(a){this.parameters=a};k.prototype.toWhereClause=function(a){return null!==this.child1?"(("+this.child1.toWhereClause(a)+") AND ("+this.child2.toWhereClause(a)+"))":this.evaluateNodeToWhereClause(this.parseTree,a)};
k.prototype.reformulateWithoutField=function(a,b){return k.create(this._reformulateInner(a,b))};k.prototype._reformulateInner=function(a,b){return null!==this.child1?"(("+this.child1._reformulateInner(a,b)+") AND ("+this.child2._reformulateInner(a,b)+"))":this.evaluateNodeToWhereClause(this.parseTree,t.FeatureServiceDatabaseType.Standardised,a,b)};k.prototype.statisticFunction=function(){if(null===this.child1&&"call-function"===this.parseTree.type){if(0===this.parseTree.parameters.length)return{name:this.parseTree.name,
expr:null};if(1<this.parseTree.parameters.length)throw Error("Statistic does not have 1 or 0 Parameters");var a=new k;a.parseTree=this.parseTree.parameters[0];return{name:this.parseTree.name,expr:a}}return null};k.prototype.testFeature=function(a){return null!==this.child1?this.child1.testFeature(a)&&this.child2.testFeature(a):this.evaluateNode(this.parseTree,a)};k.prototype.testFeatureDeferred=function(b){var c=this,d=new a;null!==this.child1?this.child1.testFeatureDeferred(b).then(t.callback(function(a){!1===
a?d.resolve(!1):c.child2.testFeatureDeferred(b).then(t.callback(function(a){d.resolve(a)},d),t.errback(d))},d),t.errback(d)):this.evaluateNodeDeferred(this.parseTree,b).then(t.callback(function(a){d.resolve(a)},d),t.errback(d));return d.promise};k.prototype.calculateValue=function(a){return null!==this.child1?this.child1.calculateValue(a)&&this.child2.calculateValue(a):this.evaluateNode(this.parseTree,a)};k.prototype.calculateValueDeferred=function(b){var c=this,d=new a;null!==this.child1?this.child1.calculateValueDeferred(b).then(t.callback(function(a){!1===
a?d.resolve(!1):c.child2.calculateValueDeferred(b).then(t.callback(function(a){d.resolve(a)},d),t.errback(d))},d),t.errback(d)):this.evaluateNodeDeferred(this.parseTree,b).then(t.callback(function(a){d.resolve(a)},d),t.errback(d));return d.promise};k.prototype.scanForField=function(a){return null!==this.child1?this.child1.scanForField(a)||this.child2.scanForField(a):this.findField(this.parseTree,a)};k.prototype.getFunctions=function(){var a=[],a=null!==this.child1?this.child1.getFunctions().concat(this.child2.getFunctions()):
this.findFunctions(this.parseTree);return this.dedup(a)};k.prototype.getFields=function(){var a=[],a=null!==this.child1?this.child1.getFields().concat(this.child2.getFields()):this.findFields(this.parseTree);return this.dedup(a)};k.prototype.dedup=function(a){for(var b=[],c={},d=0;d<a.length;d++){var e=a[d],f=e.toLowerCase();void 0===c[f]&&(b.push(e),c[f]=1)}return b};k.prototype.featureValue=function(a,b,c){var d=a.attributes[b];if(void 0!==d)return d;for(var e in a.attributes)if(b.toLowerCase()===
e.toLowerCase())return c.value=e,a.attributes[e];return null};k.prototype.isSingleField=function(){return"FieldLiteral"===this.parseTree.type?!0:!1};k.prototype.findField=function(a,b){if(null===a||void 0===a)return!1;switch(a.type){case "when_clause":return this.findField(a.operand,b)||this.findField(a.value,b);case "case_expression":for(var c=0,d=a.clauses;c<d.length;c++){var e=d[c];if(this.findField(e,b))return!0}if("simple"===a.format&&this.findField(a.operand,b)||null!==a.else&&this.findField(a.else,
b))return!0;break;case "expr_list":c=0;for(a=a.value;c<a.length;c++)if(e=a[c],this.findField(e,b))return!0;break;case "unary_expr":return this.findField(a.expr,b);case "binary_expr":return this.findField(a.left,b)||this.findField(a.right,b);case "column_ref":return b.toLowerCase()===a.column.toLowerCase();case "function":return this.findField(a.args,b)}return!1};k.prototype.findFunctions=function(a){if(null===a||void 0===a)return[];switch(a.type){case "when_clause":return this.findFunctions(a.operand).concat(this.findFunctions(a.value));
case "case_expression":for(var b=[],c=0,d=a.clauses;c<d.length;c++)var e=d[c],b=b.concat(this.findFunctions(e));"simple"===a.format&&(b=b.concat(this.findFunctions(a.operand)));null!==a.else&&(b=b.concat(this.findFunctions(a.else)));return b;case "expr_list":b=[];c=0;for(a=a.value;c<a.length;c++)e=a[c],b=b.concat(this.findFunctions(e));return b;case "unary_expr":return this.findFunctions(a.expr);case "binary_expr":return this.findFunctions(a.left).concat(this.findFunctions(a.right));case "function":return this.findFunctions(a.args).concat([a.name.toLowerCase().trim()])}return[]};
k.prototype.findFields=function(a){var b=[];if(null===a||void 0===a)return b;switch(a.type){case "when_clause":return this.findFields(a.operand).concat(this.findFields(a.value));case "case_expression":for(var c=0,d=a.clauses;c<d.length;c++)var e=d[c],b=b.concat(this.findFields(e));"simple"===a.format&&(b=b.concat(this.findFields(a.operand)));null!==a.else&&(b=b.concat(this.findFields(a.else)));return b;case "expr_list":c=0;for(a=a.value;c<a.length;c++)e=a[c],b=b.concat(this.findFields(e));return b;
case "unary_expr":return this.findFields(a.expr);case "binary_expr":return this.findFields(a.left).concat(this.findFields(a.right));case "column_ref":return[a.column];case "function":return this.findFields(a.args)}return[]};k.prototype.findAllVariables=function(a,b){if(null!==a&&void 0!==a)switch(a.type){case "when_clause":this.findAllVariables(a.operand,b);this.findAllVariables(a.value,b);break;case "case_expression":for(var c=0,d=a.clauses;c<d.length;c++){var e=d[c];this.findAllVariables(e,b)}"simple"===
a.format&&this.findAllVariables(a.operand,b);null!==a.else&&this.findAllVariables(a.else,b);break;case "param":b.push(a.value.toLowerCase());case "expr_list":c=0;for(a=a.value;c<a.length;c++)e=a[c],this.findAllVariables(e,b);break;case "unary_expr":this.findAllVariables(a.expr,b);case "binary_expr":this.findAllVariables(a.left,b);this.findAllVariables(a.right,b);break;case "function":this.findAllVariables(a.args,b)}};k.prototype.evaluateNode=function(a,b){var c;switch(a.type){case "case_expression":if("simple"===
a.format)for(var g=n(this.evaluateNode(a.operand,b)),h=0;h<a.clauses.length;h++){if(c=g===n(this.evaluateNode(a.clauses[h].operand,b)))return this.evaluateNode(a.clauses[h].value,b)}else for(h=0;h<a.clauses.length;h++)if(c=d(this.evaluateNode(a.clauses[h].operand,b)))return this.evaluateNode(a.clauses[h].value,b);return null!==a.else?this.evaluateNode(a.else,b):null;case "param":return this.parameters[a.value.toLowerCase()];case "expr_list":c=[];g=0;for(a=a.value;g<a.length;g++)h=a[g],c.push(this.evaluateNode(h,
b));return c;case "unary_expr":return e(this.evaluateNode(a.expr,b));case "binary_expr":switch(a.operator){case "AND":return c=this.evaluateNode(a.left,b),b=this.evaluateNode(a.right,b),null!=c&&null!=b?!0===c&&!0===b:!1===c||!1===b?!1:null;case "OR":return c=this.evaluateNode(a.left,b),b=this.evaluateNode(a.right,b),null!=c&&null!=b?!0===c||!0===b:!0===c||!0===b?!0:null;case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return null===this.evaluateNode(a.left,b);case "ISNOT":if("null"!==
a.right.type)throw Error("Unsupported RHS for IS");return null!==this.evaluateNode(a.left,b);case "IN":return c=[],"expr_list"===a.right.type?c=this.evaluateNode(a.right,b):(c=this.evaluateNode(a.right,b),c instanceof Array||(c=[c])),l(this.evaluateNode(a.left,b),c);case "NOT IN":return c=[],"expr_list"===a.right.type?c=this.evaluateNode(a.right,b):(c=[this.evaluateNode(a.right,b)],c instanceof Array||(c=[c])),e(l(this.evaluateNode(a.left,b),c));case "BETWEEN":return c=this.evaluateNode(a.left,b),
b=this.evaluateNode(a.right,b),null==c||null==b[0]||null==b[1]?null:c>=b[0]&&c<=b[1];case "NOTBETWEEN":return c=this.evaluateNode(a.left,b),b=this.evaluateNode(a.right,b),null==c||null==b[0]||null==b[1]?null:c<b[0]||c>b[1];case "LIKE":return f(this.evaluateNode(a.left,b),this.evaluateNode(a.right,b),a.escape);case "NOT LIKE":return e(f(this.evaluateNode(a.left,b),this.evaluateNode(a.right,b),a.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return u(a.operator,
this.evaluateNode(a.left,b),this.evaluateNode(a.right,b));case "*":return this.evaluateNode(a.left,b)*this.evaluateNode(a.right,b);case "-":return this.evaluateNode(a.left,b)-this.evaluateNode(a.right,b);case "+":return this.evaluateNode(a.left,b)+this.evaluateNode(a.right,b);case "/":return this.evaluateNode(a.left,b)/this.evaluateNode(a.right,b)}throw Error("Not Supported Operator "+a.operator);case "null":case "bool":case "string":case "number":return a.value;case "date":return this.parseDate(a.value);
case "timestamp":return this.parseTimestamp(a.value);case "column_ref":return"CURRENT_DATE"===a.column.toUpperCase()?(h=new Date,h.setHours(0,0,0,0),h):"CURRENT_TIMESTAMP"===a.column.toUpperCase()?new Date:this.featureValue(b,a.column,a);case "function":return b=this.evaluateNode(a.args,b),this.executeFunction(a.name,b)}throw Error("Unsupported sql syntax "+a.type);};k.prototype.executeFunction=function(a,b){switch(a.toLowerCase().trim()){case "extract":if(2!==b.length)throw Error("Invalid Parameter for call to Extract");
if(null==b[1])return null;a=b[1];if(a instanceof Date)switch(b[0].toUpperCase()){case "SECOND":return a.getSeconds();case "MINUTE":return a.getMinutes();case "HOUR":return a.getHours();case "DAY":return a.getDate();case "MONTH":return a.getMonth()+1;case "YEAR":return a.getFullYear();default:throw Error("Invalid Parameter for call to Extract");}else throw Error("Invalid Parameter for call to Extract");case "substring":if(2===b.length)return null===b[0]||null===b[1]?null:b[0].toString().substring(b[1]-
1);if(3===b.length)return null===b[0]||null===b[1]||null===b[2]?null:0>=b[2]?"":b[0].toString().substring(b[1]-1,b[1]+b[2]-1);throw Error("Invalid Parameter for call to SUBSTRING");case "abs":if(1!==b.length)throw Error("Invalid Parameter for call to ABS");return null===b[0]?null:Math.abs(b[0]);case "ceiling":case "ceil":if(1!==b.length)throw Error("Invalid Parameter for call to Ceil");return null===b[0]?null:Math.ceil(b[0]);case "floor":if(1!==b.length)throw Error("Invalid Parameter for call to Floor");
return null===b[0]?null:Math.floor(b[0]);case "log":if(1!==b.length)throw Error("Invalid Parameter for call to Log");return null===b[0]?null:Math.log(b[0]);case "log10":if(1!==b.length)throw Error("Invalid Parameter for call to Log10");return null===b[0]?null:Math.log(b[0])/Math.LN10;case "power":if(2!==b.length)throw Error("Invalid Parameter for call to POWER");return null===b[0]?null:Math.pow(b[0],b[1]);case "round":return 2===b.length?(a=b[0],b=-1*b[1],"undefined"===typeof b||0===+b?b=Math.round(a):
(a=+a,b=+b,isNaN(a)||"number"!==typeof b||0!==b%1?b=NaN:(a=a.toString().split("e"),a=Math.round(+(a[0]+"e"+(a[1]?+a[1]-b:-b))),a=a.toString().split("e"),b=+(a[0]+"e"+(a[1]?+a[1]+b:b)))),b):null===b[0]?null:Math.round(b[0]);case "truncate":if(1>b.length||2<b.length)throw Error("Invalid Parameter for TRUNCATE function");return null===b[0]?null:1===b.length?parseInt(b[0].toFixed(0),10):parseFloat(b[0].toFixed(b[1]));case "char_length":case "len":if(1!==b.length)throw Error("Invalid Parameter for CHAR_LENGTH function");
return"string"===typeof b[0]||b[0]instanceof String?b[0].length:0;case "concat":if(1>b.length)throw Error("Invalid Parameter for CONCAT function");a="";for(var c=0;c<b.length;c++)null!==b[c]&&(a+=b[c].toString());return a;case "lower":case "lcase":if(1!==b.length)throw Error("Invalid Parameter for Lower function");return null===b[0]?null:b[0].toString().toLowerCase();case "upper":case "ucase":if(1!==b.length)throw Error("Invalid Parameter for Upper function");return null===b[0]?null:b[0].toString().toUpperCase()}throw Error("Function Not Recognised");
};k.prototype._makeDateString=function(a,b){a=h(a);var c=0===a.minute()&&0===a.hour()&&0===a.second()&&0===a.millisecond();switch(b){case t.FeatureServiceDatabaseType.FILEGDB:case t.FeatureServiceDatabaseType.Standardised:return c?"date '"+a.format("YYYY-MM-DD")+"'":"date '"+a.format("YYYY-MM-DD HH:mm:ss")+"'";case t.FeatureServiceDatabaseType.Oracle:return c?"TO_DATE('"+a.format("YYYY-MM-DD")+"','YYYY-MM-DD')":"TO_DATE('"+a.format("YYYY-MM-DD HH:mm:ss")+"','YYYY-MM-DD HH24:MI:SS')";case t.FeatureServiceDatabaseType.SqlServer:return"'"+
a.format(c?"YYYY-MM-DD":"YYYY-MM-DD HH:mm:ss")+"'";case t.FeatureServiceDatabaseType.PGDB:return"#"+a.format(c?"MM-DD-YYYY":"MM-DD-YYYY HH:mm:ss")+"#";case t.FeatureServiceDatabaseType.Postgres:return"TIMESTAMP '"+a.format(c?"YYYY-MM-DD":"YYYY-MM-DD HH:mm:ss")+"'";default:return"date '"+a.format("YYYY-MM-DD HH:mm:ss")+"'"}};k.prototype._makeToday=function(a,b){switch(b){case t.FeatureServiceDatabaseType.FILEGDB:case t.FeatureServiceDatabaseType.Standardised:return a?"CURRENT_DATE":"CURRENT_TIMESTAMP";
case t.FeatureServiceDatabaseType.Oracle:return a?"CURRENT_DATE":"CURRENT_TIMESTAMP";case t.FeatureServiceDatabaseType.SqlServer:return a?"CAST(GETDATE() AS DATE)":"GETDATE()";case t.FeatureServiceDatabaseType.PGDB:return a?"CURRENT_DATE":"CURRENT_TIMESTAMP";case t.FeatureServiceDatabaseType.Postgres:return a?"CURRENT_DATE":"CURRENT_TIMESTAMP";default:return a?"CURRENT_DATE":"CURRENT_TIMESTAMP"}};k.prototype.evaluateNodeToWhereClause=function(a,b,c,d){void 0===c&&(c=null);void 0===d&&(d=null);var e;
switch(a.type){case "case_expression":var f=" CASE ";"simple"===a.format&&(f+=this.evaluateNodeToWhereClause(a.operand,b,c,d));for(e=0;e<a.clauses.length;e++)f+=" WHEN "+this.evaluateNodeToWhereClause(a.clauses[e].operand,b,c,d)+" THEN "+this.evaluateNodeToWhereClause(a.clauses[e].value,b,c,d);null!==a.else&&(f+=" ELSE "+this.evaluateNodeToWhereClause(a.else,b,c,d));return f+" END ";case "param":c=this.parameters[a.value.toLowerCase()];if("string"===typeof c)return"'"+this.parameters[a.value.toLowerCase()].toString()+
"'";if(c instanceof Date)return this._makeDateString(c,b);if(c instanceof Array){a=[];for(e=0;e<c.length;e++)"string"===typeof c[e]?a.push("'"+c[e].toString()+"'"):c[e]instanceof Date?a.push(this._makeDateString(c[e],b)):a.push(c[e].toString());return a}return c.toString();case "expr_list":e=[];f=0;for(a=a.value;f<a.length;f++)e.push(this.evaluateNodeToWhereClause(a[f],b,c,d));return e;case "unary_expr":return" ( NOT "+this.evaluateNodeToWhereClause(a.expr,b,c,d)+" ) ";case "binary_expr":switch(a.operator){case "AND":return" ("+
this.evaluateNodeToWhereClause(a.left,b,c,d)+" AND "+this.evaluateNodeToWhereClause(a.right,b,c,d)+") ";case "OR":return" ("+this.evaluateNodeToWhereClause(a.left,b,c,d)+" OR "+this.evaluateNodeToWhereClause(a.right,b,c,d)+") ";case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return" ("+this.evaluateNodeToWhereClause(a.left,b,c,d)+" IS NULL )";case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return" ("+this.evaluateNodeToWhereClause(a.left,b,c,d)+
" IS NOT NULL )";case "IN":e=[];if("expr_list"===a.right.type)return e=this.evaluateNodeToWhereClause(a.right,b,c,d)," ("+this.evaluateNodeToWhereClause(a.left,b,c,d)+" IN ("+e.join(",")+")) ";e=this.evaluateNodeToWhereClause(a.right,b,c,d);return e instanceof Array?" ("+this.evaluateNodeToWhereClause(a.left,b,c,d)+" IN ("+e.join(",")+")) ":" ("+this.evaluateNodeToWhereClause(a.left,b,c,d)+" IN ("+e+")) ";case "NOT IN":e=[];if("expr_list"===a.right.type)return e=this.evaluateNodeToWhereClause(a.right,
b,c,d)," ("+this.evaluateNodeToWhereClause(a.left,b,c,d)+" NOT IN ("+e.join(",")+")) ";e=this.evaluateNodeToWhereClause(a.right,b,c,d);return e instanceof Array?" ("+this.evaluateNodeToWhereClause(a.left,b,c,d)+" NOT IN ("+e.join(",")+")) ":" ("+this.evaluateNodeToWhereClause(a.left,b,c,d)+" NOT IN ("+e+")) ";case "BETWEEN":return e=this.evaluateNodeToWhereClause(a.right,b,c,d)," ("+this.evaluateNodeToWhereClause(a.left,b,c,d)+" BETWEEN "+e[0]+" AND "+e[1]+" ) ";case "NOTBETWEEN":return e=this.evaluateNodeToWhereClause(a.right,
b,c,d)," ("+this.evaluateNodeToWhereClause(a.left,b,c,d)+" NOT BETWEEN "+e[0]+" AND "+e[1]+" ) ";case "LIKE":return""!==a.escape?" ("+this.evaluateNodeToWhereClause(a.left,b,c,d)+" LIKE "+this.evaluateNodeToWhereClause(a.right,b,c,d)+" ESCAPE '"+a.escape+"') ":" ("+this.evaluateNodeToWhereClause(a.left,b,c,d)+" LIKE "+this.evaluateNodeToWhereClause(a.right,b,c,d)+") ";case "NOT LIKE":return""!==a.escape?" ("+this.evaluateNodeToWhereClause(a.left,b,c,d)+" NOT LIKE "+this.evaluateNodeToWhereClause(a.right,
b,c,d)+" ESCAPE '"+a.escape+"') ":" ("+this.evaluateNodeToWhereClause(a.left,b,c,d)+" NOT LIKE "+this.evaluateNodeToWhereClause(a.right,b,c,d)+") ";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":case "*":case "-":case "+":case "/":return" ("+this.evaluateNodeToWhereClause(a.left,b,c,d)+" "+a.operator+" "+this.evaluateNodeToWhereClause(a.right,b,c,d)+") "}throw Error("Not Supported Operator "+a.operator);case "null":return"null";case "bool":return!0===a.value?"1":
"0";case "string":return"'"+a.value.toString()+"'";case "timestamp":return this._makeDateString(a.value,b);case "date":return this._makeDateString(a.value,b);case "number":return a.value.toString();case "column_ref":return"CURRENT_DATE"===a.column.toUpperCase()?this._makeToday(!0,b):"CURRENT_TIMESTAMP"===a.column.toUpperCase()?this._makeToday(!1,b):c?c.toLowerCase()===a.column.toLowerCase()?"("+d+")":a.column:a.column;case "function":return c=this.evaluateNodeToWhereClause(a.args,b,c,d),this.translateFunction(a.name,
c,b)}throw Error("Unsupported sql syntax "+a.type);};k.prototype.translateFunction=function(a,b,c){switch(a.toLowerCase().trim()){case "abs":if(1!==b.length)throw Error("Invalid Parameter for call to ABS");return"abs("+b[0]+")";case "ceiling":case "ceil":if(1!==b.length)throw Error("Invalid Parameter for call to CEILING");switch(c){case t.FeatureServiceDatabaseType.Standardised:return"CEILING("+b[0]+")";default:return"CEILING("+b[0]+")"}case "floor":if(1!==b.length)throw Error("Invalid Parameter for call to Floor");
return"FLOOR("+b[0]+")";case "log":if(1!==b.length)throw Error("Invalid Parameter for call to LOG");return"LOG("+b[0]+")";case "log10":if(1!==b.length)throw Error("Invalid Parameter for call to LOG10");return"LOG10("+b[0]+")";case "power":if(2!==b.length)throw Error("Invalid Parameter for call to POWER");return"POWER("+b[0]+","+b[1]+")";case "round":if(2===b.length)return"ROUND("+b[0]+","+b[1]+")";if(1===b.length)return"ROUND("+b[0]+")";throw Error("Invalid Parameter for call to ROUND");case "truncate":if(1>
b.length||2<b.length)throw Error("Invalid Parameter for TRUNCATE function");switch(c){case t.FeatureServiceDatabaseType.SqlServer:return"ROUND("+b[0]+(1===b.length?"0":","+b[1])+",1)";default:return"TRUNCATE("+b[0]+(1===b.length?")":","+b[1]+")")}case "char_length":case "len":if(1!==b.length)throw Error("Invalid Parameter for CHAR_LENGTH function");switch(c){case t.FeatureServiceDatabaseType.SqlServer:return"LEN("+b[0]+")";case t.FeatureServiceDatabaseType.Oracle:return"LENGTH("+b[0]+")";default:return"CHAR_LENGTH("+
b[0]+")"}case "concat":if(1>b.length)throw Error("Invalid Parameter for CONCAT function");c="CONCAT(";for(a=0;a<b.length;a++)0!==a&&(c+=","),c+=b[a];return c+")";case "lower":case "lcase":if(1!==b.length)throw Error("Invalid Parameter for Lower function");return"LOWER("+b[0]+")";case "upper":case "ucase":if(1!==b.length)throw Error("Invalid Parameter for Upper function");return"UPPER("+b[0]+")";case "substring":switch(a="",c){case t.FeatureServiceDatabaseType.Oracle:return a="SUBSTR("+b[0]+","+b[1],
3===b.length&&(a+=","+b[2]),a+")";case t.FeatureServiceDatabaseType.SqlServer:return a=3===b.length?"SUBSTRING("+b[0]+","+b[1]+","+b[2]+")":"SUBSTRING("+b[0]+",  "+b[1]+", LEN("+b[0]+") - "+b[1]+")";default:return a="SUBSTRING("+b[0]+" FROM "+b[1],3===b.length&&(a+=" FOR "+b[2]),a+")"}case "extract":return"EXTRACT("+b[0].replace(/\'/g,"")+" FROM "+b[1]+")"}throw Error("Function Not Recognised");};k.prototype.parseTimestamp=function(a){return h(a,["YYYY-M-D H:m:s","YYYY-M-D H:mZ","YYYY-M-D H:m:sZ",
"YYYY-M-D H:m","YYYY-m-d"]).toDate()};k.prototype.parseDate=function(a){return h(a,["YYYY-M-D"]).toDate()};k.prototype.evaluateWhereClausesSimpleDeferred=function(b,c,d,e,f){var g=new a,h=this;try{c>=b.length?null===d?g.resolve(null):this.evaluateNodeDeferred(d,f).then(function(a){g.resolve(a)},function(a){g.reject(a)}):this.evaluateNodeDeferred(b[c],f).then(function(a){e===n(a)?h.evaluateNode(b[c].value,f).then(function(a){g.resolve(a)},function(a){g.reject(a)}):h.evaluateWhereClausesSimpleDeferred(b,
c+1,d,e,f).then(function(a){g.resolve(a)},function(a){g.reject(a)})},function(a){g.reject(a)})}catch(D){g.reject(D)}return g.promise};k.prototype.evaluateWhereClausesDeferred=function(b,c,e,f){var g=new a,h=this;try{c>=b.length?null===e?g.resolve(null):this.evaluateNodeDeferred(e,f).then(function(a){g.resolve(a)},function(a){g.reject(a)}):this.evaluateNodeDeferred(b[c].operand,f).then(function(a){d(a)?h.evaluateNode(b[c].value,f).then(function(a){g.resolve(a)},function(a){g.reject(a)}):h.evaluateWhereClausesDeferred(b,
c+1,e,f).then(function(a){g.resolve(a)},function(a){g.reject(a)})},function(a){g.reject(a)})}catch(B){g.reject(B)}return g.promise};k.prototype.evaluateNodeDeferred=function(b,e){var g=new a,h=this,l;try{var k=void 0,m;switch(b.type){case "case_expression":"simple"===b.format?this.evaluateNodeDeferred(b.operand,e).then(function(a){a=n(a);h.evaluateWhereClausesSimpleDeferred(b.clauses,0,b.else,a,e).then(function(a){g.resolve(a)},function(a){g.reject(a)})},function(a){g.reject(a)}):h.evaluateWhereClausesDeferred(b.clauses,
0,b.else,e).then(function(a){g.resolve(a)},function(a){g.reject(a)});break;case "param":g.resolve(this.parameters[b.value.toLowerCase()]);break;case "expr_list":k=[];l=0;for(var q=b.value;l<q.length;l++){var r=q[l];k.push(this.evaluateNodeDeferred(r,e))}c(k).then(t.callback(function(a){g.resolve(a)},g),t.errback(g));break;case "unary_expr":this.evaluateNodeDeferred(b.expr,e).then(t.callback(function(a){g.resolve(!d(a))},g),t.errback(g));break;case "binary_expr":switch(b.operator){case "IS":"null"!==
b.right.type?g.reject(Error("Unsupported RHS for IS")):this.evaluateNodeDeferred(b.left,e).then(t.callback(function(a){g.resolve(null===a)},g),t.errback(g));break;case "ISNOT":"null"!==b.right.type?g.reject(Error("Unsupported RHS for IS")):this.evaluateNodeDeferred(b.left,e).then(t.callback(function(a){g.resolve(null!==a)},g),t.errback(g));break;case "LIKE":case "NOT LIKE":case "BETWEEN":case "NOTBETWEEN":case "IN":case "NOT IN":case "AND":case "OR":case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":case "*":case "-":case "+":case "/":l=
[h.evaluateNodeDeferred(b.left,e),h.evaluateNodeDeferred(b.right,e)];c(l).then(t.callback(function(a){switch(b.operator){case "LIKE":case "NOT LIKE":a=f(a[0],a[0],b.escape);g.resolve("LIKE"===b.operator?a:!a);break;case "BETWEEN":case "NOTBETWEEN":var c=a[0];m=a[1];a=c>=m[0]&&c<=m[1];g.resolve("BETWEEN"===b.operator?a:!a);break;case "IN":case "NOT IN":"IN"===b.operator?a[1]instanceof Array?g.resolve(-1<a[1].indexOf(a[0])):g.resolve(-1<[a[1]].indexOf(a[0])):"NOT IN"===b.operator&&(a[1]instanceof Array?
g.resolve(!(-1<a[1].indexOf(a[0]))):g.resolve(!(-1<[a[1]].indexOf(a[0]))));break;case "AND":g.resolve(d(a[0])&&d(a[1]));break;case "OR":g.resolve(d(a[0])||d(a[1]));break;case "\x3c\x3e":g.resolve(n(a[0])!==n(a[1]));break;case "\x3c":g.resolve(n(a[0])<n(a[1]));break;case "\x3e":g.resolve(n(a[0])>n(a[1]));break;case "\x3e\x3d":g.resolve(n(a[0])>=n(a[1]));break;case "\x3c\x3d":g.resolve(n(a[0])<=n(a[1]));break;case "\x3d":g.resolve(n(a[0])===n(a[1]));break;case "*":g.resolve(a[0]*a[1]);break;case "-":g.resolve(a[0]-
a[1]);break;case "+":g.resolve(a[0]+a[1]);break;case "/":g.resolve(a[0]/a[1]);break;default:g.reject(Error("Unrecognised operator"))}},g),t.errback(g));break;default:g.reject(Error("Not Supported Operator "+b.operator))}break;case "null":case "bool":case "string":case "number":g.resolve(b.value);break;case "date":g.resolve(h.parseDate(b.value));break;case "timestamp":g.resolve(h.parseTimestamp(b.value));break;case "column_ref":"CURRENT_DATE"===b.column.toUpperCase()?(r=new Date,r.setHours(0,0,0,0),
g.resolve(r)):"CURRENT_TIMESTAMP"===b.column.toUpperCase()?g.resolve(new Date):g.resolve(this.featureValue(e,b.column,b));break;case "function":this.evaluateNodeDeferred(b.args,e).then(t.callback(function(a){h.executeFunctionDeferred(b.name,e,a).then(t.callback(function(a){g.resolve(a)},g),t.errback(g))},g),t.errback(g));break;default:g.reject(Error("Malformed Where Clause"))}}catch(K){g.reject(K)}return g.promise};k.prototype.executeFunctionDeferred=function(b,c,d){var e=new a,f=0;try{switch(b.toLowerCase().trim()){case "extract":case "substring":case "abs":case "ceiling":case "ceil":case "floor":case "log":case "log10":case "power":case "round":case "truncate":case "char_length":case "len":case "concat":case "lower":case "lcase":case "upper":case "ucase":try{e.resolve(this.executeFunction(b,
d))}catch(C){e.reject(C)}break;case "area":f=t.convertSquareUnitsToCode(d[0]);b=!1;void 0===d[1]||null===d[1]||"1"!==d[1].toString()&&"true"!==d[1].toString().toLowerCase()&&"geodesic"!==d[1].toString().toLowerCase()||(b=!0);null===c.geometry?e.resolve(0):b?g.geodesicArea(c.geometry,f).then(t.callback(function(a){e.resolve(a)},e),t.errback(e)):g.planarArea(c.geometry,f).then(t.callback(function(a){e.resolve(a)},e),t.errback(e));break;case "length":f=t.convertLinearUnitsToCode(d[0]);void 0===d[1]||
null===d[1]||"1"!==d[1].toString()&&"true"!==d[1].toString().toLowerCase()&&"geodesic"!==d[1].toString().toLowerCase()||(b=!0);null===c.geometry?e.resolve(0):g.planarLength(c.geometry,f).then(t.callback(function(a){e.resolve(a)},e),t.errback(e));break;default:e.reject(Error("Function Not Recognised"))}}catch(C){e.reject(C)}return e.promise};return k}()})},"esri/core/sql/WhereGrammar":function(){define(["require","exports","./sql92grammar"],function(m,k,b){return function(){function a(){}a.parse=function(a){return b.parse(a)};
return a}()})},"esri/core/sql/sql92grammar":function(){define([],function(){function m(k,b,a,c){this.message=k;this.expected=b;this.found=a;this.location=c;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,m)}(function(k,b){function a(){this.constructor=k}a.prototype=b.prototype;k.prototype=new a})(m,Error);m.buildMessage=function(k,b){function a(a){return a.charCodeAt(0).toString(16).toUpperCase()}function c(b){return b.replace(/\\/g,"\\\\").replace(/"/g,
'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(b){return"\\x0"+a(b)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(b){return"\\x"+a(b)})}function h(b){return b.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(b){return"\\x0"+a(b)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(b){return"\\x"+
a(b)})}var g={literal:function(a){return'"'+c(a.text)+'"'},"class":function(a){var b="",c;for(c=0;c<a.parts.length;c++)b+=a.parts[c]instanceof Array?h(a.parts[c][0])+"-"+h(a.parts[c][1]):h(a.parts[c]);return"["+(a.inverted?"^":"")+b+"]"},any:function(a){return"any character"},end:function(a){return"end of input"},other:function(a){return a.description}};return"Expected "+function(a){var b=Array(a.length),c;for(c=0;c<a.length;c++){var d=c,h;h=a[c];h=g[h.type](h);b[d]=h}b.sort();if(0<b.length){for(a=
c=1;c<b.length;c++)b[c-1]!==b[c]&&(b[a]=b[c],a++);b.length=a}switch(b.length){case 1:return b[0];case 2:return b[0]+" or "+b[1];default:return b.slice(0,-1).join(", ")+", or "+b[b.length-1]}}(k)+" but "+(b?'"'+c(b)+'"':"end of input")+" found."};return{SyntaxError:m,parse:function(k,b){function a(a,b){return{type:"literal",text:a,ignoreCase:b}}function c(a,b,c){return{type:"class",parts:a,inverted:b,ignoreCase:c}}function h(a){var b=Sa[a],c;if(!b){for(c=a-1;!Sa[c];)c--;b=Sa[c];for(b={line:b.line,
column:b.column};c<a;)10===k.charCodeAt(c)?(b.line++,b.column=1):b.column++,c++;Sa[a]=b}return b}function g(a,b){var c=h(a),d=h(b);return{start:{offset:a,line:c.line,column:c.column},end:{offset:b,line:d.line,column:d.column}}}function d(a){v<xa||(v>xa&&(xa=v,ab=[]),ab.push(a))}function e(){var a,b,c;a=v;b=G();b!==p?(b=f(),b!==p?(c=G(),c!==p?a=b:(v=a,a=p)):(v=a,a=p)):(v=a,a=p);return a}function l(){var a,b,c,d,e,g,h,l;a=v;b=f();if(b!==p){c=[];d=v;e=G();e!==p?(g=T(),g!==p?(h=G(),h!==p?(l=f(),l!==p?
d=e=[e,g,h,l]:(v=d,d=p)):(v=d,d=p)):(v=d,d=p)):(v=d,d=p);for(;d!==p;)c.push(d),d=v,e=G(),e!==p?(g=T(),g!==p?(h=G(),h!==p?(l=f(),l!==p?d=e=[e,g,h,l]:(v=d,d=p)):(v=d,d=p)):(v=d,d=p)):(v=d,d=p);if(c!==p){a={type:"expr_list"};b=[b];for(d=0;d<c.length;d++)b.push(c[d][3]);a.value=b}else v=a,a=p}else v=a,a=p;return a}function f(){var a,b,c,d,e,f,g,h;a=v;b=n();if(b!==p){c=[];d=v;e=G();e!==p?(f=ga(),f!==p?(g=G(),g!==p?(h=n(),h!==p?d=e=[e,f,g,h]:(v=d,d=p)):(v=d,d=p)):(v=d,d=p)):(v=d,d=p);for(;d!==p;)c.push(d),
d=v,e=G(),e!==p?(f=ga(),f!==p?(g=G(),g!==p?(h=n(),h!==p?d=e=[e,f,g,h]:(v=d,d=p)):(v=d,d=p)):(v=d,d=p)):(v=d,d=p);c!==p?a=b=ca(b,c):(v=a,a=p)}else v=a,a=p;return a}function n(){var a,b,c,d,e,f,g,h;a=v;b=u();if(b!==p){c=[];d=v;e=G();e!==p?(f=ia(),f!==p?(g=G(),g!==p?(h=u(),h!==p?d=e=[e,f,g,h]:(v=d,d=p)):(v=d,d=p)):(v=d,d=p)):(v=d,d=p);for(;d!==p;)c.push(d),d=v,e=G(),e!==p?(f=ia(),f!==p?(g=G(),g!==p?(h=u(),h!==p?d=e=[e,f,g,h]:(v=d,d=p)):(v=d,d=p)):(v=d,d=p)):(v=d,d=p);c!==p?a=b=ca(b,c):(v=a,a=p)}else v=
a,a=p;return a}function u(){var a,b,c,e,f;a=v;b=R();b===p&&(b=v,33===k.charCodeAt(v)?(c=ma,v++):(c=p,0===M&&d(wa)),c!==p?(e=v,M++,61===k.charCodeAt(v)?(f=Da,v++):(f=p,0===M&&d(ra)),M--,f===p?e=void 0:(v=e,e=p),e!==p?b=c=[c,e]:(v=b,b=p)):(v=b,b=p));b!==p?(c=G(),c!==p?(e=u(),e!==p?a=b={type:"unary_expr",operator:"NOT",expr:e}:(v=a,a=p)):(v=a,a=p)):(v=a,a=p);if(a===p)if(a=v,b=q(),b!==p)if(c=G(),c!==p){var g,h,n;c=[];e=v;f=G();f!==p?(g=t(),g!==p?(h=G(),h!==p?(n=q(),n!==p?e=f=[f,g,h,n]:(v=e,e=p)):(v=e,
e=p)):(v=e,e=p)):(v=e,e=p);if(e!==p)for(;e!==p;)c.push(e),e=v,f=G(),f!==p?(g=t(),g!==p?(h=G(),h!==p?(n=q(),n!==p?e=f=[f,g,h,n]:(v=e,e=p)):(v=e,e=p)):(v=e,e=p)):(v=e,e=p);else c=p;c!==p&&(c={type:"arithmetic",tail:c});c===p&&(c=v,e=w(),e!==p?(f=G(),f!==p?(f=U(),f!==p?(f=G(),f!==p?(f=l(),f!==p?(g=G(),g!==p?(g=Z(),g!==p?c=e={op:e,right:f}:(v=c,c=p)):(v=c,c=p)):(v=c,c=p)):(v=c,c=p)):(v=c,c=p)):(v=c,c=p)):(v=c,c=p),c===p&&(c=v,e=w(),e!==p?(f=G(),f!==p?(f=U(),f!==p?(f=G(),f!==p?(f=Z(),f!==p?c=e={op:e,right:{type:"expr_list",
value:[]}}:(v=c,c=p)):(v=c,c=p)):(v=c,c=p)):(v=c,c=p)):(v=c,c=p),c===p&&(c=v,e=w(),e!==p?(f=G(),f!==p?(f=K(),f!==p?c=e={op:e,right:f}:(v=c,c=p)):(v=c,c=p)):(v=c,c=p))),c===p&&(c=v,f=R(),f!==p?(e=G(),e!==p?(e=ha(),e!==p?(g=G(),g!==p?(g=q(),g!==p?(h=G(),h!==p?(h=ia(),h!==p?(f=G(),f!==p?(f=q(),f!==p?c=f={op:"NOT"+e,right:{type:"expr_list",value:[g,f]}}:(v=c,c=p)):(v=c,c=p)):(v=c,c=p)):(v=c,c=p)):(v=c,c=p)):(v=c,c=p)):(v=c,c=p)):(v=c,c=p)):(v=c,c=p),c===p&&(c=v,f=ha(),f!==p?(e=G(),e!==p?(e=q(),e!==p?
(g=G(),g!==p?(g=ia(),g!==p?(h=G(),h!==p?(h=q(),h!==p?c=f={op:f,right:{type:"expr_list",value:[e,h]}}:(v=c,c=p)):(v=c,c=p)):(v=c,c=p)):(v=c,c=p)):(v=c,c=p)):(v=c,c=p)):(v=c,c=p)),c===p&&(c=v,e=X(),e!==p?(f=G(),f!==p?(f=R(),f!==p?(f=G(),f!==p?(f=q(),f!==p?c=e={op:e+"NOT",right:f}:(v=c,c=p)):(v=c,c=p)):(v=c,c=p)):(v=c,c=p)):(v=c,c=p),c===p&&(c=v,e=X(),e!==p?(f=G(),f!==p?(f=q(),f!==p?c=e={op:e,right:f}:(v=c,c=p)):(v=c,c=p)):(v=c,c=p)),c===p&&(c=v,e=r(),e!==p?(f=G(),f!==p?(f=E(),f!==p?(g=G(),g!==p?(g=
v,k.substr(v,6).toLowerCase()===yc?(h=k.substr(v,6),v+=6):(h=p,0===M&&d(zc)),h!==p?(h=v,M++,n=D(),M--,n===p?h=void 0:(v=h,h=p),h!==p?g="ESCAPE":(v=g,g=p)):(v=g,g=p),g!==p?(g=G(),g!==p?(g=F(),g!==p?c=e={op:e,right:f,escape:g.value}:(v=c,c=p)):(v=c,c=p)):(v=c,c=p)):(v=c,c=p)):(v=c,c=p)):(v=c,c=p)):(v=c,c=p),c===p&&(c=v,e=r(),e!==p?(f=G(),f!==p?(f=E(),f!==p?c=e={op:e,right:f,escape:""}:(v=c,c=p)):(v=c,c=p)):(v=c,c=p))))));c===p&&(c=null);c!==p?(a=b,b=c,""==b||void 0==b||null==b?b=a:(c=null,b=c="arithmetic"==
b.type?ca(a,b.tail):S(b.op,a,b.right,b.escape)),a=b):(v=a,a=p)}else v=a,a=p;else v=a,a=p;return a}function t(){var a;k.substr(v,2)===sa?(a=sa,v+=2):(a=p,0===M&&d(ta));a===p&&(62===k.charCodeAt(v)?(a=Aa,v++):(a=p,0===M&&d(Qa)),a===p&&(k.substr(v,2)===ua?(a=ua,v+=2):(a=p,0===M&&d(Ja)),a===p&&(k.substr(v,2)===Ka?(a=Ka,v+=2):(a=p,0===M&&d(Ta)),a===p&&(60===k.charCodeAt(v)?(a=Ua,v++):(a=p,0===M&&d(Za)),a===p&&(61===k.charCodeAt(v)?(a=Da,v++):(a=p,0===M&&d(ra)),a===p&&(k.substr(v,2)===ya?(a=ya,v+=2):(a=
p,0===M&&d(Na))))))));return a}function r(){var a,b,c,d;a=a=v;b=R();b!==p?(c=G(),c!==p?(d=aa(),d!==p?a=b=[b,c,d]:(v=a,a=p)):(v=a,a=p)):(v=a,a=p);a!==p&&(a=a[0]+" "+a[2]);a===p&&(a=aa());return a}function w(){var a,b,c,d;a=a=v;b=R();b!==p?(c=G(),c!==p?(d=fa(),d!==p?a=b=[b,c,d]:(v=a,a=p)):(v=a,a=p)):(v=a,a=p);a!==p&&(a=a[0]+" "+a[2]);a===p&&(a=fa());return a}function q(){var a,b,c,d,e,f,g,h;a=v;b=y();if(b!==p){c=[];d=v;e=G();e!==p?(f=x(),f!==p?(g=G(),g!==p?(h=y(),h!==p?d=e=[e,f,g,h]:(v=d,d=p)):(v=d,
d=p)):(v=d,d=p)):(v=d,d=p);for(;d!==p;)c.push(d),d=v,e=G(),e!==p?(f=x(),f!==p?(g=G(),g!==p?(h=y(),h!==p?d=e=[e,f,g,h]:(v=d,d=p)):(v=d,d=p)):(v=d,d=p)):(v=d,d=p);c!==p?a=b=ca(b,c):(v=a,a=p)}else v=a,a=p;return a}function x(){var a;43===k.charCodeAt(v)?(a=La,v++):(a=p,0===M&&d(Ba));a===p&&(45===k.charCodeAt(v)?(a=Ma,v++):(a=p,0===M&&d(Oa)));return a}function y(){var a,b,c,d,e,f,g,h;a=v;b=A();if(b!==p){c=[];d=v;e=G();e!==p?(f=z(),f!==p?(g=G(),g!==p?(h=A(),h!==p?d=e=[e,f,g,h]:(v=d,d=p)):(v=d,d=p)):(v=
d,d=p)):(v=d,d=p);for(;d!==p;)c.push(d),d=v,e=G(),e!==p?(f=z(),f!==p?(g=G(),g!==p?(h=A(),h!==p?d=e=[e,f,g,h]:(v=d,d=p)):(v=d,d=p)):(v=d,d=p)):(v=d,d=p);c!==p?a=b=ca(b,c):(v=a,a=p)}else v=a,a=p;return a}function z(){var a;42===k.charCodeAt(v)?(a=Ra,v++):(a=p,0===M&&d(Va));a===p&&(47===k.charCodeAt(v)?(a=Ea,v++):(a=p,0===M&&d(Ya)),a===p&&(37===k.charCodeAt(v)?(a=kb,v++):(a=p,0===M&&d(Kb))));return a}function A(){var a,b,c,e,g,h,n;n=F();if(n===p){var m,q,r,t;m=v;var u,w,x,y;u=v;w=J();w!==p?(x=P(),x!==
p?(y=I(),y!==p?u=w=parseFloat(w+x+y):(v=u,u=p)):(v=u,u=p)):(v=u,u=p);u===p&&(u=v,w=J(),w!==p?(x=P(),x!==p?u=w=parseFloat(w+x):(v=u,u=p)):(v=u,u=p),u===p&&(u=v,w=J(),w!==p?(x=I(),x!==p?u=w=parseFloat(w+x):(v=u,u=p)):(v=u,u=p),u===p&&(u=v,w=J(),w!==p&&(w=parseFloat(w)),u=w)));q=u;q!==p?(r=v,M++,t=B(),M--,t===p?r=void 0:(v=r,r=p),r!==p?m=q={type:"number",value:q}:(v=m,m=p)):(v=m,m=p);n=m;if(n===p){var z,A;z=v;var ra,S,O,ja;ra=v;k.substr(v,4).toLowerCase()===Ac?(S=k.substr(v,4),v+=4):(S=p,0===M&&d(Bc));
S!==p?(O=v,M++,ja=D(),M--,ja===p?O=void 0:(v=O,O=p),O!==p?ra=S=[S,O]:(v=ra,ra=p)):(v=ra,ra=p);A=ra;A!==p&&(A={type:"bool",value:!0});z=A;if(z===p){z=v;var sa,ca,R,ta;sa=v;k.substr(v,5).toLowerCase()===Cc?(ca=k.substr(v,5),v+=5):(ca=p,0===M&&d(Dc));ca!==p?(R=v,M++,ta=D(),M--,ta===p?R=void 0:(v=R,R=p),R!==p?sa=ca=[ca,R]:(v=sa,sa=p)):(v=sa,sa=p);A=sa;A!==p&&(A={type:"bool",value:!1});z=A}n=z;if(n===p){var ea,ia,qa,ma,ga;ia=v;k.substr(v,4).toLowerCase()===Ec?(qa=k.substr(v,4),v+=4):(qa=p,0===M&&d(Fc));
qa!==p?(ma=v,M++,ga=D(),M--,ga===p?ma=void 0:(v=ma,ma=p),ma!==p?ia=qa=[qa,ma]:(v=ia,ia=p)):(v=ia,ia=p);ea=ia;ea!==p&&(ea={type:"null",value:null});n=ea;if(n===p){var W,V,Ca,ha;W=v;var T,Aa,X,wa;T=v;k.substr(v,4).toLowerCase()===Gc?(Aa=k.substr(v,4),v+=4):(Aa=p,0===M&&d(Hc));Aa!==p?(X=v,M++,wa=D(),M--,wa===p?X=void 0:(v=X,X=p),X!==p?T=Aa="DATE":(v=T,T=p)):(v=T,T=p);V=T;V!==p?(Ca=G(),Ca!==p?(ha=E(),ha!==p?W=V={type:"date",value:ha.value}:(v=W,W=p)):(v=W,W=p)):(v=W,W=p);n=W;if(n===p){var fa,aa,Da,ba;
fa=v;var ua,Qa,Ja,Ka;ua=v;k.substr(v,9).toLowerCase()===Ic?(Qa=k.substr(v,9),v+=9):(Qa=p,0===M&&d(Jc));Qa!==p?(Ja=v,M++,Ka=D(),M--,Ka===p?Ja=void 0:(v=Ja,Ja=p),Ja!==p?ua=Qa="TIMESTAMP":(v=ua,ua=p)):(v=ua,ua=p);aa=ua;aa!==p?(Da=G(),Da!==p?(ba=E(),ba!==p?fa=aa={type:"timestamp",value:ba.value}:(v=fa,fa=p)):(v=fa,fa=p)):(v=fa,fa=p);n=fa}}}}}a=n;if(a===p){var pa,Oa,ya,Ta,Za,Ma,Na,La,Ua,Va,Kb,Nb;pa=v;var Ba,Ra,xa,Mb;Ba=v;k.substr(v,7).toLowerCase()===Kc?(Ra=k.substr(v,7),v+=7):(Ra=p,0===M&&d(Lc));Ra!==
p?(xa=v,M++,Mb=D(),M--,Mb===p?xa=void 0:(v=xa,xa=p),xa!==p?Ba=Ra="EXTRACT":(v=Ba,Ba=p)):(v=Ba,Ba=p);Oa=Ba;if(Oa!==p)if(ya=G(),ya!==p)if(Ta=U(),Ta!==p)if(Za=G(),Za!==p){var Fa,Ea,kb,Ya,Lb;Ea=v;k.substr(v,4).toLowerCase()===Mc?(kb=k.substr(v,4),v+=4):(kb=p,0===M&&d(Nc));kb!==p?(Ya=v,M++,Lb=D(),M--,Lb===p?Ya=void 0:(v=Ya,Ya=p),Ya!==p?Ea=kb="YEAR":(v=Ea,Ea=p)):(v=Ea,Ea=p);Fa=Ea;if(Fa===p){var bb,lb,wb,Ob;bb=v;k.substr(v,5).toLowerCase()===Oc?(lb=k.substr(v,5),v+=5):(lb=p,0===M&&d(Pc));lb!==p?(wb=v,M++,
Ob=D(),M--,Ob===p?wb=void 0:(v=wb,wb=p),wb!==p?bb=lb="MONTH":(v=bb,bb=p)):(v=bb,bb=p);Fa=bb;if(Fa===p){var cb,mb,xb,$a;cb=v;k.substr(v,3).toLowerCase()===Qc?(mb=k.substr(v,3),v+=3):(mb=p,0===M&&d(Rc));mb!==p?(xb=v,M++,$a=D(),M--,$a===p?xb=void 0:(v=xb,xb=p),xb!==p?cb=mb="DAY":(v=cb,cb=p)):(v=cb,cb=p);Fa=cb;if(Fa===p){var db,Sa,yb,jb;db=v;k.substr(v,4).toLowerCase()===Sc?(Sa=k.substr(v,4),v+=4):(Sa=p,0===M&&d(Tc));Sa!==p?(yb=v,M++,jb=D(),M--,jb===p?yb=void 0:(v=yb,yb=p),yb!==p?db=Sa="HOUR":(v=db,db=
p)):(v=db,db=p);Fa=db;if(Fa===p){var eb,Rb,zb,Pb;eb=v;k.substr(v,6).toLowerCase()===Uc?(Rb=k.substr(v,6),v+=6):(Rb=p,0===M&&d(Vc));Rb!==p?(zb=v,M++,Pb=D(),M--,Pb===p?zb=void 0:(v=zb,zb=p),zb!==p?eb=Rb="MINUTE":(v=eb,eb=p)):(v=eb,eb=p);Fa=eb;if(Fa===p){var fb,Sb,Ab,Qb;fb=v;k.substr(v,6).toLowerCase()===Wc?(Sb=k.substr(v,6),v+=6):(Sb=p,0===M&&d(Xc));Sb!==p?(Ab=v,M++,Qb=D(),M--,Qb===p?Ab=void 0:(v=Ab,Ab=p),Ab!==p?fb=Sb="SECOND":(v=fb,fb=p)):(v=fb,fb=p);Fa=fb}}}}}Ma=Fa;Ma!==p?(Na=G(),Na!==p?(La=la(),
La!==p?(Ua=G(),Ua!==p?(Va=f(),Va!==p?(Kb=G(),Kb!==p?(Nb=Z(),Nb!==p?pa=Oa={type:"function",name:"extract",args:{type:"expr_list",value:[{type:"string",value:Ma},Va]}}:(v=pa,pa=p)):(v=pa,pa=p)):(v=pa,pa=p)):(v=pa,pa=p)):(v=pa,pa=p)):(v=pa,pa=p)):(v=pa,pa=p)}else v=pa,pa=p;else v=pa,pa=p;else v=pa,pa=p;else v=pa,pa=p;a=pa;if(a===p){var oa,ab,sb,tb,ub,Tb,vb,Ib,Jb,Ub,hc,za,nb,dc,ec,fc;oa=v;var gb,Vb,Bb,ic;gb=v;k.substr(v,9).toLowerCase()===Yc?(Vb=k.substr(v,9),v+=9):(Vb=p,0===M&&d(Zc));Vb!==p?(Bb=v,M++,
ic=D(),M--,ic===p?Bb=void 0:(v=Bb,Bb=p),Bb!==p?gb=Vb="SUBSTRING":(v=gb,gb=p)):(v=gb,gb=p);ab=gb;if(ab!==p)if(sb=G(),sb!==p)if(tb=U(),tb!==p)if(ub=G(),ub!==p)if(Tb=f(),Tb!==p)if(vb=G(),vb!==p)if(Ib=la(),Ib!==p)if(Jb=G(),Jb!==p)if(Ub=f(),Ub!==p)if(hc=G(),hc!==p){za=v;var hb,Wb,Cb,jc;hb=v;k.substr(v,3).toLowerCase()===$c?(Wb=k.substr(v,3),v+=3):(Wb=p,0===M&&d(ad));Wb!==p?(Cb=v,M++,jc=D(),M--,jc===p?Cb=void 0:(v=Cb,Cb=p),Cb!==p?hb=Wb="FOR":(v=hb,hb=p)):(v=hb,hb=p);nb=hb;nb!==p?(dc=G(),dc!==p?(ec=f(),
ec!==p?(fc=G(),fc!==p?za=nb=[nb,dc,ec,fc]:(v=za,za=p)):(v=za,za=p)):(v=za,za=p)):(v=za,za=p);za===p&&(za=null);za!==p?(nb=Z(),nb!==p?oa=ab={type:"function",name:"substring",args:{type:"expr_list",value:za?[Tb,Ub,za[2]]:[Tb,Ub]}}:(v=oa,oa=p)):(v=oa,oa=p)}else v=oa,oa=p;else v=oa,oa=p;else v=oa,oa=p;else v=oa,oa=p;else v=oa,oa=p;else v=oa,oa=p;else v=oa,oa=p;else v=oa,oa=p;else v=oa,oa=p;else v=oa,oa=p;a=oa;if(a===p){var va,Xb,kc,lc,mc,ob,nc,oc;va=v;var Ga,Db,Eb,Pa;Ga=v;Ga=Db=C();if(Ga===p)if(Ga=v,
96===k.charCodeAt(v)?(Db=pc,v++):(Db=p,0===M&&d(qc)),Db!==p){Eb=[];rc.test(k.charAt(v))?(Pa=k.charAt(v),v++):(Pa=p,0===M&&d(sc));if(Pa!==p)for(;Pa!==p;)Eb.push(Pa),rc.test(k.charAt(v))?(Pa=k.charAt(v),v++):(Pa=p,0===M&&d(sc));else Eb=p;Eb!==p?(96===k.charCodeAt(v)?(Pa=pc,v++):(Pa=p,0===M&&d(qc)),Pa!==p?Ga=Db=Eb.join(""):(v=Ga,Ga=p)):(v=Ga,Ga=p)}else v=Ga,Ga=p;Xb=Ga;Xb!==p?(kc=G(),kc!==p?(lc=U(),lc!==p?(mc=G(),mc!==p?(ob=l(),ob===p&&(ob=null),ob!==p?(nc=G(),nc!==p?(oc=Z(),oc!==p?va=Xb={type:"function",
name:Xb,args:ob?ob:{type:"expr_list",value:[]}}:(v=va,va=p)):(v=va,va=p)):(v=va,va=p)):(v=va,va=p)):(v=va,va=p)):(v=va,va=p)):(v=va,va=p);a=va;if(a===p){var Yb,ka,pb,Zb,qb,$b,Wa,Ha,Fb,tc,uc;ka=v;pb=da();if(pb!==p)if(Zb=G(),Zb!==p)if(qb=f(),qb!==p)if($b=G(),$b!==p){Wa=[];for(Ha=Q();Ha!==p;)Wa.push(Ha),Ha=Q();Wa!==p?(Ha=G(),Ha!==p?(Fb=Y(),Fb!==p?ka=pb={type:"case_expression",format:"simple",operand:qb,clauses:Wa,else:null}:(v=ka,ka=p)):(v=ka,ka=p)):(v=ka,ka=p)}else v=ka,ka=p;else v=ka,ka=p;else v=ka,
ka=p;else v=ka,ka=p;if(ka===p)if(ka=v,pb=da(),pb!==p)if(Zb=G(),Zb!==p)if(qb=f(),qb!==p)if($b=G(),$b!==p){Wa=[];for(Ha=Q();Ha!==p;)Wa.push(Ha),Ha=Q();Wa!==p?(Ha=G(),Ha!==p?(Fb=N(),Fb!==p?(tc=G(),tc!==p?(uc=Y(),uc!==p?ka=pb={type:"case_expression",format:"simple",operand:qb,clauses:Wa,else:Fb.value}:(v=ka,ka=p)):(v=ka,ka=p)):(v=ka,ka=p)):(v=ka,ka=p)):(v=ka,ka=p)}else v=ka,ka=p;else v=ka,ka=p;else v=ka,ka=p;else v=ka,ka=p;Yb=ka;if(Yb===p){var na,rb,ac,Xa,Ia,Gb,vc,wc;na=v;rb=da();if(rb!==p)if(ac=G(),
ac!==p){Xa=[];for(Ia=L();Ia!==p;)Xa.push(Ia),Ia=L();Xa!==p?(Ia=G(),Ia!==p?(Gb=Y(),Gb!==p?na=rb={type:"case_expression",format:"searched",clauses:Xa,else:null}:(v=na,na=p)):(v=na,na=p)):(v=na,na=p)}else v=na,na=p;else v=na,na=p;if(na===p)if(na=v,rb=da(),rb!==p)if(ac=G(),ac!==p){Xa=[];for(Ia=L();Ia!==p;)Xa.push(Ia),Ia=L();Xa!==p?(Ia=G(),Ia!==p?(Gb=N(),Gb!==p?(vc=G(),vc!==p?(wc=Y(),wc!==p?na=rb={type:"case_expression",format:"searched",clauses:Xa,else:Gb.value}:(v=na,na=p)):(v=na,na=p)):(v=na,na=p)):
(v=na,na=p)):(v=na,na=p)}else v=na,na=p;else v=na,na=p;Yb=na}a=Yb;if(a===p){var Hb,ib,gc,bc,cc;ib=v;gc=B();if(gc!==p){bc=[];for(cc=H();cc!==p;)bc.push(cc),cc=H();bc!==p?ib=gc+=bc.join(""):(v=ib,ib=p)}else v=ib,ib=p;Hb=ib;Hb!==p&&(Hb={type:"column_ref",table:"",column:Hb});a=Hb;a===p&&(a=K(),a===p&&(a=v,b=U(),b!==p?(c=G(),c!==p?(e=f(),e!==p?(g=G(),g!==p?(h=Z(),h!==p?(e.paren=!0,a=b=e):(v=a,a=p)):(v=a,a=p)):(v=a,a=p)):(v=a,a=p)):(v=a,a=p)))}}}}}return a}function C(){var a,b,c,d;a=v;b=B();if(b!==p){c=
[];for(d=D();d!==p;)c.push(d),d=D();c!==p?a=b+=c.join(""):(v=a,a=p)}else v=a,a=p;return a}function B(){var a;Mb.test(k.charAt(v))?(a=k.charAt(v),v++):(a=p,0===M&&d(Nb));return a}function D(){var a;Lb.test(k.charAt(v))?(a=k.charAt(v),v++):(a=p,0===M&&d(lb));return a}function H(){var a;Ob.test(k.charAt(v))?(a=k.charAt(v),v++):(a=p,0===M&&d(mb));return a}function K(){var a,b,c;a=v;64===k.charCodeAt(v)?(b=Pb,v++):(b=p,0===M&&d(Qb));b!==p?(c=C(),c!==p?a=b=[b,c]:(v=a,a=p)):(v=a,a=p);a!==p&&(a={type:"param",
value:a[1]});return a}function E(){var a;a=F();a===p&&(a=K());return a}function F(){var a,b,c;a=v;39===k.charCodeAt(v)?(b=sb,v++):(b=p,0===M&&d(tb));b===p&&(k.substr(v,2)===ub?(b=ub,v+=2):(b=p,0===M&&d(xc)));if(b!==p){b=[];c=v;k.substr(v,2)===$a?(c=$a,v+=2):(c=p,0===M&&d(vb));c!==p&&(c="'");c===p&&(Ib.test(k.charAt(v))?(c=k.charAt(v),v++):(c=p,0===M&&d(Jb)));for(;c!==p;)b.push(c),c=v,k.substr(v,2)===$a?(c=$a,v+=2):(c=p,0===M&&d(vb)),c!==p&&(c="'"),c===p&&(Ib.test(k.charAt(v))?(c=k.charAt(v),v++):
(c=p,0===M&&d(Jb)));b!==p?(39===k.charCodeAt(v)?(c=sb,v++):(c=p,0===M&&d(tb)),c!==p?a=b={type:"string",value:b.join("")}:(v=a,a=p)):(v=a,a=p)}else v=a,a=p;return a}function L(){var a,b,c;a=v;b=V();b!==p?(b=G(),b!==p?(b=f(),b!==p?(c=G(),c!==p?(c=ba(),c!==p?(c=G(),c!==p?(c=f(),c!==p?a=b={type:"when_clause",operand:b,value:c}:(v=a,a=p)):(v=a,a=p)):(v=a,a=p)):(v=a,a=p)):(v=a,a=p)):(v=a,a=p)):(v=a,a=p);return a}function Q(){var a,b,c;a=v;b=V();b!==p?(b=G(),b!==p?(b=f(),b!==p?(c=G(),c!==p?(c=ba(),c!==p?
(c=G(),c!==p?(c=f(),c!==p?a=b={type:"when_clause",operand:b,value:c}:(v=a,a=p)):(v=a,a=p)):(v=a,a=p)):(v=a,a=p)):(v=a,a=p)):(v=a,a=p)):(v=a,a=p);return a}function N(){var a,b;a=v;var c,e;b=v;k.substr(v,4).toLowerCase()===bd?(c=k.substr(v,4),v+=4):(c=p,0===M&&d(cd));c!==p?(c=v,M++,e=D(),M--,e===p?c=void 0:(v=c,c=p),c!==p?b="ELSE":(v=b,b=p)):(v=b,b=p);b!==p?(b=G(),b!==p?(b=f(),b!==p?a={type:"else_clause",value:b}:(v=a,a=p)):(v=a,a=p)):(v=a,a=p);return a}function J(){var a,b,c;a=v;b=W();b!==p?(c=O(),
c!==p?a=b+c:(v=a,a=p)):(v=a,a=p);a===p&&(a=ea(),a===p&&(a=v,45===k.charCodeAt(v)?(b=Ma,v++):(b=p,0===M&&d(Oa)),b===p&&(43===k.charCodeAt(v)?(b=La,v++):(b=p,0===M&&d(Ba))),b!==p?(c=W(),c!==p?(b=O(),b!==p?a="-"+c+b:(v=a,a=p)):(v=a,a=p)):(v=a,a=p),a===p&&(a=v,45===k.charCodeAt(v)?(b=Ma,v++):(b=p,0===M&&d(Oa)),b===p&&(43===k.charCodeAt(v)?(b=La,v++):(b=p,0===M&&d(Ba))),b!==p?(c=ea(),c!==p?a="-"+c:(v=a,a=p)):(v=a,a=p))));return a}function P(){var a,b;a=v;46===k.charCodeAt(v)?(b=dd,v++):(b=p,0===M&&d(ed));
b!==p?(b=O(),b!==p?a="."+b:(v=a,a=p)):(v=a,a=p);return a}function I(){var a,b,c;b=a=v;fd.test(k.charAt(v))?(c=k.charAt(v),v++):(c=p,0===M&&d(gd));c!==p?(hd.test(k.charAt(v))?(c=k.charAt(v),v++):(c=p,0===M&&d(id)),c===p&&(c=null),c!==p?b="e"+(null===c?"":c):(v=b,b=p)):(v=b,b=p);b!==p?(c=O(),c!==p?a=b+c:(v=a,a=p)):(v=a,a=p);return a}function O(){var a,b;a=[];b=ea();if(b!==p)for(;b!==p;)a.push(b),b=ea();else a=p;a!==p&&(a=a.join(""));return a}function ea(){var a;jd.test(k.charAt(v))?(a=k.charAt(v),v++):
(a=p,0===M&&d(kd));return a}function W(){var a;ld.test(k.charAt(v))?(a=k.charAt(v),v++):(a=p,0===M&&d(md));return a}function fa(){var a,b,c;a=v;k.substr(v,2).toLowerCase()===nd?(b=k.substr(v,2),v+=2):(b=p,0===M&&d(od));b!==p?(b=v,M++,c=D(),M--,c===p?b=void 0:(v=b,b=p),b!==p?a="IN":(v=a,a=p)):(v=a,a=p);return a}function X(){var a,b,c;a=v;k.substr(v,2).toLowerCase()===pd?(b=k.substr(v,2),v+=2):(b=p,0===M&&d(qd));b!==p?(b=v,M++,c=D(),M--,c===p?b=void 0:(v=b,b=p),b!==p?a="IS":(v=a,a=p)):(v=a,a=p);return a}
function aa(){var a,b,c;a=v;k.substr(v,4).toLowerCase()===rd?(b=k.substr(v,4),v+=4):(b=p,0===M&&d(sd));b!==p?(b=v,M++,c=D(),M--,c===p?b=void 0:(v=b,b=p),b!==p?a="LIKE":(v=a,a=p)):(v=a,a=p);return a}function R(){var a,b,c;a=v;k.substr(v,3).toLowerCase()===td?(b=k.substr(v,3),v+=3):(b=p,0===M&&d(ud));b!==p?(b=v,M++,c=D(),M--,c===p?b=void 0:(v=b,b=p),b!==p?a="NOT":(v=a,a=p)):(v=a,a=p);return a}function ia(){var a,b,c;a=v;k.substr(v,3).toLowerCase()===vd?(b=k.substr(v,3),v+=3):(b=p,0===M&&d(wd));b!==
p?(b=v,M++,c=D(),M--,c===p?b=void 0:(v=b,b=p),b!==p?a="AND":(v=a,a=p)):(v=a,a=p);return a}function ga(){var a,b,c;a=v;k.substr(v,2).toLowerCase()===xd?(b=k.substr(v,2),v+=2):(b=p,0===M&&d(yd));b!==p?(b=v,M++,c=D(),M--,c===p?b=void 0:(v=b,b=p),b!==p?a="OR":(v=a,a=p)):(v=a,a=p);return a}function ha(){var a,b,c;a=v;k.substr(v,7).toLowerCase()===zd?(b=k.substr(v,7),v+=7):(b=p,0===M&&d(Ad));b!==p?(b=v,M++,c=D(),M--,c===p?b=void 0:(v=b,b=p),b!==p?a="BETWEEN":(v=a,a=p)):(v=a,a=p);return a}function la(){var a,
b,c;a=v;k.substr(v,4).toLowerCase()===Bd?(b=k.substr(v,4),v+=4):(b=p,0===M&&d(Cd));b!==p?(b=v,M++,c=D(),M--,c===p?b=void 0:(v=b,b=p),b!==p?a="FROM":(v=a,a=p)):(v=a,a=p);return a}function da(){var a,b,c;a=v;k.substr(v,4).toLowerCase()===Dd?(b=k.substr(v,4),v+=4):(b=p,0===M&&d(Ed));b!==p?(b=v,M++,c=D(),M--,c===p?b=void 0:(v=b,b=p),b!==p?a="CASE":(v=a,a=p)):(v=a,a=p);return a}function Y(){var a,b,c;a=v;k.substr(v,3).toLowerCase()===Fd?(b=k.substr(v,3),v+=3):(b=p,0===M&&d(Gd));b!==p?(b=v,M++,c=D(),M--,
c===p?b=void 0:(v=b,b=p),b!==p?a="END":(v=a,a=p)):(v=a,a=p);return a}function V(){var a,b,c;a=v;k.substr(v,4).toLowerCase()===Hd?(b=k.substr(v,4),v+=4):(b=p,0===M&&d(Id));b!==p?(b=v,M++,c=D(),M--,c===p?b=void 0:(v=b,b=p),b!==p?a="WHEN":(v=a,a=p)):(v=a,a=p);return a}function ba(){var a,b,c;a=v;k.substr(v,4).toLowerCase()===Jd?(b=k.substr(v,4),v+=4):(b=p,0===M&&d(Kd));b!==p?(b=v,M++,c=D(),M--,c===p?b=void 0:(v=b,b=p),b!==p?a="THEN":(v=a,a=p)):(v=a,a=p);return a}function T(){var a;44===k.charCodeAt(v)?
(a=Ld,v++):(a=p,0===M&&d(Md));return a}function U(){var a;40===k.charCodeAt(v)?(a=Nd,v++):(a=p,0===M&&d(Od));return a}function Z(){var a;41===k.charCodeAt(v)?(a=Pd,v++):(a=p,0===M&&d(Qd));return a}function G(){var a,b;a=[];for(b=ja();b!==p;)a.push(b),b=ja();return a}function ja(){var a;Rd.test(k.charAt(v))?(a=k.charAt(v),v++):(a=p,0===M&&d(Sd));return a}function S(a,b,c,d){a={type:"binary_expr",operator:a,left:b,right:c};void 0!==d&&(a.escape=d);return a}function ca(a,b){for(var c=0;c<b.length;c++)a=
S(b[c][1],a,b[c][3]);return a}b=void 0!==b?b:{};var p={},qa={start:e},Ca=e,ma="!",wa=a("!",!1),Da="\x3d",ra=a("\x3d",!1),sa="\x3e\x3d",ta=a("\x3e\x3d",!1),Aa="\x3e",Qa=a("\x3e",!1),ua="\x3c\x3d",Ja=a("\x3c\x3d",!1),Ka="\x3c\x3e",Ta=a("\x3c\x3e",!1),Ua="\x3c",Za=a("\x3c",!1),ya="!\x3d",Na=a("!\x3d",!1),La="+",Ba=a("+",!1),Ma="-",Oa=a("-",!1),Ra="*",Va=a("*",!1),Ea="/",Ya=a("/",!1),kb="%",Kb=a("%",!1),Mb=/^[A-Za-z_\x80-\uFFFF]/,Nb=c([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),Lb=/^[A-Za-z0-9_]/,
lb=c([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),Ob=/^[A-Za-z0-9_.\x80-\uFFFF]/,mb=c([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),Pb="@",Qb=a("@",!1),sb="'",tb=a("'",!1),ub="N'",xc=a("N'",!1),$a="''",vb=a("''",!1),Ib=/^[^']/,Jb=c(["'"],!0,!1);c(["'","\\",["\x00","\u001f"],"\u007f"],!0,!1);c(['"',"\\",["\x00","\u001f"],"\u007f"],!0,!1);a("\\'",!1);a('\\"',!1);a("\\\\",!1);a("\\/",!1);a("\\b",!1);a("\\f",!1);a("\\n",!1);a("\\r",!1);a("\\t",!1);a("\\u",!1);c(["\n","\r"],!1,!1);var dd=
".",ed=a(".",!1),jd=/^[0-9]/,kd=c([["0","9"]],!1,!1),ld=/^[1-9]/,md=c([["1","9"]],!1,!1);c([["0","9"],["a","f"],["A","F"]],!1,!1);var fd=/^[eE]/,gd=c(["e","E"],!1,!1),hd=/^[+\-]/,id=c(["+","-"],!1,!1),Ec="null",Fc=a("NULL",!0),Ac="true",Bc=a("TRUE",!0),Cc="false",Dc=a("FALSE",!0),nd="in",od=a("IN",!0),pd="is",qd=a("IS",!0),rd="like",sd=a("LIKE",!0),yc="escape",zc=a("ESCAPE",!0);a("CONTAINS",!0);var td="not",ud=a("NOT",!0),vd="and",wd=a("AND",!0),xd="or",yd=a("OR",!0),zd="between",Ad=a("BETWEEN",!0),
Bd="from",Cd=a("FROM",!0),$c="for",ad=a("FOR",!0),Yc="substring",Zc=a("SUBSTRING",!0),Kc="extract",Lc=a("EXTRACT",!0),Ic="timestamp",Jc=a("TIMESTAMP",!0),Gc="date",Hc=a("DATE",!0),Mc="year",Nc=a("YEAR",!0),Oc="month",Pc=a("MONTH",!0),Qc="day",Rc=a("DAY",!0),Sc="hour",Tc=a("HOUR",!0),Uc="minute",Vc=a("MINUTE",!0),Wc="second",Xc=a("SECOND",!0),Dd="case",Ed=a("CASE",!0),Fd="end",Gd=a("END",!0),Hd="when",Id=a("WHEN",!0),Jd="then",Kd=a("THEN",!0),bd="else",cd=a("ELSE",!0),Ld=",",Md=a(",",!1),Nd="(",Od=
a("(",!1),Pd=")",Qd=a(")",!1);a("[",!1);a("]",!1);var Rd=/^[ \t\n\r]/,Sd=c([" ","\t","\n","\r"],!1,!1),pc="`",qc=a("`",!1),rc=/^[^`]/,sc=c(["`"],!0,!1),v=0,Sa=[{line:1,column:1}],xa=0,ab=[],M=0,jb;if("startRule"in b){if(!(b.startRule in qa))throw Error("Can't start parsing from rule \""+b.startRule+'".');Ca=qa[b.startRule]}jb=Ca();if(jb!==p&&v===k.length)return jb;jb!==p&&v<k.length&&d({type:"end"});throw function(a,b,c){return new m(m.buildMessage(a,b),a,b,c)}(ab,xa<k.length?k.charAt(xa):null,xa<
k.length?g(xa,xa+1):g(xa,xa));}}})},"esri/geometry/geometryEngineAsync":function(){define("require exports ../kernel module ./Geometry ./Polygon ./Polyline ./Point ./Extent ./Multipoint ../workers/WorkerClient dojo/Deferred".split(" "),function(m,k,b,a,c,h,g,d,e,l,f,n){function u(a){if(void 0===d.fromJson){if(void 0!==a.x&&void 0!==a.y)return new d(a);if(void 0!==a.paths)return new g(a);if(void 0!==a.rings)return new h(a);if(void 0!==a.points)return new l(a);if(void 0!==a.xmin&&void 0!==a.ymin&&void 0!==
a.xmax&&void 0!==a.ymax)return new e(a)}else{if(void 0!==a.x&&void 0!==a.y)return d.fromJson(a);if(void 0!==a.paths)return g.fromJson(a);if(void 0!==a.rings)return h.fromJson(a);if(void 0!==a.points)return l.fromJson(a);if(void 0!==a.xmin&&void 0!==a.ymin&&void 0!==a.xmax&&void 0!==a.ymax)return e.fromJson(a)}}function t(a,b){var c;if(null==a||void 0===a||"number"===typeof a)return a;var d=a.toString();if(""===d)return null;if(2==b){if(c=D[d],void 0!==c)return c}else if(0==b){c=B[d];if(void 0!==c)return c;
c=H[a];if(void 0!==c)return c}else if(3==b&&(c=B[d],void 0!==c))return c;if(1==b&&(c=H[a],void 0!==c))return c;if(!0===/^\d+$/.test(d))return parseInt(d);throw Error("Unrecognised Unit Type");}function r(a){if(void 0!==a&&null!==a)switch(a){case "loxodrome":return 1;case "great-elliptic":return 2;case "normal-section":return 3;case "shape-preserving":return 4}return 0}function w(a){if(null===a||void 0===a)return null;if(A)switch(a.type){case "point":return{x:a.x,y:a.y,z:a.z,m:a.m};case "multipoint":return{points:a.points,
hasZ:a.hasZ,hasM:a.hasM};case "polyline":return{paths:a.paths,hasZ:a.hasZ,hasM:a.hasM};case "polygon":return{rings:a.rings,hasZ:a.hasZ,hasM:a.hasM};case "extent":return{xmin:a.xmin,ymin:a.ymin,xmax:a.xmax,ymax:a.ymax,zmin:a.zmin,zmax:a.zmax,mmin:a.mmin,mmax:a.mmax}}else switch(a.type){case "point":return{x:a.x,y:a.y};case "multipoint":return{points:a.points};case "polyline":return{paths:a.paths};case "polygon":return{rings:a.rings};case "extent":return{xmin:a.xmin,ymin:a.ymin,xmax:a.xmax,ymax:a.ymax}}return null}
function q(a,b){if(null===a)return null;a=u(a);A?a.set("spatialReference",b):a.setSpatialReference(b);return a}function x(a){return null==a||void 0===a?null:-1!=a.wkid&&null!==a.wkid&&void 0!==a.wkid?{wkid:a.wkid}:""!==a.wkt&&void 0!==a.wkt&&null!==a.wkt?{wkt:a.wkt}:null}function y(a,b,c){var d=new n,e=b.spatialReference;E.a({action:a,geoma:w(b),geomb:w(c),spatialReference:x(b.spatialReference)}).then(function(a){0===a.status?d.reject(Error(a.error.message)):d.resolve(q(a.result,e))},function(a){d.reject(a)});
return d.promise}function z(a,b,c){var d=new n;E.a({action:a,geoma:w(b),geomb:w(c),spatialReference:x(b.spatialReference)}).then(function(a){0===a.status?d.reject(Error(a.error.message)):d.resolve(a.result)},function(a){d.reject(a)});return d.promise}var A=0==b.version.indexOf("4."),C;(function(a){a[a.Linear=0]="Linear";a[a.Angular=1]="Angular";a[a.Area=2]="Area";a[a.LinearOrAngular=3]="LinearOrAngular"})(C||(C={}));var B={feet:9002,kilometers:9036,meters:9001,miles:9035,"nautical-miles":9030,yards:9096},
D={acres:109402,ares:109463,hectares:109401,"square-feet":109405,"square-kilometers":109414,"square-meters":109404,"square-miles":109413,"square-yards":109442},H={degrees:9102,radians:9101},K=function(){function b(){this.c=!0;this.i=null}b.prototype.A=function(a){var b=this;this.i=new f;this.i.setWorker(this.l(),function(){b.c=!1;a()})};b.prototype.l=function(){return m.B?m.B("./geometryenginewebworker"):a.id.replace(/\/[^\/]*$/ig,"/")+"./geometryenginewebworker"};return b}(),E=function(){function a(){}
a.a=function(b){var c=new n;a.h.push({task:b,d:c});a.f();return c.promise};a.f=function(){if(0<a.h.length){for(var b=null,c=0;c<a.b.length;c++)if(!1===a.b[c].c){b=a.b[c];break}null===b&&a.b.length<a.g&&(c=new K,a.b.push(c),c.A(function(){a.f()}));if(null!==b){var d=this.h.shift();b.c=!0;b.i.postMessage(d.task).then(function(c){b.c=!1;try{d.d.resolve(c)}catch(P){}a.f()},function(c){b.c=!1;try{d.d.reject(c)}catch(P){}a.f()})}}};a.b=[];a.h=[];a.g=4;return a}();return function(){function a(){}a._removeAllWorkers=
function(){E.b=[]};a._setMaxWorkers=function(b){a._removeAllWorkers();E.g=b};a._getMaxWorkers=function(){return E.g};a._getNumWorkers=function(){return E.b.length};a.extendedSpatialReferenceInfo=function(a){var b=new n;E.a({action:"extendedspatialreferenceinfo",spatialReference:x(a)}).then(function(a){0===a.status?b.reject(Error(a.error.message)):b.resolve(a.result)},function(a){b.reject(a)});return b.promise};a.equals=function(a,b){return null===a&&null!==b||null===b&&null!==a?!1:z("equals",a,b)};
a.intersects=function(a,b){if(null===a||null===b)throw Error("Illegal Argument Exception");return z("intersects",a,b)};a.touches=function(a,b){if(null===a||null===b)throw Error("Illegal Argument Exception");return z("touches",a,b)};a.within=function(a,b){if(null===a||null===b)throw Error("Illegal Argument Exception");return z("within",a,b)};a.disjoint=function(a,b){if(null===a||null===b)throw Error("Illegal Argument Exception");return z("disjoint",a,b)};a.overlaps=function(a,b){if(null===a||null===
b)throw Error("Illegal Argument Exception");return z("overlaps",a,b)};a.crosses=function(a,b){if(null===a||null===b)throw Error("Illegal Argument Exception");return z("crosses",a,b)};a.contains=function(a,b){if(null===a||null===b)throw Error("Illegal Argument Exception");return z("contains",a,b)};a.isSimple=function(a){return z("issimple",a,null)};a.clip=function(a,b){return y("clip",a,b)};a.simplify=function(a){var b=new n,c=a.spatialReference;E.a({action:"simplify",geoma:w(a),spatialReference:x(a.spatialReference)}).then(function(a){0===
a.status?b.reject(Error(a.error.message)):b.resolve(q(a.result,c))},function(a){b.reject(a)});return b.promise};a.rotate=function(a,b,c){var d=new n,e=a.spatialReference;if(void 0===c||null===c)switch(a.type){case "point":c=a;break;case "extent":c=A?a.get("center"):a.getCenter();break;default:c=A?a.get("extent").get("center"):a.getExtent().getCenter()}E.a({action:"rotate",geoma:w(a),spatialReference:x(a.spatialReference),angle:b,rotpt:w(c)}).then(function(a){0===a.status?d.reject(Error(a.error.message)):
d.resolve(q(a.result,e))},function(a){d.reject(a)});return d.promise};a.flipHorizontal=function(a,b){var c=new n,d=a.spatialReference;if(void 0===b||null===b)switch(a.type){case "point":b=a;break;case "extent":b=A?a.get("center"):a.getCenter();break;default:b=A?a.get("extent").get("center"):a.getExtent().getCenter()}E.a({action:"fliph",geoma:w(a),spatialReference:x(a.spatialReference),flippt:w(b)}).then(function(a){0===a.status?c.reject(Error(a.error.message)):c.resolve(q(a.result,d))},function(a){c.reject(a)});
return c.promise};a.flipVertical=function(a,b){var c=new n,d=a.spatialReference;if(void 0===b||null===b)switch(a.type){case "point":b=a;break;case "extent":b=A?a.get("center"):a.getCenter();break;default:b=A?a.get("extent").get("center"):a.getExtent().getCenter()}E.a({action:"flipv",geoma:w(a),spatialReference:x(a.spatialReference),flippt:w(b)}).then(function(a){0===a.status?c.reject(Error(a.error.message)):c.resolve(q(a.result,d))},function(a){c.reject(a)});return c.promise};a.distance=function(a,
b,c){var d=new n;E.a({action:"distance",geoma:w(a),geomb:w(b),spatialReference:x(a.spatialReference),distanceunits:t(c,3)}).then(function(a){0===a.status?d.reject(Error(a.error.message)):d.resolve(a.result)},function(a){d.reject(a)});return d.promise};a.relate=function(a,b,c){var d=new n;E.a({action:"relate",geoma:w(a),geomb:w(b),relation:c,spatialReference:x(a.spatialReference)}).then(function(a){0===a.status?d.reject(Error(a.error.message)):d.resolve(a.result)},function(a){d.reject(a)});return d.promise};
a.nearestCoordinate=function(a,b,c){var d=new n,e=a.spatialReference;E.a({action:"nearestcoord",geoma:w(a),geomb:w(b),spatialReference:x(a.spatialReference),testinterior:void 0===c?!0:c}).then(function(a){0===a.status?d.reject(Error(a.error.message)):(a.result.coordinate=q(a.result.coordinate,e),d.resolve(a.result))},function(a){d.reject(a)});return d.promise};a.nearestVertex=function(a,b){var c=new n,d=a.spatialReference;E.a({action:"nearestvertex",geoma:w(a),geomb:w(b),spatialReference:x(a.spatialReference)}).then(function(a){0===
a.status?c.reject(Error(a.error.message)):(a.result.coordinate=q(a.result.coordinate,d),c.resolve(a.result))},function(a){c.reject(a)});return c.promise};a.nearestVertices=function(a,b,c,d){var e=new n,f=a.spatialReference;E.a({action:"nearestvertices",geoma:w(a),geomb:w(b),spatialReference:x(a.spatialReference),searchradius:c,maxreturn:d}).then(function(a){if(0===a.status)e.reject(Error(a.error.message));else{for(var b=0;b<a.result.length;b++)a.result[b].coordinate=q(a.result[b].coordinate,f);e.resolve(a.result)}},
function(a){e.reject(a)});return e.promise};a.cut=function(a,b){var c=new n,d=a.spatialReference;E.a({action:"cut",geoma:w(a),geomb:w(b),spatialReference:x(a.spatialReference)}).then(function(a){if(0===a.status)c.reject(Error(a.error.message));else{for(var b=0;b<a.result.length;b++)a.result[b]=q(a.result[b],d);c.resolve(a.result)}},function(a){c.reject(a)});return c.promise};a.generalize=function(a,b,c,d){var e=new n,f=a.spatialReference;E.a({action:"generalize",geoma:w(a),maxdeviation:b,removedegenerateparts:c,
maxdeviationunit:t(d,3),spatialReference:x(a.spatialReference)}).then(function(a){0===a.status?e.reject(Error(a.error.message)):e.resolve(q(a.result,f))},function(a){e.reject(a)});return e.promise};a.densify=function(a,b,c){var d=new n,e=a.spatialReference;E.a({action:"densify",geoma:w(a),maxsegmentlength:b,maxsegmentlengthunit:t(c,3),spatialReference:x(a.spatialReference)}).then(function(a){0===a.status?d.reject(Error(a.error.message)):d.resolve(q(a.result,e))},function(a){d.reject(a)});return d.promise};
a.geodesicDensify=function(a,b,c,d){void 0===d&&(d=0);var e=new n,f=a.spatialReference;E.a({action:"geodensify",geoma:w(a),maxsegmentlength:b,maxsegmentlengthunit:t(c,3),spatialReference:x(a.spatialReference),curveType:d}).then(function(a){0===a.status?e.reject(Error(a.error.message)):e.resolve(q(a.result,f))},function(a){e.reject(a)});return e.promise};a.intersect=function(b,d){return b instanceof c?y("intersect",b,d):a.u(b,d)};a.u=function(a,b){for(var c=new n,d=[],e=0;e<a.length;e++)d.push(w(a[e]));
var f=b.spatialReference;E.a({action:"intersectmany",geom:w(b),geometries:d,spatialReference:x(b.spatialReference)}).then(function(a){if(0===a.status)c.reject(Error(a.error.message));else{for(var b=0;b<a.result.length;b++)a.result[b]=q(a.result[b],f);c.resolve(a.result)}},function(a){c.reject(a)});return c.promise};a.difference=function(b,d){return b instanceof c?y("difference",b,d):a.s(b,d)};a.s=function(a,b){for(var c=new n,d=[],e=0;e<a.length;e++)d.push(w(a[e]));var f=b.spatialReference;E.a({action:"differencemany",
geom:w(b),geometries:d,spatialReference:x(b.spatialReference)}).then(function(a){if(0===a.status)c.reject(Error(a.error.message));else{for(var b=0;b<a.result.length;b++)a.result[b]=q(a.result[b],f);c.resolve(a.result)}},function(a){c.reject(a)});return c.promise};a.symmetricDifference=function(b,d){return b instanceof c?y("symdifference",b,d):a.w(b,d)};a.w=function(a,b){for(var c=new n,d=[],e=0;e<a.length;e++)d.push(w(a[e]));var f=b.spatialReference;E.a({action:"symdifferencemany",geom:w(b),geometries:d,
spatialReference:x(b.spatialReference)}).then(function(a){if(0===a.status)c.reject(Error(a.error.message));else{for(var b=0;b<a.result.length;b++)a.result[b]=q(a.result[b],f);c.resolve(a.result)}},function(a){c.reject(a)});return c.promise};a.union=function(a,b){void 0===b&&(b=null);var d=new n,e=[];if(null===a)return d.resolve(null),d.promise;a instanceof c&&(a=[a],null!==b&&a.push(b));if(0===a.length)return d.resolve(null),d.promise;for(b=0;b<a.length;b++)e.push(w(a[b]));var f=a[0].spatialReference;
E.a({action:"unionmany",geometries:e,spatialReference:x(f)}).then(function(a){0===a.status?d.reject(Error(a.error.message)):d.resolve(q(a.result,f))},function(a){d.reject(a)});return d.promise};a.buffer=function(b,d,e,f){void 0===f&&(f=!1);if(b instanceof c){var g=new n,h=b.spatialReference;E.a({action:"buffer",geoma:w(b),spatialReference:x(b.spatialReference),distance:d,unit:t(e,3),geodesic:!1,geodesicmaxdeviation:NaN,geodesiccurvetype:0}).then(function(a){0===a.status?g.reject(Error(a.error.message)):
g.resolve(q(a.result,h))},function(a){g.reject(a)});return g.promise}if("[object Array]"!==Object.prototype.toString.call(d)){for(var l=[],k=0;k<b.length;k++)l.push(d);d=l}if(d.length!=b.length){if(0==d.length)throw Error("Illegal Argument Exception");for(var l=[],m=0,k=0;k<b.length;k++)void 0===d[k]?l.push(m):(l.push(d[k]),m=d[k]);d=l}return a.j(b,d,e,!1,f,"geodesic",NaN)};a.geodesicBuffer=function(b,d,e,f,g,h){if(b instanceof c){var l=new n;void 0===g&&(g=NaN);var k=b.spatialReference;E.a({action:"buffer",
geoma:w(b),spatialReference:x(b.spatialReference),distance:d,unit:t(e,0),geodesic:!0,geodesicmaxdeviation:g,geodesiccurvetype:r(f)}).then(function(a){0===a.status?l.reject(Error(a.error.message)):l.resolve(q(a.result,k))},function(a){l.reject(a)});return l.promise}if("[object Array]"!==Object.prototype.toString.call(d)){for(var m=[],u=0;u<b.length;u++)m.push(d);d=m}if(d.length!=b.length){if(0==d.length)throw Error("Illegal Argument Exception");for(var m=[],B=0,u=0;u<b.length;u++)void 0===d[u]?m.push(B):
(m.push(d[u]),B=d[u]);d=m}return a.j(b,d,e,!0,f,g,h)};a.j=function(a,b,c,d,e,f,g){var h=new n,l=[];void 0===g&&(g=NaN);if(null===a||0===a.length)return h.resolve(null),h.promise;for(var k=0;k<a.length;k++)l.push(w(a[k]));c=d?t(c,0):t(c,3);var m=a[0].spatialReference;E.a({action:"buffermany",geometries:l,spatialReference:x(m),distances:b,tounionresults:e,unit:c,geodesic:d,geodesicmaxdeviation:g,geodesiccurvetype:r(f)}).then(function(a){if(0===a.status)h.reject(Error(a.error.message));else{for(var b=
0;b<a.result.length;b++)a.result[b]=q(a.result[b],m);h.resolve(a.result)}},function(a){h.reject(a)});return h.promise};a.convexHull=function(b,d){void 0===d&&(d=!1);if(b instanceof c){var e=new n,f=b.spatialReference;E.a({action:"convexhull",geoma:w(b),spatialReference:x(b.spatialReference)}).then(function(a){0===a.status?e.reject(Error(a.error.message)):e.resolve(q(a.result,f))},function(a){e.reject(a)});return e.promise}return a.o(b,d)};a.o=function(a,b){for(var c=new n,d=[],e=0;e<a.length;e++)d.push(w(a[e]));
var f=0<a.length?a[0].spatialReference:null;E.a({action:"convexhullmany",geometries:d,merge:b}).then(function(a){if(0===a.status)c.reject(Error(a.error.message));else{for(var b=0;b<a.result.length;b++)a.result[b]=q(a.result[b],f);c.resolve(a.result)}},function(a){c.reject(a)});return c.promise};a.offset=function(b,d,e,f,g,h){var l=0;if(null!=f&&void 0!=f)switch(f){case "round":l=0;break;case "bevel":l=1;break;case "miter":l=2;break;case "square":l=3}if(b instanceof c){var k=new n,m=b.spatialReference;
E.a({action:"offset",geoma:w(b),spatialReference:x(b.spatialReference),distance:d,joins:l,bevelratio:g,flattenerror:h,offsetunit:t(e,3)}).then(function(a){0===a.status?k.reject(Error(a.error.message)):k.resolve(q(a.result,m))},function(a){k.reject(a)});return k.promise}return a.v(b,d,e,l,g,h)};a.v=function(a,b,c,d,e,f){for(var g=new n,h=[],l=0;l<a.length;l++)h.push(w(a[l]));var k=0<a.length?a[0].spatialReference:null;E.a({action:"offsetmany",geometries:h,spatialReference:x(k),distance:b,joins:d,bevelratio:e,
offsetunit:t(c,3),flattenerror:f}).then(function(a){if(0===a.status)g.reject(Error(a.error.message));else{for(var b=0;b<a.result.length;b++)a.result[b]=q(a.result[b],k);g.resolve(a.result)}},function(a){g.reject(a)});return g.promise};a.planarArea=function(a,b){var c=new n;E.a({action:"area",geoma:w(a),unit:t(b,2),spatialReference:x(a.spatialReference)}).then(function(a){0===a.status?c.reject(Error(a.error.message)):c.resolve(a.result)},function(a){c.reject(a)});return c.promise};a.planarLength=function(a,
b){var c=new n;E.a({action:"length",geoma:w(a),unit:t(b,3),spatialReference:x(a.spatialReference)}).then(function(a){0===a.status?c.reject(Error(a.error.message)):c.resolve(a.result)},function(a){c.reject(a)});return c.promise};a.geodesicArea=function(a,b,c){var d=new n;E.a({action:"geodesicarea",geoma:w(a),unit:t(b,2),geodesiccurvetype:r(c),spatialReference:x(a.spatialReference)}).then(function(a){0===a.status?d.reject(Error(a.error.message)):d.resolve(a.result)},function(a){d.reject(a)});return d.promise};
a.geodesicLength=function(a,b,c){var d=new n;E.a({action:"geodesiclength",geoma:w(a),unit:t(b,0),geodesiccurvetype:r(c),spatialReference:x(a.spatialReference)}).then(function(a){0===a.status?d.reject(Error(a.error.message)):d.resolve(a.result)},function(a){d.reject(a)});return d.promise};return a}()})},"esri/views/3d/layers/i3s/I3SNodeLoader":function(){define("require exports dojo/_base/lang ../../webgl-engine/lib/Util ./I3SUtil ./I3SBinaryReader ../../support/PromiseLightweight ../../support/projectionUtils ../../lib/glMatrix ../../support/PromiseNativeOrShim ../../../../core/urlUtils".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f){var n=a.assert,u=e.vec4d,t={};return function(){function a(b,c,d,e,g,h,k,n,m,t,u,r,F,L,Q){this.bundleLoadedCallback=c;this.queueFunctionCall=d;this.debugVis=e;this.renderCoordsHelper=g;this.indexSR=h;this.calcDesiredTextureLOD=k;this.imageIsPartOfTextureBundle=n;this.matId2Meta=m;this.texId2Meta=t;this.useCompressedTextures=u;this.logger=r;this.defaultGeometrySchema=F;this.requiredAttributes=L;this.bypassFeatureData=Q;this.texIdToPromises={};this._numLoadAttributes=
0;this.loadShared=function(b){if(null==b.sharedResource)return l.resolve({});var c=f.makeAbsolute(b.sharedResource.href,b.baseUrl)+"/";b.sharedResource.hrefConcat=c;return this.loadJSON(c).then(function(b){a.fixTextureEncodings(b);a.addAbsoluteHrefTexture(b,c);return b})};this.loader=b;this.cancelled=!1}Object.defineProperty(a.prototype,"isLoadingAttributes",{get:function(){return 0<this._numLoadAttributes},enumerable:!0,configurable:!0});a.prototype.waitForAnimationFrame=function(){var a=this;return new l(function(b,
c){a.queueFunctionCall(b,null,[],c)})};a.prototype.cancel=function(){this.cancelled=!0};a.prototype.loadJSON=function(a){var b=this.loader.request(a,"json");return new l(function(c,d){b.then(function(a,b){c(b)},function(b){d(Error("Failed to load: "+a))})})};a.prototype.loadBinary=function(a){var b=this.loader.request(a,"binary");return new l(function(c,d){b.then(function(a,b){c(b)},function(b){d(Error("Failed to load: "+a))})})};a.prototype.loadImage=function(a){var b=this.loader.request(a,"image");
return new l(function(c,d){b.then(function(a,b){c(b)},function(b){d(Error("Failed to load: "+a))})})};a.prototype.loadAttribute=function(a,b,d){a=c.addTrailingSlash(f.makeAbsolute(d,a));return this.loadBinary(a).then(function(a){return h.readBinaryAttribute(b,a)})};a.prototype.loadAttributes=function(a,b,c){var d=this,e=c.map(function(c){null!=a.attributeData&&null!=a.attributeData[c.index]||d.logger.error("Missing attributeData for '"+c.name+"' on node '"+a.id+"'");return d.loadAttribute(b,c.attributeStorageInfo,
a.attributeData[c.index].href).catch(function(b){d.logger.error("Failed to load attributeData for '"+c.name+"' on node '"+a.id+"'");return null})});this._numLoadAttributes++;return l.all(e).then(function(a){d._numLoadAttributes--;for(var b={},e=0;e<c.length;++e)a[e]&&(b[c[e].name]=a[e]);return b}).catch(function(a){d._numLoadAttributes--;throw a;})};a.prototype.prepareBinaryGeometryData=function(a,d,e,f){b.mixin(a.geometries[0].params,e);a.faceRanges[0][0]=0;a.faceRanges[0][1]=e.header.fields.vertexCount/
3-1;f||null!=e.vertexAttributes.region||delete e.vertexAttributes.region;if(null!=e.featureAttributes){f=e.featureAttributes;if(f.faceRange){a.faceRanges=[];for(var g=h.createTypedView(d,f.faceRange),l=f.faceRange.valuesPerElement,k=e.header.fields.featureCount,n=0;n<k;n++)a.faceRanges[n]=[g[n*l],g[n*l+1]];a.componentOffsets=c.convertFlatRangesToOffsets(g,k,l)}if(f.id)for(a.featureIds=[],g=1,n=h.valueType2TypedArrayClassMap[f.id.valueType],"UInt64"===f.id.valueType&&(n=Uint32Array,g=2),d=new n(d,
f.id.byteOffset,f.id.count*f.id.valuesPerElement*g),n=0;n<e.header.fields.featureCount;n++)if(a.featureIds[n]=d[n*f.id.valuesPerElement*g],2===g){l=d[n*f.id.valuesPerElement*g+1];if(2097150<=l)throw Error("ID exceeded maximum range supported by javascript (max \x3d 53bit-1 \x3d 9007199254740991)");a.featureIds[n]+=4294967296*l}}};a.prototype.loadNodeData=function(c,d,e,g,k){var n=this,m=null==c.features,q=c.baseUrl,t={},u=this.loadShared(c),r=u.then(function(a){return n.loadReferencedShared(a,q)}),
w=null;null!=this.requiredAttributes&&(w=this.loadAttributes(c,q,this.requiredAttributes));var x=null;null!=c.geometryData&&(x=c.geometryData.map(function(a,b){if(-1===d.indexOf(b))return null;b=f.makeAbsolute(a.href,q);a.hrefConcat=b;return n.loadBinary(b)}));l.all([u,r]).then(function(e){var f=e[0];e=e[1];n.handleCancelled();c.sharedResource&&(t[c.sharedResource.hrefConcat]=f,b.mixin(t,e));e=d.map(function(b){return n.loadFeatureData(c,b,f).then(function(d){n.handleCancelled();m&&a.buildNodeFeatures(c,
b,d);var e=n.collectGeometries(c,b,d,f);d=null;d=null!=x&&null!=x[b]?x[b].then(function(a){t[c.geometryData[b].hrefConcat]=a;var d=Object.keys(f.materialDefinitions)[0],d=f.materialDefinitions[d].params.vertexRegions,g=h.createGeometryDataIndex(a,n.defaultGeometrySchema,d);n.prepareBinaryGeometryData(e[0],a,g,d);return e}):l.resolve(e);var k=g?n.loadTextures(e,f,n.matId2Meta,n.texId2Meta).then(function(a){var b={};a.forEach(function(a){var c=a.i3sTexId;b[c]={i3sTexId:c,data:a.data,encoding:a.encoding,
desiredLOD:a.desiredLOD,createdTextureForDomImage:function(){n.texIdToPromises[c]&&delete n.texIdToPromises[c]}}});return b}):null;return l.all([k,d,w])}).then(function(a){var d=a[0],e=a[1];a=a[2];n.handleCancelled();void 0!==n.debugVis&&n.debugVis.show(c,n.indexSR,"green");var f=null;a&&(f={attributeData:a,loadedAttributes:n.requiredAttributes});return n.callbackWrapped(c,e,f,t,d,b,k)}).catch(function(a){n.handleCancelled();n.logger.error("Failed to load node '"+c.id+"' bundle "+b+": "+a);return n.callbackWrapped(c,
null,null,t,null,b,k)})});return l.all(e)}).catch(function(a){if(!n.cancelled)return n.logger.error("Failed to shared data of node '"+c.id+"': "+a),a=d.map(function(a){return n.callbackWrapped(c,null,null,t,null,a,k)}),l.all(a)}).then(function(){e.done()})};a.prototype.callbackWrapped=function(a,b,c,d,e,f,h){var k=this;return this.waitForAnimationFrame().then(function(){return new l(function(l,n){var m=new g.Promise,q=k.bundleLoadedCallback;q(a,b,c,d,m,e,f,h);m.then(l,n)})})};a.addAbsoluteHrefTexture=
function(a,b){a=a.textureDefinitions;if(void 0!==a)for(var c in a)if(a.hasOwnProperty(c))for(var d=a[c],e=0;e<d.images.length;e++){var g=d.images[e];Array.isArray(d.encoding)?g.hrefConcat=g.href.map(function(a){return f.makeAbsolute(a,b)}):g.hrefConcat=f.makeAbsolute(g.href,b)}};a.fixTextureEncodings=function(a){a=a.textureDefinitions;if(null!=a)for(var b in a){var c=a[b];if(Array.isArray(c.encoding))for(var d=0;d<c.encoding.length;d++){var e=c.encoding[d];"data:"===e.substring(0,5)&&(c.encoding[d]=
e.substring(5))}else e=c.encoding,"data:"===e.substring(0,5)&&(c.encoding=e.substring(5))}};a.prototype.loadReferencedShared=function(b,c){var d=this;if(null==b||null==b.materialDefinitions)return l.resolve({});var e=Object.keys(b.materialDefinitions).filter(function(a){return b.materialDefinitions[a]&&null!=b.materialDefinitions[a].href}).map(function(a){return f.makeAbsolute(b.materialDefinitions[a].href,c)+"/"});return l.all(e.map(function(a){return d.loadJSON(a).then(function(b){return[a,b]})})).then(function(b){for(var c=
{},d=0;d<b.length;d++){var e=b[d],f=e[0],e=e[1];a.fixTextureEncodings(e);a.addAbsoluteHrefTexture(e,f);c[f]=e}return c})};a.prototype.loadTexture=function(a,b,d,e,f,g){var h=this,k=-1<g?d.encoding[g]:d.encoding;d=k===c.DDS_ENCODING_STRING;var m=this.imageIsPartOfTextureBundle(e);n(!(d&&m),"DDS in multi texture bundles not supported at the moment");return d?this.loadBinary(a).then(function(a){return h.cancelled?l.reject():{i3sTexId:b,data:a,encoding:k,desiredLOD:f}}):m?this.loadBinary(a).then(function(c){var d;
try{var m=void 0,q;-1<g?(n(Array.isArray(e.byteOffset)&&Array.isArray(e.length),"texture encoding is array, but image byteOffset/length isn't"),m=e.byteOffset[g],q=e.length[g]):(m=e.byteOffset,q=e.length);var t=new Uint8Array(c,m,q),u=new Blob([t],{type:k});d=window.URL.createObjectURL(u)}catch(J){d="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAIElEQVQ4T2P8zyD6n4ECwDhqAMNoGDCMhgEwDw2DdAAAdzkhQdS8dl8AAAAASUVORK5CYII\x3d",h.logger.error("error loading texture "+a+": "+J)}var r=
new Image;c=new l(function(a,c){var e=function(){window.URL.revokeObjectURL(d);r.onerror=void 0;r.onload=void 0};r.onerror=function(a){e();c(a)};r.onload=function(){e();h.cancelled?c():a({i3sTexId:b,data:r,encoding:k,desiredLOD:f})}});r.src=d;return c}):this.loadImage(a).then(function(a){return h.cancelled?l.reject():{i3sTexId:b,data:a,encoding:k,desiredLOD:f}})};a.getAllEngineMBS=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c].engineMBS);return b};a.prototype.loadTextures=function(b,d,e,
f){for(var g=[],h=0;h<b.length;h++)for(var k=b[h].geometries,m=a.getAllEngineMBS(b[h].features),q=0;q<k.length;++q)for(var t=k[q],u=t.params.components.length,r=0;r<u;r++){var w=t.params.components[r],x=w.materialID,w=w.textureID||"none";if((!e[x]||null==e[x][w])&&null==f[w]&&"none"!==w)if(null!=this.texIdToPromises[w])g.push(this.texIdToPromises[w]);else{null!=d.textureDefinitions&&null!=d.textureDefinitions[w]||this.logger.warn("textureDefinitions missing in shared resource. i3sTexId: "+w);x=d.textureDefinitions[w];
n(void 0!==x,"geometry wants unknown texture "+w);var y=this.calcDesiredTextureLOD(m,x.images);if(0!==x.images.length){var N=x.images[y],J=c.getAppropriateTextureEncoding(x.encoding,this.useCompressedTextures()),x=this.loadTexture(-1<J?N.hrefConcat[J]:N.hrefConcat,w,x,N,y,J);g.push(x);this.texIdToPromises[w]=x}}}return l.all(g)};a.getIdFromJsonPointer=function(a){a=a.split("/");return a[a.length-1]};a.buildNodeFeatures=function(a,b,c){null==a.features&&(a.features=[]);for(var d in c.featureData)a.features.push({id:c.featureData[d].id,
mbs:a.mbs,block:b})};a.prototype.collectGeometries=function(b,c,e,f){var g=[],h=!1,l=0,k=b.features.length-1;null==b.featureData[c].featureRange?h=!0:(l=b.featureData[c].featureRange[0],k=b.featureData[c].featureRange[1]);for(;l<=k;++l){var m=b.features[l];if(!m.engineMBS){var q=u.create();d.mbsToMbs(m.mbs,this.indexSR,q,this.renderCoordsHelper.spatialReference);q[3]=m.mbs[3];m.engineMBS=q}if(!h||m.block===c){for(var t=e.featureData,q=void 0,r=0;r<t.length;r++)if(t[r].id===m.id){q=t[r];break}n(null!=
q,"I3S: unable to find feature data in specified block in node.id "+b.id+" feature.id "+m.id);var t=q.geometries,r=[],w=[];if(null!=t)for(var x=0;x<t.length;x++){var y=q.geometries[x];if("GeometryReference"===y.type){for(var N=a.getIdFromJsonPointer(y.params.$ref),J=void 0,P=0;P<e.geometryData.length;P++){var I=e.geometryData[P];if(I.id+""===N){J=I;break}}n(null!=J,"I3S: Unable to find referenced geometry");null==J.params.material&&(this.logger.warn("material definition is missing in featureData, node: "+
b.id),P=Object.keys(f.materialDefinitions)[0],J.params.material="/materialDefinitions/"+P);null==J.params.components&&(J.params.components=null!=J.params.texture?[{material:J.params.material,materialID:a.getIdFromJsonPointer(J.params.material),texture:J.params.texture,textureID:a.getIdFromJsonPointer(J.params.texture),id:1}]:[{material:J.params.material,materialID:a.getIdFromJsonPointer(J.params.material),id:1}],null!=J.params.faces&&null!=J.params.faces.position&&(J.params.faces.position.componentIndices=
[0]));I=void 0;I=null;for(P=0;P<g.length;P++)if(1===g[P].geometries.length&&g[P].geometries[0].id+""===N){I=g[P];break}null===I&&(I={features:[],featureDataPositions:[],faceRanges:[],geometries:[J]},g.push(I));I.features.push(m);I.featureDataPositions.push(q.position);I.faceRanges.push(y.params.faceRange)}else r.push(y),null!=y.params.faceRange&&w.push(y.params.faceRange)}else null!=q.position&&r.push({id:m.id,type:"Embedded",params:{type:"points",vertexAttributes:{position:[0,0,0]}}});0===w.length&&
(w=null);0<r.length&&g.push({features:[m],featureDataPositions:[q.position],geometries:r,faceRanges:w})}}return g};a.prototype.idHash=function(a){var b=0,c=a.length;if(0===c)return b;for(var d=0;d<c;d++)var e=a.charCodeAt(d),b=(b<<5)-b+e,b=b|0;return b};a.prototype.loadFeatureData=function(b,c,d){if(this.bypassFeatureData&&this.defaultGeometrySchema){b=this.idHash(b.id);var e=c=void 0;null!=d.materialDefinitions&&(c=Object.keys(d.materialDefinitions)[0]);null!=d.textureDefinitions&&(e=Object.keys(d.textureDefinitions)[0]);
d=a.buildDefaultFeatureData(b,c,e,null);return l.resolve(d)}d=f.makeAbsolute(b.featureData[c].href,b.baseUrl);b.featureData[c].hrefConcat=d;return this.loadJSON(d)};a.buildDefaultFeatureData=function(a,b,c,d){return{featureData:[{id:a,position:[0,0,0],pivotOffset:[0,0,0],mbb:d,layer:"Default",geometries:[{id:1,type:"GeometryReference",params:{$ref:"/geometryData/0",faceRange:[0,0]}}]}],geometryData:[{id:0,type:"ArrayBufferView",params:{type:"triangles",material:"/materialDefinitions/"+b,texture:null!=
c?"/textureDefinitions/"+c:void 0}}]}};a.prototype.handleCancelled=function(){if(this.cancelled)throw t;};return a}()})},"esri/views/3d/layers/i3s/I3SUtil":function(){define("require exports ../../lib/glMatrix ../../support/earthUtils ../../support/projectionUtils ../../../../core/promiseUtils ../../../../core/Error ../../../../core/urlUtils ../../../../geometry/support/webMercatorUtils ../../../../tasks/QueryTask ../../../../tasks/support/Query dojo/_base/lang dojo/promise/all ../../../../request ../../../../geometry/SpatialReference ../../webgl-engine/Stage ../../webgl-engine/materials/Material ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/Layer ../../webgl-engine/lib/Util ./I3SBinaryReader".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f,n,u,t,r,w,q,x,y,z,A,C,B){function D(a){return a&&parseInt(a.substring(a.lastIndexOf("/")+1,a.length),10)}function H(a,b,d,e,f,g){if(null!=d){var h=aa;c.mbsToMbs(d.mbs,e,h,b);if(0!==K(a,h)){g.push(d);for(var h=null!=d.children?d.children.length:0,l=0;l<h;l++)H(a,b,f[d.children[l].id],e,f,g)}}}function K(a,b){var c=b[0],d=b[1],e=b[2];b=b[3];var f=0;if(c<a[0])var g=a[0]-c,f=f+g*g;d<a[1]&&(g=a[1]-d,f+=g*g);e<a[2]&&(g=a[2]-e,f+=g*g);c>a[3]&&(g=c-a[3],f+=g*g);d>a[4]&&(g=d-
a[4],f+=g*g);e>a[5]&&(g=e-a[5],f+=g*g);if(f>b*b)return 0;if(0<f)return 1;f=Infinity;c-a[0]<f&&(f=c-a[0]);d-a[1]<f&&(f=d-a[1]);e-a[2]<f&&(f=e-a[2]);a[3]-c<f&&(f=a[3]-c);a[4]-d<f&&(f=a[4]-d);a[5]-e<f&&(f=a[5]-e);return f>b?2:1}function E(a,b,c){void 0===c&&(c=["*"]);if(null!=a.maxRecordCount&&b.length>a.maxRecordCount){var d=Q(b,a.maxRecordCount);return u(d.map(function(b){return E(a,b,c)})).then(N)}d=new f({objectIds:b,outFields:c,orderByFields:[a.objectIdField]});return(new l(a.parsedUrl.path)).execute(d).then(function(a){return a&&
a.features&&a.features.length===b.length?a.features.map(function(a){return a.attributes}):h.reject(new g("scenelayer:feature-not-in-companion","Feature not found in companion feature layer"))})}function F(a,b,c,e,f){void 0===e&&(e=["*"]);var g=e.some(function(a){return"*"===a}),l=g?null:e.map(function(a){return a.toLowerCase()});return u(b.attributeData.map(function(c,e){var k=a[e].name.toLowerCase();if(!g&&!l.some(function(a){return k===a}))return h.resolve(null);c=d.makeAbsolute(c.href,b.baseUrl);
return t(c,{query:{token:f},responseType:"array-buffer"}).then(function(b){return B.readBinaryAttribute(a[e],b.data)}).otherwise(function(){return null})})).then(function(b){for(var d=[],e=0;e<c.length;e++){for(var f=c[e],g={},h=0;h<b.length;h++)null!=b[h]&&(g[a[h].name]=L(b[h],f));d.push(g)}return d})}function L(a,b){a=a[b];return a!==a?null:a}function Q(a,b){var c=a.length;b=Math.ceil(c/b);for(var d=[],e=0;e<b;e++)d.push(a.slice(Math.floor(c*e/b),Math.floor(c*(e+1)/b)));return d}function N(a){for(var b=
[],c=0;c<a.length;c++)b=b.concat(a[c]);return b}function J(a){var b=new r(D(a.store.indexCRS||a.store.geographicCRS));return b.equals(a.spatialReference)?a.spatialReference:b}function P(a){var b=new r(D(a.store.vertexCRS||a.store.projectedCRS));return b.equals(a.spatialReference)?a.spatialReference:b}function I(a,b,c){if(!e.canProject(a,b))throw new g("layerview:spatial-reference-incompatible","The spatial reference of this scene layer is incompatible with the spatial reference of the view",{});if("local"===
c&&a.isGeographic)throw new g("layerview:local-gcs-not-supported","Geographic coordinate systems are not supported in local scenes",{});}function O(a,b,c){var d=J(a);a=P(a);I(d,b,c);I(a,b,c)}var ea=b.vec4d,W=b.vec3d,fa=b.mat4d,X=C.assert,aa=ea.create();k.DDS_ENCODING_STRING="image/vnd-ms.dds";k.BROWSER_SUPPORTED_IMAGE_ENCODING_STRINGS=["image/jpeg","image/png"];k.addTrailingSlash=function(a){"/"!==a[a.length-1]&&(a+="/");return a};k.extractWkid=D;k.processNormals=function(a,b,d){switch(b){case "none":b=
a.normals;d=a.positions;var e=a.normalInd,f=a.positionInd;X(a.normalInd.length===a.positionInd.length);a=W.create();for(var g=W.create(),h=0;h<f.length;h+=3){var l=3*f[h],k=d[l],n=d[l+1],m=d[l+2],l=3*f[h+1];a[0]=d[l]-k;a[1]=d[l+1]-n;a[2]=d[l+2]-m;l=3*f[h+2];g[0]=d[l]-k;g[1]=d[l+1]-n;g[2]=d[l+2]-m;W.cross(a,g,a);W.normalize(a);for(l=0;3>l;l++)k=3*e[h+l],b[k]=a[0],b[k+1]=a[1],b[k+2]=a[2]}break;case "east-north-up":break;case "earth-centered":d(a.normals,c.SphericalRenderSpatialReference);break;case "vertex-reference-frame":break;
default:throw Error("Received unexpected normalReferenceFrame: "+b);}};k.getAppropriateTextureEncoding=function(a,b){if(Array.isArray(a)){if(b&&(b=a.indexOf(k.DDS_ENCODING_STRING),-1<b))return b;for(b=0;b<a.length;b++)if(-1<k.BROWSER_SUPPORTED_IMAGE_ENCODING_STRINGS.indexOf(a[b]))return b;throw Error("Could not find appropriate texture encoding (among "+a.toString()+")");}return-1};k.findIntersectingNodes=H;k.intersectBoundingBoxWithMbs=K;k.makeNodeDebugVisualizer=function(b,d,e){function f(a){return{ambient:a,
diffuse:[0,0,0],transparent:!0,opacity:.5,blendModeOneOne:!1}}var g=new x(y.createCylinderGeometry(1,1,64,[0,0,1],[0,0,0],!1),"debugCylinder"),h=new x(y.createSphereGeometry(1),"debugSphere"),l={red:new q(f([.8,0,0]),"debugMaterialRed"),grey:new q(f([.4,.4,.4]),"debugMaterialGrey"),brown:new q(f([.2,.1,0]),"debugMaterialBrown"),green:new q(f([0,.8,0]),"debugMaterialGreen"),blue:new q(f([0,0,.8]),"debugMaterialBlue"),yellow:new q(f([.8,.8,0]),"debugMaterialYellow"),magenta:new q(f([.8,0,.8]),"debugMaterialMagenta")},
k;for(k in l)b.add(w.ModelContentType.MATERIAL,l[k]);b.add(w.ModelContentType.GEOMETRY,g);e=new A(e+"_debug",{interaction:"IGNORED"},e+"_debug");b.add(w.ModelContentType.LAYER,e);b.addToViewContent([e.getId()]);var n=W.create(),m=fa.create();return{engineLayer:e,added:{},show:function(b,e,f){var h=b.computedMbs;h||(h=ea.create(),c.mbsToMbs(b.mbs,e,h,d.spatialReference));var k="node"+b.id+"dbg";W.set(h,n);var q=h[3];if(q>a.earthRadius/10&&d.spatialReference===c.SphericalRenderSpatialReference){this.showWS(n,
Math.max(.01*q,1E4),f,k+"_center");var h=W.length(n),p=a.earthRadius;p+q>h&&(q=(h*h+p*p-q*q)/(2*h),W.scale(n,q/h),q=Math.sqrt(p*p-q*q))}fa.identity(m);fa.scale(m,[q,q,.05*q]);f=l[f];X(f);f=new z({name:k,geometries:[g],materials:[[f]],transformations:[m],castShadow:!1,idHint:k});c.computeLinearTransformation(e,b.mbs,m,d.spatialReference);null!=n&&(m[12]=n[0],m[13]=n[1],m[14]=n[2]);f.setObjectTransformation(m);this._addToStage(f,k)},showWS:function(a,b,c,d){var e=fa.identity();fa.scale(e,[b,b,b]);b=
l[c];X(b);e=new z({name:d,geometries:[h],materials:[[b]],transformations:[e],castShadow:!1,idHint:d});b=fa.identity();fa.translate(b,a);e.setObjectTransformation(b);this._addToStage(e,d)},_addToStage:function(a,c){b.add(w.ModelContentType.OBJECT,a);this.engineLayer.addObject(a);var d=this.added[c];void 0!==d&&(b.remove(w.ModelContentType.OBJECT,d.getId()),this.engineLayer.removeObject(d));this.added[c]=a},clear:function(){for(var a in this.added){var c=this.added[a];b.remove(w.ModelContentType.OBJECT,
c.getId());this.engineLayer.removeObject(c)}this.added={}},dispose:function(){this.clear();for(var a in l)b.remove(w.ModelContentType.MATERIAL,l[a].getId());b.remove(w.ModelContentType.GEOMETRY,g.getId());b.remove(w.ModelContentType.LAYER,this.engineLayer.getId())}}};k.findFieldsCaseInsensitive=function(a,b){for(var c=[],d=0;d<a.length;d++)for(var e=a[d].toLowerCase(),f=0,g=b;f<g.length;f++){var h=g[f];e===h.name.toLowerCase()&&c.push(h.name)}return c};k.whenGraphicAttributes=function(a,b,c,d,e){if(0===
b.length)return h.resolve(b);var f=Object.keys(b[0].attributes).map(function(a){return a.toLowerCase()});d=d.filter(function(a){return 0>f.indexOf(a.toLowerCase())});if(0===d.length)return h.resolve(b);var l=function(a){for(var c=0;c<b.length;c++)n.mixin(b[c].attributes,a[c]);return b},k=a.companionFeatureLayer,m=a.attributeStorageInfo;return k?(b.sort(function(a,b){return a.attributes[c]-b.attributes[c]}),a=b.map(function(a){return a.attributes[c]}),E(k,a,d).then(l)):m&&(e=e(),null!=e)?F(m,e.node,
e.indices,d,a.token).then(l):h.reject(new g("scenelayer:no-attribute-source","This scene layer does not have a source for attributes available"))};k.getCachedAttributeValue=L;k.convertFlatRangesToOffsets=function(a,b,c){void 0===c&&(c=2);b=null!=b?b:a.length/c;for(var d=new Uint32Array(b+1),e=0;e<b;e++){var f=a[e*c];d[e]=3*f;var h=(e-1)*c+1;if(0<=h&&f-1!==a[h])throw new g("Face ranges are not continuous");}d[d.length-1]=3*(a[(b-1)*c+1]+1);return d};k.getIndexCrs=J;k.getVertexCrs=P;k.checkSpatialReference=
I;k.checkSpatialReferences=O;k.checkSceneLayerValid=function(a){var b;(b=null==a.store||null==a.store.defaultGeometrySchema)||(a=a.store.defaultGeometrySchema,b=!!(null!=a.geometryType&&"triangles"!==a.geometryType||null!=a.topology&&"PerAttributeArray"!==a.topology||null==a.vertexAttributes||null==a.vertexAttributes.position));if(b)throw new g("scenelayer:unsupported-geometry-schema","The geometry schema of this scene layer is not supported.",{});};k.checkSceneLayerCompatibleWithView=function(a,
b){O(a,b.spatialReference,b.viewingMode)};k.checkPointCloudLayerValid=function(a){var b;(b=null==a.store||null==a.store.defaultGeometrySchema)||(a=a.store.defaultGeometrySchema,b=!!(null==a.geometryType||"points"!==a.geometryType||null!=a.topology&&"PerAttributeArray"!==a.topology||null!=a.encoding&&""!==a.encoding&&"lepcc-xyz"!==a.encoding||null==a.vertexAttributes||null==a.vertexAttributes.position));if(b)throw new g("pointcloud:unsupported-geometry-schema","The geometry schema of this point cloud scene layer is not supported.",
{});};k.checkPointCloudLayerCompatibleWithView=function(a,b){I(a.spatialReference,b.spatialReference,b.viewingMode)}})},"esri/views/3d/layers/i3s/I3SBinaryReader":function(){define("require exports dojo/_base/lang ../../../../core/Logger ../../../../core/Error ./LEPCC".split(" "),function(m,k,b,a,c,h){function g(a,b,d){for(var e="",f=0;f<d;){var g=a[b+f];if(128>g)e+=String.fromCharCode(g),f++;else if(192<=g&&224>g){if(f+1>=d)throw new c("utf8-decode-error","UTF-8 Decode failed. Two byte character was truncated.");
var h=a[b+f+1],g=(g&31)<<6|h&63,e=e+String.fromCharCode(g),f=f+2}else if(224<=g&&240>g){if(f+2>=d)throw new c("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");var h=a[b+f+1],l=a[b+f+2],g=(g&15)<<12|(h&63)<<6|l&63,e=e+String.fromCharCode(g),f=f+3}else if(240<=g&&248>g){if(f+3>=d)throw new c("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");h=a[b+f+1];l=a[b+f+2];g=(g&7)<<18|(h&63)<<12|(l&63)<<6|a[b+f+3]&63;e=65536<=g?e+String.fromCharCode((g-
65536>>10)+55296,(g&1023)+56320):e+String.fromCharCode(g);f+=4}else throw new c("utf8-decode-error","UTF-8 Decode failed. Invalid multi byte sequence.");}return e}function d(a,b){for(var c={byteOffset:0,byteCount:0,fields:Object.create(null)},d=0,e=0;e<b.length;e++){var f=b[e],g=f.valueType||f.type;c.fields[f.property]=(0,k.valueType2ArrayBufferReader[g])(a,d);d+=k.valueType2TypedArrayClassMap[g].BYTES_PER_ELEMENT}c.byteCount=d;return c}function e(a,b,d){var e=[],f,h=0,l;for(l=0;l<a;l+=1){f=b[l];
if(0<f){if(e.push(g(d,h,f-1)),0!==d[h+f-1])throw new c("string-array-error","Invalid string array: missing null termination.");}else e.push(null);h+=f}return e}function l(a,b){return new k.valueType2TypedArrayClassMap[b.valueType](a,b.byteOffset,b.count*b.valuesPerElement)}function f(a,b){return new Uint8Array(a,b.byteOffset,b.byteCount)}function n(a,e,f){a=null!=e.header?d(a,e.header):{byteOffset:0,byteCount:0,fields:{count:f}};f={header:a,byteOffset:a.byteCount,byteCount:0,entries:Object.create(null)};
for(var g=a.byteCount,h=0;h<e.ordering.length;h++){var l=e.ordering[h],k=b.clone(e[l]);k.count=a.fields.count;if("String"===k.valueType){if(k.byteOffset=g,k.byteCount=a.fields[l+"ByteCount"],"UTF-8"!==k.encoding)throw new c("unsupported-encoding","Unsupported String encoding.",{encoding:k.encoding});}else if(t(k.valueType)){var n=r(k.valueType),g=g+(0!==g%n?n-g%n:0);k.byteOffset=g;k.byteCount=n*k.valuesPerElement*k.count}else throw new c("unsupported-value-type","Unsupported binary valueType",{valueType:k.valueType});
g+=k.byteCount;f.entries[l]=k}f.byteCount=g-f.byteOffset;return f}function u(a,b,d){b!==a&&w.error("Invalid "+d+" buffer size\n expected: "+a+", actual: "+b+")");if(b<a)throw new c("buffer-too-small","Binary buffer is too small",{expectedSize:a,actualSize:b});}function t(a){return k.valueType2TypedArrayClassMap.hasOwnProperty(a)}function r(a){return t(a)&&k.valueType2TypedArrayClassMap[a].BYTES_PER_ELEMENT}var w=a.getLogger("esri.layers.SceneService");k.readHeader=d;k.readStringArray=e;k.createTypedView=
l;k.createRawView=f;k.createAttributeDataIndex=n;k.createGeometryDataIndex=function(a,c,e){var f=d(a,c.header),g=f.byteCount,h={header:f,byteOffset:f.byteCount,byteCount:0,vertexAttributes:b.clone(c.vertexAttributes)},l=h.vertexAttributes;e||null==l.region||delete l.region;var k=f.fields.vertexCount||f.fields.count;for(e=0;e<c.ordering.length;e++){var n=c.ordering[e];null!=l[n]&&(l[n].byteOffset=g,l[n].count=k,g+=r(l[n].valueType)*l[n].valuesPerElement*k)}l=f.fields.faceCount;if(c.faces&&l)for(h.faces=
b.clone(c.faces),k=h.faces,e=0;e<c.ordering.length;e++)n=c.ordering[e],null!=k[n]&&(k[n].byteOffset=g,k[n].count=l,g+=r(k[n].valueType)*k[n].valuesPerElement*l);f=f.fields.featureCount;if(c.featureAttributes&&c.featureAttributeOrder&&f)for(h.featureAttributes=b.clone(c.featureAttributes),l=h.featureAttributes,e=0;e<c.featureAttributeOrder.length;e++)k=c.featureAttributeOrder[e],l[k].byteOffset=g,l[k].count=f,n=r(l[k].valueType),"UInt64"===l[k].valueType&&(n=8),g+=n*l[k].valuesPerElement*f;u(g,a.byteLength,
"geometry");h.byteCount=g-h.byteOffset;return h};k.readBinaryAttribute=function(a,b,d){if("lepcc-rgb"===a.encoding)return h.decodeRGB(b);if("lepcc-intensity"===a.encoding)return h.decodeIntensity(b);if(null!=a.encoding&&""!==a.encoding)throw new c("unknown-attribute-storage-info-encoding","Unknown Attribute Storage Info Encoding");a["attributeByteCounts "]&&!a.attributeByteCounts&&(w.error("Warning: Trailing space in 'attributeByteCounts '."),a.attributeByteCounts=a["attributeByteCounts "]);"ObjectIds"===
a.ordering[0]&&a.hasOwnProperty("objectIds")&&(w.error("Warning: Case error in objectIds"),a.ordering[0]="objectIds");d=n(b,a,d);u(d.byteOffset+d.byteCount,b.byteLength,"attribute");if(a=d.entries.attributeValues||d.entries.objectIds){if("String"===a.valueType){d=d.entries.attributeByteCounts;var g=l(b,d);b=f(b,a);return e(d.count,g,b)}return l(b,a)}throw new c("bad-attribute-storage-info","Bad attributeStorageInfo specification.");};k.valueType2TypedArrayClassMap={Float32:Float32Array,Float64:Float64Array,
UInt8:Uint8Array,Int8:Int8Array,UInt16:Uint16Array,Int16:Int16Array,UInt32:Uint32Array,Int32:Int32Array};k.valueType2ArrayBufferReader={Float32:function(a,b){return(new DataView(a,0)).getFloat32(b,!0)},Float64:function(a,b){return(new DataView(a,0)).getFloat64(b,!0)},UInt8:function(a,b){return(new DataView(a,0)).getUint8(b)},Int8:function(a,b){return(new DataView(a,0)).getInt8(b)},UInt16:function(a,b){return(new DataView(a,0)).getUint16(b,!0)},Int16:function(a,b){return(new DataView(a,0)).getInt16(b,
!0)},UInt32:function(a,b){return(new DataView(a,0)).getUint32(b,!0)},Int32:function(a,b){return(new DataView(a,0)).getInt32(b,!0)}};k.isValueType=t;k.getBytesPerValue=r})},"esri/views/3d/layers/i3s/LEPCC":function(){define(["require","exports","../../../../core/Error"],function(m,k,b){function a(a,b,c){return{identifier:String.fromCharCode.apply(null,new Uint8Array(a,c+g.identifierOffset,g.identifierLength)),version:b.getUint16(c+g.versionOffset,!0),checksum:b.getUint32(c+g.checksumOffset,!0)}}function c(a,
b,c){var d=[];b=h(a,b,d);for(var e=[],g=0;g<d.length;g++){e.length=0;b=h(a,b,e);for(var l=0;l<e.length;l++)c.push(e[l]+d[g])}return b}function h(a,c,g){var d=new DataView(a,c),e=d.getUint8(0),h=e&31,l=!!(e&32),k=(e&192)>>6,e=0;if(0===k)e=d.getUint32(1,!0),c+=5;else if(1===k)e=d.getUint16(1,!0),c+=3;else if(2===k)e=d.getUint8(1),c+=2;else throw new b("lepcc-decode-error","Bad count type");if(l)throw new b("lepcc-decode-error","LUT not implemented");a=new Uint8Array(a,c,Math.ceil(e*h/8));for(var k=
l=d=0,m=-1>>>32-h,q=0;q<e;q++){for(;l<h;)d|=a[k]<<l,l+=8,k+=1;g[q]=d&m;d>>>=h;l-=h;32<l+h&&(d|=a[k-1]>>8-l)}return c+k}var g={identifierOffset:0,identifierLength:10,versionOffset:10,checksumOffset:12,byteCount:16};k.decodeXYZ=function(d){var e,h,f,k,m,t,r,w,q,x,y,z,A=new DataView(d,0),C=0;k=a(d,A,C);f=k.identifier;k=k.version;C+=g.byteCount;if("LEPCC     "!==f)throw new b("lepcc-decode-error","Bad identifier");if(1<k)throw new b("lepcc-decode-error","Unknown version");var B=C;e=A.getUint32(B+0,!0);
h=A.getUint32(B+4,!0);f=A.getFloat64(B+8,!0);k=A.getFloat64(B+16,!0);m=A.getFloat64(B+24,!0);t=A.getFloat64(B+32,!0);r=A.getFloat64(B+40,!0);w=A.getFloat64(B+48,!0);q=A.getFloat64(B+56,!0);x=A.getFloat64(B+64,!0);y=A.getFloat64(B+72,!0);z=A.getUint32(B+80,!0);A.getUint32(B+84,!0);C+=88;if(h*Math.pow(2,32)+e!==d.byteLength)throw new b("lepcc-decode-error","Bad size");A=new Float64Array(3*z);e=[];h=[];z=[];B=[];C=c(d,C,e);C=c(d,C,h);C=c(d,C,z);C=c(d,C,B);if(C!==d.byteLength)throw new b("lepcc-decode-error",
"Bad length");for(var D=C=d=0;D<e.length;D++)for(var C=C+e[D],H=0,K=0;K<h[D];K++){var H=H+z[d],E=B[d];A[3*d]=Math.min(t,f+2*q*H);A[3*d+1]=Math.min(r,k+2*x*C);A[3*d+2]=Math.min(w,m+2*y*E);d++}return{errorX:q,errorY:x,errorZ:y,result:A}};k.decodeRGB=function(c){var d,h,f,k,m,t,r=new DataView(c,0),w=0;k=a(c,r,w);f=k.identifier;k=k.version;w+=g.byteCount;if("ClusterRGB"!==f)throw new b("lepcc-decode-error","Bad identifier");if(1<k)throw new b("lepcc-decode-error","Unknown version");t=w;d=r.getUint32(t+
0,!0);h=r.getUint32(t+4,!0);f=r.getUint32(t+8,!0);k=r.getUint16(t+12,!0);m=r.getUint8(t+14);t=r.getUint8(t+15);w+=16;if(h*Math.pow(2,32)+d!==c.byteLength)throw new b("lepcc-decode-error","Bad size");if(2!==m&&1!==m||0!==t){if(0===m&&0===t){if(3*f+w!==c.byteLength||0!==k)throw new b("lepcc-decode-error","Bad count");return(new Uint8Array(c,w)).slice()}if(2>=m&&1===t){if(w+3!==c.byteLength||1!==k)throw new b("lepcc-decode-error","Bad count");k=r.getUint8(w);d=r.getUint8(w+1);r=r.getUint8(w+2);w=new Uint8Array(3*
f);for(c=0;c<f;c++)w[3*c]=k,w[3*c+1]=d,w[3*c+2]=r;return w}throw new b("lepcc-decode-error","Bad method "+m+","+t);}if(3*k+f+w!==c.byteLength||256<k)throw new b("lepcc-decode-error","Bad count");r=new Uint8Array(c,w,3*k);k=new Uint8Array(c,w+3*k,f);w=new Uint8Array(3*f);for(c=0;c<f;c++)d=k[c],w[3*c]=r[3*d],w[3*c+1]=r[3*d+1],w[3*c+2]=r[3*d+2];return w};k.decodeIntensity=function(c){var d,l,f,k,m,t=new DataView(c,0),r=0;k=a(c,t,r);f=k.identifier;k=k.version;r+=g.byteCount;if("Intensity "!==f)throw new b("lepcc-decode-error",
"Bad identifier");if(1<k)throw new b("lepcc-decode-error","Unknown version");var w=r;d=t.getUint32(w+0,!0);l=t.getUint32(w+4,!0);f=t.getUint32(w+8,!0);k=t.getUint16(w+12,!0);m=t.getUint8(w+14);t.getUint8(w+15);r+=16;if(l*Math.pow(2,32)+d!==c.byteLength)throw new b("lepcc-decode-error","Bad size");t=new Uint16Array(f);if(8===m){if(f+r!==c.byteLength)throw new b("lepcc-decode-error","Bad size");m=new Uint8Array(c,r,f)}else if(16===m){if(2*f+r!==c.byteLength)throw new b("lepcc-decode-error","Bad size");
m=new Uint16Array(c,r,f)}else if(m=[],h(c,r,m)!==c.byteLength)throw new b("lepcc-decode-error","Bad size");for(c=0;c<f;c++)t[c]=m[c]*k;return t}})},"esri/views/3d/support/PromiseNativeOrShim":function(){define(["./PromiseShim"],function(m){return null!=window.Promise&&"function"===typeof window.Promise?window.Promise:m})},"esri/views/3d/support/PromiseShim":function(){define(["require","exports"],function(m,k){function b(a,b,c){setTimeout(a,0,b,c)}function a(a){return null!=a&&"object"===typeof a&&
"then"in a&&"function"===typeof a.then}var c;(function(a){a[a.Pending=0]="Pending";a[a.Rejected=1]="Rejected";a[a.Resolved=2]="Resolved"})(c||(c={}));return function(){function h(a){var b=this;this.init(c.Pending);a(function(a){return b.resolve(a)},function(a){return b.reject(a)})}h.prototype.then=function(a,b){if(this.state===c.Pending)return a=h.pending(a,b),this._addToChain(a),a;if(this.state===c.Resolved)return null!=a?h.tryResolveAsync(a,this.value):h.resolve(this.value);if(this.state===c.Rejected)return null!=
b?h.tryResolveAsync(b,this.error):h.reject(this.error)};h.prototype.catch=function(a){return this.then(null,a)};h.resolve=function(b){if(b instanceof h)return b;if(a(b)){var d=Object.create(h.prototype);d.init(c.Pending);b.then(function(a){d.resolve(a)},function(a){d.reject(a)});return d}var e=Object.create(h.prototype);e.init(c.Resolved,b);return e};h.reject=function(a){var b=Object.create(h.prototype);b.init(c.Rejected,null,a);return b};h.all=function(a){var b=a.length;if(0===b)return h.resolve([]);
var c=a.map(h.resolve),g=h.pending();a=function(){0===--b&&g.resolve(c.map(h.getValue))};for(var f=function(a){g.reject(a)},k=0;k<c.length;k++)c[k].then(a,f);return g};h.prototype.init=function(a,b,c,h,f){void 0===b&&(b=null);void 0===c&&(c=null);void 0===h&&(h=null);void 0===f&&(f=null);this.state=a;this.value=b;this.error=c;this.callback=h;this.errback=f;this.chainedPromise=this.firstPromise=null};h.pending=function(a,b){var d=Object.create(h.prototype);d.init(c.Pending,null,null,a,b);return d};
h.getValue=function(a){return a.value};h.prototype._unchain=function(){this.errback=this.callback=this.chainedPromise=null};h.prototype._addToChain=function(a){a.chainedPromise=this.firstPromise;this.firstPromise=a};h.tryResolveAsync=function(a,d){var e=Object.create(h.prototype);e.init(c.Pending);b(function(){e.tryResolve(a,d)});return e};h.prototype.tryResolve=function(a,b){try{var c=a(b);this.resolve(c)}catch(l){console.error(l.stack instanceof Error?l.stack:l),this.reject(l)}};h.prototype.resolve=
function(b){var d=this;this.state===c.Pending?b instanceof h?b.state===c.Pending?(this._unchain(),b._addToChain(this)):b.state===c.Resolved?this.resolve(b.value):b.state===c.Rejected&&this.reject(b.error):a(b)?b.then(function(a){d.resolve(a)},function(a){d.reject(a)}):(this.state=c.Resolved,this.value=b,this.resolveHandlers()):console.error("Error: Promise is already resolved")};h.prototype.reject=function(a){this.state===c.Pending?(this.state=c.Rejected,this.error=a,this.rejectHandlers()):console.error("Error: Promise is already resolved")};
h.prototype.resolveHandlers=function(){this.callResolveHandlers(this.firstPromise);this.firstPromise=null};h.prototype.callResolveHandlers=function(a){null!=a&&(this.callResolveHandlers(a.chainedPromise),null!=a.callback?a.tryResolve(a.callback,this.value):a.resolve(this.value))};h.prototype.rejectHandlers=function(){this.callRejectHandlers(this.firstPromise);this.firstPromise=null};h.prototype.callRejectHandlers=function(a){null!=a&&(this.callRejectHandlers(a.chainedPromise),null!=a.errback?a.tryResolve(a.errback,
this.error):a.reject(this.error))};return h}()})},"esri/views/3d/layers/i3s/I3SIndexTraversal":function(){define(["require","exports","./GoogPriorityQueue","../../support/PromiseLightweight","../../../../core/urlUtils"],function(m,k,b,a,c){return function(){function h(a,b,e,h,f,k,m,t,r,w,q,x){void 0===x&&(x={initDepthFirst:!0,neighborhood:!0,perLevelTraversal:!1});var d=this;this.baseURL=a;this.startNodeUrl=b;this.rootId=e;this.poi=h;this.nodeIndex=f;this.streamDataSupplier=k;this.viewportQueries=
m;this.processNodeIndexDocument=t;this.finishedLevelCallback=r;this.debugVis=w;this.logger=q;this.traversalOptions=x;this.queues=[];this.knownNodes=new Set;this.dataLoadingPerLevel=[];this.numIndicesLoading=this.currentLevel=0;this.cancelled=this.queueTraversalEnabled=!1;this.initQueryErrback=function(){d.initPromise.done()};this.initQueryCallback=function(a,b){if(d.cancelled)d.initPromise.done();else if(d.nodeTraversalState(b.id),d.enqueueConnected(a,b,0),d.isLeafNode(b))d.initPromise.done();else{for(var e=
1E9,f=void 0,g=0;g<b.children.length;++g){var h=b.children[g];if(d.nodeIsVisible(h)&&(!d.viewportQueries.hasLOD(b)||!d.viewportQueries.isTooHighLOD(b))){var l=d.viewportQueries.distToPOI(h,d.poi);l<e&&(e=l,f=h)}}f?(a=c.makeAbsolute(f.href,a),d.getNode(a,f.id,d.initQueryCallback,d.initQueryErrback)):d.initPromise.done()}}}h.prototype.start=function(){var b=this;this._nodeTraversalState={};this._nodeIsVisibleCached={};this.dataLoadingPerLevel=[];this.currentLevel=0;this.rootUrl=c.makeAbsolute(this.startNodeUrl,
this.baseURL);this.traversalOptions.initDepthFirst?(this.initPromise=new a.Promise,this.getNode(this.rootUrl,this.rootId,this.initQueryCallback,this.initQueryErrback),this.initPromise.then(function(){b.cancelled||(b.queueTraversalEnabled=!0)})):(this.enqueue(0,{id:this.rootId,hrefConcat:this.rootUrl},0),this.queueTraversalEnabled=!0)};h.prototype.continueTraversal=function(a){var b=this;if(this.queueTraversalEnabled){a=null==a?5:a;for(var c=0;c<this.queues.length;c++)if(!this.traversalOptions.perLevelTraversal||
this.currentLevel===c){for(var g=this.queues[c];0<a--&&!g.isEmpty();)(function(a){var c=b.queues[a].dequeue();b.dataLoadingPerLevel[a]++;var d=function(){b.dataLoadingPerLevel[a]--};b.getNode(c.hrefConcat,c.id,function(c,e){null==e.parentNode?(b.nodeTraversalState(e.id),b.enqueueConnected(c,e,a),b.processNodeIndexDocument(e,void 0).then(d,d)):b.getNode(b.concatHref(e.parentNode,c),e.parentNode.id,function(f,g){b.nodeTraversalState(e.id);b.enqueueConnected(c,e,a);b.processNodeIndexDocument(e,g).then(d,
d)})},d)})(c);this.traversalOptions.perLevelTraversal&&g.isEmpty()&&0===this.dataLoadingPerLevel[c]&&(this.finishedLevelCallback.call(null,this.currentLevel),this.currentLevel++)}}};h.prototype.isQueueTraversalEnabled=function(){return this.queueTraversalEnabled};h.prototype.getQueueSize=function(){for(var a=0,b=0;b<this.queues.length;b++)a+=this.queues[b].getCount();return a};h.prototype.cancel=function(){this.queueTraversalEnabled=!1;for(var a=0;a<this.queues.length;a++)this.queues[a].clear();this.cancelled=
!0};h.prototype.isLoading=function(){return 0<this.numIndicesLoading||0<this.getQueueSize()};h.prototype.nodeIsVisible=function(a){if(null!=this._nodeIsVisibleCached[a.id])return this._nodeIsVisibleCached[a.id];this._nodeIsVisibleCached[a.id]=this.viewportQueries.isNodeVisible(a);return this._nodeIsVisibleCached[a.id]};h.prototype.nodeTraversalState=function(a){if(null!=this._nodeTraversalState[a])return this._nodeTraversalState[a];var b=this.nodeIndex[a];if(null==b)return null;var c=null,g=!1;if(null!=
b.parentNode){c=this.nodeIndex[b.parentNode.id];if(null==c)return null;var f=this._nodeTraversalState[c.id];null!=f&&(g=f.nodeIsTooHighLOD)}var f=this.viewportQueries.hasLOD(b),h=this.viewportQueries.isTooHighLOD(b),c=this.viewportQueries.isChosenLOD(b,c,h,g);this._nodeTraversalState[b.id]={visited:!0,nodeHasLOD:f,nodeIsTooHighLOD:h,isChosenLOD:c};return this._nodeTraversalState[a]};h.prototype.getNode=function(a,b,c,h){var d=this;this.numIndicesLoading++;this.nodeIndex[b]?(c(a,this.nodeIndex[b]),
this.numIndicesLoading--):this.streamDataSupplier.request(a,"json").then(function(a,b){d.nodeIndex[b.id]=b;b.baseUrl=a;c(a,b);d.numIndicesLoading--},function(b){null!=h&&h(b);d.loadErrorCallback(a);d.numIndicesLoading--})};h.prototype.isLeafNode=function(a){return null==a.children};h.prototype.concatHref=function(a,b){return c.makeAbsolute(a.href,b)};h.prototype.enqueue=function(a,c,e){this.traversalOptions.perLevelTraversal||(e=0);for(this.knownNodes.add(c.id);this.queues.length<=e;)this.queues.push(new b.goog.structs.PriorityQueue),
this.dataLoadingPerLevel.push(0);this.queues[e].enqueue(a,c)};h.prototype.enqueueConnected=function(a,b,c){if(!this.cancelled&&null!=b){var d=this.nodeTraversalState(b.id);if(b.id===this.rootId||null==b.parentNode||this.knownNodes.has(b.parentNode.id))b.id===this.rootId&&!this.knownNodes.has(b.id)&&this.nodeIsVisible(b)&&this.enqueue(this.viewportQueries.distToPOI(b,this.poi),{id:b.id,hrefConcat:a},c);else{var e={id:b.parentNode.id,hrefConcat:this.concatHref(b.parentNode,a)};this.enqueue(this.viewportQueries.distToPOI(b.parentNode,
this.poi),e,c-1)}if(b.children)for(var g=0,h=b.children;g<h.length;g++){var k=h[g],e=this.nodeIsVisible(k);this.knownNodes.has(k.id)||d.nodeHasLOD&&d.nodeIsTooHighLOD||!e||(e={id:k.id,hrefConcat:this.concatHref(k,a)},this.enqueue(this.viewportQueries.distToPOI(k,this.poi),e,c+1))}if(this.traversalOptions.neighborhood&&b.neighbors)for(d=0,b=b.neighbors;d<b.length;d++)g=b[d],e=this.nodeIsVisible(g),!this.knownNodes.has(g.id)&&e&&(e={id:g.id,hrefConcat:this.concatHref(g,a)},this.enqueue(this.viewportQueries.distToPOI(g,
this.poi),e,c))}};h.prototype.loadErrorCallback=function(a){this.logger.warn("Error loading node: "+a)};return h}()})},"esri/views/3d/layers/i3s/GoogPriorityQueue":function(){define([],function(){var m={};(function(){function k(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=
typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function b(a,b){a=a.split(".");var c=e;a[0]in c||!c.execScript||c.execScript("var "+a[0]);for(var d;a.length&&(d=a.shift());)a.length||void 0===b?c=c[d]?c[d]:c[d]={}:c[d]=b}function a(a,
b){this.d=a;this.b=b}function c(a){if("array"!=k(a))for(var b=a.length-1;0<=b;b--)delete a[b];a.length=0}function h(b){this.a=[];if(b)a:{var c,d;if(b instanceof h){c=b.a;d=[];for(var e=c.length,k=0;k<e;k++)d.push(c[k].getKey());c=d;d=b.a;for(var e=[],k=d.length,l=0;l<k;l++)e.push(d[l].b);d=e;if(0>=b.a.length){b=this.a;for(e=0;e<c.length;e++)b.push(new a(c[e],d[e]));break a}}else{c=[];e=0;for(k in b)c[e++]=k;e=[];k=0;for(d in b)e[k++]=b[d];d=e}for(e=0;e<c.length;e++)g(this,c[e],d[e])}}function g(b,
c,d){var e=b.a;e.push(new a(c,d));c=e.length-1;b=b.a;for(d=b[c];0<c;)if(e=c-1>>1,b[e].getKey()>d.getKey())b[c]=b[e],c=e;else break;b[c]=d}function d(){h.call(this)}var e=this;a.prototype.getKey=function(){return this.d};a.prototype.c=function(){return new a(this.d,this.b)};h.prototype.remove=function(){var a=this.a,b=a.length,d=a[0];if(!(0>=b)){if(1==b)c(a);else{a[0]=a.pop();for(var a=0,b=this.a,e=b.length,g=b[a];a<e>>1;){var h=2*a+1,k=2*a+2,h=k<e&&b[k].getKey()<b[h].getKey()?k:h;if(b[h].getKey()>
g.getKey())break;b[a]=b[h];a=h}b[a]=g}return d.b}};h.prototype.c=function(){return new h(this)};h.prototype.g=function(){return this.a.length};h.prototype.h=function(){return 0==this.a.length};h.prototype.clear=function(){c(this.a)};(function(){function a(){}a.prototype=h.prototype;d.i=h.prototype;d.prototype=new a})();d.prototype.f=function(a,b){g(this,a,b)};d.prototype.e=function(){return this.remove()};b("goog.structs.PriorityQueue",d);b("goog.structs.PriorityQueue.prototype.enqueue",d.prototype.f);
b("goog.structs.PriorityQueue.prototype.dequeue",d.prototype.e);b("goog.structs.PriorityQueue.prototype.isEmpty",d.prototype.h);b("goog.structs.PriorityQueue.prototype.clear",d.prototype.clear);b("goog.structs.PriorityQueue.prototype.clone",d.prototype.c);b("goog.structs.PriorityQueue.prototype.getCount",d.prototype.g)}).call(m);return m})},"esri/views/3d/layers/i3s/I3SLodHandling":function(){define(["require","exports"],function(m,k){return function(){function b(a,b,h){this.layerViewRequiredFunctions=
a;this.layerViewOptionalFunctions=b;this.lodGlobalDirtyChanged=h;this._lodSwapNodeIndex={};this._lodSwapFeatureLookup={};this._lodSwapRootFeatureLookup={}}b.prototype.startNodeLoading=function(a,b,h,g,d,e){this._lodGlobalDirty=!1;this._lodMode=h;this._lodSwapNodeIndex={};this._lodSwapFeatureLookup={};this._lodSwapRootFeatureLookup={};this._nodeIndex=g;this._rootId=e;this._nodeTraversalState=b;this._nodeIsVisible=a;if("swap"===this._lodMode){for(var c in d)a=d[c],this._nodeTraversalState(a.id).nodeHasLOD&&
!this._nodeTraversalState(a.id).isChosenLOD&&(this._lodSwapNodeIndex[c]=a);this._lodSwapBuildUnmatchingFeatureLookups()}this.lodGlobalDirtyChanged(this._lodGlobalDirty)};b.prototype.cancelNodeLoading=function(){this._lodSwapNodeIndex={}};b.prototype.shouldLoadNode=function(a,b){var c=this._nodeTraversalState(a.id);b=c.nodeHasLOD;c=c.isChosenLOD;return"perLevel"!==this._lodMode?c||!b:c||!b?!0:this.layerViewOptionalFunctions.traversalOptions.allowPartialOverlaps?this._someSubtreesIncomplete(a):this._allSubtreesIncomplete(a)};
b.prototype.shouldSetPolygonOffset=function(a){return"perLevel"===this._lodMode?!this._nodeTraversalState(a.id).isChosenLOD:!1};b.prototype._allSubtreesIncomplete=function(a){if(this.layerViewRequiredFunctions.areAllBundlesLoaded(a))return!1;var b=!0;if(null!=a.children)for(var h=0;h<a.children.length;++h){var g=a.children[h];this._nodeIsVisible(g)&&(g=this._nodeIndex[g.id],b=b&&(null==g||this._allSubtreesIncomplete(g)))}return b};b.prototype._someSubtreesIncomplete=function(a){if(this.layerViewRequiredFunctions.areAllBundlesLoaded(a))return!1;
var b=!1;if(null!=a.children)for(var h=0;h<a.children.length;++h){var g=a.children[h];this._nodeIsVisible(g)&&(g=this._nodeIndex[g.id],b=b||null==g||this._allSubtreesIncomplete(g))}return b};b.prototype.setLodGlobalDirty=function(){this._lodGlobalDirty=!0;this.lodGlobalDirtyChanged(this._lodGlobalDirty)};b.prototype.finishedLevel=function(a){"perLevel"===this._lodMode&&this._deleteUpToLevelRecurse(a-1,0,this._nodeIndex[this._rootId])};b.prototype._deleteUpToLevelRecurse=function(a,b,h){if(null!=h&&
!(b>a)&&(this._nodeTraversalState(h.id).isChosenLOD||this.layerViewRequiredFunctions.removeNodeData(h),null!=h.children))for(var c=0;c<h.children.length;++c)this._deleteUpToLevelRecurse(a,b+1,this._nodeIndex[h.children[c].id])};b.prototype.lodSwapBundleLoaded=function(a,b,h){if(null!=h)if(null!=h.swapPairs&&0<Object.keys(h.swapPairs).length){if(null!=b){a=h.swapPairs;h={};for(var c=0;c<b.length;c++)for(var d=b[c].features,e=0;e<d.length;e++)h[d[e].id]=!0;for(var k in a){b=a[k];c=[];d=b.features;for(e=
0;e<d.length;e++)null!=h[d[e]]&&c.push(d[e]);this.layerViewRequiredFunctions.removeFeatures(b.node,b.features)}}}else{for(c in h.nodesHigherInTree)this.layerViewRequiredFunctions.removeNodeData(h.nodesHigherInTree[c]);for(c in h.nodesDeeperInTree)this.layerViewRequiredFunctions.removeNodeData(h.nodesDeeperInTree[c])}this.setLodGlobalDirty()};Object.defineProperty(b.prototype,"requiresLODGlobalHandling",{get:function(){return"global"===this._lodMode&&null!=this._rootId&&(!0===this._lodGlobalDirty||
this.layerViewRequiredFunctions.isOverMemory())},enumerable:!0,configurable:!0});b.prototype.lodGlobalHandling=function(){if(this.requiresLODGlobalHandling){var a=this._rootId;this._lodGlobalHandlingRecursion({id:a,mbs:null},this._nodeIndex,!1,!1,0);this._lodGlobalHandlingRecursionRemoveIntermediate(a,this._nodeIndex,!1,0);this._lodGlobalDirty=!1;this.lodGlobalDirtyChanged(this._lodGlobalDirty)}};b.prototype.lodSwapBuildInfoForNode=function(a){if(!this._nodeTraversalState(a.id).nodeHasLOD)return null;
if("swap"===this._lodMode){var b={},h={},g=!1,d=!1,e=a.id+"",k;for(k in this._lodSwapNodeIndex){var f=this._lodSwapNodeIndex[k];null!=this.layerViewRequiredFunctions.getAddedFeatures(f.id)&&(g=null===a.parentNode||0===(f.id+"").indexOf(e),d=null==f.parentNode||0===e.indexOf(f.id+""),!0===d&&(h[f.id]=f),!0===g&&(b[f.id]=f))}return{nodesHigherInTree:h,nodesDeeperInTree:b}}if("perLevel"===this._lodMode&&this._nodeTraversalState(a.id).isChosenLOD)return b={},this._getNodesRecurse(a,b),{nodesHigherInTree:null,
nodesDeeperInTree:b}};b.prototype._getNodesRecurse=function(a,b){if(null!=a.children)for(var c=0;c<a.children.length;++c){var g=a.children[c],d=this._nodeIndex[g.id];null!=d&&(b[g.id]=d,this._getNodesRecurse(d,b))}};b.prototype._lodSwapBuildUnmatchingFeatureLookups=function(){this._lodSwapFeatureLookup={};this._lodSwapRootFeatureLookup={};for(var a in this._lodSwapNodeIndex){var b=this._lodSwapNodeIndex[a],h=this.layerViewRequiredFunctions.getAddedFeatures(b.id);if(null!=h)for(var g=0;g<h.length;g++){var d=
h[g];this._lodSwapFeatureLookup[d.id]=b;null!=d.rootFeature&&(null==this._lodSwapRootFeatureLookup[d.rootFeature]&&(this._lodSwapRootFeatureLookup[d.rootFeature]=[]),this._lodSwapRootFeatureLookup[d.rootFeature].push({node:b,featureId:d.id}))}}};b.prototype._validateLodTreeVisibilities=function(){if(null!=this.layerViewOptionalFunctions.getAllAddedFeatures){var a=this.layerViewOptionalFunctions.getAllAddedFeatures();console.debug("validating lod tree: ");var b={},h={},g=!0,d;for(d in a)for(var e=
a[d],k=0;k<e.length;k++){var f=e[k];null!=b[f.id]&&b[f.id]!==d&&(console.debug("node "+d+" !! encountered feature "+f.id+" already in node "+b[f.id]),g=!1);null!=h[f.id]&&h[f.id]!==d&&(console.debug("node "+d+" !! encountered feature "+f.id+" already as rootFeature in node "+h[f.id]),g=!1);b[f.id]=d;null!=f.rootFeature&&h[f.rootFeature]!==d&&(null!=h[f.rootFeature]&&(console.debug("node "+d+" !! encountered rootFeature "+f.rootFeature+" already in node "+h[f.rootFeature]),g=!1),null!=b[f.rootFeature]&&
(console.debug("node "+d+" !! encountered rootFeature "+f.rootFeature+" already as feature"),g=!1),h[f.rootFeature]=d)}return g}};b.prototype._lodGlobalHandlingRecursion=function(a,b,h,g,d){var c=a.id,k=b[c];if(null==k)return h=null!=a.mbs?this._nodeIsVisible(a):!1,g||!h;c=this._nodeTraversalState(c);a=this._nodeIsVisible(k);var c=c.isChosenLOD,f=this.layerViewRequiredFunctions.isBundleAlreadyAddedToStage(k,0),n=!0;if(null!=k.children)for(var m=0;m<k.children.length;++m)this._lodGlobalHandlingRecursion(k.children[m],
b,f&&c||h,c||g,d+1)||(n=!1);b=this.layerViewRequiredFunctions.isOverMemory();f&&!c&&((g?h:n)||b)&&(this.setLodGlobalDirty(),this.layerViewRequiredFunctions.removeNodeData(k),f=!1);f&&this.layerViewOptionalFunctions.setPolygonOffset&&this.layerViewOptionalFunctions.setPolygonOffset(k,!(c&&!g));h=n||f;if(c&&f||!a||g)h=!0;c&&!f&&a&&(h=!1);return h};b.prototype._lodGlobalHandlingRecursionRemoveIntermediate=function(a,b,h,g){var c=b[a];if(null!=c){var e=this.layerViewRequiredFunctions.isBundleAlreadyAddedToStage(c,
0);a=this._nodeTraversalState(a).isChosenLOD;if(null!=c.children)for(var k=0;k<c.children.length;++k)this._lodGlobalHandlingRecursionRemoveIntermediate(c.children[k].id,b,e||h,g+1);h&&!a&&e&&(this.layerViewRequiredFunctions.removeNodeData(c),this.setLodGlobalDirty())}};return b}()})},"esri/views/3d/layers/i3s/I3SViewportQueries":function(){define("require exports ../../lib/glMatrix ./I3SUtil ../../webgl-engine/lib/Util ../../support/projectionUtils ../graphics/Graphics3DSymbolCommonCode ../../../../geometry/Point".split(" "),
function(m,k,b,a,c,h,g,d){var e=b.vec3d,l=b.vec4d;return function(){function b(a,b,f,g,h,k,m,y){void 0===y&&(y={});this.indexSR=a;this.extent=g;this.errorMetricPreference=h;this.elevationProvider=k;this.elevationInfo=m;this.options=y;this.fp=[];this._tmp1=[0,0,0];this._tmp2=[0,0,0];this._tmp3=[0,0,0];this._tmp0=[0,0,0];this.supportedMetrics=["screenSpaceRelative","maxScreenThreshold","removedFeatureDiameter","distanceRangeFromDefaultCamera"];this.maxDistance=y.maxDistance||Number.MAX_VALUE;this.screenspaceErrorBias=
y.screenspaceErrorBias||1;this.enableLoD=!1!==y.disableLod;for(g=0;8>g;++g)this.fp[g]=l.create();c.matrix2frustumPlanes(f.viewMatrix,f.projectionMatrix,this.fp);this.engineSR=b.spatialReference;this._screenSizeFactor=1/f.perPixelRatio;this._camPos=f.eye;this._center=f.center;this._camDir=e.subtract(this._center,this._camPos,[0,0,0]);e.normalize(this._camDir);this.tmpPoint=new d({x:0,y:0,z:0,spatialReference:a})}b.prototype.computedMbs=function(a){a.computedMbs||(a.computedMbs=l.create(),a.computedMbs[3]=
-1);var b=a.computedMbs;0>b[3]&&(l.set(a.mbs,b),this.elevationProvider&&1E5>a.mbs[3]&&(this.tmpPoint.x=b[0],this.tmpPoint.y=b[1],this.tmpPoint.z=b[2],b[2]=g.computeElevation(this.elevationProvider,this.tmpPoint,this.elevationInfo)),h.mbsToMbs(b,this.indexSR,b,this.engineSR));return b};b.prototype.isNodeVisible=function(a){a=this.computedMbs(a);return this.isMBSinExtent(a)&&this.isMBSVisible(a)};b.prototype.isMBSinExtent=function(b){return this.extent?0!==a.intersectBoundingBoxWithMbs(this.extent,
b):!0};b.prototype.isMBSVisible=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];var e=this.fp;return e[0][0]*b+e[0][1]*c+e[0][2]*d+e[0][3]<=a&&e[1][0]*b+e[1][1]*c+e[1][2]*d+e[1][3]<=a&&e[2][0]*b+e[2][1]*c+e[2][2]*d+e[2][3]<=a&&e[3][0]*b+e[3][1]*c+e[3][2]*d+e[3][3]<=a&&e[4][0]*b+e[4][1]*c+e[4][2]*d+e[4][3]<=a&&e[5][0]*b+e[5][1]*c+e[5][2]*d+e[5][3]<=a};b.prototype.calcScreenSpaceSize=function(a,b){a=this.computedMbs(a);var c=a[3];a=e.dist2(a,this._camPos)-c*c;return 0>a?.5*Number.MAX_VALUE:b/Math.sqrt(a)*
this._screenSizeFactor};b.prototype.calcCameraDistance=function(a){a=this.computedMbs(a);return Math.max(0,e.dist(a,this._camPos)-a[3])};b.prototype.calcAngleDependentLoD=function(a){a=this.computedMbs(a);var b=a[3];a=(Math.abs(a[0]*(a[0]-this._camPos[0])+a[1]*(a[1]-this._camPos[1])+a[2]*(a[2]-this._camPos[2]))/e.length(a)+b)/e.dist(a,this._camPos);return Math.min(1,a)};b.prototype.hasLOD=function(a){return this.enableLoD&&null!=a.lodSelection};b.prototype.hasFeatures=function(a){return null!=a.features&&
0<a.features.length||null!=a.featureData};b.prototype.getDistancePlanarMode=function(a,b,c){var d=a[0]-b[0],e=a[1]-b[1];a=a[2]-b[2];d=d+d+e*e;if(d<=c*c)return Math.abs(a);c=Math.sqrt(d)-c;return Math.sqrt(a*a+c*c)};b.prototype.getDistanceGlobeMode=function(a,b,c){var d=e.length(b),f=e.length(a)-d;e.scale(a,e.dot(a,b)/e.length2(a),this._tmp0);if(e.dist2(b,this._tmp0)<=c*c)return Math.abs(f);b=e.scale(b,1/d,this._tmp0);var d=e.scale(b,d-c*c/2/d,this._tmp1),g=e.subtract(a,d,this._tmp2),g=e.subtract(g,
e.scale(b,e.dot(b,g),this._tmp3),this._tmp2),d=e.add(d,e.scale(g,c/e.length(g),this._tmp2),this._tmp2);c=e.dist(a,d);2E5<=f&&(a=e.subtract(a,d,this._tmp1),a=e.dot(a,b)/e.length(a),.08>a&&(a=1E-4),c/=a);return c};b.prototype.getDistance=function(a,b,c){return this.engineSR===h.SphericalRenderSpatialReference?this.getDistanceGlobeMode(a,b,c):this.getDistancePlanarMode(a,b,c)};b.prototype._selectErrorMetric=function(a){if(this.errorMetricPreference)for(var b=0;b<this.errorMetricPreference.length;b++)for(var c=
0;c<a.length;c++){if(a[c].metricType===this.errorMetricPreference[b])return a[c]}else for(b=0;b<a.length;b++)if(0<=this.supportedMetrics.indexOf(a[b].metricType))return a[b];return null};b.prototype.isTooHighLOD=function(a){if(a.lodSelection&&0<a.lodSelection.length){if(!1===this.hasFeatures(a))return!1;var b=this._selectErrorMetric(a.lodSelection);if(null!=b)return this.evaluateLODmetric(a,b)}return!1};b.prototype.evaluateLODmetric=function(a,b){if("screenSpaceRelative"===b.metricType)return a=this.computedMbs(a),
a=2*this.getDistance(this._camPos,a,a[3])/this._screenSizeFactor,b.maxError*this.screenspaceErrorBias<=a;if("maxScreenThreshold"===b.metricType){var c=this.calcScreenSpaceSize(a,a.mbs[3]);this.options.angleDependentLoD&&(c*=this.calcAngleDependentLoD(a));return c*this.screenspaceErrorBias<b.maxError}return"removedFeatureDiameter"===b.metricType?10>this.calcScreenSpaceSize(a,b.maxError)*this.screenspaceErrorBias:"distanceRangeFromDefaultCamera"===b.metricType?this.calcCameraDistance(a)>b.maxError:
!1};b.prototype.isChosenLOD=function(a,b,c,d){return a.lodSelection&&0<a.lodSelection.length?(c||!a.children)&&!(b&&d):!0};b.prototype.distToPOI=function(a,b){a=this.computedMbs(a);return e.dist(a,b)-a[3]};return b}()})},"esri/layers/SceneLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ./Layer ./FeatureLayer ./support/Field ./support/LabelClass ./support/ElevationInfo ./support/labelingInfo ./mixins/SceneService ../PopupTemplate ../request ../core/requireUtils ../core/promiseUtils ../core/Error ../core/Logger ../core/accessorSupport/PropertyOrigin ../core/accessorSupport/utils ../renderers/support/jsonUtils ../renderers/support/styleUtils ../portal/PortalItem ../tasks/support/Query dojo/_base/lang dojo/promise/all".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f,n,u,t,r,w,q,x,y,z,A,C,B,D,H,K){function E(a,b,c){a&&((a=A.read(a,b,c)||void 0)||L.error("Failed to create renderer",{rendererDefinition:a,layer:this,context:c}));return a}var F=["3DObject","Point"],L=x.getLogger("esri.layers.SceneLayer");k=function(a){function c(b,c){b=a.call(this)||this;b.operationalLayerType="ArcGISSceneServiceLayer";b.type="scene";b.fields=[];b.definitionExpression=null;b.elevationInfo=null;b.labelsVisible=!1;b.labelingInfo=null;b.legendEnabled=!0;
b.renderer=null;b.cachedDrawingInfo={color:!1};b.popupEnabled=!0;b.popupTemplate=null;b.objectIdField=null;b.objectIdFilter=null;b._fieldUsageInfo={};return b}b(c,a);c.prototype.normalizeCtorArgs=function(a,b){return"string"===typeof a?H.mixin({},{url:a},b):a};c.prototype.getField=function(a){return this._fieldLookup(this.fields,a)};Object.defineProperty(c.prototype,"geometryType",{get:function(){return N[this.profile]||"mesh"},enumerable:!0,configurable:!0});c.prototype.readLabelsVisible=function(a,
b){return b.showLabels};c.prototype.writeLabelsVisible=function(a,b){a&&(b.showLabels=!0)};c.prototype.readLegendEnabled=function(a,b){return null!=b.showLegend?b.showLegend:!0};c.prototype.writeLegendEnabled=function(a,b){a||(b.showLegend=!1)};c.prototype.readCachedDrawingInfo=function(a,b){if(null==a||"object"!==typeof a)a={};null==a.color&&(a.color=!1);return a};c.prototype.readPopupEnabled=function(a,b){return null!=b.disablePopup?!b.disablePopup:void 0};c.prototype.writePopupEnabled=function(a,
b){a||(b.disablePopup=!0)};c.prototype.readPopupTemplate=function(a,b){return b.popupInfo?u.fromJSON(b.popupInfo):void 0};c.prototype.writePopupTemplate=function(a,b){a&&(b.popupInfo=a.toJSON())};c.prototype.readObjectIdField=function(a,b){!a&&b.fields&&b.fields.some(function(b){"esriFieldTypeOID"===b.type&&(a=b.name);return!!a});return a||void 0};c.prototype.readProfile=function(a,b){a=b.store.profile;if(null!=a&&Q[a])return Q[a];L.error("Unknown or missing profile",{profile:a,layer:this});return"mesh-pyramids"};
c.prototype.readNormalReferenceFrame=function(a,b){return b.store.normalReferenceFrame};c.prototype.load=function(){var a=this,b=this.loadFromPortal({supportedTypes:["Scene Service"]}).always(function(){return a._fetchService()}).then(function(){return K([a._verifyRootNodeAndUpdateExtent(),a._setCompanionFeatureLayer()])}).then(function(){return a._applyCompanionOverrides()}).then(function(){return a._populateFieldUsageInfo()}).then(function(){return C.loadStyleRenderer(a,{origin:"service"})});this.addResolvingPromise(b);
return this};c.prototype.createLayerView=function(a){var b=this;return r.when(m,null==this.profile||"mesh-pyramids"===this.profile?"../views/3d/layers/SceneLayerView3D":"../views/3d/layers/SceneLayerGraphicsView3D").then(function(c){return new c({view:a,layer:b})})};c.prototype.createQuery=function(){var a=new D;"mesh"!==this.geometryType&&(a.returnGeometry=!0,a.returnZ=!0);a.where=this.definitionExpression||"1\x3d1";a.sqlFormat="standard";return a};c.prototype.queryExtent=function(a){var b=this;
return this._getCompanionLayerForQuery().then(function(c){return c.queryExtent(a||b.createQuery())})};c.prototype.queryFeatureCount=function(a){var b=this;return this._getCompanionLayerForQuery().then(function(c){return c.queryFeatureCount(a||b.createQuery())})};c.prototype.queryFeatures=function(a){var b=this;return this._getCompanionLayerForQuery().then(function(c){return c.queryFeatures(a||b.createQuery())}).then(function(a){if(a&&a.features)for(var c=0,d=a.features;c<d.length;c++)d[c].layer=b;
return a})};c.prototype.queryObjectIds=function(a){var b=this;return this._getCompanionLayerForQuery().then(function(c){return c.queryObjectIds(a||b.createQuery())})};c.prototype.getFieldUsageInfo=function(a){return this._fieldUsageInfo[a]||{supportsLabelingInfo:!1,supportsRenderer:!1,supportsPopupTemplate:!1,supportsLayerQuery:!1}};c.prototype._getCompanionLayerForQuery=function(){var a=this;if(!this.loaded)return this.load().then(function(){return a._getCompanionLayerForQuery()});var b=this.companionFeatureLayer;
return null!=b?w.resolve(b):w.reject(new q("scenelayer:query-not-available","SceneLayer queries are not available without companion feature layer"))};c.prototype._validateLayer=function(a){if(a.layerType&&-1===F.indexOf(a.layerType))throw new q("scenelayer:layer-type-not-supported","SceneLayer does not support this layer type",{layerType:a.layerType});if(isNaN(this.version.major)||isNaN(this.version.minor))throw new q("layer:service-version-not-supported","Service version is not supported.",{serviceVersion:this.version.versionString,
supportedVersions:"1.x"});if(1<this.version.major)throw new q("layer:service-version-too-new","Service version is too new.",{serviceVersion:this.version.versionString,supportedVersions:"1.x"});a=this.normalReferenceFrame;var b=this.spatialReference,c=!1,d=!1;if(null==a)d=c=!0;else switch(b=b&&b.isGeographic,a){case "east-north-up":case "earth-centered":c=!0;d=b;break;case "vertex-reference-frame":c=!0;d=!b;break;default:c=!1}if(!c)throw new q("scenelayer:unsupported-normal-reference-frame","Normal reference frame is invalid.");
if(!d)throw new q("scenelayer:incompatible-normal-reference-frame","Normal reference frame is incompatible with layer spatial reference.");};c.prototype._populateFieldUsageInfo=function(){this._fieldUsageInfo={};if(this.fields)for(var a=function(a){var c=!(!b.attributeStorageInfo||!b.attributeStorageInfo.some(function(b){return b.name===a.name})),d=!!(b.companionFeatureLayer&&b.companionFeatureLayer.fields&&b.companionFeatureLayer.fields.some(function(b){return b&&a.name===b.name}));b._fieldUsageInfo[a.name]=
{supportsLabelingInfo:c,supportsRenderer:c,supportsPopupTemplate:c||d,supportsLayerQuery:d}},b=this,c=0,d=this.fields;c<d.length;c++)a(d[c])};c.prototype._applyCompanionOverrides=function(){if(this.companionFeatureLayer){if(this.companionFeatureLayer.fields)for(var a=0,b=this.companionFeatureLayer.fields;a<b.length;a++){var c=b[a];this.getField(c.name)||this.fields.push(c.clone())}a=["popupTemplate","popupEnabled"];b=z.getProperties(this);for(c=0;c<a.length;c++){var d=a[c];this._buddyIsMoreImportant(d)&&
(b.setDefaultOrigin(this.companionFeatureLayer.originOf(d)),b.set(d,this.companionFeatureLayer[d]),b.setDefaultOrigin("user"))}}};c.prototype._setCompanionFeatureLayer=function(){var a=this;return this._fetchCompanionFeatureLayer().then(function(b){a.companionFeatureLayer=b})};c.prototype._fetchCompanionFeatureLayer=function(){var a=this;return-1===["mesh-pyramids","points"].indexOf(this.profile)?w.resolve(null):(this.portalItem&&this.portalItem.isResolved()?this._fetchCompanionFeatureLayerFromRelatedItems(this.portalItem):
this._fetchCompanionFeatureLayerFromUrl()).then(function(a){return a.load()}).otherwise(function(b){null==a.attributeStorageInfo?L.warn("Companion FeatureLayer could not be loaded and no binary attributes found. Popups will not work for this SceneLayer: "+a.title):L.info("Companion FeatureLayer could not be loaded. Falling back to binary attributes for Popups on this SceneLayer: "+a.title);return null})};c.prototype._fetchCompanionFeatureLayerFromRelatedItems=function(a){var b=this;return a.fetchRelatedItems({relationshipType:"Service2Data",
direction:"forward"}).then(function(a){return(a=a.filter(function(a){return"Feature Service"===a.type})[0])?b._fetchCompanionFeatureLayerFromPortalItem(new B({id:a.id,portal:a.portal})):b._fetchCompanionFeatureLayerFromUrl()}).otherwise(function(){return b._fetchCompanionFeatureLayerFromUrl()})};c.prototype._fetchCompanionFeatureLayerFromPortalItem=function(a){var b=this;return a.load().then(function(a){return b._findMatchingCompanionSublayerUrl(a.url)}).then(function(b){return w.resolve(new g({url:b,
portalItem:a}))})};c.prototype._fetchCompanionFeatureLayerFromUrl=function(){return this._findMatchingCompanionSublayerUrl().then(function(a){return w.resolve(new g({url:a}))})};c.prototype._findMatchingCompanionSublayerUrl=function(a){var b=this.parsedUrl.path.match(/^(.*)\/SceneServer\/layers\/([\d]*)\/?$/i);if(!b)return w.reject();null==a&&(a=b[1]+"/FeatureServer");var c=a.replace(/^(.*FeatureServer)(\/[\d]*\/?)?$/i,"$1");a={query:{f:"json"},responseType:"json"};var d=b[1]+"/SceneServer",e=parseInt(b[2],
10),b=t(this._addUrlToken(d),a).otherwise(function(a){return{layers:null}});a=t(this._addUrlToken(c),a);return K([a,b]).then(function(a){var b=a[0];a=a[1];a=a.data&&a.data.layers;b=b.data&&b.data.layers;if(!Array.isArray(b))throw Error("expected layers array");if(Array.isArray(a))for(var d=0;d<Math.min(a.length,b.length);d++){if(a[d].id===e)return c+"/"+b[d].id}else if(e<b.length)return c+"/"+b[e].id;throw Error("could not find matching companion sublayer");})};c.prototype._buddyIsMoreImportant=function(a){if(!this.companionFeatureLayer)return!1;
var b=y.nameToId(this.originOf(a));a=y.nameToId(this.companionFeatureLayer.originOf(a));return null!=a&&a<=y.OriginId.SERVICE?null==b||b<y.OriginId.SERVICE:null!=a&&a<=y.OriginId.PORTAL_ITEM?null==b||b<y.OriginId.PORTAL_ITEM:!1};c.prototype._fieldLookup=function(a,b){b=b.toLowerCase();for(var c=0;c<a.length;c++){var d=a[c];if(d.name.toLowerCase()===b)return d}return null};return c}(c.declared(h,n));a([c.shared("esri.layers.SceneLayer")],k.prototype,"declaredClass",void 0);a([c.property()],k.prototype,
"companionFeatureLayer",void 0);a([c.property()],k.prototype,"operationalLayerType",void 0);a([c.property({json:{read:!1}})],k.prototype,"type",void 0);a([c.property({type:[d]})],k.prototype,"fields",void 0);a([c.property({readOnly:!0})],k.prototype,"attributeStorageInfo",void 0);a([c.property({json:{read:!1,write:!1}})],k.prototype,"definitionExpression",void 0);a([c.property({type:l,json:{origins:{service:{read:{source:"elevationInfo"},write:{target:"elevationInfo",enabled:!1}}},read:{source:"layerDefinition.elevationInfo"},
write:{target:"layerDefinition.elevationInfo"}}})],k.prototype,"elevationInfo",void 0);a([c.property({type:String,dependsOn:["profile"]})],k.prototype,"geometryType",null);a([c.property({type:Boolean})],k.prototype,"labelsVisible",void 0);a([c.reader("labelsVisible",["showLabels"])],k.prototype,"readLabelsVisible",null);a([c.writer("labelsVisible")],k.prototype,"writeLabelsVisible",null);a([c.property({type:[e],json:{origins:{service:{read:{source:"drawingInfo.labelingInfo",reader:f.reader},write:{target:"drawingInfo.labelingInfo",
enabled:!1}}},read:{source:"layerDefinition.drawingInfo.labelingInfo",reader:f.reader},write:{target:"layerDefinition.drawingInfo.labelingInfo"}}})],k.prototype,"labelingInfo",void 0);a([c.property({type:Boolean})],k.prototype,"legendEnabled",void 0);a([c.reader("legendEnabled",["showLegend"])],k.prototype,"readLegendEnabled",null);a([c.writer("legendEnabled")],k.prototype,"writeLegendEnabled",null);a([c.property({json:{origins:{service:{read:{source:"drawingInfo.renderer",reader:E},write:{target:"drawingInfo.renderer",
enabled:!1}}},read:{source:"layerDefinition.drawingInfo.renderer",reader:E},write:{target:"layerDefinition.drawingInfo.renderer"}}})],k.prototype,"renderer",void 0);a([c.property({json:{read:!1}})],k.prototype,"cachedDrawingInfo",void 0);a([c.reader("service","cachedDrawingInfo")],k.prototype,"readCachedDrawingInfo",null);a([c.property({type:Boolean})],k.prototype,"popupEnabled",void 0);a([c.reader("popupEnabled",["disablePopup"])],k.prototype,"readPopupEnabled",null);a([c.writer("popupEnabled")],
k.prototype,"writePopupEnabled",null);a([c.property({type:u})],k.prototype,"popupTemplate",void 0);a([c.reader("popupTemplate",["popupInfo"])],k.prototype,"readPopupTemplate",null);a([c.writer("popupTemplate")],k.prototype,"writePopupTemplate",null);a([c.property({type:String,json:{read:!1}})],k.prototype,"objectIdField",void 0);a([c.reader("service","objectIdField",["objectIdField","fields"])],k.prototype,"readObjectIdField",null);a([c.property()],k.prototype,"objectIdFilter",void 0);a([c.property({type:String,
json:{read:!1}})],k.prototype,"profile",void 0);a([c.reader("service","profile",["store.profile"])],k.prototype,"readProfile",null);a([c.property({readOnly:!0,type:String,json:{read:!1}})],k.prototype,"normalReferenceFrame",void 0);a([c.reader("service","normalReferenceFrame",["store.normalReferenceFrame"])],k.prototype,"readNormalReferenceFrame",null);k=a([c.subclass()],k);var Q={"mesh-pyramids":"mesh-pyramids",meshpyramids:"mesh-pyramids","features-meshes":"mesh-pyramids",points:"points","features-points":"points",
lines:"lines","features-lines":"lines",polygons:"polygons","features-polygons":"polygons"},N={"mesh-pyramids":"mesh",points:"point",lines:"polyline",polygons:"polygon"};return k})},"esri/layers/mixins/SceneService":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../Layer ../../core/MultiOriginJSONSupport ./ArcGISService ./OperationalLayer ./PortalLayer ../../core/Error ../../core/urlUtils ../../core/promiseUtils ../../core/requireUtils ../../request dojo/_base/lang dojo/io-query ../../geometry/SpatialReference ../../geometry/Extent ../support/arcgisLayerUrl".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f,n,u,t,r,w,q,x,y,z){k=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b.blendMode=null;b.spatialReference=null;b.fullExtent=null;b.version={major:Number.NaN,minor:Number.NaN,versionString:""};b.copyright=null;b.sublayerTitleMode="item-title";b.title=null;b.layerId=null;return b}b(c,a);c.prototype.readSpatialReference=function(a,b){return this._readSpatialReference(b)};c.prototype._readSpatialReference=function(a){if(null!=a.spatialReference)return x.fromJSON(a.spatialReference);
a=a.store;a=(a=a.indexCRS||a.geographicCRS)&&parseInt(a.substring(a.lastIndexOf("/")+1,a.length),10);return null!=a?new x(a):null};c.prototype.readFullExtent=function(a,b){a=b.store;b=this._readSpatialReference(b);return null==b||null==a||null==a.extent?null:new y({xmin:a.extent[0],ymin:a.extent[1],xmax:a.extent[2],ymax:a.extent[3],spatialReference:b})};c.prototype.readVersion=function(a,b){a=b.store;b=null!=a.version?a.version.toString():"";a={major:Number.NaN,minor:Number.NaN,versionString:b};b=
b.split(".");2<=b.length&&(a.major=parseInt(b[0],10),a.minor=parseInt(b[1],10));return a};c.prototype.readCopyright=function(a,b){return b.copyrightText};c.prototype.readTitlePortalItem=function(a,b){return"item-title"!==this.sublayerTitleMode?void 0:a};c.prototype.readTitleService=function(a,b){a=this.portalItem&&this.portalItem.title;if("item-title"===this.sublayerTitleMode)return z.titleFromUrlAndName(this.url,b.name);b=b.name||z.parse(this.url).title;"item-title-and-service-name"===this.sublayerTitleMode&&
a&&(b=a+" - "+b);return z.cleanTitle(b)};c.prototype.readLayerId=function(a,b){return b.id};Object.defineProperty(c.prototype,"url",{set:function(a){var b=n.urlToObject(a),c=z.parse(b.path);c&&null!=c.sublayer&&(this.layerId=c.sublayer,b=q.objectToQuery(b.query),a=c.url.path,b&&(a=a+"?"+b));for(;"/"===a[a.length-1];)a=a.slice(0,-1);this._set("url",a)},enumerable:!0,configurable:!0});c.prototype.writeUrl=function(a,b){a&&n.isProtocolRelative(a)&&(a="https:"+a);var c=n.urlToObject(a);null!=this.layerId&&
c?(b.url=c.path+"/layers/"+this.layerId,c.query&&Object.keys(c.query)&&(b.url+="?"+q.objectToQuery(c.query))):a&&(b.url=a)};Object.defineProperty(c.prototype,"parsedUrl",{get:function(){var a=this._get("url");if(!a)return null;a=n.urlToObject(a);null!=this.layerId&&z.match.test(a.path)&&(a.path=a.path+"/layers/"+this.layerId);return a},enumerable:!0,configurable:!0});c.prototype._addUrlToken=function(a){var b=w.mixin({},this.parsedUrl.query,{token:this.token}),b=q.objectToQuery(b);return a+(b?"?"+
b:"")};c.prototype.readRootNode=function(a,b){return b.store.rootNode};c.prototype._verifyRootNodeAndUpdateExtent=function(){var a=this;return this._fetchRootNode().then(function(b){return a._updateExtentFromRootNode(b)})};c.prototype._updateExtentFromRootNode=function(a){if(null!=this.fullExtent&&!this.fullExtent.hasZ&&null!=a&&Array.isArray(a.mbs)&&4===a.mbs.length){var b=a.mbs[2];a=a.mbs[3];this.fullExtent.zmin=b-a;this.fullExtent.zmax=b+a}};c.prototype._fetchRootNode=function(){if(!this.rootNode)return u.resolve();
var a=n.join(this.parsedUrl.path,this.rootNode);return r(this._addUrlToken(a),{query:{f:"json"},responseType:"json"}).then(function(a){return a.data}).otherwise(function(b){throw new f("sceneservice:root-node-missing","Root node missing.",{error:b,url:a});})};c.prototype._fetchService=function(){var a=this;return(null==this.layerId&&/SceneServer\/*$/i.test(this.url)?this._fetchFirstLayerId().then(function(b){null!=b&&(a.layerId=b)}):u.resolve()).then(function(){return a._fetchServiceLayer()})};c.prototype._fetchFirstLayerId=
function(){return r(this._addUrlToken(this.url),{query:{f:"json"},callbackParamName:"callback",responseType:"json"}).then(function(a){if(a.data&&Array.isArray(a.data.layers)&&0<a.data.layers.length)return a.data.layers[0].id})};c.prototype._fetchServiceLayer=function(){var a=this;return r(this._addUrlToken(this.parsedUrl.path),{query:{f:"json"},responseType:"json"}).then(function(b){b.ssl&&(a.url=a.url.replace(/^http:/i,"https:"));b=b.data;a.read(b,{origin:"service",url:a.parsedUrl});a._validateLayer(b)})};
c.prototype._validateLayer=function(a){};c.prototype.createGraphicsController=function(a){var b=this;a.layer=this;a.addUrlToken=function(a){return b._addUrlToken(a)};var c=t.when(m,"../graphics/controllers/I3SOnDemandController").then(function(b){return new b(a)});c.then(function(a){b.emit("graphics-controller-create",{graphicsController:a})});return c};return c}(c.declared(h,d,g,e,l));a([c.shared({id:{json:{origins:{service:{read:!1},portalItem:{read:!1}}}}})],k.prototype,"properties",void 0);a([c.property({type:x})],
k.prototype,"spatialReference",void 0);a([c.reader("spatialReference",["spatialReference","store.indexCRS","store.geographicCRS"])],k.prototype,"readSpatialReference",null);a([c.property({type:y})],k.prototype,"fullExtent",void 0);a([c.reader("fullExtent",["store.extent","spatialReference","store.indexCRS","store.geographicCRS"])],k.prototype,"readFullExtent",null);a([c.property({readOnly:!0})],k.prototype,"version",void 0);a([c.reader("version",["store.version"])],k.prototype,"readVersion",null);
a([c.property({type:String})],k.prototype,"copyright",void 0);a([c.reader("copyright",["copyrightText"])],k.prototype,"readCopyright",null);a([c.property({type:String})],k.prototype,"sublayerTitleMode",void 0);a([c.property({type:String})],k.prototype,"title",void 0);a([c.reader("portal-item","title")],k.prototype,"readTitlePortalItem",null);a([c.reader("service","title",["name"])],k.prototype,"readTitleService",null);a([c.property({type:Number})],k.prototype,"layerId",void 0);a([c.reader("service",
"layerId",["id"])],k.prototype,"readLayerId",null);a([c.property()],k.prototype,"url",null);a([c.writer("url")],k.prototype,"writeUrl",null);a([c.property({dependsOn:["layerId"]})],k.prototype,"parsedUrl",null);a([c.property()],k.prototype,"store",void 0);a([c.property({type:String})],k.prototype,"rootNode",void 0);a([c.reader("rootNode",["store.rootNode"])],k.prototype,"readRootNode",null);return k=a([c.subclass("esri.layers.mixins.SceneService")],k)})},"esri/layers/IntegratedMeshLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ./Layer ./mixins/SceneService ../core/Error dojo/_base/lang".split(" "),
function(m,k,b,a,c,h,g,d,e){m=function(a){function c(b,c){b=a.call(this)||this;b.geometryType="mesh";b.operationalLayerType="IntegratedMeshLayer";b.type="integrated-mesh";return b}b(c,a);c.prototype.normalizeCtorArgs=function(a,b){return"string"===typeof a?e.mixin({},{url:a},b):a};c.prototype.load=function(){var a=this,b=this.loadFromPortal({supportedTypes:["Scene Service"]}).always(function(){return a._fetchService()}).then(function(){return a._verifyRootNodeAndUpdateExtent()});this.addResolvingPromise(b);
return this};c.prototype._validateLayer=function(a){if(a.layerType&&"IntegratedMesh"!==a.layerType)throw new d("integratedmeshlayer:layer-type-not-supported","IntegratedMeshLayer does not support this layer type",{layerType:a.layerType});if(isNaN(this.version.major)||isNaN(this.version.minor))throw new d("layer:service-version-not-supported","Service version is not supported.",{serviceVersion:this.version.versionString,supportedVersions:"1.x"});if(1<this.version.major)throw new d("layer:service-version-too-new",
"Service version is too new.",{serviceVersion:this.version.versionString,supportedVersions:"1.x"});};return c}(c.declared(h,g));a([c.shared("esri.layers.IntegratedMeshLayer")],m.prototype,"declaredClass",void 0);a([c.shared({"3d":"../views/3d/layers/SceneLayerView3D"})],m.prototype,"viewModulePaths",void 0);a([c.property({type:String,readOnly:!0})],m.prototype,"geometryType",void 0);a([c.property()],m.prototype,"operationalLayerType",void 0);a([c.property({json:{read:!1}})],m.prototype,"type",void 0);
return m=a([c.subclass()],m)})},"esri/views/3d/layers/ElevationLayerView3D":function(){define(["../../../core/declare","../../../core/promiseUtils","../../../core/Error","./TiledLayerView3D"],function(m,k,b,a){return m(a,{declaredClass:"esri.views.3d.layers.ElevationLayerView3D",properties:{isTransparent:{readOnly:!0,get:function(){return!0}}},initialize:function(){var a=this.get("view.map.ground.layers");a&&-1!==a.indexOf(this.layer)||this.addResolvingPromise(k.reject(new b("layerview:elevation-layer-only",
"3D elevation layer '"+this.layer.id+"' can only be added in the map ground")))}})})},"esri/views/3d/layers/TiledLayerView3D":function(){define("dojo/request/xhr ../../../core/declare ../../../core/watchUtils ../../../core/promiseUtils ../../../core/Error ../../../layers/support/arcgisLayerUrl ../../layers/LayerView ../terrain/terrainUtils ./support/LayerViewUpdatingPercentage".split(" "),function(m,k,b,a,c,h,g,d,e){function l(a){var b=null,c=a.search(/\/rest\/services\//i);0<c&&(b=a.substring(0,
c+6));return b}return k([g,e],{declaredClass:"esri.views.3d.layers.TiledLayerView3D",properties:{formatIsTransparent:{dependsOn:["layer.tileInfo.format"],get:function(){return"jpg"!==this.get("layer.tileInfo.format")}},isTransparent:{dependsOn:["fullOpacity","formatIsTransparent"],readOnly:!0,get:function(){return 1>this.fullOpacity||this.formatIsTransparent}}},_numUpdating:0,_maxNumUpdating:0,_isUpdating:!1,minDataLevel:0,maxDataLevel:Infinity,initialize:function(){var e=this.layer.tileInfo,g=d.checkIfTileInfoSupportedForView(e,
this.layer.fullExtent,this.view.spatialReference,this.view.basemapTerrain.manifold);if(g){var h={layer:this.layer,error:g};switch(g.name){case "tilingscheme:local-gcs-not-supported":g=new c("layerview:local-gcs-not-supported","Geographic coordinate systems are not supported in local scenes",h);break;case "tilingscheme:spatial-reference-mismatch":case "tilingscheme:global-unsupported-spatial-reference":g=new c("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",
h);break;default:g=new c("layerview:tiling-scheme-unsupported","The tiling scheme of this layer is not supported by SceneView",h)}this.addResolvingPromise(a.reject(g))}else g=b.whenTrueOnce(this.view,"basemapTerrain.tilingSchemeLocked").then(function(){if(!this.view.basemapTerrain.tilingScheme.compatibleWith(e)){var b=new c("layerview:tiling-scheme-incompatible","The tiling scheme of this layer is incompatible with the tiling scheme of the surface");return a.reject(b)}}.bind(this)),this.addResolvingPromise(g);
this._checkServiceVersionCompatibility();var k=Infinity,l=0;e.lods.forEach(function(a){k=Math.min(a.level,k);l=Math.max(a.level,l)});l=Math.min(l,d.getKnownTiledServiceLevelCap(this.layer.url));this.minDataLevel=k;this.maxDataLevel=l},getTileUrl:function(a,b,c){return this.layer.getTileUrl(a,b,c)},_checkServiceVersionCompatibility:function(){if(!h.isHostedAgolService(this.layer.url))if(10.22>this.layer.version){var b=new c("layerview:service-version-too-old","Tiled Map Layers on servers prior to 10.2.2 are not supported. Detected version: "+
this.layer.version,{minVersion:10.22,detectedVersion:this.layer.version});this.addResolvingPromise(a.reject(b))}else if(10.22===this.layer.version&&!h.isHostedSecuredProxyService(this.layer.url,this.layer.get("portalItem.id"))){var b=l(this.layer.url),d=new c("tiledlayerview3d:service-missing-cors-patch","Tiled Map Layers from 10.2.2 servers are only supported if all server updates have been applied."),b=m(b+"self?f\x3djson",{headers:{"X-Requested-With":null},timeout:1E4,handleAs:"json"}).then(function(a){if(!a||
a.error)throw d;}).otherwise(function(){throw d;});this.addResolvingPromise(b)}},_evaluateUpdatingState:function(a){this._isUpdating=!!a;this.notifyChange("updating")},isUpdating:function(){return this._isUpdating}})})},"esri/views/3d/layers/support/LayerViewUpdatingPercentage":function(){define(["../../../../core/Accessor"],function(m){return m.createSubclass([],{properties:{updating:{readOnly:!0},updatingPercentageValue:{value:100,readOnly:!0},updatingPercentage:{dependsOn:["updating","updatingPercentageValue"],
readOnly:!0,value:0,get:function(){return this.updating?this.updatingPercentageValue:0}}},constructor:function(){}})})},"esri/views/3d/layers/FeatureLayerView3D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators dojo/promise/all ./graphics/Graphics3DLayerViewCore ./graphics/graphicUtils ./support/LayerViewUpdatingPercentage ../../layers/LayerView ../../../layers/FeatureLayer ../../../renderers/support/renderingInfoUtils ../../../layers/graphics/controllers/SnapshotController ../support/PromiseLightweight ../../../core/watchUtils ./support/projectExtentUtils ../../../core/Error ../../../core/promiseUtils ../../../layers/graphics/QueryEngine".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f,n,u,t,r,w,q,x,y){m=z=function(a){function c(b){b=a.call(this)||this;b.controller=null;b.supportsDraping=!0;b._overlayUpdating=null;b._progressMaxNumNodes=0;b._eventHandles=[];b._controllerClientSideFiltering=!1;b._suspendResumeExtent=null;b.fullExtentInViewSpatialReference=null;b._isUpdating=!1;b._controllerCreated=!1;return b}b(c,a);Object.defineProperty(c.prototype,"drawingOrder",{set:function(a){this._layerViewCore.graphicsCore.setDrawingOrder(a);this._set("drawingOrder",
a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"hasDraped",{get:function(){return this._layerViewCore.graphicsCore.hasDraped},enumerable:!0,configurable:!0});c.prototype.initialize=function(){var a=this;this._layerViewCore=new g({owner:this,layer:this.layer,spatialIndexRequired:!0,frustumVisibilityEnabled:!0,scaleVisibilityEnabled:!0,labelingEnabled:this.layer.isInstanceOf(f),elevationAlignmentEnabled:!0,verticalScaleEnabled:!0,updateSuspendResumeExtent:function(){return a.updateSuspendResumeExtent()},
updateClippingExtent:function(b){return a.updateClippingExtent(b)}});this.addResolvingPromise(this._layerViewCore.initialize());this.drawingOrder=this.view.getDrawingOrder(this.layer.uid);this.createController();this.addResolvingPromise(this.validateMaximumFeatureCount());this.addResolvingPromise(this.validateGeometryType());var b=w.toView(this).then(function(b){a.fullExtentInViewSpatialReference=b});b&&this.addResolvingPromise(b);this._evaluateUpdatingState()};c.prototype.destroy=function(){this._eventHandles.forEach(function(a){return a.remove()});
this._eventHandles=null;this.controller&&(this.controller.destroy(),this.controller=null);this._layerViewCore&&(this._layerViewCore.destroy(),this._layerViewCore=null);this.loadedGraphics=null};c.prototype.getRenderingInfo=function(a){if((a=n.getRenderingInfo(a,{renderer:this.layer.renderer}))&&a.color){var b=a.color;b[0]/=255;b[1]/=255;b[2]/=255}return a};c.prototype.getGraphicsFromStageObject=function(a,b){var c=a.getMetadata().graphicId,d=null;this.loadedGraphics&&this.loadedGraphics.some(function(a){return a.uid===
c?(d=a,!0):!1});a=new t.Promise;null!==d?a.done(d):a.reject();return a};c.prototype.getGraphics3DGraphics=function(){return this._layerViewCore.graphicsCore.getGraphics3DGraphics()};c.prototype.getGraphics3DGraphicsKeys=function(){return this._layerViewCore.graphicsCore.getGraphics3DGraphicsKeys()};c.prototype.getSymbolUpdateType=function(){return this._layerViewCore.graphicsCore.getSymbolUpdateType()};c.prototype.queryGraphics=function(){return this._queryEngine?this._queryEngine.queryFeatures():
this._rejectQuery()};c.prototype.queryFeatures=function(a){return this._queryEngine?this._queryEngine.queryFeatures(a):this._rejectQuery()};c.prototype.queryObjectIds=function(a){return this._queryEngine?this._queryEngine.queryObjectIds(a):this._rejectQuery()};c.prototype.queryFeatureCount=function(a){return this._queryEngine?this._queryEngine.queryFeatureCount(a):this._rejectQuery()};c.prototype.queryExtent=function(a){return this._queryEngine?this._queryEngine.queryExtent(a):this._rejectQuery()};
c.prototype.whenGraphicBounds=function(a){return this._layerViewCore.graphicsCore.whenGraphicBounds(a)};c.prototype._rejectQuery=function(){return x.reject(new q("FeatureLayerView3D","Not ready to execute query"))};c.prototype._notifySuspendedChange=function(){this.notifyChange("suspended")};c.prototype._notifyDrapedDataChange=function(){this.notifyChange("hasDraped");this.emit("draped-data-change")};c.prototype.canResume=function(){return this.inherited(arguments)&&this._layerViewCore&&this._layerViewCore.canResume()};
c.prototype._evaluateUpdatingState=function(){if(this._layerViewCore.elevationAlignment){var a;a=0+this._layerViewCore.elevationAlignment.numNodesUpdating();a+=this._layerViewCore.graphicsCore.numNodesUpdating();var b;b=(b=(b=(b=(b=!this._controllerCreated)||this.controller&&this.controller.updating)||this._overlayUpdating)||this._layerViewCore.graphicsCore.needsIdleUpdate())||!(this.view.basemapTerrain&&this.view.basemapTerrain.ready);var c;c=0<a||b||this._layerViewCore.spatialIndex.isUpdating();
this._progressMaxNumNodes=Math.max(a,this._progressMaxNumNodes);0===a&&(this._progressMaxNumNodes=1);this._isUpdating=c;this.notifyChange("updating");this._set("updatingPercentageValue",b?100:100*a/this._progressMaxNumNodes)}else this._isUpdating=!1,this.notifyChange("updating"),this._set("updatingPercentageValue",100)};c.prototype.isUpdating=function(){return this._isUpdating};c.prototype.createController=function(){var a=this,b=this.layer.createGraphicsController({layerView:this,options:{maxPageSize:300,
extent:this.view.clippingArea}});r.whenTrueOnce(this.view,"basemapTerrain.ready",function(){h([a,b]).then(function(b){b=b[1];b instanceof u&&(a.controller=b,a._eventHandles.push(a.controller.watch("updating",function(){return a._evaluateUpdatingState()})),a._eventHandles.push(r.whenFalseOnce(a,"suspended",function(){a.controller&&a.controller.startup()})));a.loadedGraphics=b.graphics;a._queryEngine=new y({features:a.loadedGraphics,objectIdField:a.layer.objectIdField});a._evaluateUpdatingState()}).always(function(){a._controllerCreated=
!0;a._evaluateUpdatingState()})})};c.prototype.updateClippingExtent=function(a){if(this.controller){if(this._controllerClientSideFiltering)return!1;this.controller.extent?(this.controller.extent=null,this._controllerClientSideFiltering=!0):this.controller.extent=a;return!0}return!1};c.prototype.updateSuspendResumeExtent=function(){return this._suspendResumeExtent=d.enlargeExtent(this._layerViewCore.graphicsCore.computedExtent,this._suspendResumeExtent,1.2)};c.prototype.validateGeometryType=function(){var a=
this.layer;switch(a.geometryType){case "multipatch":case "multipoint":return x.reject(new q("featurelayerview3d:unsupported-geometry-type","Unsupported geometry type ${geometryType}",{geometryType:a.geometryType}))}};c.prototype.validateMaximumFeatureCount=function(){return 0>z.maximumFeatureCount||!this.layer.url?x.resolve():this.layer.queryFeatureCount().then(function(a){if(a>z.maximumFeatureCount)throw new q("featurelayerview3d:maximum-feature-count-exceeded","The maximum number of allowed features (${maximumFeatureCount}) has been exceeded (layer has ${numberOfFeatures} features)",
{maximumFeatureCount:z.maximumFeatureCount,numberOfFeatures:a});})};c.prototype.getStats=function(){var a=this._layerViewCore.graphicsCore.getGraphics3DGraphics(),b="null",c=this._suspendResumeExtent;c&&(b=[c[0],c[1],c[2],c[3]].map(function(a){return a.toPrecision(4)}).join(", "));var c="null",d=this._layerViewCore.graphicsCore.computedExtent;d&&(c=[d.xmin,d.ymin,d.xmax,d.ymax].map(function(a){return a.toPrecision(4)}).join(", "));return{numCollection:this.loadedGraphics.length,numGraphics:Object.keys(a).length,
numElevationUpdating:this._layerViewCore.elevationAlignment.numNodesUpdating(),numSpatialIndexUpdating:this._layerViewCore.spatialIndex.numNodesUpdating(),numGraphicsUpdating:this._layerViewCore.graphicsCore.numNodesUpdating(),visibilityFrustum:this._layerViewCore.frustumVisibility.canResume(),visibilityScale:this._layerViewCore.scaleVisibility.canResume(),resumeExtent:b,computedExtent:c,updating:this.updating,suspended:this.suspended}};return c}(c.declared(l,e));m.maximumFeatureCount=-1;a([c.property()],
m.prototype,"drawingOrder",null);a([c.property()],m.prototype,"loadedGraphics",void 0);a([c.property()],m.prototype,"symbolsUpdating",void 0);a([c.property()],m.prototype,"hasDraped",null);a([c.property()],m.prototype,"controller",void 0);m=z=a([c.subclass("esri.views.3d.layers.FeatureLayerView3D")],m);var z;return m})},"esri/views/3d/layers/graphics/Graphics3DLayerViewCore":function(){define("require exports ../../../../core/HandleRegistry ../../../../core/watchUtils ../../../../core/promiseUtils ./Graphics3DCore ./Graphics3DLabeling ./Graphics3DScaleVisibility ./Graphics3DFrustumVisibility ./Graphics3DElevationAlignment ./Graphics3DSpatialIndex ./Graphics3DVerticalScale".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f,n){return function(){function k(c){var k=this;this._handles=new b;this.layer=c.layer;this.owner=c.owner;this.updateClippingExtent=c.updateClippingExtent;this.updateSuspendResumeExtent=c.updateSuspendResumeExtent;this.elevationChanged=c.elevationChanged;this.graphicsCore=new h;c.spatialIndexRequired&&(this.spatialIndex=new f);if(c.frustumVisibilityEnabled){this.frustumVisibility=new e;var m=this.owner.view.basemapTerrain;this._handles.add([this.owner.view.on("resize",
function(){return k.frustumVisibility.viewChange()}),this.owner.view.navigation.on("currentViewChanged",function(){return k.frustumVisibility.viewChange()}),m.on("elevation-bounds-change",function(){return k.frustumVisibility.elevationBoundsChange()})]);"local"===this.owner.view.viewingMode?this.frustumVisibility.isVisibleBelowSurface=!0:this._handles.add(a.init(m,["opacity","wireframe"],function(){return k.frustumVisibility.isVisibleBelowSurface=m._renderer.isTransparent()}))}c.scaleVisibilityEnabled&&
(c.spatialIndexRequired?(this.scaleVisibility=new d,this._handles.add(this.layer.watch("minScale,maxScale,labelingInfo",function(){return k.scaleVisibility.layerMinMaxScaleChangeHandler()}))):console.warn("scaleVisibility requires a spatialIndex"));c.elevationAlignmentEnabled&&(this.elevationAlignment=new l,this._handles.add(this.layer.watch("elevationInfo",function(){return k.graphicsCore.elevationInfoChange()})));c.labelingEnabled&&(this.labeling=new g,this._handles.add(this.layer.watch("labelsVisible",
function(){return k.labeling.labelVisibilityChanged()})),this._handles.add(this.layer.watch("labelingInfo",function(){return k.labeling.updateLabelingInfo()})));c.verticalScaleEnabled&&(this.verticalScale=new n({sourceSpatialReference:this.layer.spatialReference,destSpatialReference:this.owner.view.spatialReference}))}k.prototype.initialize=function(){var a=this;return this.whenSpatialIndexLoaded().then(function(){return a.deferredInitialize()})};k.prototype.whenSpatialIndexLoaded=function(){return this.spatialIndex?
this.spatialIndex.whenLoaded():c.resolve()};k.prototype.deferredInitialize=function(){var a=this;this.spatialIndex&&this.spatialIndex.initialize(this.owner,this.layer,this.owner.view.spatialReference,this.graphicsCore);this.frustumVisibility&&this.frustumVisibility.initialize(this.owner);var b=this.owner.view.basemapTerrain;this.scaleVisibility&&this.scaleVisibility.initialize(this.owner,this.layer,this.spatialIndex,this.graphicsCore,b);this.elevationAlignment&&this.elevationAlignment.initialize(this.owner,
function(b,c,d){return a._elevationChanged(b,c,d)},this.graphicsCore,b);this.labeling&&this.labeling.initialize(this.owner,this.layer,function(b,c){return a._labelGraphicCreated(b,c)},this.graphicsCore);this.graphicsCore.initialize(this.owner,this.layer,this.elevationAlignment,this.scaleVisibility,this.spatialIndex,this.labeling,function(){a.updateSuspendResumeExtent&&a._updateSuspendResumeExtent(a.updateSuspendResumeExtent())},function(b){return a.verticalScale?a.verticalScale.adjust(b):b},b);this._handles.add([this.layer.watch("renderer",
function(b){return a.graphicsCore.rendererChange(b)}),this.owner.watch("fullOpacity",function(){return a.graphicsCore.opacityChange()})]);this._handles.add(this.layer.on("graphic-update",function(b){return a.graphicsCore.graphicUpdateHandler(b)}));this.owner.view.resourceController.registerIdleFrameWorker(this,{needsUpdate:this._needsIdleUpdate,idleFrame:this._idleUpdate});this.updateClippingExtent&&(this._handles.add(this.owner.view.watch("clippingArea",function(){return a._updateClippingExtent()})),
this._updateClippingExtent());if(this.labeling)return this.labeling.updateLabelingInfo()};k.prototype.destroy=function(){this.owner&&this.owner.view.resourceController.deregisterIdleFrameWorker(this);this._handles&&(this._handles.destroy(),this._handles=null);this.frustumVisibility&&(this.frustumVisibility.destroy(),this.frustumVisibility=null);this.scaleVisibility&&(this.scaleVisibility.destroy(),this.scaleVisibility=null);this.elevationAlignment&&(this.elevationAlignment.destroy(),this.elevationAlignment=
null);this.labeling&&(this.labeling.destroy(),this.labeling=null);this.graphicsCore&&(this.graphicsCore.destroy(),this.graphicsCore=null);this.spatialIndex&&(this.spatialIndex.destroy(),this.spatialIndex=null);this.owner=this.layer=null};k.prototype.canResume=function(){return(!this.frustumVisibility||this.frustumVisibility.canResume())&&(!this.scaleVisibility||this.scaleVisibility.canResume())};k.prototype._needsIdleUpdate=function(){return this.frustumVisibility&&this.frustumVisibility.needsIdleUpdate()||
this.scaleVisibility&&this.scaleVisibility.needsIdleUpdate()||this.elevationAlignment&&this.elevationAlignment.needsIdleUpdate()||this.graphicsCore&&this.graphicsCore.needsIdleUpdate()?!0:!1};k.prototype._idleUpdate=function(a){this.frustumVisibility&&this.frustumVisibility.idleUpdate(a);this.scaleVisibility&&this.scaleVisibility.idleUpdate(a);this.elevationAlignment&&this.elevationAlignment.idleUpdate(a);this.graphicsCore&&this.graphicsCore.idleUpdate(a)};k.prototype._updateSuspendResumeExtent=function(a){this.frustumVisibility&&
this.frustumVisibility.setExtent(a);this.scaleVisibility&&this.scaleVisibility.setExtent(a)};k.prototype._updateClippingExtent=function(){var a=this.owner.view.clippingArea;this.graphicsCore.setClippingExtent(a,this.owner.view.spatialReference)&&(this.updateClippingExtent(a)||this.graphicsCore.recreateAllGraphics())};k.prototype._elevationChanged=function(a,b,c){this.elevationChanged?this.elevationChanged(a,b,c):this.spatialIndex&&this.spatialIndex.intersects(a,b,c)};k.prototype._labelGraphicCreated=
function(a,b){this.scaleVisibility&&this.scaleVisibility.updateGraphicLabelScaleVisibility(a,b)};return k}()})},"esri/views/3d/layers/graphics/Graphics3DLabeling":function(){define("require exports dojo/promise/all ../../../../core/HandleRegistry ../../../../core/watchUtils ../../../../layers/support/LabelClass ../../lib/glMatrix ../../webgl-engine/lib/TextTextureAtlas ../../webgl-engine/lib/MaterialCollection ../../webgl-engine/materials/HUDMaterial ./Graphics3DWebStyleSymbol".split(" "),function(m,
k,b,a,c,h,g,d,e,l,f){var n=g.vec3d;m=function(){function g(){this.hudMaterialCollection=this.textTextureAtlas=null;this.labelVisibilityDirty=!1;this.labelClasses=[];this.eventHandles=new a;this.graphicsCore=this.layer=this.layerView=null}g.prototype.initialize=function(a,b,d,e){var f=this;this.layerView=a;this.layer=b;this.graphicsCore=e;this.labelGraphicsCreated=d;this.layerView.view.labelManager.addSceneServiceLayerView(this);this.eventHandles.add(c.whenNot(this.layerView,"suspended",function(){return f.resume()}))};
g.prototype.destroy=function(){this.layerView.view.labelManager.removeSceneServiceLayerView(this);this.textTextureAtlas&&(this.textTextureAtlas.dispose(),this.textTextureAtlas=null);this.hudMaterialCollection&&(this.hudMaterialCollection.dispose(),this.hudMaterialCollection=null);this.labelClasses=null;this.eventHandles.destroy();this.graphicsCore=this.layer=this.layerView=this.eventHandles=null};g.prototype.clear=function(){this.layerView.view.labelManager.setDirty();this.textTextureAtlas&&(this.textTextureAtlas.dispose(),
this.textTextureAtlas=null);this.hudMaterialCollection&&(this.hudMaterialCollection.dispose(),this.hudMaterialCollection=null)};g.prototype.updateLabelingInfo=function(){var a=this;this.removeLabels();return this.layer.then(function(){var c=a.layer.labelingInfo&&a.layer.labelingInfo.filter(function(a){return!!a.symbol});if(c&&0<c.length){var d=Array(c.length),c=c.map(function(b,c){var e=a.graphicsCore.getOrCreateGraphics3DSymbol(b.symbol),g;g=e instanceof f?e.graphics3DSymbol:e;d[c]={labelClass:b,
graphics3DSymbolLayer:g,options:b.getOptions()};return e});return b(c).then(function(){return d})}return null}).then(function(b){a.labelClasses=b;a.labelVisibilityChanged()})};g.prototype.createLabelsForGraphic=function(a,b){var c=!1;if(this.labelClasses&&0!==this.labelClasses.length&&b._graphics[0]){for(var f=0;f<this.labelClasses.length;f++){var g=this.labelClasses[f],k=g.labelClass;if(h.evaluateWhere(k.where,a.attributes)&&(k=k.getLabelExpression(),k.expression&&(k=h.buildLabelText(k.expression,
a,this.layer.fields,g.options)))){var f=g.graphics3DSymbolLayer.childGraphics3DSymbols[0],l=this.evalLabelPlacementParams(a,b);null==this.textTextureAtlas&&(this.textTextureAtlas=new d(this.layer.id,this.layerView.view._stage),this.hudMaterialCollection=new e(this.layerView.view._stage));if(f=f.createGraphics3DGraphic(a,{text:k,centerOffset:l.centerOffset,translation:l.translation,screenOffset:l.screenOffset,anchor:l.anchor},this.hudMaterialCollection,this.textTextureAtlas))f._labelClass=g.labelClass,
b.addLabelGraphic(f,this.graphicsCore.labelStageLayer,this.graphicsCore.stage),f.setVisibilityFlag("VISIBILITY_LABEL_SHOW",this.layerLabelsEnabled()),this.layerView.view.labelManager.setInitialLabelGraphicState(f),c=!0;break}}c&&this.labelGraphicsCreated&&this.labelGraphicsCreated(a,b)}};g.prototype.evalLabelPlacementParams=function(a,b){var c=u[this.layer.labelingInfo[0].labelPlacement]||u["default"];if("polygon"===a.geometry.type||"polyline"===a.geometry.type||"extent"===a.geometry.type)return{anchor:"center"};
if("point"!==a.geometry.type)return{anchor:c.anchor};a=b.graphics3DSymbol;var d=(a instanceof f?a.graphics3DSymbol:a).symbol.symbolLayers.getItemAt(0);a={screenOffset:[0,0],centerOffset:[0,0,0,-1],translation:n.create(b.getCenterObjectSpace()),anchor:c.anchor};var e=b._graphics[0];"Icon"===d.type?(d=e.getScreenSize(),b.isDraped()?a.anchor="center":(b=e.stageObject.getGeometryRecords()[0].materials[0],b instanceof l?(b=b.getParams(),a.screenOffset=[d[0]/2*(c.normalizedOffset[0]-2*(b.anchorPos[0]-.5)),
d[1]/2*(c.normalizedOffset[1]-2*(b.anchorPos[1]-.5))]):a.screenOffset=[d[0]/2*c.normalizedOffset[0],d[1]/2*c.normalizedOffset[1]])):"Object"===d.type&&(b=e.getBoundingBoxObjectSpace(),d=[b[3]-b[0],b[4]-b[1],b[5]-b[2]],a.centerOffset[0]=1.1*Math.max(d[0],d[1])/2*c.normalizedOffset[0],a.translation[2]+=1.1*d[2]/2*c.normalizedOffset[1],b=n.length(d),a.centerOffset[2]=1.1*b/2*c.normalizedOffset[2]);return a};g.prototype.layerLabelsEnabled=function(){return this.layer.labelsVisible};g.prototype.getGraphics3DGraphics=
function(){return this.graphicsCore.getGraphics3DGraphics()};g.prototype.getGraphics3DGraphicsKeys=function(){return this.graphicsCore.getGraphics3DGraphicsKeys()};g.prototype.labelVisibilityChanged=function(){var a=this;if(this.layerView.suspended)this.labelVisibilityDirty=!0;else if(this.layerView.loadedGraphics){var b=this.layerLabelsEnabled();this.layerView.loadedGraphics.forEach(function(c){var d=a.graphicsCore.getGraphics3DGraphicById(c.uid);if(d)for(b&&0===d._labelGraphics.length&&a.createLabelsForGraphic(c,
d),c=0;c<d._labelGraphics.length;c++)d._labelGraphics[c].setVisibilityFlag("VISIBILITY_LABEL_SHOW",b)});this.layerView.view.labelManager.setDirty();this.labelVisibilityDirty=!1}};g.prototype.elevationInfoChange=function(){this.labelClasses&&this.labelClasses.forEach(function(a){a.graphics3DSymbolLayer.layerPropertyChanged("elevationInfo",{})})};g.prototype.resume=function(){this.labelVisibilityDirty&&this.labelVisibilityChanged()};g.prototype.removeLabels=function(){var a=this;this.layerView.loadedGraphics&&
(this.layerView.loadedGraphics.forEach(function(b){if(b=a.graphicsCore.getGraphics3DGraphicById(b.uid))b._labelGraphics&&b._labelGraphics.forEach(function(a){return a._labelClass=null}),b.clearLabelGraphics()}),this.labelClasses=null,this.layerView.view.labelManager.setDirty())};return g}();var u={"above-center":{normalizedOffset:[0,1,0],anchor:"bottom"},"above-left":{normalizedOffset:[-1,1,0],anchor:"bottom-right"},"above-right":{normalizedOffset:[1,1,0],anchor:"bottom-left"},"below-center":{normalizedOffset:[0,
-1,2],anchor:"top"},"below-left":{normalizedOffset:[-1,-1,0],anchor:"top-right"},"below-right":{normalizedOffset:[1,-1,0],anchor:"top-left"},"center-center":{normalizedOffset:[0,0,1],anchor:"center"},"center-left":{normalizedOffset:[-1,0,0],anchor:"right"},"center-right":{normalizedOffset:[1,0,0],anchor:"left"}};k={"above-center":["default","esriServerPointLabelPlacementAboveCenter"],"above-left":["esriServerPointLabelPlacementAboveLeft"],"above-right":["esriServerPointLabelPlacementAboveRight"],
"below-center":["esriServerPointLabelPlacementBelowCenter"],"below-left":["esriServerPointLabelPlacementBelowLeft"],"below-right":["esriServerPointLabelPlacementBelowRight"],"center-center":["esriServerPointLabelPlacementCenterCenter"],"center-left":["esriServerPointLabelPlacementCenterLeft"],"center-right":["esriServerPointLabelPlacementCenterRight"]};var t,r;for(r in k)g=k[r],t=u[r],g.forEach(function(a){u[a]=t});Object.freeze&&(Object.freeze(u),Object.keys(u).forEach(function(a){Object.freeze(u[a]);
Object.freeze(u[a].normalizedOffset)}));return m})},"esri/views/3d/webgl-engine/lib/TextTextureAtlas":function(){define("require exports ./Texture ./ModelContentType ../../../webgl/Texture ../../../webgl/enums".split(" "),function(m,k,b,a,c,h){var g=function(){function a(a){this.textTextures={};this.dirty=!1;this._glTexture=null;this.id=b.idGen.gen(a)}a.prototype.getId=function(){return this.id};a.prototype.dispose=function(){};a.prototype.deferredLoading=function(){return!1};a.prototype.getWidth=
function(){return 512};a.prototype.getHeight=function(){return 512};a.prototype.initializeThroughRender=function(a,b){b.wrapMode=33071;b.samplingMode=9729;b.flipped=!0;var d=this._drawToCanvas();this._glTexture=new c(a,b,d);this.dirty=!1;return this._glTexture};a.prototype.redraw=function(){if(this.dirty&&this._glTexture){var a=this._drawToCanvas();this._glTexture.setData(a);this.dirty=!1}};a.prototype.setUnloadFunc=function(a){this._unloadFunc=a};a.prototype.unload=function(){null!=this._unloadFunc&&
(this._unloadFunc(this.id),this._unloadFunc=null)};a.prototype._drawToCanvas=function(){var b=a._create2Dcanvas(),c=b.getContext("2d");c.clearRect(0,0,512,512);for(var d in this.textTextures){var g=this.textTextures[d];g.textTexture.renderText(1,g.placement.width,g.placement.height,c,g.placement.atlasOffX,g.placement.atlasOffY)}return b};a._create2Dcanvas=function(){a._textCanvas2D||(a._textCanvas2D=document.createElement("canvas"),a._textCanvas2D.setAttribute("id","canvas2d"),a._textCanvas2D.setAttribute("width",
(512).toString()),a._textCanvas2D.setAttribute("height",(512).toString()),a._textCanvas2D.setAttribute("style","display:none"));return a._textCanvas2D};return a}();return function(){function b(a,b){this._textureAtlasSubtextures=[];this._curLineHeight=this._curY=this._curX=0;this._idHint=a;this._stage=b}b.prototype.dispose=function(){for(var b=0;b<this._textureAtlasSubtextures.length;b++)this._stage.remove(a.TEXTURE,this._textureAtlasSubtextures[b].getId());this._textureAtlasSubtextures=[]};b.prototype.addTextTexture=
function(b){for(var c=JSON.stringify(b.getParams())+"_"+b.getString(),d=0;d<this._textureAtlasSubtextures.length;d++){var e=this._textureAtlasSubtextures[d].textTextures[c];if(null!=e)return e.placement}var h=null;0===this._textureAtlasSubtextures.length&&(h=new g(this._idHint),this._textureAtlasSubtextures.push(h));var d=b.getTextWidth(),e=b.getTextHeight(),k,m;this._curLineHeight=Math.max(this._curLineHeight,e);512>this._curX+d&&512>this._curY+this._curLineHeight||(512>this._curY+this._curLineHeight+
e?(this._curX=0,this._curY+=this._curLineHeight+2):(h=new g(this._idHint),this._textureAtlasSubtextures.push(h),this._curY=this._curX=0),this._curLineHeight=e);k=this._curX;m=this._curY;this._curX+=d;null!=h&&this._stage.add(a.TEXTURE,h);h=this._textureAtlasSubtextures[this._textureAtlasSubtextures.length-1];d={uvMinMax:[k/512,1-(m+e)/512,(k+d)/512,1-m/512],atlasOffX:k,atlasOffY:m,width:d,height:e,texture:h};h.textTextures[c]={placement:d,textTexture:b};h.dirty=!0;return d};return b}()})},"esri/views/3d/webgl-engine/lib/MaterialCollection":function(){define(["require",
"exports","./ModelContentType"],function(m,k,b){return function(){function a(a){this.materials={};this.stage=a}a.prototype.getMaterial=function(a){return this.materials[a]};a.prototype.addMaterial=function(a,h){this.materials[a]=h;this.stage.add(b.MATERIAL,h)};a.prototype.dispose=function(){for(var a in this.materials)this.stage.remove(b.MATERIAL,this.materials[a].getId());this.materials={}};return a}()})},"esri/views/3d/layers/graphics/Graphics3DScaleVisibility":function(){define(["require","exports"],
function(m,k){function b(b){var c=!1;b.labelingInfo&&(c=c||b.labelingInfo.some(function(b){return b&&a(b.minScale,b.maxScale)}));return c=c||a(b.minScale,b.maxScale)}function a(a,b){return null!==a&&0<a&&8E7>a||1E3<b}return function(){function a(){this._scaleRangeActive=!1;this.layerScaleRangeVisibilityDirty=this.layerScaleRangeVisibility=!0;this.layerScaleRangeVisibilityQuery=!1;this.basemapTerrain=this.graphicsCore=this.extent=this.spatialIndex=this.layer=this.layerView=this.scaleChangeEventHandle=
null}a.prototype.initialize=function(a,c,d,e,k){this.layerView=a;this.layer=c;this.spatialIndex=d;this.graphicsCore=e;this._scaleRangeActive=b(c);this.basemapTerrain=k;this.layerMinMaxScaleChangeHandler(!1)};a.prototype.destroy=function(){this.scaleChangeEventHandle&&(this.scaleChangeEventHandle.remove(),this.scaleChangeEventHandle=null);this.graphicsCore=this.spatialIndex=this.extent=this.layerView=null};a.prototype.needsIdleUpdate=function(){return this.layerView.view.basemapTerrain&&this.layerScaleRangeVisibilityDirty};
a.prototype.canResume=function(){return this.layerScaleRangeVisibility};a.prototype.setExtent=function(a){this.extent=a;this.layerScaleRangeVisibilityDirty=!0};a.prototype.idleUpdate=function(a){this.layerView.view.basemapTerrain&&!a.done()&&this.layerScaleRangeVisibilityDirty&&(this.updateSuspendScaleVisible(),this.layerScaleRangeVisibilityDirty=!1)};a.prototype.scaleRangeActive=function(){return this._scaleRangeActive};a.prototype.updateSuspendScaleVisibleFinish=function(a){this.layerScaleRangeVisibilityQuery=
!1;this.layerScaleRangeVisibility!==a&&(this.layerScaleRangeVisibility=a,this.layerView._notifySuspendedChange())};a.prototype.updateSuspendScaleVisible=function(){var a=this,b=this.layerView.view.basemapTerrain;this.extent&&b&&this._scaleRangeActive?this.layerScaleRangeVisibilityQuery||(this.layerScaleRangeVisibilityQuery=!0,b.queryVisibleScaleRange(this.extent,this.layer.minScale,this.layer.maxScale,function(b){return a.updateSuspendScaleVisibleFinish(b)})):this.updateSuspendScaleVisibleFinish(!0)};
a.prototype.visibleAtScale=function(a,b,c){return null==a?!0:a>c&&(!b||a<b)};a.prototype.visibleAtLayerScale=function(a){return this.visibleAtScale(a,this.layer.minScale,this.layer.maxScale)};a.prototype.visibleAtLabelScale=function(a,b){return this.visibleAtScale(a,b.minScale,b.maxScale)};a.prototype.graphicScale=function(a,b){var c;b.centroid?c=b.centroid:"point"===a.geometry.type&&(c=a.geometry);return c?this.layerView.view.basemapTerrain?this.layerView.view.basemapTerrain.getScale(c):1:null};
a.prototype.graphicVisible=function(a,b){a=this.graphicScale(a,b);return this.visibleAtLayerScale(a)};a.prototype.updateGraphicScaleVisibility=function(a,b){return this._scaleRangeActive&&b.addedToSpatialIndex?(a=this.graphicVisible(a,b),b.setVisibilityFlag("VISIBILITY_SCALERANGE",a)):!1};a.prototype.updateGraphicLabelScaleVisibility=function(a,b){if(!this._scaleRangeActive||!b.addedToSpatialIndex||!b._labelGraphics||0===b._labelGraphics.length)return!1;a=this.graphicScale(a,b);(b=this.updateLabelScaleVisibility(b,
a))&&this.layerView.view.labelManager.setDirty();return b};a.prototype.updateLabelScaleVisibility=function(a,b){if(!a._labelGraphics||0===a._labelGraphics.length)return!1;var c=!1,e=0;for(a=a._labelGraphics;e<a.length;e++){var g=a[e],f=g._labelClass;f&&null!=f.minScale&&null!=f.maxScale&&(f=this.visibleAtLabelScale(b,f),g.setVisibilityFlag("VISIBILITY_SCALERANGE_LABEL",f)&&(c=!0))}return c};a.prototype.scaleUpdateHandler=function(a){var b=this;if(!this.layerView.suspended&&this.spatialIndex.hasGraphics()){var c=
a.extent,e=a.scale;this.spatialIndex.intersects(c,a.spatialReference,function(a,d){for(var f=b.visibleAtLayerScale(e),g=!1,h=!1,k=0;k<d;k++){var l=b.graphicsCore.getGraphics3DGraphicById(a[k]);if(l){var m=l.centroid;m&&(c[0]>m.x||c[1]>m.y||c[2]<m.x||c[3]<m.y)||(m=!1,l.setVisibilityFlag("VISIBILITY_SCALERANGE",f)&&(m=!0),b.updateLabelScaleVisibility(l,e)&&(m=!0),m&&(h=!0,l.isDraped()&&(g=!0)))}}h&&b.layerView.view.labelManager.setDirty();g&&b.layerView._notifyDrapedDataChange()})}this.layerScaleRangeVisibilityDirty=
!0};a.prototype.layerMinMaxScaleChangeHandler=function(a){var c=this;void 0===a&&(a=!0);(this._scaleRangeActive=b(this.layer))&&!this.scaleChangeEventHandle?(this.scaleChangeEventHandle=this.basemapTerrain.on("scale-change",function(a){return c.scaleUpdateHandler(a)}),this.layerView.suspended||this.spatialIndex.addGraphicsToSpatialIndex(this._scaleRangeActive)):!this._scaleRangeActive&&this.scaleChangeEventHandle&&(this.scaleChangeEventHandle.remove(),this.scaleChangeEventHandle=null);!this.layerView.suspended&&
a&&this.graphicsCore.updateAllGraphicsVisibility();this.layerScaleRangeVisibilityDirty=!0};return a}()})},"esri/views/3d/layers/graphics/Graphics3DFrustumVisibility":function(){define("require exports ../../support/earthUtils ../../support/projectionUtils ../../support/intersectionUtils ../../lib/glMatrix".split(" "),function(m,k,b,a,c,h){var g=h.vec3d,d=h.vec4d,e=-.3*b.earthRadius;m=.5*Math.PI;var l=m/Math.PI*180,f=m*b.earthRadius,n=.9*b.earthRadius,u=function(){function b(){this.extent=Array(4);
this.planes=Array(4);this.maxSpan=0;this.center={origin:g.create(),direction:g.create()};for(var a=0;4>a;a++)this.extent[a]={origin:g.create(),originLength:0,direction:g.create(),cap:{next:null,direction:g.create()}},this.planes[a]=d.create();this.planes[4]=d.create()}b.prototype.update=function(b,c,d,e,f,h){var k=this.extent;g.set3(b[0],b[1],h,k[0].origin);g.set3(b[2],b[1],h,k[1].origin);g.set3(b[2],b[3],h,k[2].origin);g.set3(b[0],b[3],h,k[3].origin);if(!f)for(f=0;4>f;f++)a.vectorToVector(k[f].origin,
e,k[f].origin,d);g.add(k[0].origin,k[2].origin,this.center.origin);g.scale(this.center.origin,.5);c(this.center.origin,this.center.direction);for(f=0;4>f;f++)d=k[f],c(d.origin,d.direction),d.originLength=g.length(d.origin),e=k[3===f?0:f+1],d.cap.next=e.origin,g.direction(e.origin,d.origin,d.cap.direction),this._computePlane(d.cap.direction,d.direction,d.origin,this.planes[f]);this._computePlane(k[1].cap.direction,k[0].cap.direction,k[0].origin,this.planes[4]);this.maxSpan=Math.max(Math.abs(b[0]-b[2]),
Math.abs(b[1]-b[3]))};b.prototype.isVisibleInFrustumGlobal=function(a){if(0>g.dot(this.center.direction,a.direction))return!0;for(var b=0;4>b;b++)if(0>g.dot(this.extent[b].direction,a.direction))return!0;return!1};b.prototype.isVisibleInFrustum=function(a,b,d){if("global"===a.viewingMode){if(this.maxSpan>(a.spatialReference.isWGS84?l:f))return!0;if(b.altitude()>=n)return this.isVisibleInFrustumGlobal(b)}for(a=0;a<this.extent.length;a++)if(d=this.extent[a],c.frustumRay(b.planes,d.origin,null,d.direction)||
c.frustumLineSegment(b.planes,d.origin,d.cap.next,d.cap.direction))return!0;for(a=0;a<b.lines.length;a++)if(d=b.lines[a],c.frustumLineSegment(this.planes,d.origin,d.endpoint,d.direction))return!0;return!1};b.prototype._computePlane=function(a,b,c,d){g.cross(a,b,d);d[3]=-g.dot(d,c)};return b}();return function(){function a(){this.frustumVisibilityDirty=this.frustumVisibility=!0;this.extent=null;this.extentEngine=new u;this.extentEngineDirty=!0;this.renderSREqualsViewSR=null;this._isVisibleBelowSurface=
!1;this.layerView=null}a.prototype.initialize=function(a){this.layerView=a;this.renderSREqualsViewSR=a.view.renderSpatialReference.equals(a.view.spatialReference)};a.prototype.destroy=function(){this.extentEngine=this.extent=this.layerView=null};a.prototype.needsIdleUpdate=function(){return this.frustumVisibilityDirty};a.prototype.canResume=function(){return this.frustumVisibility};a.prototype.setExtent=function(a){this.extent=a;this.frustumVisibilityDirty=this.extentEngineDirty=!0};a.prototype.viewChange=
function(){this.frustumVisibilityDirty=!0};a.prototype.elevationBoundsChange=function(){this.extentEngineDirty=this.frustumVisibilityDirty=!0};Object.defineProperty(a.prototype,"isVisibleBelowSurface",{set:function(a){this._isVisibleBelowSurface=a;this.extentEngineDirty=this.frustumVisibilityDirty=!0},enumerable:!0,configurable:!0});a.prototype.idleUpdate=function(a){!a.done()&&this.frustumVisibilityDirty&&(this.updateSuspendFrustumVisible(),this.frustumVisibilityDirty=!1)};a.prototype.updateExtentEngine=
function(){if(this.extentEngineDirty){this.extentEngineDirty=!1;var a=this.layerView.view,b=a.renderCoordsHelper.worldUpAtPosition,c;if(this._isVisibleBelowSurface)c=e;else{c=a.basemapTerrain.getElevationBounds();var d=c[0];c=d-Math.max(1,(c[1]-d)*(1.2-1))}this.extentEngine.update(this.extent,b,a.renderSpatialReference,a.spatialReference,this.renderSREqualsViewSR,c)}};a.prototype.updateSuspendFrustumVisible=function(){if(this.extent){this.updateExtentEngine();var a=this.layerView.view.getFrustum(),
a=this.extentEngine.isVisibleInFrustum(this.layerView.view,a,this._isVisibleBelowSurface);a!==this.frustumVisibility&&(this.frustumVisibility=a,this.layerView._notifySuspendedChange())}else this.frustumVisibility=!0};return a}()})},"esri/views/3d/layers/graphics/Graphics3DVerticalScale":function(){define(["require","exports","../../../../geometry/support/scaleUtils"],function(m,k,b){return function(){function a(a){this.sourceSpatialReference=a.sourceSpatialReference;this.destSpatialReference=a.destSpatialReference}
a.prototype.adjust=function(a){var b=this._getVerticalUnitScale();1!==b&&(a=a.slice(),this._scaleVerticalUnits(a,b));return a};a.prototype._getVerticalUnitScale=function(){if(this.sourceSpatialReference&&!this.sourceSpatialReference.equals(this.destSpatialReference)){var a=this._getVerticalUnitValueForSR(this.sourceSpatialReference),b=this._getVerticalUnitValueForSR(this.destSpatialReference);return a/b}return 1};a.prototype._getVerticalUnitValueForSR=function(a){a=b.getUnitValueForSR(a);return 1E5<
a?1:a};a.prototype._vertexListsScaleZ=function(a,b){for(var c=0;c<a.length;++c)for(var d=a[c],e=0;e<d.length;++e)d[e][2]*=b};a.prototype._scaleVerticalUnits=function(a,b){for(var c=0;c<a.length;++c){var d=a[c].geometry;if(d.hasZ)this._geometryIsPoint(d)?null!==d.z&&(d.z*=b):this._geometryIsPolyline(d)?this._vertexListsScaleZ(d.paths,b):this._geometryIsPolygon(d)&&this._vertexListsScaleZ(d.rings,b);else break}};a.prototype._geometryIsPoint=function(a){return"point"===a.type};a.prototype._geometryIsPolygon=
function(a){return"polygon"===a.type};a.prototype._geometryIsPolyline=function(a){return"polyline"===a.type};return a}()})},"esri/renderers/support/renderingInfoUtils":function(){define(["require","exports"],function(m,k){function b(a,b){if(!a||a.symbol)return null;b=b.renderer;return a&&b&&b.getObservationRenderer?b.getObservationRenderer(a):b}function a(a,h){if(a.symbol)return a.symbol;var c=b(a,h);return c&&c.getSymbol(a,h)}k.getRenderer=b;k.getSymbol=a;k.getRenderingInfo=function(c,h){var g=b(c,
h),d=a(c,h);if(!d)return null;d={renderer:g,symbol:d};if(g){g.colorInfo&&(d.color=g.getColor(c).toRgba());if(g.sizeInfo){var e=g.getSize(c);d.size=[e,e,e]}if(g.visualVariables){c=g.getVisualVariableValues(c,h);e=["proportional","proportional","proportional"];for(h=0;h<c.length;h++){var g=c[h],k=g.variable,f=k.type;"color"===f?d.color=g.value.toRgba():"size"===f?"outline"===k.target?d.outlineSize=g.value:(k=g.variable.axis,g=g.variable.useSymbolValue?"symbolValue":g.value,"width"===k?e[0]=g:"depth"===
k?e[1]=g:"height"===k?e[2]=g:e[0]="width-and-depth"===k?e[1]=g:e[1]=e[2]=g):"opacity"===f?d.opacity=g.value:"rotation"===f&&(d.rotationAngle=g.value)}if(isFinite(e[0])||isFinite(e[1])||isFinite(e[2]))d.size=e}}return d}})},"esri/views/3d/layers/support/projectExtentUtils":function(){define(["require","exports","../../../../portal/support/geometryServiceUtils","../../../../core/promiseUtils","../../../../tasks/support/ProjectParameters"],function(m,k,b,a,c){k.toView=function(h){var g=h.view.spatialReference,
d=h.layer.fullExtent&&h.layer.fullExtent.spatialReference;return!d||d.equals(g)||"local"!==h.view.viewingMode?a.resolve(null):b.create(h.layer.portalItem).then(function(a){var b=new c;b.geometries=[h.layer.fullExtent];b.outSR=g;return a.project(b)}).then(function(a){if(!h.destroyed&&a&&Array.isArray(a)&&1===a.length)return a[0]}).otherwise(function(){return null})}})},"esri/views/3d/layers/SceneLayerView3D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../layers/IntegratedMeshLayer ../../../core/arrayUtils ../../../core/watchUtils ../../../core/promiseUtils ../../../core/Logger ../../../core/lang dojo/_base/lang dojox/color/_base dojo/has ../../layers/LayerView ../../../Graphic ../../../symbols/Symbol3D ../../../geometry/Extent ./i3s/I3SUtil ./i3s/I3SBinaryReader ./i3s/I3SProjectionUtil ./i3s/I3SQueryEngine ./graphics/graphicUtils ./support/LayerViewUpdatingPercentage ../support/intersectionUtils ../support/projectionUtils ../support/aaBoundingBox ../webgl-engine/Stage ../webgl-engine/lib/Layer ../webgl-engine/lib/Geometry ../webgl-engine/lib/GeometryData ../webgl-engine/lib/Object3D ../webgl-engine/lib/Texture ../webgl-engine/materials/Material ../webgl-engine/lib/Util ../webgl-engine/lib/base64Binary ../lib/glMatrix".split(" "),
function(m,k,b,a,c,h,g,d,e,l,f,n,u,t,r,w,q,x,y,z,A,C,B,D,H,K,E,F,L,Q,N,J,P,I,O,ea,W){function fa(a,b,c,d){var e=!1,f;b.encoding===y.DDS_ENCODING_STRING?f=P.DDS_ENCODING:e=!(ga(a.width)&&ga(a.height));a=b.usedByEngineMats.some(function(a){return a.getParams().atlasRegions})||b.atlas;c=(c||!a)&&!e;return{mipmap:c,wrapClamp:a||!b.wrap,disableAnisotropy:a&&c&&d,encoding:f,noUnpackFlip:!0}}function X(a,b){b=b.toLowerCase();for(var c=0,d=Object.keys(a);c<d.length;c++){var e=d[c];if(e.toLowerCase()===b)return a[e]}return null}
var aa=l.getLogger("esri.layers.SceneService"),R=O.assert,ia=O.clamp,ga=O.isPowerOfTwo,ha=O.fallbackIfUndefined,la=O.objectEmpty,da=O.VertexAttrConstants,Y=[1,1,1,1],V=F.ModelContentType,ba=[.8,.8,.8],T=[.5,.5,.5];m=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b._queryEngine=null;b._controllerCreated=!1;b._definitionExpressionErrors=0;b._maxDefinitionExpressionErrors=20;b._featuresChangedEventScheduled=!1;b._featuresChangedEvent=null;return b}b(c,a);c.prototype.initialize=
function(){var a=this;y.checkSceneLayerValid(this.layer);y.checkSceneLayerCompatibleWithView(this.layer,this.view);var b=this.layer.version,b=!t("trident")||1<b.major||1===b.major&&3<b.minor;this.useCompressedTextures=this.view.has("s3tc")&&b;this._disableAtlasAnisotropy=(this._enableAtlasMipMaps=this.view.has("standardDerivatives"))&&!this.view.has("shaderTextureLOD");this._initGraphicsController();this.dbg=!1;this.maxGpuMemory=1E3;this.geoMemoryEstimate=this.texMemoryEstimate=this.gpuMemoryEstimate=
0;this._stage=this.view._stage;this._matId2Meta={};this._texId2Meta={};this._requestedTexImageIds={};this._nodeId2Meta={};this._colorOverride=null;for(var b=new Uint8Array(256),c=0;c<b.length;c++)b[c]=255;this._whiteTexture=new P(b,"white",{width:8,height:8});this._stage.add(F.ModelContentType.TEXTURE,this._whiteTexture);this._layerEventHandles=[d.init(this.layer,"renderer",function(b){return a._rendererChange(b)}),d.watch(this,"fullOpacity",function(b){return a._opacityChange(b)}),d.init(this.layer,
"objectIdFilter",function(){return a._filterChange()}),d.init(this,"_controller.parsedDefinitionExpression",function(){return a._filterChange()}),d.init(this.view,"clippingArea",function(){return a._clippingAreaChanged()})];this._addThisLayerToStage();this.setVisibility(!this.suspended);this.debugLODVis=this.debugNodeVis=!1};c.prototype.destroy=function(){this._stage.remove(F.ModelContentType.TEXTURE,this._whiteTexture.getId());this._removeThisLayerFromStage();this._layerEventHandles.forEach(function(a){a.remove()});
this._stage=null;null!=this._controller&&(this._controller.destroy(),this._controller=null);this._nodeId2Meta=this._texId2Meta=this._matId2Meta=null};c.prototype.canResume=function(){return this.inherited(arguments)&&(!this._controller||this._controller.rootNodeVisible)};c.prototype.isUpdating=function(){return this._controllerCreated?!(!this._controller||!this._controller.updating):!1};c.prototype.memEstimateTextureAdded=function(a){a=a.getEstimatedTexMemRequiredMB();this.gpuMemoryEstimate+=a;this.texMemoryEstimate+=
a};c.prototype.memEstimateTextureRemoved=function(a){a=a.getEstimatedTexMemRequiredMB();this.gpuMemoryEstimate-=a;this.texMemoryEstimate-=a};c.prototype.memEstimateGeometryAdded=function(a){a=a.estimateGpuMemoryUsage()/1E6;this.gpuMemoryEstimate+=a;this.geoMemoryEstimate+=a};c.prototype.memEstimateGeometryRemoved=function(a){a=a.estimateGpuMemoryUsage()/1E6;this.gpuMemoryEstimate-=a;this.geoMemoryEstimate-=a};c.prototype.isBundleAlreadyAddedToStage=function(a,b){return this._nodeId2Meta[a.id]&&this._nodeId2Meta[a.id].engineObjectsPerBundle&&
null!=this._nodeId2Meta[a.id].engineObjectsPerBundle[b]};c.prototype._initGraphicsController=function(){var a=this,b={addBundle:this._addBundle.bind(this),isBundleAlreadyAddedToStage:function(b,c){return a.isBundleAlreadyAddedToStage(b,c)},isOverMemory:function(){return a.isOverMemory()},removeNodeData:function(b){return a._removeNodeDataFromStage(b)},removeFeatures:function(b,c){return a._removeFeatures(b,c)},getAddedFeatures:function(b){return a._getAddedFeatures(b)},getAddedNodeIDs:function(){return a._getAddedNodeIDs()},
areAllBundlesLoaded:function(b){return a._areAllBundlesLoaded(b)},wholeNodeSwitchEnabled:!0};this.layer.createGraphicsController({layerView:this,layerViewRequiredFunctions:b,layerViewOptionalFunctions:{additionalStartNodeLoadingHandler:function(){return a._startNodeLoading()},additionalCancelNodeLoadingHandler:function(){return a.cancelNodeLoading()},getTexturePrefetchFunctions:function(){return{_calcDesiredTextureLOD:function(b,c){return a._calcDesiredTextureLOD(b,c)},_imageIsPartOfTextureBundle:function(b){return a._imageIsPartOfTextureBundle(b)},
_matId2Meta:a._matId2Meta,_texId2Meta:a._texId2Meta,useCompressedTextures:function(){return a.useCompressedTextures}}},_nodeDebugVisualizer:this._nodeDebugVisualizer,setPolygonOffset:function(b,c){return a._setPolygonOffset(b,c?1:0)},traversalOptions:{initDepthFirst:!0,neighborhood:!0,perLevelTraversal:!1,allowPartialOverlaps:!1},getLoadedAttributes:function(b){return a.getLoadedAttributes(b)},setAttributeData:function(b,c,d){return a.setAttributeData(b,c,d)}}}).then(function(b){b.watch("rootNodeVisible",
function(){a.notifyChange("suspended")})}).always(function(){a._controllerCreated=!0;a.notifyChange("updating")})};c.prototype.setMaxGpuMemory=function(a){this.maxGpuMemory=a};c.prototype.setVisibility=function(a){if(this._stage&&this._engineLayer){var b=this._engineLayer.getId(),c=0<=this._stage.getViewContent().indexOf(b);!!a!==c&&(b=[b],null!=this._nodeDebugVisualizer&&b.push(this._nodeDebugVisualizer.engineLayer.getId()),a?this._stage.addToViewContent(b):this._stage.removeFromViewContent(b))}};
c.prototype.getEngineLayer=function(){return this._engineLayer};c.prototype.getStats=function(){var a={nodesInIndex:0,knownFeatures:0,activeMaterials:0};if(!this._controller)return a;for(var b=0,c=Object.keys(this._controller.nodeIndex);b<c.length;b++){var d=c[b];a.nodesInIndex++;d=this._controller.nodeIndex[d];null!=d.features&&(a.knownFeatures+=d.features.length)}a.activeMaterials=Object.keys(this._matId2Meta).length;return a};c.prototype._addThisLayerToStage=function(){var a=this._stage;this._initTexture=
new P(null,"i3sInitTexture");a.add(V.TEXTURE,this._initTexture);var b=this.layer.id;this._engineLayer=b=new L(b,{},b);a.add(V.LAYER,b);null!=this._nodeDebugVisualizer&&this._nodeDebugVisualizer.dispose()};c.prototype._removeThisLayerFromStage=function(){this.cancelNodeLoading();if(null!=this._engineLayer){var a=this._stage;a.remove(V.TEXTURE,this._initTexture.getId());if(null!=this._controller)for(var b in this._controller.nodeIndex)this._controller.nodeIndex.hasOwnProperty(b)&&(this._removeNodeDataFromStage(this._controller.nodeIndex[b]),
delete this._controller.nodeIndex[b]);R(la(this._nodeId2Meta));R(la(this._matId2Meta));R(la(this._texId2Meta));a.remove(V.LAYER,this._engineLayer.getId());null!=this._nodeDebugVisualizer&&this._nodeDebugVisualizer.dispose();this._nodeDebugVisualizer=void 0;this._matId2Meta={};this._texId2Meta={};this._requestedTexImageIds={};this._nodeId2Meta={};this._engineLayer=void 0;this.gpuMemoryEstimate=0}};c.prototype._startNodeLoading=function(){this._updateAllTextureLOD()};c.prototype.cancelNodeLoading=function(){null!=
this._nodeDebugVisualizer&&this._nodeDebugVisualizer.clear();this._requestedTexImageIds={}};c.prototype._isAllHidden=function(a){a=this._nodeId2Meta[a.id].engineObjects;for(var b=0;b<a.length;b++)if(!a[b].isAllHidden())return!1;return!0};c.prototype.getLoadedAttributes=function(a){if((a=this._nodeId2Meta[a.id])&&1===a.engineObjects.length)return a.engineObjects[0].getMetadata().loadedAttributes};c.prototype.setAttributeData=function(a,b,c){var d=this._nodeId2Meta[a.id];if(d&&1===d.engineObjects.length){var d=
d.engineObjects[0],e=d.getMetadata();e.loadedAttributes=b;e.attributeData=c;this._setObjectSymbology(d);this._applyFilters(a)}};c.prototype._createUnitTestData=function(a){var b=this.view.navigation.targetCamera,b={viewParams:{eye:b.eye,center:b.center,up:b.up,viewMatrix:b.viewMatrix,projectionMatrix:b.projectionMatrix,fovX:b.fovX,viewport:b.viewport,perPixelRatio:b.perPixelRatio},visibleObjects:[]};a=a.getAll("objects");for(var c in a){var d=a[c];if(d.getParentLayer()===this._engineLayer){var e=
d.getMetadata(),d=e.i3sNode,e=e.features.map(function(a){return a.id});e.sort();b.visibleObjects.push({featureIDs:e,nodeId:d})}}console.debug(""+b.visibleObjects.length);return JSON.stringify(b)};c.prototype.isOverMemory=function(){return this.gpuMemoryEstimate>this.maxGpuMemory?(aa.warn("over memory: "+this.gpuMemoryEstimate+" tex "+this.texMemoryEstimate+" geom "+this.geoMemoryEstimate),!0):!1};c.prototype._getAddedFeatures=function(a){if(null==this._nodeId2Meta[a])return null;var b=[];a=this._nodeId2Meta[a].engineObjects;
for(var c=0;c<a.length;c++)b=b.concat(a[c].getMetadata().features);return b};c.prototype._getAddedNodeIDs=function(){return Object.keys(this._nodeId2Meta)};c.prototype._calcEngineMaterialTransparencyParams=function(a,b,c){var d=this.fullOpacity,e=1-ia(ha(b.transparency,0),0,1),d=d*e;a=1>d||a&&f.endsWith(a.channels,"a")||!0===b.useVertexColorAlpha||c;return{opacity:d,transparent:a}};c.prototype._calcEngineMaterialDoubleSidedParams=function(a){return null!=a.doubleSided?a.doubleSided:!0};c.prototype._calcEngineMaterialCullFaceParams=
function(a){return a.cullFace?a.cullFace:null!=a.doubleSided?a.doubleSided?"none":"back":"none"};c.prototype._createEngineMaterial=function(a,b,c,d,e,f){var g,k;null!=a&&(g=(k=this._texId2Meta[b])&&k.engineTex?k.engineTex.getId():this._initTexture.getId());var l=c.params,m=ha(l.diffuse,ba),p,q;null!=a&&(q=y.getAppropriateTextureEncoding(a.encoding,this.useCompressedTextures),p=-1<q?a.encoding[q]:a.encoding);"standard"!==c.type&&aa.warn("Unknown material type '"+c.type+"', must be 'standard'");void 0===
l.reflectivity&&aa.warn("Material parameter 'reflectivity' is missing.");c=this.layer instanceof h;g={ambient:this._colorOverride||m,diffuse:this._colorOverride||m,specular:ha(l.specular,T),shininess:ha(l.shininess,64),atlasRegions:l.vertexRegions,textureId:g&&this._colorOverride?this._whiteTexture.getId():g,vertexColors:!0,flipV:!1,doubleSided:this._calcEngineMaterialDoubleSidedParams(l),cullFace:this._calcEngineMaterialCullFaceParams(l),writeStencil:c,receiveSSAO:!c};c||(m=this._calcEngineMaterialTransparencyParams(a,
l),n.mixin(g,m));g=new I(g,d);g.metadata={i3sMatId:d,i3sTexId:b,i3sTex:a,i3sMatParams:l};if(null!=a){k?k.usedByEngineMats.push(g):(k={id:b,featureMBS:[],usedByEngineMats:[g],images:a.images,encoding:p,encodingIdx:q,atlas:!0===a.atlas,wrap:"none"!==a.wrap[0]||"none"!==a.wrap[1]},this._texId2Meta[b]=k);for(a=0;a<e.length;a++)k.featureMBS.push(e[a].engineMBS);if(void 0!==f[b]){null==k.engineTex&&(e=f[b].data,a=fa(e,k,this._enableAtlasMipMaps,this._disableAtlasAnisotropy),k.engineTex=new P(e,k.id,a),
this._stage.add(V.TEXTURE,k.engineTex),k.desiredLOD=f[b].desiredLOD,k.curLOD=k.desiredLOD,this.memEstimateTextureAdded(k.engineTex));e=k.engineTex.getId();for(a=0;a<k.usedByEngineMats.length;a++)l=k.usedByEngineMats[a],null==this._colorOverride&&l.setParameterValues({textureId:e}),l.metadata.originalTextureId=e;f[b].createdTextureForDomImage();delete f[b]}else this._updateTextureLOD(k)}this._matId2Meta[d]||(this._matId2Meta[d]={});this._matId2Meta[d][b]={engineMat:g,refCount:1};return g};c.prototype._createVertexArrays=
function(a,b){var c;a=a.params.vertexAttributes;var d={},e;for(e in a)if(a.hasOwnProperty(e)&&"classification"!==e){var f=a[e];c=z.valueType2TypedArrayClassMap[f.valueType];R(null!=c,"unsupported vertex attribute value type: "+f.valueType);d[e]={data:new c(b,f.byteOffset,f.count*f.valuesPerElement),size:f.valuesPerElement}}if(null==d[da.COLOR])for(c=z.valueType2TypedArrayClassMap.UInt8,d[da.COLOR]={data:new c(4*a.position.count),size:4},b=0;b<d[da.COLOR].data.length;b++)d[da.COLOR].data[b]=0===b%
3?255:0;null==d[da.NORMAL]&&(c=z.valueType2TypedArrayClassMap.Float32,d[da.NORMAL]={data:new c(3*a.position.count),size:3});return d};c.prototype._createEngineMats=function(a,b,c,d,e){for(var f=a.params.components.length,g=Array(f),h=0;h<f;h++){var k=a.params.components[h],l=k.materialID,m=c.materialDefinitions[l];null!=m.href&&(m=d[m.hrefConcat].materialDefinitions[l]);R(void 0!==m,"geometry wants unknown material "+l);var n=k.textureID||"none",p=void 0;"none"!==n&&(null!=c.textureDefinitions&&null!=
c.textureDefinitions[n]||aa.warn("textureDefinitions missing in shared resource"),p=c.textureDefinitions[n]);k=void 0;this._matId2Meta[l]&&this._matId2Meta[l][n]?(l=this._matId2Meta[l][n],k=l.engineMat,l.refCount++):k=this._createEngineMaterial(p,n,m,l,b,e);g[h]=k}return g};c.prototype._areAllBundlesLoaded=function(a){if(null==this._nodeId2Meta[a.id]||null==this._nodeId2Meta[a.id].engineObjectsPerBundle)return!1;for(var b=0;b<a.featureData.length;b++)if(null==this._nodeId2Meta[a.id].engineObjectsPerBundle[b])return!1;
return!0};c.prototype._getObjectIdField=function(){return this.layer.objectIdField||"OBJECTID"};c.prototype._findGraphicNodeAndIndex=function(a){a=X(a.attributes,this._getObjectIdField());for(var b=0,c=Object.keys(this._nodeId2Meta);b<c.length;b++)for(var d=c[b],e=this._nodeId2Meta[d].engineObjects,f=0;f<e.length;f++){var g=e[f].getMetadata().featureIds.indexOf(a);if(-1!==g)return{node:this._controller.nodeIndex[d],nodeId:d,bundleNr:f,index:g}}return null};c.prototype._getGraphicIndices=function(a,
b,c){a=this._nodeId2Meta[a.id].engineObjects;if(!a||!a[b])return[];b=a[b].getMetadata();a=[];for(var d=this._getObjectIdField(),e=0;e<c.length;e++){var f=X(c[e].attributes,d),f=b.featureIds.indexOf(f);-1!==f&&a.push(f)}return a};c.prototype.whenGraphicBounds=function(a){var b=this._findGraphicNodeAndIndex(a);if(null!=b){a=this._nodeId2Meta[b.nodeId].engineObjects[b.bundleNr];var c=a.getMetadata().faceRanges[b.index],b=new Float64Array(24);this._boundingBoxCornerPoints(c,a,b);if(K.bufferToBuffer(b,
this.view.renderSpatialReference,0,b,this.view.spatialReference,0,8))return a=E.create(E.NEGATIVE_INFINITY),E.expandBuffer(a,b,0,8),e.resolve(a)}return e.reject()};c.prototype.whenGraphicAttributes=function(a,b){var c=this;return y.whenGraphicAttributes(this.layer,[a],this._getObjectIdField(),b,function(){var b=c._findGraphicNodeAndIndex(a);return{node:b.node,indices:[b.index]}}).then(function(a){return a[0]})};c.prototype.getGraphicsFromStageObject=function(a,b){if(this.layer instanceof h)return e.reject();
var c=a.getMetadata();a=a.getFaceRangeIndexFromTriangleNr(b);return null!=a&&null!=c.featureIds&&a<c.featureIds.length?(c=this._createGraphic(a,c),e.resolve(c)):e.reject()};c.prototype._addBundle=function(a,b,c,d,e,f,g){if(!0===this.debugNodeVis&&null!=this._nodeDebugVisualizer){var h="grey";switch(a.level){case 1:h="red";break;case 2:h="green";break;case 3:h="blue";break;case 4:h="yellow";break;case 5:h="magenta";break;case 6:h="brown"}this._nodeDebugVisualizer.show(a,this._controller.crsIndex,h)}var h=
this._stage,k={};k[V.OBJECT]={};k[V.GEOMETRY]={};k[V.MATERIAL]={};k[V.TEXTURE]={};var l=this._engineLayer,m=l.getId(),n=d[a.sharedResource.hrefConcat];if(null!=this._nodeId2Meta[a.id]&&null!=this._nodeId2Meta[a.id].engineObjectsPerBundle&&this._nodeId2Meta[a.id].engineObjectsPerBundle[g])this._applyFilters(a),null!=e&&e.done();else if(!this.isOverMemory())if(null==this._nodeId2Meta[a.id]&&(this._nodeId2Meta[a.id]={engineObjects:[],engineObjectsPerBundle:[]}),this._nodeId2Meta[a.id].engineObjectsPerBundle[g]=
[],null==b)null!=e&&e.done();else{for(var p=0,q=0;q<b.length;q++){var t=b[q],r=t.faceRanges,u=t.componentOffsets,w=t.geometries,x=t.featureIds,z=t.features,G=d[a.geometryData[g].hrefConcat];R(G instanceof ArrayBuffer,"I3S: geometry data is not an ArrayBuffer");null==G._isReprojected&&(G._isReprojected={});for(var B=a.id+"|"+z[0].id.toString(),C=[],D=[],E=[],S=void 0,t=function(b){var c=w[b],e=F._createVertexArrays(c,G),g=new N(e,N.DefaultIndices,u||N.DefaultOffsets),h=F._createEngineMats(c,z,n,d,
f),l=F._controller.crsIndex,m=F.view.renderSpatialReference;S=A.reprojectPoints(F._controller.isMeshPyramid?A.ReprojectionTypes.PER_VERTEX:A.ReprojectionTypes.BOUNDINGBOX,e.position.data,a.mbs,G._isReprojected[c.id],l,F._controller.crsVertex,m);G._isReprojected[c.id]=!0;F._controller.isMeshPyramid&&y.processNormals({normals:g.vertexAttributes.normal.data,positions:g.vertexAttributes.position.data,normalInd:g.indices.normal,positionInd:g.indices.position},F.layer.normalReferenceFrame||"none",function(b,
c){A.reprojectNormalsPerVertex(b,a.mbs,l,c,m)});e=S.localTrafo;null!=c.transformation&&(e=W.mat4d.create(c.transformation),W.mat4d.multiply(S.localTrafo,e,e));for(c=0;c<h.length;c++){var p=h[c];k[V.MATERIAL][p.getId()]=p}g=new Q(g,B+"_"+b);F.memEstimateGeometryAdded(g.getData());k[V.GEOMETRY][g.getId()]=g;C[b]=g;D[b]=e;E[b]=h},F=this,ca=0;ca<w.length;++ca)t(ca);r={i3sNode:a.id,ceLayer:m,features:z,faceRanges:r,featureIds:x,attributeData:c?c.attributeData:null,loadedAttributes:c?c.loadedAttributes:
null,layerId:this.layer.id};p+=null!=r.featureIds?r.featureIds.length:1;r=new J({idHint:a.id,name:B,geometries:C,materials:E,transformations:D,castShadow:!0,metadata:r});x=W.mat4d.create();W.mat4d.identity(x);W.mat4d.multiply(x,S.globalTrafo,x);r.setObjectTransformation(x);this._nodeId2Meta[a.id].engineObjectsPerBundle[g].push(r);this._nodeId2Meta[a.id].engineObjects.push(r);k[V.OBJECT][r.getId()]=r;this._setObjectSymbology(r);this._applyFilters(a)}h.beginMod();b=k[V.OBJECT];for(var H in b)b.hasOwnProperty(H)&&
l.addObject(b[H]);for(var ja in k)if(k.hasOwnProperty(ja)){H=k[ja];for(var I in H)H.hasOwnProperty(I)&&null==h.get(ja,I)&&h.add(ja,H[I])}h.endMod();null!=e&&e.done();this._notifyFeaturesChanged(p,0)}};c.prototype._clippingAreaChanged=function(){var a=this,b=[];K.extentToBoundingBox(this.view.clippingArea,b,this.view.renderSpatialReference)?this._clippingArea=b:this._clippingArea=null;this._updateFilters();if(this._controller){var c=this._controller.nodeIndex;c&&Object.keys(this._nodeId2Meta).forEach(function(b){return a._applyFilters(c[b])});
this._controller.updateClippingArea(this.view.clippingArea)}};c.prototype._filterChange=function(){this._updateFilters();if(this._controller){var a=this._controller.nodeIndex;if(a)for(var b=0,c=Object.keys(this._nodeId2Meta);b<c.length;b++)this._applyFilters(a[c[b]])}};c.prototype._updateFilters=function(){var a=this,b=[];if(this.layer.objectIdFilter){var c=new Float64Array(this.layer.objectIdFilter.ids),d="include"===this.layer.objectIdFilter.method;c.sort();b.push(function(b,e){return a._objectIdFilter(c,
d,e)})}if(this._controller&&this._controller.parsedDefinitionExpression&&this._controller.definitionExpressionFields){this._definitionExpressionErrors=0;var e=this._controller.parsedDefinitionExpression,f=this._controller.definitionExpressionFields;b.push(function(b,c){return a._sqlFilter(b,e,f,c)})}this._clippingArea&&b.push(function(b,c){return a._boundingboxFilter(b,a._clippingArea,c)});this._filters=b};c.prototype._sqlFilter=function(a,b,c,d){var e={},f=new w(null,null,e);f.layer=this.layer;var g=
0,h=0,k=function(a){var k=a.getMetadata();a=k.featureIds;for(var m=k.attributeData,k=c.every(function(a){return null!=m[a]}),n=0;n<a.length&&g<d.length;n++)if(d[g]===a[n]){var p=!0;if(k){for(var p=0,q=c;p<q.length;p++){var r=q[p];e[r]=y.getCachedAttributeValue(m[r],n)}p=l._evaluateClause(b,f)}p&&(d[h]=d[g],h++);g++}},l=this,m=0;for(a=this._nodeId2Meta[a.id].engineObjects;m<a.length;m++)k(a[m]);d.length=h};c.prototype._evaluateClause=function(a,b){try{return!!a.calculateValue(b)}catch(S){return this._definitionExpressionErrors<
this._maxDefinitionExpressionErrors&&aa.error("Error while evaluating definitionExpression: "+S),this._definitionExpressionErrors++,this._definitionExpressionErrors===this._maxDefinitionExpressionErrors&&aa.error("Further errors are ignored"),!1}};c.prototype._objectIdFilter=function(a,b,c){for(var d=0,e=0;d<c.length;)0<=g.binaryIndexOf(a,c[d])===b&&(c[e]=c[d],e++),d++;c.length=e};c.prototype._boundingboxFilter=function(a,b,c){var d=[0,0,0,0];K.mbsToMbs(a.mbs,this._controller.crsIndex,d,this.view.renderSpatialReference);
d=null!=b?y.intersectBoundingBoxWithMbs(b,d):2;if(2!==d){var e=0,f=0;for(a=this._nodeId2Meta[a.id].engineObjects;f<a.length;f++){var g=a[f],h=g.getMetadata().featureIds;if(0===d){for(var k=0,g=0;g<h.length&&e+k<c.length;g+=1)c[e+k]===h[g]&&k++;c.splice(e,k)}else{var l=g.getObjectTransformation(),k=g.getGeometryRecords()[0].getShaderTransformation();W.mat4d.multiply(l,k);if(0===l[1]&&0===l[2]&&0===l[3]&&0===l[4]&&0===l[6]&&0===l[7]&&0===l[8]&&0===l[9]&&0===l[11]&&1===l[15])for(var k=(b[0]-l[12])/l[0],
m=(b[1]-l[13])/l[5],n=(b[2]-l[14])/l[10],q=(b[3]-l[12])/l[0],r=(b[4]-l[13])/l[5],l=(b[5]-l[14])/l[10],t=g.getGeometryRecords()[0].geometry.getData(),u=t.getFaces()[0].indices.position,t=t.getVertexAttr().position.data,w=g.getMetadata().faceRanges,x=void 0,z=void 0,A=void 0,G=void 0,B=void 0,C=void 0,g=0;g<w.length&&e<c.length;g+=1)if(c[e]===h[g]){for(var x=w[g],D=x[0],E=x[1],x=z=A=Number.MAX_VALUE,G=B=C=-Number.MAX_VALUE;D<=E;D+=1)for(var F=0;3>F;F+=1)var S=3*u[3*D+F],H=t[S],I=t[S+1],S=t[S+2],x=Math.min(H,
x),z=Math.min(I,z),A=Math.min(S,A),G=Math.max(H,G),B=Math.max(I,B),C=Math.max(S,C);x>q||G<k||z>r||B<m||A>l||C<n?c.splice(e,1):e++}}}}};c.prototype._applyFilters=function(a){if(this._nodeId2Meta[a.id]&&null!=this._nodeId2Meta[a.id].engineObjects){for(var b=this._nodeId2Meta[a.id].engineObjects,c=0;c<b.length;c++){var d=b[c];d.unhideAllComponents()}if(0!==this._filters.length){for(var c=[],e=0;e<b.length;e++)d=b[e],c=c.concat(d.getMetadata().featureIds);d=c.length;for(e=0;e<this._filters.length;e++)this._filters[e](a,
c);if(c.length!==d)for(e=a=0;e<b.length;e++)for(var d=b[e],f=d.getGeometryRecords()[0],g=d.getMetadata().featureIds,h=0;h<g.length;h+=1){var k=g[h];a>=c.length||c[a]!==k?d.setComponentVisibility(f,h,!1):a++}}}};c.prototype._hideFeatures=function(a,b){var c=0;for(a=this._nodeId2Meta[a.id].engineObjects;c<a.length;c++)for(var d=a[c],e=d.getGeometryRecords()[0],f=d.getMetadata().features,g=d.hasComponents(),h=0,k=b;h<k.length;h++)for(var l=k[h],m=0;m<f.length;m++)l===f[m].id&&(g?d.setComponentVisibility(e,
m,!1):d.hideAllComponents())};c.prototype._removeFeatures=function(a,b){null!=this._nodeId2Meta[a.id]&&(this._hideFeatures(a,b),!0===this._isAllHidden(a)&&this._removeNodeDataFromStage(a))};c.prototype._removeNodeDataFromStage=function(a){if(null!=this._nodeId2Meta[a.id]&&null!=this._nodeId2Meta[a.id].engineObjects){for(var b=this._stage,c=this._engineLayer,d=0,e=this._nodeId2Meta[a.id].engineObjects,f=0;f<e.length;++f){var g=e[f],h=g.getMetadata(),d=d+(null!=h.featureIds?h.featureIds.length:1);c.removeObject(g);
for(var h=g.getGeometryRecords(),k=0;k<h.length;k++){var l=h[k];this.memEstimateGeometryRemoved(l.geometry.getData());b.remove(V.GEOMETRY,l.geometry.getId());for(var m=0;m<l.materials.length;m++){var n=l.materials[m],q=n.getId(),r=n.metadata.i3sMatId,t=n.metadata.i3sTexId||"none",u=this._matId2Meta[r][t];R(0<u.refCount);u.refCount--;0===u.refCount&&this._removeMaterial(q,t,r,n,b)}}b.remove(V.OBJECT,g.getId())}delete this._nodeId2Meta[a.id];this._notifyFeaturesChanged(0,d)}};c.prototype._emitFeaturesChangedEvent=
function(){this.emit("features-changed",this._featuresChangedEvent);this._featuresChangedEvent=null;this._featuresChangedEventScheduled=!1};c.prototype._cancelFeaturesChangedEvent=function(){this._featuresChangedEventScheduled=!1};c.prototype._notifyFeaturesChanged=function(a,b){var c=this;null==this._featuresChangedEvent&&(this._featuresChangedEvent={addedCount:0,removedCount:0});this._featuresChangedEvent.addedCount+=a;this._featuresChangedEvent.removedCount+=b;this._featuresChangedEventScheduled||
null==this._controller||(this._featuresChangedEventScheduled=!0,this._controller.queueAnimationFrameFunctionCall(function(){return c._emitFeaturesChangedEvent()},null,null,function(){return c._cancelFeaturesChangedEvent()},null))};c.prototype._removeMaterial=function(a,b,c,d,e){e.remove(V.MATERIAL,a);if("none"!==b){a=this._texId2Meta[b];var f=a.usedByEngineMats;d=f.indexOf(d);R(-1<d);f[d]=f[f.length-1];f.pop();1>f.length&&((d=a.engineTex)&&d!==this._initTexture&&(this.memEstimateTextureRemoved(d),
e.remove(V.TEXTURE,a.engineTex.getId())),a.engineTex=void 0,a.desiredLOD=-1,a.curLOD=-1,delete this._texId2Meta[b])}delete this._matId2Meta[c][b];la(this._matId2Meta[c])&&delete this._matId2Meta[c]};c.prototype._updateAllTextureLOD=function(){for(var a in this._texId2Meta)this._texId2Meta.hasOwnProperty(a)&&this._updateTextureLOD(this._texId2Meta[a])};c.prototype._calcDesiredTextureLOD=function(a,b){for(var c=0,d=0;d<a.length;d++){var e=a[d],f=W.vec3.dist(e,this._controller.camPos),e=2*e[3]/f*this._controller.screenSizeFactor;
e>c&&(c=e)}c/=9;for(a=b.length-1;0<a&&b[a].size<c;)a--;return a};c.prototype._updateTextureLOD=function(a){var b=this;a.desiredLOD=this._calcDesiredTextureLOD(a.featureMBS,a.images);if(a.curLOD!==a.desiredLOD&&(0>a.curLOD||!a.curLOD||0===a.desiredLOD||a.desiredLOD>a.curLOD||a.desiredLOD<a.curLOD-1)){if(0===a.images.length)return;var c=a.images[a.desiredLOD],d=-1<a.encodingIdx?c.hrefConcat[a.encodingIdx]:c.hrefConcat;if(!this._requestedTexImageIds[c.id]){var e={metadata:{texMeta:a,image:c}};this._requestedTexImageIds[c.id]=
!0;this._imageIsPartOfTextureBundle(c)?this._controller.streamDataSupplier.request(d,"binary",e).then(this._extractTextureImageFromBlob.bind(this)):this._controller.streamDataSupplier.request(d,"image",e).then(function(a,c,d,e){b._textureImageLoaded(a,c,e.image,e.texMeta)})}}a.engineTex||(a.engineTex=this._initTexture,a.curLOD=-1);if(this.debugLODVis)for(c=u.fromHsv(a.desiredLOD/a.images.length*270,100,100).toRgb().map(function(a){return a/255}),d=0;d<a.usedByEngineMats.length;d++)a.usedByEngineMats[d].setParameterValues({ambient:c,
diffuse:c})};c.prototype._extractTextureImageFromBlob=function(a,b,c,d){var e=d.texMeta;if(0>e.desiredLOD||d.image.size>e.images[e.desiredLOD].size)delete this._requestedTexImageIds[d.image.id];else{var f=this;R("binary"===c);var g="";try{var h=c=0;-1<e.encodingIdx?(c=d.image.byteOffset[e.encodingIdx],h=d.image.length[e.encodingIdx]):(c=d.image.byteOffset,h=d.image.length);var k=new Uint8Array(b,c,h),l=new Blob([k],{type:e.encoding}),g=window.URL.createObjectURL(l)}catch(sa){g="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAIElEQVQ4T2P8zyD6n4ECwDhqAMNoGDCMhgEwDw2DdAAAdzkhQdS8dl8AAAAASUVORK5CYII\x3d",
aa.error("error loading texture "+a+" "+sa)}var m=new Image;m.onerror=function(){window.URL.revokeObjectURL(g);m.src="";m.onerror=void 0;m.onload=void 0};m.onload=function(){f._controller.queueAnimationFrameFunctionCall(f._textureImageLoaded,f,[a,m,d.image,d.texMeta,g],void 0,1);window.URL.revokeObjectURL(g);m.src="";m.onerror=void 0;m.onload=void 0};m.src=g}};c.prototype._textureImageLoaded=function(a,b,c,d){delete this._requestedTexImageIds[c.id];if(!(0>d.desiredLOD)){a=d.images[d.desiredLOD];var e=
d.images[d.curLOD];if(!this.isOverMemory()||!(null==e||c.size>e.size))if(!e||c.size>e.size&&c.size<=a.size||c.size<e.size&&c.size>=a.size){(e=d.engineTex)&&e!==this._initTexture&&(this.memEstimateTextureRemoved(e),this._stage.remove(V.TEXTURE,d.engineTex.getId()));e=fa(b,d,this._enableAtlasMipMaps,this._disableAtlasAnisotropy);d.engineTex=new P(b,d.id,e);this._stage.add(V.TEXTURE,d.engineTex);d.curLOD=d.desiredLOD;this.memEstimateTextureAdded(d.engineTex);b=d.engineTex.getId();for(e=0;e<d.usedByEngineMats.length;e++){var f=
d.usedByEngineMats[e];null==this._colorOverride&&f.setParameterValues({textureId:b});f.metadata.originalTextureId=b}c!==a&&(d.curLOD=d.images.indexOf(c),R(-1<d.curLOD),this._requestedTexImageIds[a.id]||(c={metadata:{texMeta:d,image:a}},this._requestedTexImageIds[a.id]=!0,this._controller.streamDataSupplier.request(a.hrefConcat,"binary",c).then(this._extractTextureImageFromBlob.bind(this))))}}};c.prototype._imageIsPartOfTextureBundle=function(a){return!this._controller.isMeshPyramid};c.prototype._setPolygonOffset=
function(a,b){if(null!=this._nodeId2Meta[a.id]&&null!=this._nodeId2Meta[a.id].engineObjectsPerBundle){b={polygonOffset:b};for(var c=0;c<this._nodeId2Meta[a.id].engineObjectsPerBundle.length;c++)for(var d=this._nodeId2Meta[a.id].engineObjectsPerBundle[c],e=0;e<d.length;e++)for(var f=d[e].getGeometryRecords(),g=0;g<f.length;g++)for(var h=f[g].materials,k=0;k<h.length;k++)h[k].setParameterValues(b)}};c.prototype._rendererChange=function(a){(this._currentRenderer=a)&&(a.colorInfo||a.sizeInfo)&&aa.warn("renderer.colorInfo and renderer.sizeInfo are not supported for Scene Services. Use visualVariables instead.")};
c.prototype._getRenderingInfo=function(a){var b=this._currentRenderer,c=b&&b.getSymbol(a);if(!(c&&c instanceof q))return null;var c={symbol:c},d,e;if(b&&b.visualVariables)for(a=b.getVisualVariableValues(a),b=0;b<a.length;b++){var f=a[b],g=f.variable.type;"color"===g?d=f.value:"opacity"===g&&(e=f.value)}d&&(c.color=[d.r/255,d.g/255,d.b/255]);null!=e?c.opacity=e:d&&null!=d.a&&(c.opacity=d.a);return c};c.prototype._getSymbolFillColor=function(a){a=a.symbolLayers;for(var b=0;b<a.length;b++){var c=a.getItemAt(b);
if("Fill"===c.type&&c.material&&c.material.color)return a=c.material.color,[a.r/255,a.g/255,a.b/255,a.a]}};c.prototype._setObjectSymbology=function(a){if(!(this.layer instanceof h)){for(var b=a.getMetadata(),c=[],d=!1,e=b.faceRanges?b.faceRanges.length:1,f={attributes:{}},g=this.layer.objectIdField,k=this._currentRenderer&&this._currentRenderer.requiredFields,l=0;l<e;l++){null!=g&&null!=b.featureIds&&(f.attributes[g]=b.featureIds[l]);if(null!=k&&null!=b.attributeData)for(var m=0,n=k;m<n.length;m++){var q=
n[m];b.attributeData[q]&&(f.attributes[q]=y.getCachedAttributeValue(b.attributeData[q],l))}var r=this._getRenderingInfo(f),m=null!=b.faceRanges?b.faceRanges[l]:null;r?(n=r.color,q=r.opacity,null==n||null==q?(r=this._getSymbolFillColor(r.symbol),n=B.overrideColor(n,q,r,r&&r[3],Y)):n=B.overrideColor(n,q,null,null,Y),1>n[3]&&(d=!0),c.push({faceRanges:m,color:n})):c.push({faceRanges:m,color:void 0})}this.layer.cachedDrawingInfo.color?a.setFacerangeColors(c,"replace"):a.setFacerangeColors(c,"blend");a=
a.getGeometryRecords();for(b=0;b<a.length;b++)for(c=a[b],e=0;e<c.materials.length;e++)f=c.materials[e],g=f.getParams().transparent,k=f.getParams().opacity,f.metadata.symbolIsTransparent=d,l=this._calcEngineMaterialTransparencyParams(f.metadata.i3sTex,f.metadata.i3sMatParams,f.metadata.symbolIsTransparent),g===l.transparent&&k===l.opacity||f.setParameterValues({transparent:l.transparent,opacity:l.opacity})}};c.prototype._opacityChange=function(a){for(var b in this._matId2Meta)for(var c in this._matId2Meta[b]){a=
this._matId2Meta[b][c].engineMat;var d=a.getParams().transparent,e=a.getParams().opacity,f=this._calcEngineMaterialTransparencyParams(a.metadata.i3sTex,a.metadata.i3sMatParams,a.metadata.symbolIsTransparent);d===f.transparent&&e===f.opacity||a.setParameterValues({transparent:f.transparent,opacity:f.opacity})}};c.prototype.queryExtent=function(a){return this._ensureQueryEngine().queryExtent(a)};c.prototype.queryFeatureCount=function(a){return this._ensureQueryEngine().queryFeatureCount(a)};c.prototype.queryFeatures=
function(a){return this._ensureQueryEngine().queryFeatures(a)};c.prototype.queryObjectIds=function(a){return this._ensureQueryEngine().queryObjectIds(a)};c.prototype._ensureQueryEngine=function(){this._queryEngine||(this._queryEngine=this._createQueryEngine());return this._queryEngine};c.prototype._createQueryEngine=function(){var a=this,b={id:0,index:0,object:null,bbCorners:new Float64Array(24)};return new C({forAll:function(c,d){a._forAllFeatures(function(d,e,f){b.id=d;b.index=e;b.object=f;d=b.object.getMetadata().faceRanges[b.index];
a._boundingBoxCornerPoints(d,b.object,b.bbCorners);c(b)},d)},createGraphic:function(b){return a._createGraphic(b.index,b.object.getMetadata())},requestFields:function(b,c,d){return y.whenGraphicAttributes(a.layer,c,a._getObjectIdField(),d,function(){var d=a._getGraphicIndices(b.node,b.bundleNr,c);return{node:b.node,indices:d}})},createExtentBuilder:function(){return a._createExtentBuilder()},createVisibilityFilter:function(){return a._createVisibilityFilter()}},{enableObjectId:!0,enableOutFields:!!this.layer.objectIdField,
addVisibilityFilter:!0})};c.prototype._createExtentBuilder=function(){var a=this.view.renderSpatialReference,b=this.view.spatialReference,c=E.create(E.NEGATIVE_INFINITY),d=new Float64Array(24);return{add:function(e){K.bufferToBuffer(e.bbCorners,a,0,d,b,0,8)&&E.expandBuffer(c,d,0,8)},getExtent:function(){return new x({xmin:c[0],ymin:c[1],zmin:c[2],xmax:c[3],ymax:c[4],zmax:c[5],spatialReference:b})}}};c.prototype._createVisibilityFilter=function(){var a=this.view._stage.getCamera().frustumPlanes,b=
0;return function(c){c=H.conservativeFrustumConvexBuffer(a,c.bbCorners,0,8,b);return 0<=c?(b=c,!1):!0}};c.prototype._forAllFeatures=function(a,b){for(var c=0,d=Object.keys(this._nodeId2Meta);c<d.length;c++)for(var e=d[c],f=this._nodeId2Meta[e].engineObjects,g=0;g<f.length;g++){for(var h=f[g],k=h.getMetadata().featureIds,l=h.getGeometryRecords()[0],m=0;m<k.length;m++)h.getComponentVisibility(l,m)&&a(k[m],m,h);b&&b({node:this._controller.nodeIndex[e],bundleNr:g})}};c.prototype._createGraphic=function(a,
b){var c={};c[this._getObjectIdField()]=b.featureIds[a];for(var d=0,e=Object.keys(b.attributeData);d<e.length;d++){var f=e[d];c[f]=y.getCachedAttributeValue(b.attributeData[f],a)}a=new w(null,null,c);a.layer=this.layer;return a};c.prototype._boundingBoxCornerPoints=function(a,b,c){a=b.geometries[0].calculateAABB(0,a);for(var d=0;8>d;++d){var e=[d&1?a[0]:a[3],d&2?a[1]:a[4],d&4?a[2]:a[5]];W.mat4d.multiplyVec3(b.objectTransformation,e);c[3*d]=e[0];c[3*d+1]=e[1];c[3*d+2]=e[2]}return c};return c}(c.declared(r,
D));a([c.property()],m.prototype,"layer",void 0);a([c.property()],m.prototype,"view",void 0);a([c.property()],m.prototype,"_controller",void 0);a([c.property({dependsOn:["_controller.updating"]})],m.prototype,"updating",void 0);a([c.property({readOnly:!0,aliasOf:"_controller.updatingPercentage"})],m.prototype,"updatingPercentageValue",void 0);return m=a([c.subclass("esri.views.3d.layers.SceneLayerView3D")],m)})},"dojox/color/_base":function(){define(["../main","dojo/_base/lang","dojo/_base/Color",
"dojo/colors"],function(m,k,b,a){m=k.getObject("color",!0,m);m.Color=b;m.blend=b.blendColors;m.fromRgb=b.fromRgb;m.fromHex=b.fromHex;m.fromArray=b.fromArray;m.fromString=b.fromString;m.greyscale=a.makeGrey;k.mixin(m,{fromCmy:function(a,h,g){k.isArray(a)?(h=a[1],g=a[2],a=a[0]):k.isObject(a)&&(h=a.m,g=a.y,a=a.c);return new b({r:Math.round(255*(1-a/100)),g:Math.round(255*(1-h/100)),b:Math.round(255*(1-g/100))})},fromCmyk:function(a,h,g,d){k.isArray(a)?(h=a[1],g=a[2],d=a[3],a=a[0]):k.isObject(a)&&(h=
a.m,g=a.y,d=a.b,a=a.c);d/=100;return new b({r:Math.round(255*(1-Math.min(1,a/100*(1-d)+d))),g:Math.round(255*(1-Math.min(1,h/100*(1-d)+d))),b:Math.round(255*(1-Math.min(1,g/100*(1-d)+d)))})},fromHsl:function(a,h,g){k.isArray(a)?(h=a[1],g=a[2],a=a[0]):k.isObject(a)&&(h=a.s,g=a.l,a=a.h);h/=100;for(g/=100;0>a;)a+=360;for(;360<=a;)a-=360;var c,e;120>a?(c=(120-a)/60,e=a/60,a=0):240>a?(c=0,e=(240-a)/60,a=(a-120)/60):(c=(a-240)/60,e=0,a=(360-a)/60);c=2*h*Math.min(c,1)+(1-h);e=2*h*Math.min(e,1)+(1-h);a=2*
h*Math.min(a,1)+(1-h);.5>g?(c*=g,e*=g,a*=g):(c=(1-g)*c+2*g-1,e=(1-g)*e+2*g-1,a=(1-g)*a+2*g-1);return new b({r:Math.round(255*c),g:Math.round(255*e),b:Math.round(255*a)})}});m.fromHsv=function(a,h,g){k.isArray(a)?(h=a[1],g=a[2],a=a[0]):k.isObject(a)&&(h=a.s,g=a.v,a=a.h);360==a&&(a=0);h/=100;g/=100;var c,e,l;if(0==h)e=l=c=g;else{var f=a/60;a=Math.floor(f);var m=f-a,f=g*(1-h),u=g*(1-h*m);h=g*(1-h*(1-m));switch(a){case 0:c=g;e=h;l=f;break;case 1:c=u;e=g;l=f;break;case 2:c=f;e=g;l=h;break;case 3:c=f;e=
u;l=g;break;case 4:c=h;e=f;l=g;break;case 5:c=g,e=f,l=u}}return new b({r:Math.round(255*c),g:Math.round(255*e),b:Math.round(255*l)})};k.extend(b,{toCmy:function(){return{c:Math.round(100*(1-this.r/255)),m:Math.round(100*(1-this.g/255)),y:Math.round(100*(1-this.b/255))}},toCmyk:function(){var a,b=this.r/255,g=this.g/255,d=this.b/255;a=Math.min(1-b,1-g,1-d);return{c:Math.round((1-b-a)/(1-a)*100),m:Math.round((1-g-a)/(1-a)*100),y:Math.round((1-d-a)/(1-a)*100),b:Math.round(100*a)}},toHsl:function(){var a=
this.r/255,b=this.g/255,g=this.b/255,d=Math.min(a,g,b),e=Math.max(a,b,g),k=e-d,f=0,m=0,d=(d+e)/2;0<d&&1>d&&(m=k/(.5>d?2*d:2-2*d));0<k&&(e==a&&e!=b&&(f+=(b-g)/k),e==b&&e!=g&&(f+=2+(g-a)/k),e==g&&e!=a&&(f+=4+(a-b)/k),f*=60);return{h:f,s:Math.round(100*m),l:Math.round(100*d)}},toHsv:function(){var a=this.r/255,b=this.g/255,g=this.b/255,d=Math.max(a,b,g),e=d-Math.min(a,g,b),k=null,f=0==d?0:e/d;0==f?k=0:(k=a==d?60*(b-g)/e:b==d?120+60*(g-a)/e:240+60*(a-b)/e,0>k&&(k+=360));return{h:k,s:Math.round(100*f),
v:Math.round(100*d)}}});return m})},"dojox/main":function(){define(["dojo/_base/kernel"],function(m){return m.dojox})},"esri/views/3d/layers/i3s/I3SProjectionUtil":function(){define(["../../support/projectionUtils","../../lib/glMatrix","../../webgl-engine/lib/Util"],function(m,k,b){var a=k.vec3d,c=k.mat4d,h=b.assert,g={PER_VERTEX:"perVertex",BOUNDINGBOX:"boundingBox",NO_REPROJECTION:"noReprojection"},d=new Float64Array(3E3);return{ReprojectionTypes:g,reprojectPoints:function(a,b,d,h,k,t,r){a===g.PER_VERTEX?
d=this.reprojectPointsPerVertex(b,d,k,t,r,h):a===g.BOUNDINGBOX?d=this.reprojectBoundingBox(b,d,k,t,r):(a=c.create(),c.identity(a),b=c.create(),m.computeLinearTransformation(k,d,b,r),d={localTrafo:a,globalTrafo:b});return d},reprojectPointsPerVertex:function(a,b,f,g,h,k){var e=c.create();m.computeLinearTransformation(f,b,e,h);var l=c.create(),l=c.inverse(e,l),n=c.create();c.identity(n);if(!k){k=[0,0,0];var t=a.length/3;m.vectorToVector(b,f,k,g);for(f=b=0;f<t;f+=1E3){var u=Math.min(1E3,t-f);for(b=0;b<
u;b++)d[3*b]=a[3*(f+b)]+k[0],d[3*b+1]=a[3*(f+b)+1]+k[1],d[3*b+2]=a[3*(f+b)+2]+k[2];m.bufferToBuffer(d,g,0,d,h,0,u);var z,A,C;for(b=0;b<u;b++)z=d[3*b],A=d[3*b+1],C=d[3*b+2],a[3*(f+b)]=l[0]*z+l[4]*A+l[8]*C+l[12],a[3*(f+b)+1]=l[1]*z+l[5]*A+l[9]*C+l[13],a[3*(f+b)+2]=l[2]*z+l[6]*A+l[10]*C+l[14]}}return{localTrafo:n,globalTrafo:e}},reprojectNormalsPerVertex:function(a,b,d,g,k){h(g.equals(m.SphericalRenderSpatialReference));g=c.create();m.computeLinearTransformation(d,b,g,k);b=c.create();b=c.inverse(g,b);
d=a.length/3;for(var e,f=0;f<d;f++)k=a[3*f],g=a[3*f+1],e=a[3*f+2],a[3*f]=b[0]*k+b[4]*g+b[8]*e,a[3*f+1]=b[1]*k+b[5]*g+b[9]*e,a[3*f+2]=b[2]*k+b[6]*g+b[10]*e},reprojectBoundingBox:function(b,d,f,g,h){for(var e=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],k=[-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE],l=0;l<b.length/3;l++)for(var n=[b[3*l],b[3*l+1],b[3*l+2]],u=0;3>u;u++)e[u]=Math.min(e[u],n[u]),k[u]=Math.max(k[u],n[u]);l=this.geographicToProjected(d,f,g);a.add(l,e,e);a.add(l,k,k);for(l=
0;3>l;l++)k[l]==e[l]&&(k[l]+=1);l=[[e[0],e[1],e[2]],[k[0],e[1],e[2]],[e[0],k[1],e[2]],[e[0],e[1],k[2]]];for(n=0;4>n;n++)u=l[n],m.vectorToVector(u,g,u,h);g=a.subtract(l[1],l[0],a.create());n=a.subtract(l[2],l[0],a.create());u=a.subtract(l[3],l[0],a.create());a.scale(g,1/(k[0]-e[0]));a.scale(n,1/(k[1]-e[1]));a.scale(u,1/(k[2]-e[2]));var e=a.length(g),k=a.length(n),y=a.length(u);if(3<Math.abs(e-k)||3<Math.abs(e-y)||3<Math.abs(k-y)){for(l=0;l<b.length/3;l++)b[3*l]*=e,b[3*l+1]*=k,b[3*l+2]*=y;a.normalize(g);
a.normalize(n);a.normalize(u)}b=c.createFromMatrixRowMajor([g[0],n[0],u[0],0,g[1],n[1],u[1],0,g[2],n[2],u[2],0,0,0,0,1]);e=[0,0,0,0];m.vectorToVector(d,f,e,h);return{globalTrafo:c.createFromMatrixRowMajor([1,0,0,e[0],0,1,0,e[1],0,0,1,e[2],0,0,0,1]),localTrafo:b}},geographicToProjected:function(a,b,c){return 4326===c.wkid?[a[0],a[1],a[2]]:a}}})},"esri/views/3d/layers/i3s/I3SQueryEngine":function(){define("require exports dojo/promise/all ../../../../core/promiseUtils ../../../../core/Error ../../../../tasks/support/FeatureSet".split(" "),
function(m,k,b,a,c,h){return function(){function g(a,b){this._support=a;this._options=b}g.prototype.queryExtent=function(a){var b=this;return this._rejectUnsupported(a).then(function(){var c=0,d=b._support.createExtentBuilder();b._forAllQueried(a,function(a){c++;d.add(a)});return{count:c,extent:0===c?null:d.getExtent()}})};g.prototype.queryFeatureCount=function(a){var b=this;return this._rejectUnsupported(a).then(function(){var c=0;b._forAllQueried(a,function(){return c++});return c})};g.prototype.queryFeatures=
function(c){var d=this;return this._rejectUnsupported(c).then(function(){var e=[],f=c&&c.outFields,g=[];d._forAllQueried(c,function(a){return g.push(d._support.createGraphic(a))},function(a){f&&(e.push(d._support.requestFields(a,g,f)),g=[])});f||e.push(a.resolve(g));return b(e)}).then(function(a){a=a.reduce(function(a,b){return a.concat(b)},[]);var b=new h;b.features=a;return b})};g.prototype.queryObjectIds=function(a){var b=this;return this._rejectUnsupported(a).then(function(){var c=[];b._forAllQueried(a,
function(a){return c.push(a.id)});return c})};g.prototype._forAllQueried=function(a,b,c){var d=[];if(a&&a.objectIds){var e=a.objectIds;d.push(function(a){return 0<=e.indexOf(a.id)})}this._options.addVisibilityFilter&&d.push(this._support.createVisibilityFilter());this._support.forAll(function(a){for(var c=0;c<d.length;c++)if(!(0,d[c])(a))return;b(a)},c)};g.prototype._rejectUnsupported=function(b){if(null==b)return a.resolve();var d=function(b){return a.reject(new c("Unsupported Query","Unsupported property '"+
b+"'"))};return null!=b.distance?d("distance"):null!=b.geometryPrecision?d("geometryPrecision"):b.groupByFieldsForStatistics&&b.groupByFieldsForStatistics.length?d("groupByFieldsForStatistics"):null!=b.maxAllowableOffset?d("maxAllowableOffset"):b.multipatchOption?d("multipatchOption"):null!=b.num?d("num"):b.orderByFields&&b.orderByFields.length?d("orderByFields"):b.outSpatialReference?d("outSpatialReference"):b.outStatistics&&b.outStatistics.length?d("outStatistics"):b.pixelSize?d("pixelSize"):b.quantizationParameters?
d("quantizationParameters"):b.relationParam?d("relationParam"):b.returnDistinctValues?d("returnDistinctValues"):null!=b.start?d("start"):b.text?d("text"):b.timeExtent?d("timeExtent"):b.where?d("where"):b.geometry?d("geometry"):!this._options.enableOutFields&&b.outFields&&b.outFields.length?d("outFields"):!this._options.enableObjectId&&b.objectIds&&b.objectIds.length?d("objectIds"):a.resolve()};return g}()})},"esri/views/3d/webgl-engine/lib/base64Binary":function(){define(["require","exports"],function(m,
k){function b(b){var c=a[b.charAt(b.length-1)],g=a[b.charAt(b.length-2)],d=b.length/4*3;64===c&&d--;64===g&&d--;c=new ArrayBuffer(d);g=new Uint8Array(c);b=b.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e=0,k=0;k<d;k+=3){var f=a[b.charAt(e++)],m=a[b.charAt(e++)],u=a[b.charAt(e++)],t=a[b.charAt(e++)],r=(m&15)<<4|u>>2,w=(u&3)<<6|t;g[k]=f<<2|m>>4;64!==u&&(g[k+1]=r);64!==t&&(g[k+2]=w)}return c}var a={};for(m=0;65>m;m++)a["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[m]]=m;k.decode=
b;k.decodeFloat32=function(a){return new Float32Array(b(a))};k.decodeUint32=function(a){return new Uint32Array(b(a))};k.decodeInt32=function(a){return new Int32Array(b(a))};k.encode=function(a){var b;b=a instanceof Uint8Array?a:new Uint8Array(b.buffer,b.byteOffset,b.byteLength);a=b.length%3;for(var c="",d,e=b.length-a,k=0;k<e;k+=3)d=(b[k]<<16)+(b[k+1]<<8)+b[k+2],c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[d>>18&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[d>>
12&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[d>>6&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[d&63];switch(a){case 1:d=b[b.length-1];c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[d>>2];c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[d<<4&63];c+="\x3d\x3d";break;case 2:d=(b[b.length-2]<<8)+b[b.length-1],c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[d>>10],
c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[d>>4&63],c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[d<<2&63],c+="\x3d"}return c}})},"url:esri/widgets/Popup/templates/Popup.html":'\x3cdiv role\x3d"presentation" class\x3d"${_css.invisible}"\x3e\r\n  \x3c!-- Popup Container --\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_containerNode" class\x3d"${_css.container} ${_css.alignTop} ${_css.shadow}"\x3e\r\n    \x3cdiv class\x3d"${_css.main}"\x3e\r\n      \x3c!-- Popup Docked Pagination --\x3e\r\n      \x3csection class\x3d"${_css.paginationDocked}"\x3e\r\n        \x3cdiv role\x3d"presentation" class\x3d"${_css.loadingContainer}" title\x3d"${_i18n.loading}"\x3e\r\n          \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconLoading}"\x3e\x3c/span\x3e\r\n          \x3cspan class\x3d"${_css.iconText}"\x3e${_i18n.loading}\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"${_css.paginationDockedButtons}"\x3e\r\n          \x3cdiv role\x3d"button" tabindex\x3d"0" data-dojo-attach-point\x3d"_previousDockedNode" class\x3d"${_css.button} ${_css.paginationPrevious}" title\x3d"${_i18n.previous}"\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconLeftTriangleArrow} ${_css.paginationPreviousIconLTR}"\x3e\x3c/span\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconRightTriangleArrow} ${_css.paginationPreviousIconRTL}"\x3e\x3c/span\x3e\r\n            \x3cspan class\x3d"${_css.iconText}"\x3e${_i18n.previous}\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_pageTextDockedNode" class\x3d"${_css.paginationText}"\x3e\x3c/div\x3e\r\n          \x3cdiv role\x3d"button" tabindex\x3d"0" data-dojo-attach-point\x3d"_nextDockedNode" class\x3d"${_css.button} ${_css.paginationNext}" title\x3d"${_i18n.next}"\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconRightTriangleArrow} ${_css.paginationNextIconLTR}"\x3e\x3c/span\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconLeftTriangleArrow} ${_css.paginationNextIconRTL}"\x3e\x3c/span\x3e\r\n            \x3cspan class\x3d"${_css.iconText}"\x3e${_i18n.next}\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv role\x3d"button" tabindex\x3d"0" data-dojo-attach-point\x3d"_pageMenuDockedNode" class\x3d"${_css.button} ${_css.featureMenuButton}" title\x3d"${_i18n.menu}"\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconPaginationMenu}"\x3e\x3c/span\x3e\r\n            \x3cspan class\x3d"${_css.iconText}"\x3e${_i18n.menu}\x3c/span\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/section\x3e\r\n      \x3c!-- /Popup Docked Pagination --\x3e\r\n      \x3c!-- Popup Header --\x3e\r\n      \x3cheader class\x3d"${_css.header}"\x3e\r\n        \x3ch1 data-dojo-attach-point\x3d"_titleNode" class\x3d"${_css.headerTitle}"\x3e\x3c/h1\x3e\r\n        \x3cdiv class\x3d"${_css.headerButtons}"\x3e\r\n          \x3cdiv role\x3d"button" tabindex\x3d"0" data-dojo-attach-point\x3d"_dockNode" class\x3d"${_css.button} ${_css.buttonDock}"\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconDock} ${_css.iconDockToRight}"\x3e\x3c/span\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconDock} ${_css.iconDockToTop}"\x3e\x3c/span\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconDock} ${_css.iconDockToLeft}"\x3e\x3c/span\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconDock} ${_css.iconDockToBottom}"\x3e\x3c/span\x3e\r\n            \x3cspan class\x3d"${_css.iconText}"\x3e${_i18n.dock}\x3c/span\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconUndock}"\x3e\x3c/span\x3e\r\n            \x3cspan class\x3d"${_css.iconText}"\x3e${_i18n.undock}\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv role\x3d"button" tabindex\x3d"0" data-dojo-attach-point\x3d"_closeNode" class\x3d"${_css.button}" title\x3d"${_i18n.close}"\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconClose}"\x3e\x3c/span\x3e\r\n            \x3cspan class\x3d"${_css.iconText}"\x3e${_i18n.close}\x3c/span\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/header\x3e\r\n      \x3c!-- /Popup Header --\x3e\r\n      \x3c!-- Popup Content --\x3e\r\n      \x3carticle class\x3d"${_css.content}" data-dojo-attach-point\x3d"_bodyContentNode"\x3e\x3c/article\x3e\r\n      \x3c!-- /Popup Content --\x3e\r\n      \x3c!-- Popup Footer --\x3e\r\n      \x3cfooter class\x3d"${_css.footer}"\x3e\r\n        \x3c!-- Popup Actions --\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_actionsNode" class\x3d"${_css.actions}"\x3e\x3c/div\x3e\r\n        \x3c!-- /Popup Actions --\x3e\r\n        \x3c!-- Popup Pagination --\x3e\r\n        \x3csection class\x3d"${_css.pagination}"\x3e\r\n          \x3cdiv role\x3d"presentation" class\x3d"${_css.loadingContainer}" title\x3d"${_i18n.loading}"\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconLoading}"\x3e\x3c/span\x3e\r\n            \x3cspan class\x3d"${_css.iconText}"\x3e${_i18n.loading}\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv role\x3d"button" tabindex\x3d"0" data-dojo-attach-point\x3d"_previousNode" class\x3d"${_css.button} ${_css.paginationPrevious}" title\x3d"${_i18n.previous}"\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconLeftTriangleArrow} ${_css.paginationPreviousIconLTR}"\x3e\x3c/span\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconRightTriangleArrow} ${_css.paginationPreviousIconRTL}"\x3e\x3c/span\x3e\r\n            \x3cspan class\x3d"${_css.iconText}"\x3e${_i18n.previous}\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"_pageTextNode" class\x3d"${_css.paginationText}"\x3e\x3c/div\x3e\r\n          \x3cdiv role\x3d"button" tabindex\x3d"0" data-dojo-attach-point\x3d"_nextNode" class\x3d"${_css.button} ${_css.paginationNext}" title\x3d"${_i18n.next}"\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconRightTriangleArrow} ${_css.paginationNextIconLTR}"\x3e\x3c/span\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconLeftTriangleArrow} ${_css.paginationNextIconRTL}"\x3e\x3c/span\x3e\r\n            \x3cspan class\x3d"${_css.iconText}"\x3e${_i18n.next}\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv role\x3d"button" tabindex\x3d"0" data-dojo-attach-point\x3d"_pageMenuNode" class\x3d"${_css.button} ${_css.featureMenuButton}" title\x3d"${_i18n.menu}"\x3e\r\n            \x3cspan aria-hidden\x3d"true" class\x3d"${_css.icon} ${_css.iconPaginationMenu}"\x3e\x3c/span\x3e\r\n            \x3cspan class\x3d"${_css.iconText}"\x3e${_i18n.menu}\x3c/span\x3e\r\n          \x3c/div\x3e\r\n        \x3c/section\x3e\r\n        \x3c!-- /Popup Pagination --\x3e\r\n      \x3c/footer\x3e\r\n      \x3c!-- /Popup Footer --\x3e\r\n      \x3c!-- Popup Menu --\x3e\r\n      \x3csection class\x3d"${_css.featureMenu}" data-dojo-attach-point\x3d"_pageMenuSectionNode" aria-hidden\x3d"true"\x3e\r\n        \x3ch2 class\x3d"${_css.featureMenuHeader}" data-dojo-attach-point\x3d"_pageMenuInfoNode"\x3e\x3c/h2\x3e\r\n        \x3cnav class\x3d"${_css.featureMenuViewport}"\x3e\r\n          \x3col class\x3d"${_css.featureMenuList}" role\x3d"menu" data-dojo-attach-point\x3d"_paginationNode"\x3e\x3c/ol\x3e\r\n        \x3c/nav\x3e\r\n      \x3c/section\x3e\r\n      \x3c!-- /Popup Menu --\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Popup Pointer --\x3e\r\n    \x3cdiv class\x3d"${_css.pointer}" role\x3d"presentation"\x3e\r\n      \x3cdiv class\x3d"${_css.pointerDirection} ${_css.shadow}"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- /Popup Pointer --\x3e\r\n  \x3c/div\x3e\r\n  \x3c!-- /Popup Container --\x3e\r\n\x3c/div\x3e\r\n',
"url:esri/widgets/Popup/templates/PopupRenderer.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"${_css.container}"\x3e\r\n    \x3cdiv class\x3d"${_css.main}"\x3e\r\n      \x3cdiv class\x3d"${_css.loadingSpinnerContainer}"\x3e\x3cspan class\x3d"${_css.iconLoading} ${_css.spinner}"\x3e\x3c/span\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_contentNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:esri/views/3d/environment/materials/SimpleAtmosphereMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vsSimpleAtmosphere"\x3e\x3c![CDATA[\r\n  uniform mat4 proj;\r\n  uniform mat4 view;\r\n\r\n#ifndef PANORAMIC\r\n\r\n  const float TWICEPI \x3d 2.0*3.14159265;\r\n  const float ATMOSPHERE_RIM_SEGMENTS \x3d 128.0;\r\n\r\n  uniform vec3 silCircleCenter;\r\n  uniform vec3 silCircleV1;\r\n  uniform vec3 silCircleV2;\r\n  uniform vec2 texV;\r\n\r\n#endif\r\n\r\n  uniform vec3 lightDirection;\r\n\r\n  attribute vec3 $position;\r\n  varying vec2 vtc;\r\n  varying float falloff;\r\n\r\n  void main(void) {\r\n\r\n#ifdef PANORAMIC\r\n\r\n    vec3 pos \x3d $position;\r\n    float ndotl \x3d lightDirection.z;\r\n    vtc \x3d vec2(0, $position.z+0.05);\r\n\r\n#else\r\n\r\n    float phi \x3d $position.x * (TWICEPI / ATMOSPHERE_RIM_SEGMENTS) + 1.0;\r\n    vec3 pos \x3d (sin(phi) * silCircleV1 + cos(phi) * silCircleV2 + silCircleCenter) * $position.y;\r\n    float ndotl \x3d dot(normalize(pos), lightDirection);\r\n\r\n    vtc.x \x3d $position.x / ATMOSPHERE_RIM_SEGMENTS;\r\n    vtc.y \x3d texV.x * (1.0 - $position.z) + texV.y * $position.z;\r\n\r\n#endif\r\n\r\n    falloff \x3d max(0.0, (smoothstep(-1.0, 0.8, ndotl + ndotl)));\r\n\r\n    gl_Position \x3d proj * view * vec4(pos, 1.0);\r\n    gl_Position.z \x3d gl_Position.w; // project atmosphere onto the far plane\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsSimpleAtmosphere"\x3e\x3c![CDATA[\r\n  precision mediump float;\r\n\r\n  uniform sampler2D tex;\r\n  uniform vec4 color;\r\n  varying vec2 vtc;\r\n  varying float falloff;\r\n\r\n  void main() {\r\n    vec4 texColor \x3d texture2D(tex, vtc);\r\n    gl_FragColor \x3d texColor * color * falloff;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/environment/materials/RealisticAtmosphereMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3c!--Vertex Shader for Atmosphere--\x3e\r\n\x3csnippet name\x3d"vsRealisticAtmosphere"\x3e\x3c![CDATA[\r\n//\r\n// Based on Atmospheric scattering vertex shader by Sean O\'Neil from GPU Gems 2 Chapter 16.\r\n//\r\n// Link:                   http://http.developer.nvidia.com/GPUGems2/gpugems2_chapter16.html\r\n// Download Portal:        http://http.download.nvidia.com/developer/GPU_Gems_2/CD/Index.html\r\n// Unmodified Source Code: http://http.download.nvidia.com/developer/GPU_Gems_2/CD/Content/16.zip\r\n//\r\n// Adapted for WebGIS by Jascha Gr\u00fcbel (jgruebel@esri.com), Z\u00fcrich 2015\r\n//\r\n\r\n  precision mediump  float;\r\n\r\n  //Camera\r\n  uniform vec2 halfSizeNearPlane;\r\n  uniform vec3 v3CameraUp;\r\n  uniform vec3 v3CameraRight;\r\n  uniform vec3 v3CameraDir;\r\n  uniform vec2 v2CameraCenterOffset;\r\n\r\n  //Attributes\r\n  attribute vec3 $position;\r\n  attribute vec2 $uv0;\r\n\r\n  //Varyings\r\n  varying vec3 v3WorldRay;\r\n  varying vec2 vtc;\r\n\r\n#ifdef HAZE\r\n  varying vec3 v3EyeDir;\r\n#endif\r\n\r\n  void main(void) {\r\n    vec3 v3Pos \x3d $position;\r\n    vtc \x3d $uv0;\r\n    vec2 rayvtc \x3d $uv0 - v2CameraCenterOffset;\r\n\r\n#ifdef HAZE\r\n    v3EyeDir \x3d vec3((2.0*halfSizeNearPlane *rayvtc)-halfSizeNearPlane,-1.0);\r\n#else\r\n    vec3 v3EyeDir \x3d vec3((2.0*halfSizeNearPlane *rayvtc)-halfSizeNearPlane,-1.0);\r\n#endif\r\n    v3WorldRay \x3d v3EyeDir.z*v3CameraDir + v3EyeDir.y*v3CameraUp + v3EyeDir.x*v3CameraRight;\r\n    gl_Position \x3d vec4(v3Pos, 1.0);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"atmosphereScaleFunction"\x3e\x3c![CDATA[\r\n  //Approximation for inner integral based on a radii ratio of 10.25:10\r\n  float scale(float fCos){\r\n    float x \x3d 1.0 - fCos;\r\n    return exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"toneMapperConstants"\x3e\x3c![CDATA[\r\n#ifdef HAZE\r\n  const float fOneOverGamma \x3d 1.0;//Gamma \x3d 1.0\r\n#else\r\n  const float fOneOverGamma \x3d 0.454545; // Gamma \x3d 2.2\r\n#endif\r\n  const vec3 v3OneOverGamma \x3d vec3(fOneOverGamma);\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"exponentialToneMapper"\x3e\x3c![CDATA[\r\n  //ToneMapping operators\r\n  vec3 expTM(vec3 inputColor,float exposure){\r\n      return pow(1.0 - exp(inputColor * -exposure), v3OneOverGamma);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"reinhardToneMapper"\x3e\x3c![CDATA[\r\n  vec3 reinhardTM(vec3 inputColor, float exposure){\r\n      vec3 intermediate \x3d inputColor *exposure;\r\n      intermediate /\x3d (1.0+intermediate);\r\n      return pow(intermediate, v3OneOverGamma);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"HSVColorSpace"\x3e\x3c![CDATA[\r\n//based on http://gamedev.stackexchange.com/a/59808\r\n// Hue in range [0,1] instead of 360\u00b0\r\nvec3 rgb2hsv(vec3 c)\r\n{\r\n    vec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\r\n    vec4 p \x3d mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\r\n    vec4 q \x3d mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\r\n\r\n    float d \x3d q.x - min(q.w, q.y);\r\n    float e \x3d 1.0e-10;\r\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\r\n}\r\n\r\nvec3 hsv2rgb(vec3 c)\r\n{\r\n    vec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\r\n    vec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\r\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\r\n}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"atmosphereUniformsConstantsVaryings"\x3e\x3c![CDATA[\r\n\r\n  //Light\r\n  uniform vec3 v3LightDir;      // The direction vector to the light source\r\n  uniform vec3 v3InvWavelength; // 1 / pow(wavelength, 4) for the red, green, and blue channels\r\n  uniform vec3 v3InvWavelengthScaled; //v3InvWavelength * fKr4PI + fKm4PI\r\n\r\n  //Radii\r\n  uniform vec4 v4Radii; // inner, inner^2, outer, outer^2,\r\n\r\n  //Atmosphere\r\n  const float fKrESun \x3d 0.075;        // Kr * ESun \x3d 0.005 * 15.0\r\n  const float fKmESun \x3d 0.015;        // Km * ESun \x3d 0.005 * 15\r\n  //uniform float fScale;         // 1 / (fOuterRadius - fInnerRadius)\r\n  //uniform float fScaleDepth;    // The scale depth (i.e. the altitude at which the atmosphere\'s average density is found)\r\n  //uniform float fScaleOverScaleDepth; // fScale / fScaleDepth\r\n  //uniform float fOneOverScaleDepth; // 1.0 / fScaleDepth\r\n\r\n  //uniform float fScaleDepthBlue;    // The scale depth (i.e. the altitude at which the atmosphere\'s average density is found)\r\n  //uniform float fScaleOverScaleDepthBlue; // fScale / fScaleDepth\r\n  //uniform float fOneOverScaleDepthBlue; // 1.0 / fScaleDepth\r\n\r\n  uniform vec4 v4AtmosParams1; //(fScale,fScaleDepth,fScaleOverScaleDepth,fOneOverScaleDepth)\r\n  uniform vec4 v4AtmosParams2; //(g,fScaleDepthBlue,fScaleOverScaleDepthBlue,fOneOverScaleDepthBlue)\r\n#ifndef HAZE\r\n  uniform vec4 v4AtmosParams3; //(g2,fMiePhaseCoefficients,fLowerAlphaBlendBound,fOneOverOuterRadiusMinusAlphaBlendBound)\r\n#endif\r\n\r\n  //Camera\r\n  uniform vec3 v3CameraPos;     // The camera\'s current position\r\n  //uniform float fCameraHeight;  // The camera\'s current height\r\n  //uniform float fCameraHeight2; // fCameraHeight^2\r\n  //uniform float fC; //fCameraHeight2 - fOuterRadius2; // C \x3d ||o-c||^2 - r^2\r\n  //uniform float fCSur; //fCameraHeight2 - (fInnerRadius2 - 63756370000.0); // C \x3d ||o-c||^2 - r^2\r\n  uniform vec4 v4SphereComp; //The camera\'s current height, CameraHeight^2,fC,fCSur\r\n  uniform vec2 nearFar;\r\n\r\n  //Camera HDR\r\n#ifdef HAZE\r\n  const float fExposure \x3d 1.5;\r\n#else\r\n  const float fExposure \x3d 2.0;\r\n#endif\r\n\r\n#ifdef HAZE\r\n  //Depth texture\r\n  uniform sampler2D tDepth;\r\n#endif\r\n\r\n  //Testing variables\r\n  uniform float showTest;\r\n\r\n  //Varyings\r\n  varying vec3 v3EyeDir;\r\n  varying vec3 v3WorldRay;\r\n  varying vec2 vtc;\r\n\r\n  //Loop constants for integral approximation\r\n  const float fSamples \x3d 5.0;\r\n  const int maxSamples \x3d 5;\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"atmospherePrecomputation"\x3e\x3c![CDATA[\r\n    float fInnerRadius \x3d v4Radii[0];   // The inner (planetary) radius\r\n    float fInnerRadius2 \x3d v4Radii[1];  // fInnerRadius^2\r\n    float fOuterRadius \x3d v4Radii[2];   // The outer (atmosphere) radius\r\n    float fOuterRadius2 \x3d v4Radii[3];  // fOuterRadius^2\r\n\r\n    float fCameraHeight \x3d v4SphereComp[0];\r\n    float fCameraHeight2 \x3d v4SphereComp[1];\r\n    float fC \x3d v4SphereComp[2];\r\n    float fCSur \x3d v4SphereComp[3];\r\n\r\n#ifdef PLANAR\r\n    vec3 cameraPosition \x3d vec3(0.0,0.0,fCameraHeight);\r\n#else\r\n    vec3 cameraPosition \x3d v3CameraPos;\r\n#endif\r\n\r\n    //Debug variables\r\n    vec3 test \x3d vec3(0.0,0.0,0.0);\r\n\r\n    //Obtain ray from Camera\r\n    vec3 worldSpaceRay \x3d normalize(v3WorldRay);\r\n\r\n    //Compute Atmosphere intersection; i.e. ray/sphere intersection\r\n    float B \x3d 2.0 * dot(cameraPosition, worldSpaceRay); // B \x3d 2(l * (o-c))\r\n    float det \x3d B*B - 4.0 * fC; // det \x3d B^2 - 4.0* C\r\n\r\n    //idealized sphere intersection to discard early some pixels\r\n    float detSur \x3d B*B - 4.0 * fCSur; // det \x3d B^2 - 4.0* C\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"atmosphereDiscardPixels"\x3e\x3c![CDATA[\r\n      bool continueComputation \x3d true;\r\n#ifdef HAZE\r\n      // only use red channel from depth texture.\r\n      // see \'Issues\' at https://www.khronos.org/registry/webgl/extensions/WEBGL_depth_texture\r\n      float depthSample \x3d texture2D(tDepth, vtc).r;\r\n\r\n      float zNear \x3d nearFar[0];\r\n      float zFar \x3d nearFar[1];\r\n\r\n      // http://web.archive.org/web/20130416194336/http://olivers.posterous.com/linear-depth-in-glsl-for-real\r\n      float zNorm \x3d 2.0 * depthSample - 1.0;\r\n      float linDepth \x3d 2.0 * zNear * zFar /\r\n        (zFar + zNear - zNorm * (zFar - zNear));\r\n\r\n      float nearSurfaceT;\r\n      if (detSur\x3e0.0){\r\n        nearSurfaceT \x3d 0.5 *(-B - sqrt(detSur));\r\n      }\r\n\r\n      float rayEndT;\r\n\r\n      // find intersections with ground, but only between the near and far\r\n      // clipping planes.\r\n      if (depthSample \x3c 1.0 \x26\x26 depthSample \x3e 0.0) {\r\n        vec3 cameraSpaceRay \x3d normalize(v3EyeDir);\r\n        cameraSpaceRay /\x3d cameraSpaceRay.z;\r\n        cameraSpaceRay *\x3d linDepth;\r\n#ifndef PLANAR\r\n        if((fCameraHeight-fInnerRadius)\x3e8000000.0 \x26\x26 detSur\x3e0.0){\r\n          rayEndT \x3d nearSurfaceT;\r\n        } else  if ((fCameraHeight-fInnerRadius)\x3e2000000.0 \x26\x26 detSur\x3e0.0){\r\n          rayEndT \x3d mix(length(cameraSpaceRay),nearSurfaceT,((fCameraHeight-fInnerRadius)-2000000.0)/6000000.0);\r\n        } else {\r\n          rayEndT \x3d length(cameraSpaceRay);\r\n        }\r\n#else\r\n        rayEndT \x3d length(cameraSpaceRay);\r\n#endif\r\n      } else {\r\n        continueComputation \x3d false;\r\n      }\r\n#ifdef PLANAR\r\n      if (16500.0+ fInnerRadius \x3c fCameraHeight){\r\n        continueComputation \x3d false;\r\n      }\r\n#endif\r\n#else\r\n      if (detSur\x3e0.0){\r\n        float nearSurfaceT \x3d 0.5 *(-B - sqrt(detSur));\r\n        if (nearSurfaceT \x3e 0.0){\r\n          continueComputation \x3d false;\r\n        }\r\n      }\r\n#endif\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"atmosphereUnpackAddUniforms"\x3e\x3c![CDATA[\r\n        float fScale \x3d v4AtmosParams1.x;\r\n        vec2 v2ScaleDepth \x3d vec2(v4AtmosParams1.y,v4AtmosParams2.y);//fScaleDepth, fScaleDepthBlue\r\n        vec2 v2ScaleOverScaleDepth \x3d vec2(v4AtmosParams1.z,v4AtmosParams2.z);//fScaleOverScaleDepth, fScaleOverScaleDepthBlue\r\n        vec2 v2OneOverScaleDepth \x3d vec2(v4AtmosParams1.w,v4AtmosParams2.w);//fOneOverScaleDepth, fOneOverScaleDepthBlue\r\n\r\n#ifndef HAZE\r\n        float g \x3d v4AtmosParams2.x;\r\n        float g2 \x3d v4AtmosParams3.x;\r\n        float fMiePhaseCoefficients \x3d v4AtmosParams3.y;\r\n        float fLowerAlphaBlendBound \x3d v4AtmosParams3.z;\r\n        float fOneOverOuterRadiusMinusAlphaBlendBound \x3d v4AtmosParams3.w;\r\n#endif\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"atmosphereComputeRayAndLoopSetup"\x3e\x3c![CDATA[\r\n        float rayStartT \x3d 0.5 *(-B - sqrt(det)); //near intersection with atmosphere\r\n#ifdef HAZE\r\n        float nearT \x3d abs(rayStartT);\r\n        float farT \x3d abs(rayEndT);\r\n#else\r\n        float rayEndT \x3d 0.5 *(-B + sqrt(det)); //far intersection with atmosphere\r\n\r\n#endif\r\n\r\n        float fDistance;//calculate its scattering offset\r\n        // Calculate the ray\'s starting position\r\n        if (rayStartT \x3c 0.0)\r\n        { //ray starts from camera to far\r\n          rayStartT \x3d 0.0;\r\n#ifndef HAZE\r\n          fDistance \x3d fScale*(fInnerRadius - fCameraHeight);\r\n#endif\r\n        }\r\n#ifndef HAZE\r\n        else\r\n        {//outside atmosphere\r\n          fDistance \x3d -1.0;\r\n        }\r\n#endif\r\n\r\n        // Initialize the scattering loop variables\r\n        vec3 v3Start \x3d cameraPosition + worldSpaceRay * rayStartT;\r\n\r\n#ifdef HAZE\r\n        vec3 v3End \x3d cameraPosition + worldSpaceRay * rayEndT;\r\n\r\n        float fEndLength \x3d length(v3End);\r\n        float fLocalCameraHeight \x3d length(v3Start);\r\n\r\n        //computed for the original end point to get consistent light angles after possible inversions\r\n        float fLightAngle \x3d dot(v3LightDir, v3End) / fEndLength;\r\n\r\n        if (nearT \x3e farT)\r\n        {\r\n          if (fLocalCameraHeight \x3c fEndLength)\r\n          {\r\n            //Switch positive slopes for flipped rays\r\n            v3End \x3d cameraPosition + worldSpaceRay * rayStartT;\r\n            v3Start \x3d cameraPosition + worldSpaceRay * rayEndT;\r\n            worldSpaceRay *\x3d -1.0;\r\n            fEndLength \x3d length(v3End);\r\n            fLocalCameraHeight \x3d length(v3Start);\r\n          }\r\n          else if (fLocalCameraHeight \x3d\x3d fEndLength)\r\n          {// create minuscule fake slope for integration if the slope is zero\r\n            fLocalCameraHeight +\x3d 1.0; //BUGFIX, if the height of camera and ground is equal the equation breaks, add fake meter to camera height to get\r\n            //slope for the camera function\r\n          }\r\n        }\r\n\r\n        //Calculate its scattering offset\r\n        // Assumes camera constrains of WSV 3.8\r\n        float fCameraDepth;\r\n        float fCameraDepthBlue;\r\n        if (fLocalCameraHeight \x3e fOuterRadius)\r\n        {\r\n          fDistance \x3d fInnerRadius - fOuterRadius;\r\n        } else\r\n        {//outside atmosphere\r\n          fDistance \x3d fEndLength - fLocalCameraHeight;\r\n        }\r\n\r\n#endif\r\n        vec2 v2OpticalStartDepth \x3d exp(fDistance * v2OneOverScaleDepth);\r\n\r\n        float fRayLength \x3d rayEndT - rayStartT;\r\n        float fSampleLength \x3d fRayLength / fSamples;\r\n        float fScaledLength \x3d fSampleLength * fScale;\r\n        vec3 v3SampleRay \x3d worldSpaceRay * fSampleLength;\r\n        vec3 v3SamplePoint \x3d v3Start + v3SampleRay * 0.5;\r\n\r\n#ifdef HAZE\r\n        float fCameraAngle \x3d dot(-worldSpaceRay, v3End) / fEndLength;\r\n        float fScaleCameraAngle \x3d scale(fCameraAngle);\r\n        vec2 v2CameraOffset \x3d fScaleCameraAngle*v2OpticalStartDepth;\r\n\r\n        float scaledValues \x3d scale(fLightAngle) + fScaleCameraAngle;\r\n        vec2 v2ScaledValuesDepth \x3d scaledValues * v2ScaleDepth;\r\n#else\r\n        float fCameraAngle \x3d dot(worldSpaceRay, v3Start / length(v3Start));\r\n        float angleMultiplier \x3d fCameraAngle\x3e0.0?fCameraAngle:0.0;\r\n\r\n        float fScaleCameraAngle \x3d scale(fCameraAngle);\r\n        vec2 v2CameraOffset \x3d fScaleCameraAngle*v2OpticalStartDepth * v2ScaleDepth;\r\n#endif\r\n\r\n        //Loop variables\r\n        vec3 v3FrontColor \x3d vec3(0.0, 0.0, 0.0);\r\n        vec3 v3FrontColorBlue \x3d vec3(0.0, 0.0, 0.0);\r\n        vec3 v3Attenuate\x3d vec3(0.0, 0.0, 0.0);\r\n        vec3 v3AttenuateBlue \x3d vec3(0.0, 0.0, 0.0);\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"atmosphereComputeSampleContribution"\x3e\x3c![CDATA[\r\n          float fHeight \x3d length(v3SamplePoint);\r\n          vec2 v2Depth \x3d exp(v2ScaleOverScaleDepth * (fInnerRadius - fHeight));\r\n#ifdef HAZE\r\n          vec2 v2Scatter \x3d v2Depth*v2ScaledValuesDepth-v2CameraOffset;\r\n#else\r\n          float fLightAngle \x3d dot(v3LightDir, v3SamplePoint) / fHeight;\r\n          float fCameraAngle \x3d dot(worldSpaceRay, v3SamplePoint) / fHeight;\r\n          float fTempScaledValues \x3d scale(fLightAngle) - scale(fCameraAngle);\r\n          vec2 v2Scatter \x3d v2CameraOffset + fTempScaledValues*v2Depth* v2ScaleDepth;\r\n#endif\r\n          v3Attenuate \x3d exp(-v2Scatter.x * v3InvWavelengthScaled);\r\n          v3AttenuateBlue \x3d exp(-v2Scatter.y * v3InvWavelengthScaled);\r\n\r\n          v3FrontColor +\x3d v3Attenuate * v2Depth.x;\r\n          v3FrontColorBlue +\x3d v3AttenuateBlue * v2Depth.y;\r\n\r\n          v3SamplePoint +\x3d v3SampleRay;\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"atmosphereComputeHDRColors"\x3e\x3c![CDATA[\r\n        //Phase computation\r\n        //clamp to avoid numerical instability at fCos \x3d\x3d -1.0 (and close values) to display fake sun\r\n        float fCos \x3d clamp(dot(v3LightDir, -worldSpaceRay ),-0.9999999,1.0);\r\n        float fOnePlusCos2 \x3d fCos*fCos + 1.0;\r\n#ifdef HAZE\r\n        // Finally, scale the Rayleigh colors and set up the varying variables for the pixel shader\r\n        vec3 colorCoefficients \x3d (fScaledLength* 0.75 * fOnePlusCos2)*(fKrESun*v3InvWavelength+fKmESun);\r\n\r\n        //Scaled Length is only applied afterwards to save multiplications\r\n        vec3 v3Color \x3d colorCoefficients *v3FrontColor;\r\n        vec3 v3ColorBlue \x3d colorCoefficients *v3FrontColorBlue;\r\n#else\r\n        vec3 v3RayleighCoefficients \x3d (fScaledLength*0.75 * fOnePlusCos2*fKrESun)*v3InvWavelength;\r\n        float fMieCoefficients \x3d fScaledLength*fKmESun * fMiePhaseCoefficients * fOnePlusCos2 / pow(1.0 + g2 - 2.0*g*fCos, 1.5);\r\n\r\n        // Calculate the attenuation factor for the ground\r\n        vec3 v3Color \x3d v3RayleighCoefficients * v3FrontColor + fMieCoefficients * v3FrontColor;\r\n        vec3 v3ColorBlue \x3d v3RayleighCoefficients * v3FrontColorBlue + fMieCoefficients * v3FrontColorBlue;\r\n#endif\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"atmosphereComputePixelColor"\x3e\x3c![CDATA[\r\n\r\n\r\n        //HDR to LDR conversion\r\n        vec3 ldrBlue \x3d expTM(v3ColorBlue,2.0*fExposure);\r\n        vec3 ldrRed \x3d expTM(v3Color,fExposure);\r\n\r\n        //mix reddish and blueish atmosphere\r\n        vec3 LDR \x3d mix(ldrBlue,ldrRed,0.2);\r\n#ifdef HAZE\r\n        LDR *\x3d (1.0-fCameraAngle);\r\n        vec3 hsv \x3d rgb2hsv(LDR);\r\n        hsv.y \x3d clamp(hsv.y*1.5,0.0,1.0);//boost haze saturation by 50%\r\n        LDR \x3d hsv2rgb(hsv);\r\n        vec3 finalColor \x3d LDR;\r\n        // when rendering we specify the blend functions such that\r\n        // newDestColor \x3d oldDestColor*(1.0-finalColor) + finalColor\r\n#else\r\n        //reinhard tonemapper for looking upwards\r\n        vec3 ldrReinhard \x3d reinhardTM(v3Color,fExposure);\r\n        LDR +\x3d angleMultiplier*ldrReinhard;\r\n\r\n        //height dependent parameter to smooth out reddish atmosphere\r\n        float side \x3d (rayEndT+rayStartT)*0.5;\r\n        float atmoHeight \x3d sqrt(fCameraHeight2 - side*side);\r\n        float h2 \x3d clamp(1.0-(atmoHeight-fLowerAlphaBlendBound)/(fOuterRadius-fLowerAlphaBlendBound),0.0,1.0);\r\n\r\n        vec3 finalColor \x3d LDR*h2;\r\n        vec3 hsv \x3d rgb2hsv(finalColor);\r\n        hsv.y \x3d clamp(hsv.y*1.5,0.0,1.0);//boost sky saturation by 50%\r\n        finalColor \x3d hsv2rgb(hsv);\r\n#endif\r\n#ifdef PLANAR\r\n#ifndef HAZE\r\n        float alpha \x3d clamp(fCameraHeight-fInnerRadius,7000.0,30000.0);\r\n        alpha \x3d alpha / (30000.0-7000.0);\r\n        gl_FragColor \x3d vec4(finalColor, 1.0-alpha);\r\n#else\r\n        float alpha \x3d clamp(fCameraHeight-fInnerRadius,0.0,16500.0);\r\n        alpha \x3d alpha / (16500.0-0.0);\r\n        gl_FragColor \x3d vec4(finalColor, 1.0-alpha);\r\n#endif\r\n#else\r\n#ifndef HAZE\r\n        float alpha \x3d clamp(fCameraHeight-fInnerRadius,7000.0,30000.0);\r\n        alpha \x3d alpha / (30000.0-7000.0);\r\n        float atmosStrength \x3d clamp((length(ldrRed)-0.05)*1.05,0.0,1.0);\r\n        gl_FragColor \x3d vec4(finalColor, atmosStrength*clamp(1.0-(atmoHeight-fInnerRadius)/(fOuterRadius-fInnerRadius),0.0,1.0));\r\n#else\r\n        gl_FragColor \x3d vec4(finalColor, 1.0);\r\n#endif\r\n#endif\r\n\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c!--Fragment Shader for Atmosphere--\x3e\r\n\x3csnippet name\x3d"fsRealisticAtmosphere"\x3e\x3c![CDATA[\r\n\r\n  precision mediump  float;\r\n\r\n$atmosphereUniformsConstantsVaryings\r\n\r\n$atmosphereScaleFunction\r\n\r\n  //Conversion implementation found in util.xml\r\n$rgba2float\r\n\r\n\r\n$toneMapperConstants\r\n$exponentialToneMapper\r\n#ifndef HAZE\r\n$reinhardToneMapper\r\n#endif\r\n\r\n$HSVColorSpace\r\n\r\n  void main()\r\n  {\r\n\r\n    $atmospherePrecomputation\r\n\r\n    //Inside Atmosphere\r\n    if (det \x3e\x3d 0.0){\r\n\r\n      $atmosphereDiscardPixels\r\n\r\n      if(continueComputation){\r\n\r\n        $atmosphereUnpackAddUniforms\r\n\r\n        $atmosphereComputeRayAndLoopSetup\r\n\r\n        // Now loop through the sample rays\r\n        for(int i\x3d0; i\x3cmaxSamples; i++)\r\n        {\r\n          $atmosphereComputeSampleContribution\r\n        }\r\n\r\n        $atmosphereComputeHDRColors\r\n\r\n        $atmosphereComputePixelColor\r\n\r\n        //Debug variable overlay\r\n        if(showTest\x3e0.0){\r\n          gl_FragColor \x3d vec4(test,1.0);\r\n        }\r\n\r\n      } else {//Not on surface\r\n        gl_FragColor \x3d vec4(0.0);\r\n      }\r\n    } else {//Outside Atmosphere\r\n      gl_FragColor \x3d vec4(0.0);\r\n    }\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/environment/materials/StarMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderStar"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tuniform vec4 viewport;\r\n\r\n\tattribute vec3 $position;\r\n\tattribute vec4 $color;\r\n  attribute float $size;\r\n\r\n\tvarying vec4 vcolor;\r\n\tvarying float vsize;\r\n\r\n\t$matchPixelCenter\r\n\r\n\tvoid main(void) {\r\n\t\tvec4 posProj \x3d proj * view * model*vec4($position*1.0e25,1.0);//move infinitely far away\r\n\t\tgl_Position \x3d matchPixelCenter(posProj, viewport.zw); //pixel align position\r\n    gl_Position.z \x3d gl_Position.w; // project atmosphere onto the far plane\r\n\t\tvcolor \x3d $color/1.2;\r\n\t\tvsize \x3d size*5.0;\r\n\t\tgl_PointSize \x3d vsize;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderStar"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tvarying vec4 vcolor;\r\n\tvarying float vsize;\r\n\r\n\tvoid main() {\r\n\t\tfloat cap \x3d 0.7;\r\n\t\tfloat scale \x3d 1.0/cap;\r\n\t\tfloat helper \x3d clamp(length(abs(gl_PointCoord-vec2(0.5))),0.0,cap);\r\n\t\tfloat alpha \x3d clamp((cap-helper)*scale,0.0,1.0);\r\n\t\tfloat intensity \x3d alpha*alpha*alpha;\r\n\t\tif (vsize \x3c 3.0)\r\n\t\t\tintensity *\x3d 0.5;\r\n\t\tgl_FragColor \x3d vec4(1.0,1.0,1.0,intensity);\r\n\t\tgl_FragColor.xyz *\x3d vcolor.xyz;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/terrain/TerrainMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vsTerrain"\x3e\x3c![CDATA[\r\n  precision mediump float;\r\n\r\n  uniform mat4 proj;\r\n  uniform mat4 view;\r\n  uniform vec3 origin;\r\n  uniform vec2 texOffset;\r\n  uniform float texScale;\r\n  uniform mat4 viewNormal;\r\n\r\n  attribute vec3 $position;\r\n  attribute vec2 $uv0;\r\n  varying vec2 vtc;\r\n  varying vec3 vpos;\r\n  varying vec3 vnormal;\r\n\r\n#if defined(WIREFRAME) || defined(TILE_BORDERS)\r\n  varying vec2 vuv;\r\n#endif\r\n\r\n#ifdef ATMOSPHERE\r\n  uniform vec3 lightDirection;\r\n  varying vec3 wpos;\r\n  varying vec3 wview;\r\n  varying vec3 wnormal;\r\n  varying vec3 wlight;\r\n#endif\r\n\r\n#ifdef OVERLAY\r\n  uniform vec2 overlayTexOffset;\r\n  uniform vec2 overlayTexScale;\r\n  varying vec2 vtcOverlay;\r\n#endif\r\n\r\n  void main(void) {\r\n    vpos \x3d $position;\r\n\r\n#ifdef SPHERICAL\r\n    vnormal \x3d normalize(vpos + origin);\r\n#else\r\n    vnormal \x3d vec3(0, 0, 1); // WARNING: up-axis dependent code\r\n#endif\r\n\r\n#ifdef ATMOSPHERE\r\n    wpos \x3d (view * vec4(vpos, 1.0)).xyz;\r\n    wnormal \x3d (viewNormal * vec4(normalize(vpos+origin), 1.0)).xyz;\r\n    wlight \x3d (view  * vec4(lightDirection, 1.0)).xyz;\r\n#endif\r\n\r\n#if defined(WIREFRAME) || defined(TILE_BORDERS)\r\n    vuv \x3d $uv0;\r\n#endif\r\n\r\n    gl_Position \x3d proj * view * vec4(vpos, 1.0);\r\n    vtc \x3d $uv0*texScale + texOffset;\r\n\r\n#ifdef OVERLAY\r\n    vtcOverlay \x3d $uv0*overlayTexScale + overlayTexOffset;\r\n#endif\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsTerrainCommon"\x3e\x3c![CDATA[\r\n  uniform vec3 lightDirection;\r\n  uniform vec3 viewDirection;\r\n  uniform sampler2D depthTex;\r\n  uniform int shadowMapNum;\r\n  uniform vec4 shadowMapDistance;\r\n  uniform mat4 shadowMapMatrix[4];\r\n  uniform float depthHalfPixelSz;\r\n  uniform sampler2D ssaoTex;\r\n  uniform vec4 viewportPixelSz;\r\n  uniform sampler2D tex;\r\n  uniform float opacity;\r\n\r\n  varying vec3 vpos;\r\n  varying vec3 vnormal;\r\n  varying vec2 vtc;\r\n\r\n#if defined(WIREFRAME) || defined(TILE_BORDERS)\r\n  varying vec2 vuv;\r\n#endif\r\n\r\n#ifdef ATMOSPHERE\r\n  varying vec3 wpos;\r\n  varying vec3 wview;\r\n  varying vec3 wnormal;\r\n  varying vec3 wlight;\r\n#endif\r\n\r\n  const vec3 ambient \x3d vec3(0.2,0.2,0.2);\r\n  const vec3 diffuse \x3d vec3(0.8,0.8,0.8);\r\n  const float diffuseHardness \x3d 2.5;\r\n\r\n#ifdef OVERLAY\r\n  uniform sampler2D overlayTex;\r\n  uniform float overlayOpacity;\r\n  varying vec2 vtcOverlay;\r\n#endif\r\n\r\n#ifdef RECEIVE_SHADOWS\r\n\t$evalShadow\r\n#endif\r\n\r\n  float lum(vec3 c) {\r\n    float max \x3d max(max(c.r, c.g), c.b);\r\n    float min \x3d min(min(c.r, c.g), c.b);\r\n    return (min + max) * 0.5;\r\n  }\r\n\r\n#ifdef ATMOSPHERE\r\n  vec3 atmosphere(vec3 lightPos, vec3 normal, vec3 view) {\r\n    vec3 surfaceColor   \x3d vec3(0.0);\r\n    vec3 fuzzySpecColor \x3d vec3(1.0);\r\n    vec3 subColor       \x3d vec3(0.0);\r\n    float rollOff       \x3d 1.0;\r\n\r\n    vec3 Ln \x3d normalize(lightPos);\r\n    vec3 Nn \x3d normalize(normal);\r\n    vec3 Hn \x3d normalize(view + Ln);\r\n\r\n    float ldn \x3d dot(Ln, Nn);\r\n    float diffComp \x3d max(0.0, ldn);\r\n    float vdn \x3d 1.0 - dot(view, Nn);\r\n    float ndv \x3d dot(view, Ln);\r\n\r\n    vec3 diffContrib \x3d surfaceColor * diffComp;\r\n    float subLamb \x3d max(0.0, smoothstep(-rollOff, 1.0, ldn) - smoothstep(0.0, 1.0, ldn));\r\n\r\n    vec3 subContrib \x3d subLamb * subColor;\r\n    vec3 vecColor \x3d vec3(vdn);\r\n\r\n    vec3 diffuseContrib \x3d (subContrib + diffContrib);\r\n    vec3 specularContrib \x3d (vecColor * fuzzySpecColor);\r\n\r\n    return (diffContrib + specularContrib) * rollOff;\r\n  }\r\n#endif\r\n\r\n  void main() {\r\n    vec3 a \x3d ambient;\r\n\r\n    float shadow \x3d 0.0;\r\n#ifdef RECEIVE_SHADOWS\r\n    shadow \x3d evalShadow(vpos, 1.0 / gl_FragCoord.w, depthTex, shadowMapNum, shadowMapDistance, shadowMapMatrix, depthHalfPixelSz);\r\n#endif\r\n    float vndl \x3d dot(normalize(vnormal), lightDirection);\r\n    float k \x3d smoothstep(0.0, 1.0, clamp(vndl*diffuseHardness, 0.0, 1.0));\r\n    vec3 d \x3d (1.0 - shadow/1.8) * diffuse * k;\r\n\r\n    float ssao \x3d viewportPixelSz.w \x3c .0 ? 1.0 : texture2D(ssaoTex, (gl_FragCoord.xy - viewportPixelSz.xy) * viewportPixelSz.zw).a;\r\n    vec4 texCol \x3d texture2D(tex, vtc);\r\n\r\n#ifdef OVERLAY\r\n    if ((vtcOverlay.x \x3e 0.0) \x26\x26 (vtcOverlay.y \x3e 0.0) \x26\x26 (vtcOverlay.x \x3c 1.0) \x26\x26 (vtcOverlay.y \x3c 1.0)) {\r\n      vec4 overlayTexCol \x3d texture2D(overlayTex, vtcOverlay);\r\n      overlayTexCol *\x3d overlayOpacity;\r\n      texCol \x3d texCol * (1.0 - overlayTexCol.a) + overlayTexCol; // texCol and overlayTexCol have pre-multiplied alpha\r\n    }\r\n#endif\r\n\r\n    vec3 atm \x3d vec3(0.0);\r\n#ifdef ATMOSPHERE\r\n    float ndotl \x3d max(0.0, min(1.0, vndl));\r\n    atm \x3d atmosphere(wlight, wnormal, -viewDirection);\r\n    atm *\x3d max(0.0, min(1.0, (1.0-lum(texCol.rgb)*1.5))); //avoid atmosphere on bright base maps\r\n    atm *\x3d max(0.0, min(1.0, ndotl*2.0)); // avoid atmosphere on dark side of the globe\r\n#endif\r\n\r\n    vec3 color \x3d atm + texCol.rgb * (a + d) * ssao;\r\n    gl_FragColor \x3d vec4(color, texCol.a) * opacity;\r\n\r\n  // closing } is missing here, it\'s in the shaders using this snippet below\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsTerrainWireframe"\x3e\x3c![CDATA[\r\n#ifdef GL_OES_standard_derivatives\r\n#extension GL_OES_standard_derivatives : enable\r\n#endif\r\n\r\n  precision mediump float;\r\n\r\n  struct WireframeSettings {\r\n    float width;\r\n    float falloff;\r\n    float subdivision;\r\n    vec4 color;\r\n    float wireOpacity;\r\n    float surfaceOpacity;\r\n    float near;\r\n    float far;\r\n  };\r\n\r\n  uniform WireframeSettings wireframe;\r\n\r\n    $fsTerrainCommon\r\n\r\n    vec2 dVuv;\r\n    vec2 vuvScaled \x3d vuv * wireframe.subdivision;\r\n    vec2 vuvMod \x3d fract(vuvScaled);\r\n\r\n#ifdef GL_OES_standard_derivatives\r\n    dVuv \x3d fwidth(vuvScaled);\r\n#else\r\n    // Something that reasonably works\r\n    dVuv \x3d vec2(0.05);\r\n#endif\r\n\r\n    vec2 edgeFactors \x3d smoothstep((wireframe.width - wireframe.falloff) * dVuv,\r\n                                  wireframe.width * dVuv, min(vuvMod, 1.0 - vuvMod));\r\n\r\n    float edgeFactor \x3d 1.0 - min(edgeFactors.x, edgeFactors.y);\r\n\r\n#ifdef WIREFRAME\r\n    gl_FragColor \x3d vec4(mix(gl_FragColor.rgb, wireframe.color.rgb, edgeFactor * wireframe.color.a),\r\n                        mix(wireframe.surfaceOpacity, wireframe.wireOpacity, edgeFactor));\r\n#endif\r\n\r\n\r\n#ifdef TILE_BORDERS\r\n    dVuv \x3d fwidth(vuv);\r\n    edgeFactors \x3d smoothstep((wireframe.width - wireframe.falloff) * dVuv,\r\n                              wireframe.width * dVuv, min(vuv, 1.0 - vuv));\r\n    edgeFactor \x3d 1.0 - min(edgeFactors.x, edgeFactors.y);\r\n\r\n    gl_FragColor \x3d mix(gl_FragColor, vec4(1.0, 0.0, 0.0, 1.0), edgeFactor);\r\n#endif\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsTerrain"\x3e\x3c![CDATA[\r\n  precision mediump float;\r\n\r\n    $fsTerrainCommon\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsTerrainNormal"\x3e\x3c![CDATA[\r\n  uniform vec3 origin;\r\n  uniform mat4 proj;\r\n  uniform mat4 view;\r\n  uniform mat4 viewNormal;\r\n  attribute vec3 $position;\r\n  varying vec3 vnormal;\r\n\r\n  void main(void) {\r\n#ifdef SPHERICAL\r\n    vec4 normal \x3d vec4(normalize($position + origin), 1.0);\r\n#else\r\n    vec4 normal \x3d vec4(0.0, 1.0, 0.0, 1.0);\r\n#endif\r\n\r\n    gl_Position \x3d proj * view * vec4($position, 1.0);\r\n    vnormal \x3d normalize((viewNormal * normal).xyz);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsTerrainDepthOnly"\x3e\x3c![CDATA[\r\n  precision mediump float;\r\n\r\n  uniform mat4 proj;\r\n  uniform mat4 view;\r\n\r\n  attribute vec3 $position;\r\n\r\n  void main() {\r\n    gl_Position \x3d proj * view * vec4($position, 1.0);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsTerrainDepthOnly"\x3e\x3c![CDATA[\r\n  precision mediump float;\r\n\r\n  void main() {\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"*now":function(m){m(['dojo/i18n!*preload*esri/views/nls/SceneView*["ar","ca","cs","da","de","el","en-gb","en-us","es-es","fi-fi","fr-fr","he-il","hu","it-it","ja-jp","ko-kr","nl-nl","nb","pl","pt-br","pt-pt","ru","sk","sl","sv","th","tr","zh-tw","zh-cn","ROOT"]'])},"*noref":1}});
define("../core/accessorSupport/watch dojo/_base/lang dojo/_base/kernel dojo/dom dojo/Deferred dojo/when ./View ./DOMContainer ./ViewAnimation ./animation/easing ../geometry/SpatialReference ../geometry/support/webMercatorUtils ../Camera ../Graphic ../geometry/Point ../geometry/Extent ../geometry/ScreenPoint ../Viewpoint ../core/Scheduler ../core/sniff ../core/watchUtils ../core/promiseUtils ../core/Error ../core/Logger ../core/HandleRegistry ../webscene/Environment ./support/screenshotUtils ./3d/environment/SceneViewEnvironment ./3d/environment/SceneViewEnvironmentManager ./3d/constraints/SceneViewConstraints ./3d/input/SceneInputManager ./3d/lib/glMatrix ./3d/support/cameraUtils ./3d/support/viewpointUtils ./3d/support/projectionUtils ./3d/webgl-engine/Stage ./3d/webgl-engine/lib/Selector ./3d/support/RenderCoordsHelper ./3d/support/MapCoordsHelper ./3d/support/ResourceController ./3d/support/DisplayQualityProfile ./3d/support/QualitySettings ./3d/support/SharedSymbolResources ./3d/support/debugFlags ./3d/terrain/TerrainSurface ./3d/terrain/terrainUtils ./3d/layers/graphics/LabelManager ./3d/layers/GraphicsView3D ./3d/navigation/spherical/NavigationSpherical ./3d/navigation/planar/NavigationPlanar ./3d/support/Frustum ./ui/3d/DefaultUI3D".split(" "),function(m,
k,b,a,c,h,g,d,e,l,f,n,u,t,r,w,q,x,y,z,A,C,B,D,H,K,E,F,L,Q,N,J,P,I,O,ea,W,fa,X,aa,R,ia,ga,ha,la,da,Y,V,ba,T,U,Z){function G(a,b){return function(){return this._internallyReady?b.apply(this,arguments):this._get(a)}}function ja(a,b){return function(c){if(this._internallyReady)return b.apply(this,arguments);this._initialProps[a]=c;this._set(a,c);wa[a]&&this.notifyChange("initialExtentRequired")}}var S=D.getLogger("esri.views.SceneView"),ca=J.vec3d,p=ca.create();D=new r(0,0,0);var qa=new u(new r(0,0,0)),
Ca={point:D,retval:null},ma={heading:0,tilt:0},wa={camera:["viewpoint"],viewpoint:["extent"],extent:["center","scale"],scale:["zoom"],center:[],zoom:[]},Da=Object.keys(wa);return d.createSubclass([g],{declaredClass:"esri.views.SceneView",properties:{animation:{type:e,value:null},basemapTerrain:{readOnly:!0,value:null},camera:{copy:function(a,b){a.position.x=b.position.x;a.position.y=b.position.y;a.position.z=b.position.z;a.position.spatialReference=b.position.spatialReference;a.heading=b.heading;
a.tilt=b.tilt},type:u},canvas:{readOnly:!0,value:null},center:{copy:function(a,b){if(!a)return b.clone();a.x=b.x;a.y=b.y;a.z=b.z;a.spatialReference=b.spatialReference;return a},type:r},clippingArea:{type:w,dependsOn:["map.clippingArea","map.clippingEnabled","viewingMode"],get:function(){if("global"===this.viewingMode)return null;if(this._userClippingArea)return this._userClippingArea;var a=this.get("map.clippingEnabled"),b=this.get("map.clippingArea");if(!a||!b)return this._clippingArea=null;if(!(b instanceof
w))return console.error("Only clippingArea geometries of type Extent are supported"),this._clippingArea;if(n.canProject(b.spatialReference,this.spatialReference))b=n.project(b,this.spatialReference);else return console.error("Setting clippingArea with incompatible SpatialReference."),this._clippingArea;return this._clippingArea&&b&&this._clippingArea.equals(b)?this._clippingArea:this._clippingArea=b},set:function(a){this._userClippingArea=a;this._set("clippingArea",a)}},constraints:{type:Q,value:null},
dataExtent:{dependsOn:["basemapTerrain.extent","clippingArea","map"],readOnly:!0,get:function(){function a(a){a&&(a=n.project(a,c))&&(d&&(a=a.intersection(d)),a&&b.push(a))}var b=[],c=this.spatialReference||f.WGS84,d=this.clippingArea;d&&(d=n.project(d,c));var e=this._get("basemapTerrain");e&&e.spatialReference&&a(new w({xmin:e.extent[0],ymin:e.extent[1],zmin:0,xmax:e.extent[2],ymax:e.extent[3],zmax:0,spatialReference:e.spatialReference}));this.map&&this.map.allLayers.forEach(function(b){a(b.fullExtent)});
return 0<b.length?(e=b.reduce(function(a,b){return a.union(b)}),e.hasZ?(e.zmin=Math.min(0,e.zmin),e.zmax=Math.max(0,e.zmax)):(e.zmin=0,e.zmax=0),e):new w({xmin:0,ymin:0,zmin:0,xmax:0,ymax:0,zmax:0,spatialReference:c})}},environment:{value:null,set:function(a){a!==this._defaults.environment&&(this._externallySet.environment=!0);a?a instanceof F?this._set("environment",a):a instanceof K?this.environment.lighting=a.lighting:a.declaredClass?this._set("environment",a):this._set("environment",new F(a)):
this._set("environment",new F)}},environmentManager:{},extent:{copy:function(a,b){a.xmin=b.xmin;a.ymin=b.ymin;a.zmin=b.zmin;a.xmax=b.xmax;a.ymax=b.ymax;a.zmax=b.zmax;a.spatialReference=b.spatialReference},type:w},fullOpacity:1,groundExtent:{dependsOn:["basemapTerrain.extent"],readOnly:!0,get:function(){var a=this._get("basemapTerrain");if(a&&a.spatialReference){var b=a.extent;return new w({xmin:b[0],ymin:b[1],xmax:b[2],ymax:b[3],spatialReference:a.spatialReference})}return new w({spatialReference:this.spatialReference||
f.WGS84})}},initialExtentRequired:{dependsOn:["map.initialViewProperties.viewpoint"],get:function(){if(this.get("map.initialViewProperties.viewpoint"))return!1;for(var a=0;a<Da.length;a++)if(this._initialProps&&void 0!==this._initialProps[Da[a]])return!1;return!0}},interacting:{dependsOn:["navigation.interacting"],get:function(){return!(!this.navigation||!this.navigation.interacting)}},map:{value:null},mapCoordsHelper:{},navigation:{readOnly:!0,value:null},inputManager:{},qualityProfile:{set:function(a){R.isValidProfile(a)&&
(R.apply(a,this),this._set("qualityProfile",a))}},qualitySettings:{type:ia},ready:{dependsOn:["viewingMode"]},renderCoordsHelper:{},scale:{},spatialReference:{dependsOn:["map.initialViewProperties.spatialReference","defaultsFromMap.isDone"]},type:"3d",ui:{type:Z},updating:{},updatingPercentage:0,viewingMode:{dependsOn:["map.initialViewProperties.viewingMode","spatialReference"],get:function(){var a=this.get("map.initialViewProperties.viewingMode"),b=this.spatialReference;a||(a=!b||b.isWebMercator||
b.isWGS84?"global":"local");return a},set:function(a){if(-1!==["local","global"].indexOf(a)){var b=this._get("viewingMode")===a;this._override("viewingMode",a);b&&!this.get("map.initialViewProperties.viewingMode")&&this._internallyReady&&this._initGlobe(this.viewingMode)}else void 0===a&&this._clearOverride("viewingMode")}},viewpoint:{copy:function(a,b){a.rotation=b.rotation;a.scale=b.scale;a.targetGeometry=b.targetGeometry;a.camera=b.camera},dependsOn:["camera"],type:x},zoom:{dependsOn:["scale"]}},
getDefaults:function(a){var b=this.inherited(arguments);b.constraints||a.constraints||(this._defaults.constraints=new Q,b.constraints=this._defaults.constraints);b.environment||a.environment||(this._defaults.environment=new F,b.environment=this._defaults.environment);b.popup.autoPanEnabled=!1;b.qualitySettings=new ia;b.qualityProfile=R.getDefaultProfile();return b},constructor:function(){A.when(this,"ready",this._viewReadyHandler.bind(this));this._internallyReady=!1;this._initialProps={};this._initialDefaultSpatialReference=
this._gotoTask=this._userClippingArea=null;this._initCoordinateSystem();this._frustum=new U;this._clippingArea=this._constraints=this._animationStateWatcher=null;this.inputManager=new N({view:this});this._defaults={};this._externallySet={};this.resourceController=new aa(this);this.labelManager=new Y(this);this._evaluateUpdating=this._evaluateUpdating.bind(this);this._layerViewsUpdatingHandles={};this._navigationHandles=new H;this._navigationPauseNotifications=!1;this._navigationHandles.add([A.on(this,
"navigation","currentViewChanged",this._navigationCurrentViewChanged.bind(this),null,null,!0),A.on(this,"navigation","currentViewReachedTarget",this._navigationCurrentViewReachedTarget.bind(this),null,null,!0),A.on(this,"navigation","targetViewChanged",function(a){this._navigationPauseNotifications||this._navigationTargetViewChanged(a)}.bind(this),null,null,!0),A.on(this,"navigation","animationStarted",function(a){this._navigationPauseNotifications||this._navigationAnimationStarted(a)}.bind(this),
null,null,!0)]);this.watch("map",function(a){a&&a.load&&a.load()})},initialize:function(){this.environmentManager=new L({view:this});this._updateUpdatingMonitorsHandle=this.allLayerViews.on("change",this._updateUpdatingMonitors.bind(this));this._updateUpdatingMonitors({added:this.allLayerViews.toArray(),removed:[],moved:[]});A.whenNot(this,"ready",this._viewUnreadyHandler.bind(this))},destroy:function(){m.dispatchTarget(this);this.environmentManager.destroy();this._disposeGraphicsView();this._updateUpdatingMonitorsHandle.remove();
this._updateUpdatingMonitorsHandle=null;this._navigationHandles.remove();this._navigationHandles=null;this.inputManager&&(this.inputManager.destroy(),this.inputManager=null)},destroyLayerViews:function(){for(var a in this._layerViewsUpdatingHandles)this._layerViewsUpdatingHandles[a].remove();this._layerViewsUpdatingHandles={};this._disposeSurface();this.inherited(arguments);this._stage&&(this._stage.dispose(),this._stage=null,this._forwardAASettingsHandle.remove(),this._forwardAASettingsHandle=null);
this._setCanvas(null);this.labelManager.destroy();this.labelManager=null;this.resourceController.destroy();this.resourceController=null},on:function(a,b,c){var d=this.inputManager.viewEvents.register(a,b,c);return d?d:this.inherited(arguments)},toMap:function(a,b,c){if(!this._internallyReady)return S.error("#toMap()","Scene view cannot be used before it is ready"),null;a=this._normalizePointArgs(a,b,void 0,c);b=this._stage.pick([a.point.x,this.height-a.point.y]).getMinResult();return this._computeMapPointFromIntersectionResult(b,
a.retval)},toScreen:function(a,b,c,d){if(!this._internallyReady)return S.error("#toScreen()","Scene view cannot be used before it is ready"),null;a=this._normalizePointArgs(a,b,c,d);O.pointToVector(a.point,p,this.renderSpatialReference);return this.engineToScreen(p,a.retval)},pixelSizeAt:function(a,b,c){if(!this._internallyReady)return S.error("#pixelSizeAt()","Scene view cannot be used before it is ready"),null;if("esri.geometry.ScreenPoint"===a.declaredClass){if(!this._stage.pick([a.x,this.height-
a.y]).getMinResult().getIntersectionPoint(p))return 0}else a=this._normalizePointArgs(a,b,c,void 0),O.pointToVector(a.point,p,this.renderSpatialReference);return this.navigation.currentCamera.computePixelSizeAt(p)},hitTest:function(a,b){if(!this._internallyReady)return S.error("#hitTest()","Scene view cannot be used before it is ready"),null;a=this._normalizePointArgs(a,b,void 0,void 0);var c=[a.point.x,this.height-a.point.y],d=this._stage.pick(c,null,!0);a=d.getMinResult();var e=this._computeMapPointFromIntersectionResult(a),
f;switch(a.targetType){case "None":f=null;break;case "StageObject":f=this._getGraphicFromStageObject(a.target,a.triangleNr);break;case "StagePoint":f=this._getGraphicFromStagePoint(a.target)}return h(f).otherwise(function(){return null}).then(function(a){var b=[];(a||e)&&b.push({mapPoint:e,graphic:a});a={screenPoint:c,results:b};ha.SCENEVIEW_HITTEST_RETURN_SELECTOR&&(a.selector=d);return a})},goTo:function(a,b){if(this._internallyReady)return b=k.mixin({animate:!0},b),a=I.create(this,a,b),this._gotoTask=
{},b.animate?this._gotoAnimated(a,b):this._gotoImmediate(a,b);S.error("#goTo()","Scene view cannot be used before it is ready")},animateTo:function(a,c){b.deprecated(this.declaredClass+".animateTo is deprecated. Use .goTo instead.","","4.0");return this.goTo(a,c)},takeScreenshot:function(a){if(this._internallyReady){a=E.adjustScreenshotSettings(a,this);var b=new c;this._stage.requestScreenCapture(a,function(a){y.schedule(function(){b.resolve(a)})});return b.promise}S.error("#takeScreenshot()","Scene view cannot be used before it is ready")},
engineToScreen:function(a,b){var c=ca.create();this._stage.getCamera().projectPoint(a,c);a=c[0];var d=this.height-c[1],c=c[2];return b?(b.x=a,b.y=d,b.z=c,b):new q({x:a,y:d,z:c})},getDefaultSpatialReference:function(){return this.get("map.initialViewProperties.spatialReference")||this.get("defaultsFromMap.spatialReference")||this.get("defaultsFromMap.isDone")&&this._initialDefaultSpatialReference||null},validate:function(){var a;z("esri-webgl")?z("safari")&&9>z("safari")&&(a=new B("sceneview:browser-not-supported",
"This browser is not supported by SceneView (Safari \x3c 9)",{type:"safari",requiredVersion:9,detectedVersion:z("safari")})):a=new B("sceneview:webgl-required","WebGL is required but not supported");return a?C.reject(a):C.resolve()},isSpatialReferenceSupported:function(a,b){var c=a.isGeographic,d=a.isWebMercator,e=a.isWGS84,f="local"===this.viewingMode,g=!(!this._isOverridden("viewingMode")&&!this.get("map.initialViewProperties.viewingMode"));if(g){if(f&&c||!f&&!d&&!e)return!1}else if(c&&!e)return!1;
if(b)if(da.isTiledLayer(b)){if(g?null!=da.checkIfTileInfoSupportedForView(b.tileInfo,b.fullExtent,a,this.viewingMode):null!=da.checkIfTileInfoSupportedForView(b.tileInfo,b.fullExtent,a,"local")&&null!=da.checkIfTileInfoSupportedForView(b.tileInfo,b.fullExtent,a,"global"))return!1}else if((e||d)&&!f)return null==this._initialDefaultSpatialReference&&(this._initialDefaultSpatialReference=a),g||this.ready||(this.viewingMode="global"),!1;return!0},has:function(a){return this._stage.has(a)},flushDisplayModifications:function(){this._stage.processDirty()},
getFrustum:function(){this._frustum.dirty&&this._frustum.update(this.navigation.currentCamera);return this._frustum},getDrawingOrder:function(a){return this.allLayerViews.findIndex(function(b){return b.layer&&b.layer.uid===a})},getViewForGraphic:function(a){return a.layer?this.allLayerViews.find(function(b){return b.layer===a.layer}):this._graphicsView},whenViewForGraphic:function(a){return a.layer?this.whenLayerView(a.layer):C.resolve(this._graphicsView)},renderSpatialReference:null,_graphicsView:null,
_surfaceReadyWatchHandle:null,_forwardAASettingsHandle:null,_gotoImmediate:function(a,b){var c=this._gotoTask;return a.then(function(a){c===this._gotoTask&&(this.viewpoint=a)}.bind(this))},_gotoAnimated:function(a,b){!this.animation||"running"!==this.animation.state&&"waiting-for-target"!==this.animation.state?this.animation=new e({target:a}):this.animation.target=a;var c=this.animation;c.state="waiting-for-target";a.then(function(d){if(c.target===a&&this.animation===c){c.target=d;c.state="running";
d=I.toCamera(this,d);if(!d)throw S.error("#goTo()","Invalid target specified for animateTo"),new B("goto:invalid-camera","Invalid camera in conversion from viewpoint");this._cameraAlmostEquals(this.camera,d)?c.finish():(d=P.externalToInternal(this,d),d.almostEquals(this.navigation.currentCamera,5E-4/this.renderCoordsHelper.unitInMeters)?c.finish():(this._navigationPauseNotifications=!0,this._setInternalCamera(d,this._animateOptions(b)),c.state===e.State.STOPPED&&c.stop(),this._navigationPauseNotifications=
!1))}}.bind(this)).otherwise(function(){c.target===a&&this.animation===c&&(this.animation=null,c.finish())});return c},_animateOptions:function(a){var b={animate:!0};a&&null!=a.speedFactor&&(b.speedFactor=a.speedFactor);a&&null!=a.duration&&(b.duration=a.duration/1E3);a&&null!=a.minDuration&&(b.minDuration=a.minDuration/1E3);a&&null!=a.maxDuration&&(b.maxDuration=a.maxDuration/1E3);a&&null!=a.easing&&(b.easing="string"===typeof a.easing?l.named[a.easing]:a.easing);return b},_trackCanvasSize:function(){this.on("resize",
function(a){if(this.canvas){this.canvas.width=a.width;this.canvas.height=a.height;var b=this._stage.getCamera();b.width=a.width;b.height=a.height;this._stage.setCamera(b);this.navigation&&(this.navigation.windowSize=[a.width,a.height])}}.bind(this));this.canvas.width=this.width;this.canvas.height=this.height},_computeMapPointFromIntersectionResult:function(a,b){if(a.getIntersectionPoint(p)){b=this._computeMapPointFromVec3d(p,b);var c=this._get("basemapTerrain");"terrain"===a.intersector&&c&&(a=c.getElevation(b),
null!==a&&(b.z=a));return b}return null},_computeMapPointFromVec3d:function(a,b){var c=this.spatialReference||f.WGS84;O.vectorToVector(a,this.renderSpatialReference,a,c)||(c=f.WGS84,O.vectorToVector(a,this.renderSpatialReference,a,c));b?(b.x=a[0],b.y=a[1],b.z=a[2],b.spatialReference=c):b=new r(a,c);return b},_getGraphicFromStageObject:function(a,b){var c=a.getMetadata();if(null!=c&&null!=c.layerId){if(c.layerId===this._graphicsView.mockLayerId)return this._graphicsView.getGraphicsFromStageObject(a,
b);if(c=this.map.findLayerById(c.layerId))return this.whenLayerView(c).then(function(c){if(c&&null!=c.getGraphicsFromStageObject&&!c.suspended)return c.getGraphicsFromStageObject(a,b)})}return null},_getGraphicFromStagePoint:function(a){var b=this._computeMapPointFromVec3d(a.point),b=new t(b);a=a.metadata.layerId;null!=a&&(b.layer=this.map.findLayerById(a));return b},_viewingModeToManifold:function(a){return{local:"planar",global:"spherical"}[a]},_initBasemapTerrain:function(a){this._disposeBasemapTerrain();
this._set("basemapTerrain",new la(this,this._viewingModeToManifold(a)));this.navigation.elevationProvider=this._get("basemapTerrain")},_initGlobe:function(a){this._initCoordinateSystem();this._initNavigation(a);this._stage.setViewParams({backgroundColor:[0,0,0,0],maxFarNearRatio:0,frustumCullingEnabled:!1});this._initBasemapTerrain(a);this._navigationCurrentViewChanged({camera:this.navigation.currentCamera})},_initCoordinateSystem:function(){if(this.spatialReference){var a=this.spatialReference;this.mapCoordsHelper&&
this.mapCoordsHelper.spatialReference.equals(a)||(this.mapCoordsHelper=new X(this.map,a));var b=this.renderCoordsHelper?this.renderCoordsHelper.unitInMeters:1,c="global"===this.viewingMode,a=c?O.SphericalRenderSpatialReference:a;a!==this.renderSpatialReference&&(this.renderSpatialReference=a,this.renderCoordsHelper=new (c?fa.Spherical:fa.Planar)(a),this._stage&&this._stage.setIntersectTolerance(W.DEFAULT_TOLERANCE/this.renderCoordsHelper.unitInMeters),this._constraints&&this._constraints.scale(b/
this.renderCoordsHelper.unitInMeters))}else this.renderSpatialReference=this.renderCoordsHelper=this.mapCoordsHelper=null},_paddingEqualsArray:function(a){var b=this.padding;return b?b.top===a[0]&&b.right===a[1]&&b.bottom===a[2]&&b.left===a[3]:!0},_navigationCurrentViewChanged:function(a){this._frustum.dirty=!0;a=a.camera;var b=a.padding,c=this._get("basemapTerrain"),d=c.spatialReference;d&&(d=this.renderCoordsHelper.fromRenderCoords(a.eye,d),c=c.getElevation(d)||0,a.aboveGround=d.z>=c);this._paddingEqualsArray(b)||
(c=this._padding,b={top:b[0],right:b[1],bottom:b[2],left:b[3]},this._internallyReady?(this._padding=b,this.notifyChange("padding",c,b)):this.padding=b);this._stage.setCamera(a);this.notifyChange("center");this.notifyChange("extent");this.notifyChange("scale");b=this.camera;a=P.internalToExternal(this,a,qa);b&&this._cameraAlmostEquals(b,a)||this.notifyChange("camera")},_cameraAlmostEquals:function(a,b){return 1E-5>Math.abs(a.tilt-b.tilt)&&1E-5>Math.abs(a.heading-b.heading)&&1E-5>Math.abs(a.fov-b.fov)&&
a.position.equals(b.position)},_navigationAnimationStarted:function(a){a=I.fromInternalCamera(this,this.navigation.targetCamera);this.animation?this.animation.target=a:this.animation=new e({target:a})},_navigationTargetViewChanged:function(a){if(this.animation&&"waiting-for-target"!==this.animation.state){a=a.camera;var b=this.spatialReference||f.WGS84,c=P.internalToExternal(this,a);a=new x({camera:c,targetGeometry:O.vectorToPoint(a.center,b,this.renderSpatialReference),scale:P.computeScale(this,
a),rotation:I.headingToRotation(c.heading)});this.animation.target=a}},_navigationCurrentViewReachedTarget:function(a){if(a.interruptedAnimation||a.finishedAnimation)this._gotoTask=null;if(this.animation&&(a.interruptedAnimation||a.finishedAnimation)){this._animationStateWatcher&&(this._animationStateWatcher.remove(),this._animationStateWatcher=null);var b=this.animation;this.animation=null;a.finishedAnimation?b.finish():b.stop();this.notifyChange("animation")}},_setInternalCamera:function(a,b){a&&
(this.navigation.setCamera(a,b),this._externallySet.camera=!0);return!!a},_setCamera:function(a,b){return this._setInternalCamera(P.externalToInternal(this,a),b)},_evaluateUpdating:function(){var a=0,b=0,c=!1;this.allLayerViews.forEach(function(d){d.updating&&(c=!0,d=d.updatingPercentage,null!=d&&(++b,a+=d))});this._graphicsView&&this._graphicsView.updating&&(c=!0);c!==this.updating&&(this.updating=c);a=0!==b?a/b:c?100:0;this.updatingPercentage!==a&&(this.updatingPercentage=a)},_updateUpdatingMonitors:function(a){for(var b=
0;b<a.removed.length;b++){var c=a.removed[b],d=this._layerViewsUpdatingHandles[c.id];d&&(delete this._layerViewsUpdatingHandles[c.id],d.remove())}for(b=0;b<a.added.length;b++)c=a.added[b],c.destroyed||(d=c.watch(["updating","updatingPercentage"],this._evaluateUpdating),this._layerViewsUpdatingHandles[c.id]=d);this._evaluateUpdating()},_spatialReferenceSetter:function(a){this.inherited(arguments);this._initCoordinateSystem()},_setInitialView:function(a){if(a&&!this._externallySet.camera){var b=null;
a instanceof x&&!a.camera&&a.targetGeometry instanceof w&&(b=I.rotationToHeading(a.rotation),a=a.targetGeometry);if(a instanceof x)this.viewpoint=a;else if(a instanceof u)this.camera=a;else{var c=this._getDesiredHeadingTilt();null!=b&&(c.heading=b);I.create(this,{target:a,heading:c.heading,tilt:c.tilt}).then(function(a){this.navigation._dataExtentChanged();this.viewpoint=a}.bind(this))}}},_pickRay:function(a,b,c,d,e,f,g){return this._stage?this._stage.pickRay(a,b,c,d,e,f,g):null},_pickRayWithBeginPoint:function(a,
b,c,d,e){return this._stage?this._stage.pickRayWithBeginPoint(a,b,c,d,e):null},_removeHandles:function(a){for(var b=0;b<a.length;b++){var c=a[b];this[c]&&(this[c].remove(),this[c]=null)}},_setCanvas:function(a){a!==this._get("canvas")&&this._set("canvas",a)},_disposeSurface:function(){this._removeHandles(["_stageFrameTask","_updateDrawingOrderHandle","onViewExtentUpdateHandle","_mapLayersChangeHandle"]);this._disposeBasemapTerrain();this._setNavigation(null);this.environmentManager&&this.environmentManager.disposeRendering()},
_disposeBasemapTerrain:function(){var a=this._get("basemapTerrain");a&&(a.destroy(),this._set("basemapTerrain",null))},_disposeNavigation:function(){var a=this._get("navigation");a&&(a.destroy(),a.elevationProvider=null,this._set("navigation",null))},_setNavigation:function(a){this._get("navigation")!==a&&(this._disposeNavigation(),a&&(a.windowSize=[this.width,this.height],a.userConstraints=this.constraints),this._set("navigation",a))},_initNavigation:function(a){a=a||this.viewingMode;var b={view:this};
"global"===a?this._setNavigation(new ba(b)):this._setNavigation(new T(b))},_initSurface:function(){var b={};b.deactivatedWebGLExtensions=this.deactivatedWebGLExtensions;this.renderCanvas&&(b.canvas=this.renderCanvas);this._stage=new ea(a.byId(this.surface),b);this._stage.selectionState=!1;this._forwardAASettingsHandle=A.init(this.qualitySettings,"antialiasingEnabled",function(){this._stage.setRenderParams({antialiasingEnabled:this.qualitySettings.antialiasingEnabled})}.bind(this));this.sharedSymbolResources=
new ga(this._stage,this.resourceController);this.renderCoordsHelper&&this._stage.setIntersectTolerance(W.DEFAULT_TOLERANCE/this.renderCoordsHelper.unitInMeters);this._setCanvas(this._stage.getCanvas());this._stageFrameTask=y.addFrameTask(this._stage.getFrameTask());this._trackCanvasSize();this._initGlobe(this.viewingMode)},_initGraphicsView:function(){this._surfaceReadyWatchHandle=A.whenTrueOnce(this,"basemapTerrain.ready",function(){this._graphicsView=new V({view:this,graphics:this.graphics});this._surfaceReadyWatchHandle=
null;this._layerViewsUpdatingHandles[this._graphicsView.mockLayerId]=A.init(this._graphicsView,"updating",this._evaluateUpdating)}.bind(this))},_disposeGraphicsView:function(){this._surfaceReadyWatchHandle&&(this._surfaceReadyWatchHandle.remove(),this._surfaceReadyWatchHandle=null);if(this._graphicsView){var a=this._graphicsView.mockLayerId;this._layerViewsUpdatingHandles[a].remove();delete this._layerViewsUpdatingHandles[a];this._graphicsView.destroy();this._graphicsView=null}},_normalizePointArgs:function(a,
b,c,d,e){e=e||Ca;var g=e.point;g.spatialReference=void 0;"object"===typeof a?(g.x=a.x,g.y=a.y,g.z=a.z,a.spatialReference&&(g.spatialReference=a.spatialReference),e.retval=b):(g.x=a,g.y=b,"number"!==typeof c&&void 0!==c?(g.z=void 0,e.retval=c):(g.z=c,e.retval=d));g.spatialReference||(g.spatialReference=this.spatialReference||f.WGS84);return e},_separateInitialProperties:function(){var a={},b={},c={},d=function(a){if(a=wa[a])for(var b=0;b<a.length;b++)c[a[b]]=!0,d(a[b])},e;for(e in this._initialProps){var f=
this._initialProps[e];wa[e]?(d(e),a[e]=f):b[e]=f}for(e in c)delete a[e];return{view:a,other:b}},_viewReadyHandler:function(a,b){if(!b){"global"===this.viewingMode&&(this._clippingArea=null);this._internallyReady=!0;this._initSurface();this._initGraphicsView();a=this._separateInitialProperties();for(var c in a.other)this.set(c,a.other[c]);for(c in a.view)this.set(c,a.view[c]);c=this.get("map.initialViewProperties.viewpoint");a=this.get("initialExtent");c?this._setInitialView(c):a&&a.spatialReference.equals(this.spatialReference)?
this._setInitialView(a):"local"===this.viewingMode&&A.whenOnce(this.basemapTerrain,"ready",function(){this._setInitialView(this.groundExtent)}.bind(this));!this._externallySet.environment&&(c=this.get("map.initialViewProperties.environment"))&&(this.environment=c);this._initialProps={};this.notifyChange("initialExtentRequired");this._updateDrawingOrderHandle=this.allLayerViews.on("change",this._updateDrawingOrder.bind(this));this._updateDrawingOrder({added:this.allLayerViews.toArray(),removed:[],
moved:[]});this.environmentManager.updateReadyChange(!0)}},_viewUnreadyHandler:function(a,b){b&&(this._initialDefaultSpatialReference=null,this.environmentManager.updateReadyChange(!1),this._disposeGraphicsView(),this._internallyReady=!1,this._disposeSurface(),this.sharedSymbolResources&&(this.sharedSymbolResources.destroy(),this.sharedSymbolResources=null),this._stage&&(this._stage.dispose(),this._stage=null,this._forwardAASettingsHandle.remove(),this._forwardAASettingsHandle=null),this._setCanvas(null))},
_getDesiredHeadingTilt:function(){if(this._externallySet.camera){var a=this.camera;ma.heading=a.heading;ma.tilt=a.tilt}else ma.heading=0,ma.tilt=.5;return ma},_cameraSetter:ja("camera",function(a){this._setCamera(a,{animate:!1})||S.error("#camera\x3d","Invalid camera",a)}),_cameraGetter:G("camera",function(a){return P.internalToExternal(this,this.navigation.currentCamera,a)}),_externalExtent:function(){this._cachedExtentDirty&&(P.toExtent(this,null,null,this._cachedExtent,qa),this._cachedExtentDirty=
!1);return this._cachedExtent},_extentGetter:G("extent",function(a){return P.toExtent(this,null,null,a,qa)}),_extentSetter:ja("extent",function(a){var b=P.fromExtent(this,a,this._getDesiredHeadingTilt(),qa);b?this.camera=b:this._isIncompatibleSpatialReference(a.spatialReference)?S.error("#extent\x3d","Extent has an incompatible spatial reference (extent: "+a.spatialReference.wkid+", view: "+this.spatialReference.wkid+")",a):S.error("#extent\x3d","Invalid extent",a)}),_isIncompatibleSpatialReference:function(a){return a&&
!a.equals(this.spatialReference)&&!n.canProject(a,this.spatialReference)},_scaleGetter:G("scale",function(){return null!=this.navigation?P.computeScale(this,this.navigation.currentCamera):0}),_scaleSetter:ja("scale",function(a){var b=this._getDesiredHeadingTilt(),c=this.navigation.currentCamera.center,d=ca.create();O.vectorToVector(c,this.renderSpatialReference,d,f.WGS84);a=P.scaleToDistance(this,a,d[1]);b=P.eyeHeadingTiltForCenterPointAtDistance(this,b.heading,b.tilt,c,a);this._externallySet.camera=
!0;this.navigation.setCameraFromEyeCenterAndUp(b.eye,b.center,b.up,{animate:!1})}),_zoomGetter:G("zoom",function(){return P.scaleToZoom(this,this.scale)}),_zoomSetter:ja("zoom",function(a){this.scale=P.zoomToScale(this,a)}),_centerGetter:G("center",function(a){var b=this.spatialReference||f.WGS84;return O.vectorToPoint(this.navigation.currentCamera.center,this.renderSpatialReference,a||b,b)}),_centerSetter:ja("center",function(a){if(this._isIncompatibleSpatialReference(a&&a.spatialReference))S.error("#center\x3d",
"Center has an incompatible spatial reference (center: "+a.spatialReference.wkid+", view: "+this.spatialReference.wkid+")",a);else{var b=this._getDesiredHeadingTilt();(b=P.eyeHeadingTiltForCenterPointAtDistance(this,b.heading,b.tilt,a,this.navigation.currentCamera.distance))||S.error("#center\x3d","Invalid center",a);this._externallySet.camera=!0;this.navigation.setCameraFromEyeCenterAndUp(b.eye,b.center,b.up,{animate:!1})}}),_viewpointGetter:G("viewpoint",function(){return I.fromCamera(this,this.camera)}),
_viewpointSetter:ja("viewpoint",function(a){var b=I.toCamera(this,a);b?this._setCamera(b,{animate:!1}):S.error("#viewpoint\x3d","Invalid viewpoint",a)}),_screenCenterGetter:function(){var a=this.padding;return new q((this.size[0]-(a.left+a.right))/2+a.left,(this.size[1]-(a.top+a.bottom))/2+a.top)},_updateDrawingOrder:function(){var a=this.allLayerViews.length-1;this.allLayerViews.forEach(function(b,c){null!=b.drawingOrder&&(b.drawingOrder=a-c)},this)},_paddingSetter:ja("padding",function(a){this._set("padding",
{top:a&&a.top||0,right:a&&a.right||0,bottom:a&&a.bottom||0,left:a&&a.left||0});this.navigation&&(this.navigation.padding=this._get("padding"))}),_constraintsSetter:ja("constraints",function(a){this._set("constraints",a);a===this._defaults.constraints&&(this._defaults.constraints=null,a.scale(1/this.renderCoordsHelper.unitInMeters));this.navigation.userConstraints=a}),_animationSetter:function(a){a!==this._get("animation")&&(this._internallyReady?(this._animationStateWatcher&&(this._animationStateWatcher.remove(),
this._animationStateWatcher=null),this._set("animation",a),a&&(this._animationStateWatcher=a.watch("state",function(a){if(a===e.State.FINISHED||a===e.State.STOPPED)this.animation=null,a===e.State.FINISHED?this.navigation.setCurrentToTarget():this.navigation.setCamera(this.navigation.currentCamera,{animate:!1})}.bind(this)))):S.error("#animation\x3d","Scene view cannot be used before it is ready"))},_mapSetter:function(a){a!==this._get("map")&&(this.navigation&&this.navigation._dataExtentChanged(),
this._mapLayersChangeHandle&&this._mapLayersChangeHandle.remove(),a&&(this._mapLayersChangeHandle=a.allLayers.on("change",this.notifyChange.bind(this,"dataExtent"))),delete this._externallySet.camera,this.inherited(arguments))}})});