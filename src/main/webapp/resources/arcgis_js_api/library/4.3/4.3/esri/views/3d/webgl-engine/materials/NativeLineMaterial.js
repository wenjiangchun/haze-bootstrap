// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.3/esri/copyright.txt for details.
//>>built
define("./internal/MaterialUtil ../lib/Util ../lib/gl-matrix ../lib/RenderSlot ../lib/DefaultVertexBufferLayouts ../../../webgl/Util".split(" "),function(v,w,x,D,E,F){var a=x.vec3d,y=x.vec2d,z=x.mat4d,G=w.VertexAttrConstants,e=a.create(),c=a.create(),l=a.create(),t=a.create(),p=y.create(),q=y.create(),A=a.create(),B=a.create(),h=function(I,C,f,u){"string"===typeof f&&(u=f,f=void 0);v.basicMaterialConstructor(this,u);this.lineType=f||h.LINES;var b=E.Pos3,r=F.getStride(b)/4;this.canBeMerged=this.lineType===
h.LINES;this.setColor=function(d){C=d;this.notifyDirty("matChanged")};this.getColor=function(){return C};this.dispose=function(){};this.getOutputAmount=function(d){d=d/2+1;if(this.lineType===h.STRIP)return d*r;if(this.lineType===h.LINES)return(2*d-2)*r};this.getVertexBufferLayout=function(){return b};this.fillInterleaved=function(d,k,a,b,m,e){d=d.vertexAttr[G.POSITION].data;if(k||this.lineType===h.LINES)for(b=d.length/3,a=0;a<b;a++){var c=3*a,g=d[c],l=d[c+1],n=d[c+2];if(k)var c=g,f=l,g=k[0]*c+k[4]*
f+k[8]*n+k[12],l=k[1]*c+k[5]*f+k[9]*n+k[13],n=k[2]*c+k[6]*f+k[10]*n+k[14];m[e++]=g;m[e++]=l;m[e++]=n;this.lineType===h.LINES&&0!==a&&a!==b-1&&(m[e++]=g,m[e++]=l,m[e++]=n)}else for(a=0;a<d.length;a++)m[e++]=d[a]};this.intersect=function(d,b,f,h,m,r,u){if(h.isSelection){b=d.getData().getVertexAttr("position").position.data;d=Number.MAX_VALUE;var g,k;m=h.camera;r=h.point;for(var n=0;n<b.length-5;n+=3){e[0]=b[n];e[1]=b[n+1];e[2]=b[n+2];z.multiplyVec3(f,e);c[0]=b[n+3];c[1]=b[n+4];c[2]=b[n+5];z.multiplyVec3(f,
c);m.projectPoint(e,p);m.projectPoint(c,q);if(0>p[2]&&0<q[2])a.subtract(e,c,l),g=m.frustumPlanes,k=-(a.dot(g[4],e)+g[4][3]),g=k/a.dot(l,g[4]),a.scale(l,g,l),a.add(e,l,e),m.projectPoint(e,p);else if(0<p[2]&&0>q[2])a.subtract(c,e,l),g=m.frustumPlanes,k=-(a.dot(g[4],c)+g[4][3]),g=k/a.dot(l,g[4]),a.scale(l,g,l),a.add(c,l,c),m.projectPoint(c,q);else if(0>p[2]&&0>q[2])continue;g=w.projectVectorVector2D(p,q,r);g<d&&(d=g,a.set(e,A),a.set(c,B))}f=h.p0;h=h.p1;2>d&&(d=w.linelineDistance3D(A,B,f,h),b=Number.MAX_VALUE,
d[0]&&(a.subtract(d[2],f,t),d=a.length(t),a.scale(t,1/d),b=d/a.dist(f,h)),u(b,t))}};this.getGLMaterials=function(){return{color:H,depthShadowMap:void 0,normal:void 0,depth:void 0,highlight:void 0}};this.getAllTextureIds=function(){return[]}};h.STRIP=1;h.LINES=2;var H=function(a,e){v.basicGLMaterialConstructor(this,a);var f=e.get("simple"),c=a.getColor();this.beginSlot=function(b){return b===D.OPAQUE_MATERIAL};this.getProgram=function(){return f};this.bind=function(b,a){b.bindProgram(f);f.setUniform4fv("color",
c);b.setBlendingEnabled(1>c[3]);b.setBlendFunctionSeparate(b.gl.SRC_ALPHA,b.gl.ONE_MINUS_SRC_ALPHA,b.gl.ONE,b.gl.ONE_MINUS_SRC_ALPHA);b.setDepthTestEnabled(!0)};this.release=function(a){1>c[3]&&a.setBlendingEnabled(!1)};this.bindView=function(a,c){v.bindView(c.origin,c.view,f)};this.bindInstance=function(a,c){f.setUniformMatrix4fv("model",c.transformation)};this.getDrawMode=function(b){b=b.gl;return a.lineType===h.STRIP?b.LINE_STRIP:b.LINES}};return h});