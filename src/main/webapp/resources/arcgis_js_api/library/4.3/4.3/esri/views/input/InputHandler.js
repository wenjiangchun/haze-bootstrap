// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.3/esri/copyright.txt for details.
//>>built
define(["require","exports","./EventMatch","../../core/Logger"],function(f,h,k,l){var g=l.getLogger("esri.views.input");f=function(){function c(a,b){this._manager=null;this._incoming={};this._outgoing={};this._outgoingEventTypes=this._incomingEventTypes=this._incomingEventMatches=null;this._name=a;this._hasSideEffects=b}Object.defineProperty(c.prototype,"incomingEventMatches",{get:function(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(var a in this._incoming)for(var b=0,c=this._incoming[a];b<
c.length;b++)this._incomingEventMatches.push(c[b].match)}return this._incomingEventMatches},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"incomingEventTypes",{get:function(){this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map(function(a){return a.eventType}));return this._incomingEventTypes},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"outgoingEventTypes",{get:function(){this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing));
return this._outgoingEventTypes},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"hasSideEffects",{get:function(){return this._hasSideEffects},enumerable:!0,configurable:!0});c.prototype.onInstall=function(a){var b=this;this._manager?g.error("This InputHandler has already been registered with an InputManager"):(a.setEventCallback(function(a){return b._handleEvent(a)}),a.setUninstallCallback(function(){return b._onUninstall()}),this._manager=a)};c.prototype.onUninstall=function(){};
c.prototype.registerIncoming=function(a,b,c){var d=this;"function"===typeof b?(c=b,b=[]):b=b||[];a="string"===typeof a?new k.EventMatch(a,b):a;var e=function(){d._incomingEventTypes=null;d._incomingEventMatches=null};b=function(a){var b=d._incoming[a.match.eventType];b&&(a=b.indexOf(a),b.splice(a,1),e(),d._manager&&d._manager.updateDependencies())};c=new m(a,c,{onPause:b,onRemove:b,onResume:function(a){var b=d._incoming[a.match.eventType];b&&-1===b.indexOf(a)&&(b.push(a),e(),d._manager&&d._manager.updateDependencies())}});
b=this._incoming[a.eventType];b||(b=[],this._incoming[a.eventType]=b);b.push(c);e();this._manager&&this._manager.updateDependencies();return c};c.prototype.registerOutgoing=function(a){var b=this;if(this._outgoing[a])throw Error("There is already a callback registered for this outgoing InputEvent: "+a);var c=new n(a,{onEmit:function(a,c,e){b._manager.emit(a.eventType,c,e)},onRemove:function(a){delete b._outgoing[a.eventType];b._manager.updateDependencies()}});this._outgoing[a]=c;this._outgoingEventTypes=
null;this._manager&&this._manager.updateDependencies();return c};c.prototype.startCapturingPointer=function(a){this._manager.setPointerCapture(a,!0)};c.prototype.stopCapturingPointer=function(a){this._manager.setPointerCapture(a,!1)};c.prototype._onUninstall=function(){this._manager?(this.onUninstall(),this._manager=null):g.error("This InputHandler is not registered with an InputManager")};c.prototype._handleEvent=function(a){var b=this._incoming[a.type];if(b)for(var c=0;c<b.length;c++){var d=b[c];
if(d.match.matches(a)&&(d.callback(a),a.shouldStopPropagation()))break}};return c}();h.InputHandler=f;var m=function(){function c(a,b,c){this.match=a;this._callback=b;this._handler=c}c.prototype.pause=function(){this._handler.onPause(this)};c.prototype.resume=function(){this._handler.onResume(this)};c.prototype.remove=function(){this._handler.onRemove(this)};Object.defineProperty(c.prototype,"callback",{get:function(){return this._callback},enumerable:!0,configurable:!0});return c}(),n=function(){function c(a,
b){this.eventType=a;this._removed=!1;this._handler=b}c.prototype.emit=function(a,b){if(!this._removed)this._handler.onEmit(this,a,b)};c.prototype.remove=function(){this._removed=!0;this._handler.onRemove(this)};return c}()});