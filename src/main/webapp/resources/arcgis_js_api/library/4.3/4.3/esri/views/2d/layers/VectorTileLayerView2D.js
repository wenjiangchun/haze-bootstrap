// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.3/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/2d/layers/support/TileInfoViewPOT":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/decorateHelper ./TileKey ./TileInfoView".split(" "),function(m,e,a,b,c,d){return function(b){function d(){return null!==b&&b.apply(this,arguments)||this}a(d,b);d.prototype.getTileParentId=function(a){a=c.pool.acquire(a);var b=0===a.level?null:c.getId(a.level-1,a.row>>1,a.col>>1,a.world);c.pool.release(a);return b};d.prototype.getTileIdAtParent=
function(a,b){b=c.pool.acquire(b);var d=this._infoByLevel[b.level];if(a.resolution<d.resolution)throw c.pool.release(b),Error("Cannot calculate parent tile. destination LOD's resolution "+a.resolution+" is not a parent resolution of "+d.resolution);if(a.resolution===d.resolution)return a=b.id,c.pool.release(b),a;d=b.level-a.level;if(0>d)throw c.pool.release(b),Error("Wrong way...!");a=c.getId(a.level,b.row>>d,b.col>>d,b.world);c.pool.release(b);return a};return d}(d)})},"esri/views/vectorTiles/TileHandler":function(){define("require exports module dojo/Deferred dojo/promise/all ../../core/workers ../../core/promiseUtils ../../core/requireUtils ../../request ../2d/layers/support/TileKey ./TileIndex ./SpriteMosaic ./SpriteSource ./GlyphMosaic ./GlyphSource ./VectorTileDisplayObject ./GeometryUtils".split(" "),
function(m,e,a,b,c,d,f,g,k,h,n,l,p,q,v,r,u){return function(){function e(a,b,c,d){void 0===d&&(d=!1);this.devicePixelRatio=c;this.allowUpdates=d;this._tileIndex=this._connection=this._glyphMosaic=this._spriteMosaic=null;this._ongoingRequests={};this._vectorTileLayer=a;this._styleRepository=a.styleRepository;this._requestUpdate=b}e.prototype.destroy=function(){this.stop();this._vectorTileLayer=this._requestUpdate=this._styleRepository=null};Object.defineProperty(e.prototype,"spriteMosaic",{get:function(){return this._spriteMosaic},
enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"glyphMosaic",{get:function(){return this._glyphMosaic},enumerable:!0,configurable:!0});e.prototype.start=function(){var f=this;this.stop();var h=this._styleRepository,k=new p(h.sprite,this.devicePixelRatio);k.devicePixelRatio=devicePixelRatio;var n=k.load().then(function(){f._spriteMosaic=new l(1024,1024,250);f._spriteMosaic.setSpriteSource(k)}),e=new v(h.glyphs);this._glyphMosaic=new q(1024,1024,e);var r=this._fetchTileMap(this._vectorTileLayer.tileIndexUrl),
u=d.open(this,g.getAbsMid("./WorkerTileHandler",m,a)).then(function(a){f._connection=a}),t=new b(function(a){n.isFulfilled()||n.cancel();r.isFulfilled()||r.cancel();u.isFulfilled()||u.cancel()});c([n,r,u]).then(function(a){c(f._connection.broadcast("setLayers",h.styleJSON)).then(function(){t.resolve()})});return this._broadcastPromise=t.promise};e.prototype.stop=function(){this._broadcastPromise&&!this._broadcastPromise.isFulfilled()&&this._broadcastPromise.cancel();for(var a in this._ongoingRequests)this._ongoingRequests[a].cancel("cancel");
this._connection&&(this._connection.close(),this._connection=null)};e.prototype.updateTile=function(a,b){if(this.allowUpdates){if(!this._broadcastPromise.isFulfilled()||!this._connection)return f.reject(Error("no connection"));b=Math.round(u.degToByte(b.state.rotation));if(a.rotation===b)return null;a.rotation=b;return this._connection.invoke("update",{key:a.id,rotation:b},[],{id:a.workerID}).then(function(b){a.updateSymbolData(b);return a})}};e.prototype.getVectorTileWithLRC=function(a,b,c,d){void 0===
d&&(d=0);return this.getVectorTile(h.from(a,b,c,0),{state:{rotation:d}})};e.prototype.getVectorTile=function(a,b){var c=this;if(!this._broadcastPromise.isFulfilled()||!this._connection)return f.reject(Error("no connection"));var d=this._vectorTileLayer.tileInfo,g=Math.round(b?b.state.rotation:0);if(d.lods.length<=a.level)return f.reject("Cannot create tile for the requested level");var h=this._tileIndex?this._tileIndex.dataKey(a):a;return h?this._getTileData(this._connection,a,h,g).then(function(b){if(!b||
!b.tileData)return f.reject("No data");var k=d.size[0]*d.lods[a.level].resolution,n=d.origin,l=n.x+a.col*k+a.world*c._vectorTileLayer.fullExtent.width,p=l+k,n=n.y-a.row*k,k=n-k;c._requestUpdate();return new r(a,h,[l,n,p,k],c._vectorTileLayer.tileInfo.size[1],4096,g,b.tileData,c._styleRepository,c._glyphMosaic,c.allowUpdates?b.workerId:-1,c._connection)}):f.reject(Error("no data"))};e.prototype.fetchTileData=function(a){a=h.pool.acquire(a);var b=this._vectorTileLayer.getTileUrl(a.level,a.row,a.col);
h.pool.release(a);return k(b,{callbackParamName:"callback",responseType:"array-buffer"}).then(function(a){return{data:{protobuff:a.data},buffers:[a.data]}})};e.prototype.getSprites=function(a){return f.resolve({data:{spriteItems:this._spriteMosaic.getSpriteItems(a.sprites)}})};e.prototype.getGlyphs=function(a){return this._glyphMosaic.getGlyphItems(a.tileID,a.font,a.codePoints).then(function(a){return{data:{glyphItems:a}}})};e.prototype.getStyleRepository=function(){return this._styleRepository};
e.prototype.getTileIndex=function(){return this._tileIndex};e.prototype._getTileData=function(a,b,c,d){var g=this,h={id:null};if(a=this._ongoingRequests[b.id])return a;a=this._connection.invoke("getTile",{key:b.id,refKey:c.id,rotation:d,cacheTile:this.allowUpdates},[],h).then(function(a){delete g._ongoingRequests[b.id];return{tileData:a,workerId:h.id}}).otherwise(function(a){delete g._ongoingRequests[b.id];g.allowUpdates&&g._connection.invoke("destructTileData",{key:b.id},[],h);return f.reject(a)});
return this._ongoingRequests[b.id]=a};e.prototype._fetchTileMap=function(a){var b=this;return a?k(a,{callbackParamName:"callback",responseType:"json"}).then(function(a){b._tileIndex=new n(a.data)}):null};return e}()})},"esri/core/workers":function(){define(["require","exports","./workers/workers"],function(m,e,a){for(var b in a)e.hasOwnProperty(b)||(e[b]=a[b])})},"esri/core/workers/workers":function(){define("require exports dojo/Deferred dojo/promise/all ../promiseUtils ./Connection ./JobProxy".split(" "),
function(m,e,a,b,c,d,f){function g(a,c){for(var d=[],f=0;f<p.length;f++)d.push(p[f].openConnection(a,c));return b(d).then(function(a){})}function k(a){q[a]=!0;if(!l&&q.every(function(a){return a})){for(var b in t)(a=u[b])&&t[b].resolve(a);t={};l=!0}}function h(b){var c=r++;b=new d(b,c);var f=new a;u[c]=b;l?f.resolve(b):t[c]=f;return f.promise}var n=Math.max((navigator.hardwareConcurrency||2)-1,2),l=!1,p=[],q=[],v=0,r=0,u={},t={},w=!1;e.open=function(a,b){if(!1===w){for(var d=0;d<n;++d){var l=new f(u,
d,k);p.push(l);q.push(!1)}w=!0}return h(a).then(function(a){return g(b,a.id).then(function(){return a}).otherwise(function(a){return c.reject(a)})})};e.terminate=function(){for(var a=0;a<p.length;a++)p[a].terminate();p=[];q=[];l=!1};e.closeConnection=function(a){if(a)if(u[a.id]&&delete u[a.id],l)for(var b=0;b<p.length;b++)p[b].closeConnection(a.id);else if(b=t[a.id])b.promise.cancel(),delete t[a.id]};e.invoke=function(a,b,d,f,g){var h=null;f&&(h=f.id);if(null===h&&(h=v=(v+1)%p.length,!q[h]&&!p.some(function(a,
b,c){h=(h+1)%c.length;return q[h]})))return c.reject(Error("No worker available"));a=p[h].invoke(a,b,d,g);f&&(f.id=h);return a};e.broadcast=function(a,b,c,d){for(var f=[],g=0;g<p.length;g++)q[g]&&f.push(p[g].invoke(a,b,c,d));return f}})},"esri/core/workers/Connection":function(){define(["require","exports","./workers"],function(m,e,a){return function(){function b(a,b){this.client=a;this.id=b}b.prototype.invoke=function(b,d,f,g){return a.invoke(b,d,f,g,this.id)};b.prototype.broadcast=function(b,d,
f){return a.broadcast(b,d,f,this.id)};b.prototype.close=function(){a.closeConnection(this)};return b}()})},"esri/core/workers/JobProxy":function(){define("require exports dojo/_base/kernel dojo/_base/lang dojo/_base/url dojo/Deferred ../../kernel ../../config ../../request ../Logger ../urlUtils ./WorkerFallbackImpl".split(" "),function(m,e,a,b,c,d,f,g,k,h,n,l){function p(){if(!w){var a=void 0;try{a=new Worker(r)}catch(z){v.warn("Failed to create Worker. Fallback to execute module in main thread",
event),a=new l}return q(a)}if(!y){var a=new c(r),b=g.defaults?g.defaults.io.corsEnabledServers:g.request.corsEnabledServers;-1===b.indexOf(a.host)&&b.push(a.host);y=k(r,{responseType:"text"})}return y.then(function(a){var b;try{b=new Worker(URL.createObjectURL(new Blob([a.data],{type:"text/javascript"})))}catch(F){v.warn("Failed to create Worker. Fallback to execute module in main thread",F),b=new l}return q(b)})}function q(c){function f(d){if(d&&d.data&&d.data.type)if(d=d.data.type,"\x3cworker-loaded\x3e"===
d){d=c;var n;null!=g["default"]?(n=b.mixin({},g),delete n["default"],n=JSON.parse(JSON.stringify(n))):n=JSON.parse(JSON.stringify(g));var l={async:!0,baseUrl:t,locale:a.locale,has:{},paths:{}};b.mixin(l,g.workers.loaderConfig);l.has=b.mixin({"esri-cors":1,"dojo-test-sniff":0,"config-deferredInstrumentation":0,"host-webworker":1},l.has);l.paths=b.mixin({esri:"../esri",dojo:"../dojo",dojox:"../dojox",dstore:"../dstore",moment:"../moment"},l.paths);d.postMessage({type:"\x3cconfigure\x3e",configure:{esriConfig:n,
dojoConfig:l,loaderUrl:u}})}else"\x3cworker-configured\x3e"===d&&(c.removeEventListener("message",f),c.removeEventListener("error",h),k.resolve(c))}function h(a){a.preventDefault();c.removeEventListener("message",f);c.removeEventListener("error",h);v.warn("Failed to create Worker. Fallback to execute module in main thread",a);c=new l;c.addEventListener("message",f);c.addEventListener("error",h)}var k=new d;c.addEventListener("message",f);c.addEventListener("error",h);return k.promise}var v=h.getLogger("esri.core.workers"),
r=n.makeAbsolute(m.toUrl("./worker.js")),u=n.makeAbsolute(m.toUrl("dojo/dojo.js")),t=n.makeAbsolute("../",u)+"/",w=!n.hasSameOrigin(r,location.href),y=null;return function(){function a(a,b,c){var d=this;this.connections=a;this.index=b;this.workerInitCallback=c;this.msgCount=0;this.outgoingJobs={};this.incomingJobs={};this.incomingStaticJobs={};p().then(function(a){d.worker=a;d.worker.addEventListener("message",d.message.bind(d));d.worker.addEventListener("error",function(a){a.preventDefault();v.error(a)});
d.workerInitCallback(d.index)})}a.prototype.terminate=function(){this.worker.terminate()};a.prototype.openConnection=function(a,b){return this.invoke("\x3copen-connection\x3e",{path:a},void 0,b)};a.prototype.closeConnection=function(a){this.invoke("\x3cclose-connection\x3e",void 0,void 0,a)};a.prototype.invoke=function(a,b,c,f){var g=this,h=++this.msgCount,k=new d(function(a){g.worker.postMessage({type:"\x3ccancel\x3e",id:h,connection:f,data:{reason:a}});g.outgoingJobs[h]&&delete g.outgoingJobs[h]});
this.outgoingJobs[h]=k;this.worker.postMessage({type:a,id:h,connection:f,data:b},c);return k.promise};a.prototype.message=function(a){var b=this;if(a&&a.data){var c=a.data.type;if(c){var d=a.data,g=a.data.id;if("\x3cresponse\x3e"===c&&g){if(a=this.outgoingJobs[g])delete this.outgoingJobs[g],d.error?a.reject(d.error):a.resolve(d.data)}else if("\x3ccancel\x3e"===c&&g)(a=this.incomingJobs[g])&&a.cancel(d.data.reason),d.staticMsg&&(a=this.incomingStaticJobs[g])&&a.cancel(d.data.reason);else if("\x3cstatic-message\x3e"===
c){var h=d.staticMsg;(a=f.workerMessages[h])&&"function"===typeof a?(d=a.call(this,d.data),this.incomingStaticJobs[g]=d,d.then(function(a){b.worker.postMessage({type:"\x3cstatic-message\x3e",staticMsg:h,id:g,data:a.data},a.buffers)}).otherwise(function(a){a||(a="Error encountered at method"+h);a.dojoType&&"cancel"===a.dojoType||b.worker.postMessage({type:"\x3cstatic-message\x3e",staticMsg:h,id:g,error:a})}).always(function(){delete b.incomingStaticJobs[g]})):this.worker.postMessage({type:"\x3cstatic-message\x3e",
staticMsg:h,id:g,error:a+" message type is not available on the kernel!"})}else{var k=d.connection;if(a=this.connections[k])if(a=a.client){var n=a[c];"function"===typeof n&&(d=n.call(a,d.data),this.incomingJobs[g]=d,d.then(function(a){b.worker.postMessage({type:"\x3cresponse\x3e",id:g,connection:k,error:a.error,data:a.data},a.buffers)}).otherwise(function(a){a||(a="Error encountered at method"+c);a.dojoType&&"cancel"===a.dojoType||b.worker.postMessage({type:"\x3cresponse\x3e",id:g,connection:k,error:a})}).always(function(){delete b.incomingJobs[g]}))}}}}};
return a}()})},"esri/core/workers/WorkerFallbackImpl":function(){define(["require","exports"],function(m,e){var a=function(){return this}(),b=function(){return function(){var a=this,b=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach(function(c){a[c]=function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];return b[c].apply(b,a)}})}}(),c=a.MutationObserver||a.WebKitMutationObserver,d=function(){var b;if(a.process&&a.process.nextTick)b=
function(b){a.process.nextTick(b)};else if(a.Promise)b=function(b){a.Promise.resolve().then(b)};else if(c){var d=[],k=document.createElement("div");(new c(function(){for(;0<d.length;)d.shift()()})).observe(k,{attributes:!0});b=function(a){d.push(a);k.setAttribute("queueStatus","1")}}return b}();return function(){function a(){this._dispatcher=new b;this._connections={};this._outgoingStaticMessages={};this._isInitialized=!1;this._workerPostMessage({type:"\x3cworker-loaded\x3e"})}a.prototype.terminate=
function(){this._connections={}};Object.defineProperty(a.prototype,"onmessage",{get:function(){return this._onmessageHandler},set:function(a){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler);(this._onmessageHandler=a)&&this.addEventListener("message",a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"onerror",{get:function(){return this._onerrorHandler},set:function(a){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler);
(this._onerrorHandler=a)&&this.addEventListener("error",a)},enumerable:!0,configurable:!0});a.prototype.postMessage=function(a,b){var c=this;d(function(){c._workerMessageHandler(new MessageEvent("message",{data:a}))})};a.prototype.dispatchEvent=function(a){return this._dispatcher.dispatchEvent(a)};a.prototype.addEventListener=function(a,b,c){this._dispatcher.addEventListener(a,b,c)};a.prototype.removeEventListener=function(a,b,c){this._dispatcher.removeEventListener(a,b,c)};a.prototype._workerPostMessage=
function(a,b){var c=this;d(function(){c.dispatchEvent(new MessageEvent("message",{data:a}))})};a.prototype._workerMessageHandler=function(a){var b=this,c=a.data;if(c){var d=c.connection,f=c.type;if("\x3cconfigure\x3e"===f)this._isInitialized||this._workerPostMessage({type:"\x3cworker-configured\x3e"});else if("\x3copen-connection\x3e"===f){a=c.data.path;var g=c.id;this._connections[d]?this._workerPostMessage({type:"\x3cresponse\x3e",id:g,connection:d}):m(["./WorkerConnection",a],function(a,c){b._connections[d]=
new a(c,{postMessage:function(a,c){return b._workerPostMessage(a,c)}},d);b._workerPostMessage({type:"\x3cresponse\x3e",id:g,data:{connection:d},error:void 0})})}else"\x3cclose-connection\x3e"===f?this._connections[d]&&delete this._connections[d]:"\x3cstatic-message\x3e"===f?(a=c.id,this._outgoingStaticMessages[a]&&(f=this._outgoingStaticMessages[a],delete this._outgoingStaticMessages[a],c.error?f.reject(c.error):f.resolve(c.data))):f&&(c=this._connections[d])&&c.proxy.message(a)}};return a}()})},
"esri/views/vectorTiles/TileIndex":function(){define(["require","exports","../2d/layers/support/TileKey"],function(m,e,a){return function(){function b(a){if(!("index"in a))throw Error("The tilemap is missing the 'index' property.");this._tilemap=a.index}b.prototype.dataKey=function(b){var c=[b];if(0>b.level||0>b.row||0>b.col||0<b.row>>b.level||0<b.col>>b.level)return null;for(;0!==b.level;)b=new a(b.level-1,b.row>>1,b.col>>1,b.world),c.push(b);b=this._tilemap;var f=c.pop(),g,k;if(1===b)return f;for(;c.length;){g=
c.pop();k=f.level+1;var h=2*f.row,n=2*f.col;k=[a.getId(k,h,n,g.world),a.getId(k,h,n+1,g.world),a.getId(k,h+1,n,g.world),a.getId(k,h+1,n+1,g.world)].indexOf(g.id);if(b)if(0===b[k]){f=null;break}else if(1===b[k]){f=g;break}else f=g,b=b[k]}return f};b.prototype.forEach=function(a,b,f,g,k){this._callback=k;this._maxLevel=b+a;this._forEach(this._tilemap,b,f,g)};b.prototype._forEach=function(a,b,f,g){0!==a&&(this._callback(b,f,g),b!==this._maxLevel&&"object"===typeof a&&(this._forEach(a[0],b+1,2*f,2*g),
this._forEach(a[1],b+1,2*f,2*g+1),this._forEach(a[2],b+1,2*f+1,2*g),this._forEach(a[3],b+1,2*f+1,2*g+1)))};return b}()})},"esri/views/vectorTiles/SpriteMosaic":function(){define("require exports ./Rect ./GeometryUtils ./RectangleBinPack ../webgl/Texture".split(" "),function(m,e,a,b,c,d){return function(){function f(a,b,d){void 0===d&&(d=0);this._size=[];this._mosaicsData=[];this._textures=[];this._dirties=[];this._pageHeight=this._pageWidth=this._currentPage=this._maxItemSize=0;this._mosaicRects=
{};this.pixelRatio=1;(0>=a||0>=b)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!");this._pageWidth=a;this._pageHeight=b;0<d&&(this._maxItemSize=d);this._binPack=new c(a,b)}f.prototype.getWidth=function(a){return a>=this._size.length?-1:this._size[a][0]};f.prototype.getHeight=function(a){return a>=this._size.length?-1:this._size[a][1]};f.prototype.setSpriteSource=function(a){this._dispose();this.pixelRatio=a.devicePixelRatio;0===this._mosaicsData.length&&(this._binPack=
new c(this._pageWidth,this._pageHeight),this._mosaicsData[0]=new Uint32Array(Math.floor(this._pageWidth)*Math.floor(this._pageHeight)),this._dirties.push(!0),this._size.push([this._pageWidth,this._pageHeight]),this._textures.push(void 0));this._sprites=a};f.prototype.getSpriteItem=function(a,b){void 0===b&&(b=!1);var c=this._mosaicRects[a];if(c)return c;if(!this._sprites||"loaded"!==this._sprites.loadStatus)return null;var d=this._sprites.getSpritePosition(a);if(!d||!d.width||!d.height)return null;
var c=this._allocateImage(d.width,d.height),f=c[0],g=c[1],k=c[2];if(0>=f.width)return null;c={rect:f,width:d.width,height:d.height,sdf:d.sdf,pixelRatio:d.pixelRatio,page:g};this._copy(f,d,g,k,b);return this._mosaicRects[a]=c};f.prototype.getSpriteItems=function(a){for(var b={},c=0;c<a.length;c++){var d=a[c];b[d]=this.getSpriteItem(d)}return b};f.prototype.getMosaicItemPosition=function(a,b){b=(a=this.getSpriteItem(a,b))&&a.rect;if(!b)return null;b.width=a.width;b.height=a.height;return{size:[a.width,
a.height],tl:[(b.x+1)/this._size[a.page][0],(b.y+1)/this._size[a.page][1]],br:[(b.x+1+a.width)/this._size[a.page][0],(b.y+1+a.height)/this._size[a.page][1]],page:a.page}};f.prototype.bind=function(a,b,c,f){void 0===c&&(c=0);void 0===f&&(f=0);this._textures[c]||(this._textures[c]=new d(a,{pixelFormat:6408,dataType:5121,width:this._size[c][0],height:this._size[c][1]},new Uint8Array(this._mosaicsData[c].buffer)));var g=this._textures[c];g.setSamplingMode(b);a.bindTexture(g,f);this._dirties[c]&&g.setData(new Uint8Array(this._mosaicsData[c].buffer));
this._dirties[c]=!1};f._copyBits=function(a,b,c,d,f,p,q,e,r,u,t){var g=d*b+c;q=e*p+q;if(t)for(q-=p,t=-1;t<=u;t++,g=((t+u)%u+d)*b+c,q+=p)for(e=-1;e<=r;e++)f[q+e]=a[g+(e+r)%r];else for(t=0;t<u;t++){for(e=0;e<r;e++)f[q+e]=a[g+e];g+=b;q+=p}};f.prototype._copy=function(a,b,c,d,l){if(this._sprites&&"loaded"===this._sprites.loadStatus&&!(c>=this._mosaicsData.length)){var g=new Uint32Array(this._sprites.image.buffer),h=this._mosaicsData[c];h&&g||console.error("Source or target images are uninitialized!");
f._copyBits(g,this._sprites.width,b.x,b.y,h,d[0],a.x+1,a.y+1,b.width,b.height,l);this._dirties[c]=!0}};f.prototype._allocateImage=function(d,f){d+=2;f+=2;var g=Math.max(d,f);if(this._maxItemSize&&this._maxItemSize<g){var g=Math.pow(2,Math.ceil(b.log2(d))),k=Math.pow(2,Math.ceil(b.log2(f)));d=new a(0,0,d,f);this._mosaicsData.push(new Uint32Array(g*k));this._dirties.push(!0);this._size.push([g,k]);this._textures.push(void 0);return[d,this._mosaicsData.length-1,[g,k]]}g=this._binPack.allocate(d+(d%4?
4-d%4:0),f+(f%4?4-f%4:0));return 0>=g.width?(this._dirties[this._currentPage]||(this._mosaicsData[this._currentPage]=null),this._currentPage=this._mosaicsData.length,this._mosaicsData.push(new Uint32Array(this._pageWidth*this._pageHeight)),this._dirties.push(!0),this._size.push([this._pageWidth,this._pageHeight]),this._textures.push(void 0),this._binPack=new c(this._pageWidth,this._pageHeight),this._allocateImage(d,f)):[g,this._currentPage,[this._pageWidth,this._pageHeight]]};f.prototype._dispose=
function(){this._binPack=null;this._mosaicRects={}};return f}()})},"esri/views/vectorTiles/Rect":function(){define(["require","exports"],function(m,e){return function(){function a(a,c,d,f){void 0===a&&(a=0);void 0===c&&(c=0);void 0===d&&(d=0);void 0===f&&(f=0);this.x=a;this.y=c;this.width=d;this.height=f}Object.defineProperty(a.prototype,"isEmpty",{get:function(){return 0>=this.width||0>=this.height},enumerable:!0,configurable:!0});return a}()})},"esri/views/vectorTiles/GeometryUtils":function(){define(["require",
"exports"],function(m,e){function a(a,b){a%=b;return 0<=a?a:a+b}e.C_INFINITY=Number.POSITIVE_INFINITY;e.C_PI=Math.PI;e.C_2PI=2*e.C_PI;e.C_PI_BY_2=e.C_PI/2;e.C_RAD_TO_256=128/e.C_PI;e.C_256_TO_RAD=e.C_PI/128;e.C_DEG_TO_256=256/360;e.C_DEG_TO_RAD=e.C_PI/180;e.C_SQRT2=1.414213562;e.C_SQRT2_INV=1/e.C_SQRT2;var b=1/Math.LN2;e.positiveMod=a;e.radToByte=function(b){return a(b*e.C_RAD_TO_256,256)};e.degToByte=function(b){return a(b*e.C_DEG_TO_256,256)};e.log2=function(a){return Math.log(a)*b};e.sqr=function(a){return a*
a};e.clamp=function(a,b,f){return Math.min(Math.max(a,b),f)};e.interpolate=function(a,b,f){return a*(1-f)+b*f};e.between=function(a,b,f){return a>=b&&a<=f||a>=f&&a<=b}})},"esri/views/vectorTiles/RectangleBinPack":function(){define(["require","exports","./Rect"],function(m,e,a){return function(){function b(b,d){this._height=this._width=0;this._free=[];this._width=b;this._height=d;this._free.push(new a(0,0,b,d))}b.prototype.allocate=function(b,d){for(var c=null,g=-1,k=0;k<this._free.length;++k){var h=
this._free[k];b<=h.width&&d<=h.height&&(null===c||h.y<=c.y&&h.x<=c.x)&&(c=h,g=k)}if(null===c)return new a;this._free.splice(g,1);c.width<c.height?(c.width>b&&this._free.push(new a(c.x+b,c.y,c.width-b,d)),c.height>d&&this._free.push(new a(c.x,c.y+d,c.width,c.height-d))):(c.width>b&&this._free.push(new a(c.x+b,c.y,c.width-b,c.height)),c.height>d&&this._free.push(new a(c.x,c.y+d,b,c.height-d)));return new a(c.x,c.y,b,d)};b.prototype.release=function(a){for(var b=0;b<this._free.length;++b){var c=this._free[b];
if(c.y===a.y&&c.height===a.height&&c.x+c.width===a.x)c.width+=a.width;else if(c.x===a.x&&c.width===a.width&&c.y+c.height===a.y)c.height+=a.height;else if(a.y===c.y&&a.height===c.height&&a.x+a.width===c.x)c.x=a.x,c.width+=a.width;else if(a.x===c.x&&a.width===c.width&&a.y+a.height===c.y)c.y=a.y,c.height+=a.height;else continue;this._free.splice(b,1);this.release(a)}this._free.push(a)};return b}()})},"esri/views/vectorTiles/SpriteSource":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper dojo/Deferred dojo/promise/all ../../request ../../kernel ../../core/promiseUtils".split(" "),
function(m,e,a,b,c,d,f,g,k){return function(){function a(a,b){this.baseURL=a;this.devicePixelRatio=b;this._isRetina=!1;this._spritesData={};this.height=this.width=this.image=null;this.loadStatus="not-loaded"}a.prototype.getSpritePosition=function(a){return this._spritesData[a]};a.prototype.load=function(){var a=this;this.loadStatus="loading";return this.baseURL?this._loadSprites().then(function(){a.loadStatus="loaded";return a}).otherwise(function(b){a.loadStatus="failed";return a}):k.resolve(this)};
a.prototype._loadSprites=function(){var a=this;this._isRetina=1.15<this.devicePixelRatio?!0:!1;var b=this.baseURL,h=this._isRetina?"@2x":"",k=f(b+h+".json",{callbackParamName:"callback",responseType:"json"}).then(function(b){a._spritesData=b.data}),e=new c,r=new Image;r.crossOrigin="anonymous";r.onload=function(){r.onload=null;a.width=r.width;a.height=r.height;var b=document.createElement("canvas");b.width=r.width;b.height=r.height;b=b.getContext("2d");b.drawImage(r,0,0,r.width,r.height);for(var b=
b.getImageData(0,0,r.width,r.height),b=new Uint8Array(b.data),c,d=0;d<b.length;d+=4)c=b[d+3]/255,b[d]*=c,b[d+1]*=c,b[d+2]*=c;a.image=b;e.resolve()};b=""+b+h+".png";g.id&&(h=g.id.findCredential(b))&&h.token&&(b+="?token\x3d"+h.token);r.src=b;return d([k,e.promise])};return a}()})},"esri/views/vectorTiles/GlyphMosaic":function(){define("require exports dojo/promise/all dojo/Deferred ./Rect ../webgl/Texture ./RectangleBinPack".split(" "),function(m,e,a,b,c,d,f){return function(){function g(a,b,c){this.height=
this.width=0;this._dirty=!1;this._glyphIndex={};this._rangePromises={};(0>=a||0>=b)&&console.error("Glyph mosaic width and height must be greater than zero!");this.width=a;this.height=b;this._glyphSource=c;this._binPack=new f(a,b);this._glyphData=new Uint8Array(a*b)}g.prototype.getGlyphItems=function(d,f,g){for(var h=this,k=[],n=this._glyphSource,e=new Set,r=1/256,u=0;u<g.length;u++)e.add(Math.floor(g[u]*r));var t=[];e.forEach(function(a){if(256>=a){var c=new b;t.push(c.promise);var d=f+a,g=h._rangePromises[d];
g?g.push(c):(h._rangePromises[d]=[c],n.getRange(f,a).then(function(){var a=h._rangePromises[d];delete h._rangePromises[d];for(var b=0;b<a.length;b++)a[b].resolve()}))}});return a(t).then(function(a){a=h._glyphIndex[f];a||(a={},h._glyphIndex[f]=a);for(var b=0;b<g.length;b++){var l=g[b],p=a[l];if(p)p.tileIDs.add(d),k[l]={rect:p.rect,metrics:p.metrics};else{var e=n.getGlyph(f,l);if(e&&e.metrics){var p=e.metrics,q=void 0;if(0===p.width)q=new c(0,0,0,0);else{var r=p.width+6,v=p.height+6,q=h._binPack.allocate(r+
(r%4?4-r%4:0),v+(v%4?4-v%4:0));0>=q.width&&(q=new c(0,0,0,0));var e=e.bitmap,u=void 0,t=void 0;if(e)for(var m=0;m<v;m++)for(var u=r*m,t=h.width*(q.y+m)+q.x,w=0;w<r;w++)h._glyphData[t+w]=e[u+w]}r=new Set;r.add(d);a[l]={rect:q,metrics:p,tileIDs:r};k[l]={rect:q,metrics:p};h._dirty=!0}}}return k})};g.prototype.removeGlyphs=function(a){for(var b in this._glyphIndex){var c=this._glyphIndex[b];if(c){var d=void 0,f;for(f in c)if(d=c[f],d.tileIDs["delete"](a),0===d.tileIDs.size){for(var d=d.rect,g=void 0,
k=void 0,e=0;e<d.height;e++)for(g=this.width*(d.y+e)+d.x,k=0;k<d.width;k++)this._glyphData[g+k]=0;delete c[f];this._dirty=!0}}}};g.prototype.bind=function(a,b,c){void 0===c&&(c=0);this._texture||(this._texture=new d(a,{pixelFormat:6406,dataType:5121,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));this._texture.setSamplingMode(b);a.bindTexture(this._texture,c);this._dirty&&this._texture.setData(this._glyphData);this._dirty=!1};return g}()})},"esri/views/vectorTiles/GlyphSource":function(){define(["require",
"exports","../../core/promiseUtils","../../request","../../core/pbf"],function(m,e,a,b,c){var d=function(){function a(a){this._metrics=[];for(this._bitmaps=[];a.next();)switch(a.tag()){case 1:for(var b=a.getMessage();b.next();)switch(b.tag()){case 3:for(var c=b.getMessage(),d=void 0,f=void 0,g=void 0,k=void 0,e=void 0,u=void 0,t=void 0;c.next();)switch(c.tag()){case 1:d=c.getUInt32();break;case 2:f=c.getBytes();break;case 3:g=c.getUInt32();break;case 4:k=c.getUInt32();break;case 5:e=c.getSInt32();
break;case 6:u=c.getSInt32();break;case 7:t=c.getUInt32();break;default:c.skip()}d&&(this._metrics[d]={width:g,height:k,left:e,top:u,advance:t},this._bitmaps[d]=f);break;default:b.skip()}break;default:a.skip()}}a.prototype.getMetrics=function(a){return this._metrics[a]};a.prototype.getBitmap=function(a){return this._bitmaps[a]};return a}(),f=function(){function a(){this._ranges=[]}a.prototype.getRange=function(a){return this._ranges[a]};a.prototype.addRange=function(a,b){this._ranges[a]=b};return a}();
return function(){function g(a){this._glyphInfo={};this._baseURL=a}g.prototype.getRange=function(f,g){var h=this._getFontStack(f);if(h.getRange(g))return a.resolve();var k=256*g,e=k+255;f=this._baseURL.replace("{fontstack}",f).replace("{range}",k+"-"+e);return b(f,{callbackParamName:"callback",responseType:"array-buffer"}).then(function(a){h.addRange(g,new d(new c(new Uint8Array(a.data),new DataView(a.data))))})};g.prototype.getGlyph=function(a,b){if(a=this._getFontStack(a)){var c=Math.floor(b/256);
if(!(256<c)&&(a=a.getRange(c)))return{metrics:a.getMetrics(b),bitmap:a.getBitmap(b)}}};g.prototype._getFontStack=function(a){var b=this._glyphInfo[a];b||(b=this._glyphInfo[a]=new f);return b};return g}()})},"esri/core/pbf":function(){define(["require","exports"],function(m,e){return function(){function a(a,c,d,f){this._tag=0;this._dataType=99;this._data=a;this._dataView=c;this._pos=d||0;this._end=f||a.byteLength}a.prototype.clone=function(){return new a(this._data,this._dataView,this._pos,this._end)};
a.prototype.next=function(a){for(;;){if(this._pos===this._end)return!1;var b=this._decodeVarint();this._tag=b>>3;this._dataType=b&7;if(!a||a===this._tag)break;this.skip()}return!0};a.prototype.empty=function(){return this._pos>=this._end};a.prototype.tag=function(){return this._tag};a.prototype.getInt32=function(){return this._decodeVarint()};a.prototype.getInt64=function(){return this._decodeVarint()};a.prototype.getUInt32=function(){return this._decodeVarint()};a.prototype.getUInt64=function(){return this._decodeVarint()};
a.prototype.getSInt32=function(){return this._decodeSVarint()};a.prototype.getSInt64=function(){return this._decodeSVarint()};a.prototype.getBool=function(){var a=0!==this._data[this._pos];this._skip(1);return a};a.prototype.getEnum=function(){return this._decodeVarint()};a.prototype.getFixed64=function(){var a=this._dataView,c=this._pos,a=a.getUint32(c,!0)+4294967296*a.getUint32(c+4,!0);this._skip(8);return a};a.prototype.getSFixed64=function(){var a=this._dataView,c=this._pos,a=a.getUint32(c,!0)+
4294967296*a.getInt32(c+4,!0);this._skip(8);return a};a.prototype.getDouble=function(){var a=this._dataView.getFloat64(this._pos,!0);this._skip(8);return a};a.prototype.getFixed32=function(){var a=this._dataView.getUint32(this._pos,!0);this._skip(4);return a};a.prototype.getSFixed32=function(){var a=this._dataView.getInt32(this._pos,!0);this._skip(4);return a};a.prototype.getFloat=function(){var a=this._dataView.getFloat32(this._pos,!0);this._skip(4);return a};a.prototype.getString=function(){var a=
this._getLength(),c=this._pos,c=this._toString(this._data,c,c+a);this._skip(a);return c};a.prototype.getBytes=function(){var a=this._getLength(),c=this._pos,c=this._toBytes(this._data,c,c+a);this._skip(a);return c};a.prototype.getMessage=function(){var b=this._getLength(),c=this._pos,c=new a(this._data,this._dataView,c,c+b);this._skip(b);return c};a.prototype.skip=function(){switch(this._dataType){case 0:this._decodeVarint();break;case 1:this._skip(8);break;case 2:this._skip(this._getLength());break;
case 5:this._skip(4);break;default:throw Error("Invalid data type!");}};a.prototype._skip=function(a){if(this._pos+a>this._end)throw Error("Attempt to skip past the end of buffer!");this._pos+=a};a.prototype._decodeVarint=function(){var a=this._data,c=this._pos,d=0,f;if(10<=this._end-c){if(f=a[c++],d|=f&127,0!==(f&128)&&(f=a[c++],d|=(f&127)<<7,0!==(f&128)&&(f=a[c++],d|=(f&127)<<14,0!==(f&128)&&(f=a[c++],d|=(f&127)<<21,0!==(f&128)&&(f=a[c++],d+=268435456*(f&127),0!==(f&128)&&(f=a[c++],d+=34359738368*
(f&127),0!==(f&128)&&(f=a[c++],d+=4398046511104*(f&127),0!==(f&128)&&(f=a[c++],d+=562949953421312*(f&127),0!==(f&128)&&(f=a[c++],d+=72057594037927936*(f&127),0!==(f&128)&&(f=a[c++],d+=0x7fffffffffffffff*(f&127),0!==(f&128)))))))))))throw Error("Varint too long!");}else{for(var g=1;c!==this._end;){f=a[c];if(0===(f&128))break;++c;d+=(f&127)*g;g*=128}if(c===this._end)throw Error("Varint overrun!");++c;d+=f*g}this._pos=c;return d};a.prototype._decodeSVarint=function(){var a=this._decodeVarint();return a%
2?-(a+1)/2:a/2};a.prototype._getLength=function(){if(2!==this._dataType)throw Error("Not a delimited data type!");return this._decodeVarint()};a.prototype._toString=function(a,c,d){var b="",g="";for(d=Math.min(this._end,d);c<d;++c){var k=a[c];k&128?g+="%"+k.toString(16):(b+=decodeURIComponent(g)+String.fromCharCode(k),g="")}g.length&&(b+=decodeURIComponent(g));return b};a.prototype._toBytes=function(a,c,d){d=Math.min(this._end,d);return new Uint8Array(a.buffer,c,d-c)};return a}()})},"esri/views/vectorTiles/VectorTileDisplayObject":function(){define("require exports ../../core/tsSupport/extendsHelper ../webgl/BufferObject ../2d/engine/DisplayObject ../../core/libs/gl-matrix/vec2 ../../core/libs/gl-matrix/mat4 ./RenderBucket".split(" "),
function(m,e,a,b,c,d,f,g){return function(c){function h(a,b,g,h,k,e,u,t,m,y,x){var l=c.call(this)||this;l._renderBuckets=[];l._vectorTileData=null;l._symbolUpdateData=null;l.coords=[0,0];l.tileTransform={transform:Float32Array[16],displayCoord:Float32Array[2]};l.stencilData={mask:0,reference:0};l.key=a;l.refKey=b;l.coords[0]=g[0];l.coords[1]=g[1];l.widthInPixels=h;l.coordRange=k;l.rotation=e;l._vectorTileData=u;l.styleLayers=t;l._glyphsMosaic=m;l.workerID=y;l._connection=x;l.id=a.id;l.status=3;l.tileTransform.transform=
f.create();l.tileTransform.displayCoord=d.create();return l}a(h,c);h.prototype.updateSymbolData=function(a){a&&(this._symbolUpdateData=a,this.requestRender())};h.prototype.dispose=function(){-1!==this.workerID&&this._connection&&6!==this.status&&7!==this.status&&this._connection.broadcast("destructTileData",{key:this.id,worker:this.workerID},[]);this.polygonTrianglesVertexArrayObject&&(this.polygonTrianglesVertexArrayObject.dispose(),this.polygonTrianglesVertexArrayObject=null);this.polygonOutlineVertexArrayObject&&
(this.polygonOutlineVertexArrayObject.dispose(),this.polygonOutlineVertexArrayObject=null);this.lineTrianglesVertexArrayObject&&(this.lineTrianglesVertexArrayObject.dispose(),this.lineTrianglesVertexArrayObject=null);this.lineJoinsVertexArrayObject&&(this.lineJoinsVertexArrayObject.dispose(),this.lineJoinsVertexArrayObject=null);this.iconVertexArrayObject&&(this.iconVertexArrayObject.dispose(),this.iconVertexArrayObject=null);this.textVertexArrayObject&&(this.textVertexArrayObject.dispose(),this.textVertexArrayObject=
null);this.polygonTrianglesVertexBuffer&&(this.polygonTrianglesVertexBuffer.dispose(),this.polygonTrianglesVertexBuffer=null);this.polygonTrianglesIndexBuffer&&(this.polygonTrianglesIndexBuffer.dispose(),this.polygonTrianglesIndexBuffer=null);this.polygonOutlinesVertexBuffer&&(this.polygonOutlinesVertexBuffer.dispose(),this.polygonOutlinesVertexBuffer=null);this.polygonOutlinesIndexBuffer&&(this.polygonOutlinesIndexBuffer.dispose(),this.polygonOutlinesIndexBuffer=null);this.lineVertexBuffer&&(this.lineVertexBuffer.dispose(),
this.lineVertexBuffer=null);this.lineTrianglesIndexBuffer&&(this.lineTrianglesIndexBuffer.dispose(),this.lineTrianglesIndexBuffer=null);this.lineJoinVertexBuffer&&(this.lineJoinVertexBuffer.dispose(),this.lineJoinVertexBuffer=null);this.iconVertexBuffer&&(this.iconVertexBuffer.dispose(),this.iconVertexBuffer=null);this.iconIndexBuffer&&(this.iconIndexBuffer.dispose(),this.iconIndexBuffer=null);this.textVertexBuffer&&(this.textVertexBuffer.dispose(),this.textVertexBuffer=null);this.textIndexBuffer&&
(this.textIndexBuffer.dispose(),this.textIndexBuffer=null);this._renderBuckets=[];this.status=7};h.prototype.attach=function(a){this.status=3;if(!this._vectorTileData)return!1;if(0===this._renderBuckets.length)for(var c=new Uint32Array(this._vectorTileData.bucketDataInfo),d=c.length,f=0;f<d;){var h=c[f],k=c[f+1];if(0===k)k=new g.BackgroundRenderBucket,k.layerID=h,this._renderBuckets.push(k),f+=2;else if(1===k)k=new g.FillRenderBucket,k.layerID=h,k.triangleElementStart=c[f+2],k.triangleElementCount=
c[f+3],k.outlineElementStart=c[f+4],k.outlineElementCount=c[f+5],this._renderBuckets.push(k),f+=6;else if(2===k)k=new g.LineRenderBucket,k.layerID=h,k.triangleElementStart=c[f+2],k.triangleElementCount=c[f+3],k.joinStart=c[f+4],k.joinCount=c[f+5],this._renderBuckets.push(k),f+=6;else if(3===k){k=new g.SymbolRenderBucket;k.layerID=h;k.textElementStart=c[f+2];k.textElementCount=c[f+3];k.isSDF=0!==c[f+4];h=c[f+5];if(0<h)for(var e=f+6,n=void 0,m=void 0,y=void 0,x=0;x<h;x++)n=c[e],m=c[e+1],y=c[e+2],k.markerPerPageElementsMap.set(n,
[m,y]),e+=3;this._renderBuckets.push(k);f+=6+3*h}else console.error("Bad bucket type!")}c=a.context;a=a.budget;d=new Uint32Array(this._vectorTileData.bufferDataInfo);f=d.length;for(h=k=0;h<f;h+=2,k++)if(e=d[h+1],!(0>=e||0===this._vectorTileData.bufferData[k].byteLength)){if(a&&a.done)return!1;switch(d[h]){case 2:this.polygonTrianglesVertexBuffer||(this.polygonTrianglesVertexBuffer=b.createVertex(c,35044,this._vectorTileData.bufferData[k]));break;case 6:this.polygonTrianglesIndexBuffer||(this.polygonTrianglesIndexBuffer=
b.createIndex(c,35044,new Uint32Array(this._vectorTileData.bufferData[k],0,e/4)));break;case 3:this.polygonOutlinesVertexBuffer||(this.polygonOutlinesVertexBuffer=b.createVertex(c,35044,this._vectorTileData.bufferData[k]));break;case 7:this.polygonOutlinesIndexBuffer||(this.polygonOutlinesIndexBuffer=b.createIndex(c,35044,new Uint32Array(this._vectorTileData.bufferData[k],0,e/4)));break;case 0:this.lineVertexBuffer||(this.lineVertexBuffer=b.createVertex(c,35044,this._vectorTileData.bufferData[k]));
break;case 8:this.lineTrianglesIndexBuffer||(this.lineTrianglesIndexBuffer=b.createIndex(c,35044,this._vectorTileData.bufferData[k]));break;case 1:this.lineJoinVertexBuffer||(this.lineJoinVertexBuffer=b.createVertex(c,35044,this._vectorTileData.bufferData[k]));break;case 4:this.iconVertexBuffer||(this.iconVertexBuffer=b.createVertex(c,35044,this._vectorTileData.bufferData[k]));break;case 9:this.iconIndexBuffer||(this.iconIndexBuffer=b.createIndex(c,35044,new Uint32Array(this._vectorTileData.bufferData[k],
0,e/4)));break;case 5:this.textVertexBuffer||(this.textVertexBuffer=b.createVertex(c,35044,this._vectorTileData.bufferData[k]));break;case 10:this.textIndexBuffer||(this.textIndexBuffer=b.createIndex(c,35044,new Uint32Array(this._vectorTileData.bufferData[k],0,e/4)))}}this.status=4;return!0};h.prototype.detach=function(a){};h.prototype.render=function(a){if(this.visible&&4===this.status){var b=a.context,c=a.renderer;if(b&&c){var d=a.drawphase;this._symbolUpdateData&&this._updateSymbolData(a);b.setStencilFunction(514,
this.stencilData.reference,this.stencilData.mask);var f=this.styleLayers,g=void 0!==a.layerOpacity?a.layerOpacity:1;if(0!==g){var h,k=this._renderBuckets.length,e=0;if(0===d)for(e=k-1;0<=e;e--)h=this._renderBuckets[e],3!==h.type&&h.hasData()&&c.renderBucket(b,h,a.displayLevel,a.requiredLevel,d,this,f.layers[h.layerID],g);else for(e=0;e<k;e++)h=this._renderBuckets[e],h.hasData()&&c.renderBucket(b,h,a.displayLevel,a.requiredLevel,d,this,f.layers[h.layerID],g)}}}};h.prototype._updateSymbolData=function(a){var c=
new Uint32Array(this._symbolUpdateData.bucketDataInfo),d=c.length;if(0===d)return this._symbolUpdateData=null,!0;if(1>a.budget.remaining)return this.requestRender(),!1;a=a.context;a.bindVAO(null);for(var f=new Uint32Array(this._symbolUpdateData.bufferDataInfo),h=f.length,k=0,e=0;e<h;e+=2,k++){var n=f[e+1];if(!(0>=n||0===this._symbolUpdateData.bufferData[k].byteLength))switch(f[e]){case 4:this.iconVertexBuffer&&(this.iconVertexBuffer.dispose(),this.iconVertexBuffer=null);this.iconVertexBuffer=b.createVertex(a,
35044,this._symbolUpdateData.bufferData[k]);break;case 9:this.iconIndexBuffer&&(this.iconIndexBuffer.dispose(),this.iconIndexBuffer=null);this.iconIndexBuffer=b.createIndex(a,35044,new Uint32Array(this._symbolUpdateData.bufferData[k],0,n/4));break;case 5:this.textVertexBuffer&&(this.textVertexBuffer.dispose(),this.textVertexBuffer=null);this.textVertexBuffer=b.createVertex(a,35044,this._symbolUpdateData.bufferData[k]);break;case 10:this.textIndexBuffer&&(this.textIndexBuffer.dispose(),this.textIndexBuffer=
null),this.textIndexBuffer=b.createIndex(a,35044,new Uint32Array(this._symbolUpdateData.bufferData[k],0,n/4))}}a=this._renderBuckets.length;for(f=0;f<a;f++)this._renderBuckets[f]instanceof g.SymbolRenderBucket&&(h=this._renderBuckets[f],h.markerPerPageElementsMap.clear(),h.textElementStart=0,h.textElementCount=0);for(a=0;a<d;){k=c[a];h=-1;e=this._renderBuckets.length;for(f=0;f<e;f++)if(this._renderBuckets[f].layerID===k){h=f;break}-1===h&&console.log("bucket not found");if(f=this._renderBuckets[h]){f.textElementStart=
c[a+2];f.textElementCount=c[a+3];for(var h=c[a+5],k=a+6,m=n=e=void 0,y=0;y<h;y++)e=c[k],n=c[k+1],m=c[k+2],f.markerPerPageElementsMap.set(e,[n,m]),k+=3;a+=6+3*h}else a+=7}this.iconVertexArrayObject&&(this.iconVertexArrayObject.dispose(),this.iconVertexArrayObject=null);this.textVertexArrayObject&&(this.textVertexArrayObject.dispose(),this.textVertexArrayObject=null);this._symbolUpdateData=null;return!0};return h}(c)})},"esri/core/libs/gl-matrix/vec2":function(){define(["./common"],function(m){var e=
{create:function(){var a=new m.ARRAY_TYPE(2);a[0]=0;a[1]=0;return a},clone:function(a){var b=new m.ARRAY_TYPE(2);b[0]=a[0];b[1]=a[1];return b},fromValues:function(a,b){var c=new m.ARRAY_TYPE(2);c[0]=a;c[1]=b;return c},copy:function(a,b){a[0]=b[0];a[1]=b[1];return a},set:function(a,b,c){a[0]=b;a[1]=c;return a},add:function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];return a},subtract:function(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];return a}};e.sub=e.subtract;e.multiply=function(a,b,c){a[0]=b[0]*c[0];a[1]=
b[1]*c[1];return a};e.mul=e.multiply;e.divide=function(a,b,c){a[0]=b[0]/c[0];a[1]=b[1]/c[1];return a};e.div=e.divide;e.ceil=function(a,b){a[0]=Math.ceil(b[0]);a[1]=Math.ceil(b[1]);return a};e.floor=function(a,b){a[0]=Math.floor(b[0]);a[1]=Math.floor(b[1]);return a};e.min=function(a,b,c){a[0]=Math.min(b[0],c[0]);a[1]=Math.min(b[1],c[1]);return a};e.max=function(a,b,c){a[0]=Math.max(b[0],c[0]);a[1]=Math.max(b[1],c[1]);return a};e.round=function(a,b){a[0]=Math.round(b[0]);a[1]=Math.round(b[1]);return a};
e.scale=function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;return a};e.scaleAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;return a};e.distance=function(a,b){var c=b[0]-a[0];a=b[1]-a[1];return Math.sqrt(c*c+a*a)};e.dist=e.distance;e.squaredDistance=function(a,b){var c=b[0]-a[0];a=b[1]-a[1];return c*c+a*a};e.sqrDist=e.squaredDistance;e.length=function(a){var b=a[0];a=a[1];return Math.sqrt(b*b+a*a)};e.len=e.length;e.squaredLength=function(a){var b=a[0];a=a[1];return b*b+a*a};e.sqrLen=e.squaredLength;
e.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];return a};e.inverse=function(a,b){a[0]=1/b[0];a[1]=1/b[1];return a};e.normalize=function(a,b){var c=b[0],d=b[1],c=c*c+d*d;0<c&&(c=1/Math.sqrt(c),a[0]=b[0]*c,a[1]=b[1]*c);return a};e.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]};e.cross=function(a,b,c){b=b[0]*c[1]-b[1]*c[0];a[0]=a[1]=0;a[2]=b;return a};e.lerp=function(a,b,c,d){var f=b[0];b=b[1];a[0]=f+d*(c[0]-f);a[1]=b+d*(c[1]-b);return a};e.random=function(a,b){b=b||1;var c=2*m.RANDOM()*Math.PI;a[0]=Math.cos(c)*
b;a[1]=Math.sin(c)*b;return a};e.transformMat2=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[2]*b;a[1]=c[1]*d+c[3]*b;return a};e.transformMat2d=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[2]*b+c[4];a[1]=c[1]*d+c[3]*b+c[5];return a};e.transformMat3=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[3]*b+c[6];a[1]=c[1]*d+c[4]*b+c[7];return a};e.transformMat4=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[4]*b+c[12];a[1]=c[1]*d+c[5]*b+c[13];return a};e.forEach=function(){var a=e.create();return function(b,
c,d,f,g,k){c||(c=2);d||(d=0);for(f=f?Math.min(f*c+d,b.length):b.length;d<f;d+=c)a[0]=b[d],a[1]=b[d+1],g(a,a,k),b[d]=a[0],b[d+1]=a[1];return b}}();e.str=function(a){return"vec2("+a[0]+", "+a[1]+")"};e.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]};e.equals=function(a,b){var c=a[0];a=a[1];var d=b[0];b=b[1];return Math.abs(c-d)<=m.EPSILON*Math.max(1,Math.abs(c),Math.abs(d))&&Math.abs(a-b)<=m.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))};return e})},"esri/core/libs/gl-matrix/common":function(){define([],
function(){var m={EPSILON:1E-6};m.ARRAY_TYPE="undefined"!==typeof Float32Array?Float32Array:Array;m.RANDOM=Math.random;m.ENABLE_SIMD=!1;m.SIMD_AVAILABLE=m.ARRAY_TYPE===Float32Array&&"SIMD"in this;m.USE_SIMD=m.ENABLE_SIMD&&m.SIMD_AVAILABLE;m.setMatrixArrayType=function(a){m.ARRAY_TYPE=a};var e=Math.PI/180;m.toRadian=function(a){return a*e};m.equals=function(a,b){return Math.abs(a-b)<=m.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))};return m})},"esri/core/libs/gl-matrix/mat4":function(){define(["./common"],
function(m){var e={scalar:{},SIMD:{},create:function(){var a=new m.ARRAY_TYPE(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a},clone:function(a){var b=new m.ARRAY_TYPE(16);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=
b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a},fromValues:function(a,b,c,d,f,g,k,h,e,l,p,q,v,r,u,t){var n=new m.ARRAY_TYPE(16);n[0]=a;n[1]=b;n[2]=c;n[3]=d;n[4]=f;n[5]=g;n[6]=k;n[7]=h;n[8]=e;n[9]=l;n[10]=p;n[11]=q;n[12]=v;n[13]=r;n[14]=u;n[15]=t;return n},set:function(a,b,c,d,f,g,k,h,e,l,p,q,v,r,u,t,m){a[0]=b;a[1]=c;a[2]=d;a[3]=f;a[4]=g;a[5]=k;a[6]=h;a[7]=e;a[8]=l;a[9]=p;a[10]=q;a[11]=v;a[12]=r;a[13]=u;a[14]=
t;a[15]=m;return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}};e.scalar.transpose=function(a,b){if(a===b){var c=b[1],d=b[2],f=b[3],g=b[6],k=b[7],h=b[11];a[1]=b[4];a[2]=b[8];a[3]=b[12];a[4]=c;a[6]=b[9];a[7]=b[13];a[8]=d;a[9]=g;a[11]=b[14];a[12]=f;a[13]=k;a[14]=h}else a[0]=b[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=
b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a};e.SIMD.transpose=function(a,b){var c,d,f,g,k,h;c=SIMD.Float32x4.load(b,0);d=SIMD.Float32x4.load(b,4);f=SIMD.Float32x4.load(b,8);b=SIMD.Float32x4.load(b,12);g=SIMD.Float32x4.shuffle(c,d,0,1,4,5);k=SIMD.Float32x4.shuffle(f,b,0,1,4,5);h=SIMD.Float32x4.shuffle(g,k,0,2,4,6);g=SIMD.Float32x4.shuffle(g,k,1,3,5,7);SIMD.Float32x4.store(a,0,h);SIMD.Float32x4.store(a,4,g);g=SIMD.Float32x4.shuffle(c,d,2,3,6,7);k=SIMD.Float32x4.shuffle(f,b,2,3,6,7);c=SIMD.Float32x4.shuffle(g,
k,0,2,4,6);d=SIMD.Float32x4.shuffle(g,k,1,3,5,7);SIMD.Float32x4.store(a,8,c);SIMD.Float32x4.store(a,12,d);return a};e.transpose=m.USE_SIMD?e.SIMD.transpose:e.scalar.transpose;e.scalar.invert=function(a,b){var c=b[0],d=b[1],f=b[2],g=b[3],k=b[4],h=b[5],e=b[6],l=b[7],p=b[8],q=b[9],v=b[10],r=b[11],u=b[12],t=b[13],m=b[14];b=b[15];var y=c*h-d*k,x=c*e-f*k,A=c*l-g*k,z=d*e-f*h,C=d*l-g*h,F=f*l-g*e,G=p*t-q*u,B=p*m-v*u,D=p*b-r*u,H=q*m-v*t,J=q*b-r*t,K=v*b-r*m,E=y*K-x*J+A*H+z*D-C*B+F*G;if(!E)return null;E=1/E;
a[0]=(h*K-e*J+l*H)*E;a[1]=(f*J-d*K-g*H)*E;a[2]=(t*F-m*C+b*z)*E;a[3]=(v*C-q*F-r*z)*E;a[4]=(e*D-k*K-l*B)*E;a[5]=(c*K-f*D+g*B)*E;a[6]=(m*A-u*F-b*x)*E;a[7]=(p*F-v*A+r*x)*E;a[8]=(k*J-h*D+l*G)*E;a[9]=(d*D-c*J-g*G)*E;a[10]=(u*C-t*A+b*y)*E;a[11]=(q*A-p*C-r*y)*E;a[12]=(h*B-k*H-e*G)*E;a[13]=(c*H-d*B+f*G)*E;a[14]=(t*x-u*z-m*y)*E;a[15]=(p*z-q*x+v*y)*E;return a};e.SIMD.invert=function(a,b){var c,d,f,g,k,h,e,l;k=SIMD.Float32x4.load(b,0);h=SIMD.Float32x4.load(b,4);e=SIMD.Float32x4.load(b,8);l=SIMD.Float32x4.load(b,
12);b=SIMD.Float32x4.shuffle(k,h,0,1,4,5);d=SIMD.Float32x4.shuffle(e,l,0,1,4,5);c=SIMD.Float32x4.shuffle(b,d,0,2,4,6);d=SIMD.Float32x4.shuffle(d,b,1,3,5,7);b=SIMD.Float32x4.shuffle(k,h,2,3,6,7);g=SIMD.Float32x4.shuffle(e,l,2,3,6,7);f=SIMD.Float32x4.shuffle(b,g,0,2,4,6);g=SIMD.Float32x4.shuffle(g,b,1,3,5,7);b=SIMD.Float32x4.mul(f,g);b=SIMD.Float32x4.swizzle(b,1,0,3,2);k=SIMD.Float32x4.mul(d,b);h=SIMD.Float32x4.mul(c,b);b=SIMD.Float32x4.swizzle(b,2,3,0,1);k=SIMD.Float32x4.sub(SIMD.Float32x4.mul(d,b),
k);h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,b),h);h=SIMD.Float32x4.swizzle(h,2,3,0,1);b=SIMD.Float32x4.mul(d,f);b=SIMD.Float32x4.swizzle(b,1,0,3,2);k=SIMD.Float32x4.add(SIMD.Float32x4.mul(g,b),k);l=SIMD.Float32x4.mul(c,b);b=SIMD.Float32x4.swizzle(b,2,3,0,1);k=SIMD.Float32x4.sub(k,SIMD.Float32x4.mul(g,b));l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,b),l);l=SIMD.Float32x4.swizzle(l,2,3,0,1);b=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,2,3,0,1),g);b=SIMD.Float32x4.swizzle(b,1,0,3,2);f=SIMD.Float32x4.swizzle(f,
2,3,0,1);k=SIMD.Float32x4.add(SIMD.Float32x4.mul(f,b),k);e=SIMD.Float32x4.mul(c,b);b=SIMD.Float32x4.swizzle(b,2,3,0,1);k=SIMD.Float32x4.sub(k,SIMD.Float32x4.mul(f,b));e=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,b),e);e=SIMD.Float32x4.swizzle(e,2,3,0,1);b=SIMD.Float32x4.mul(c,d);b=SIMD.Float32x4.swizzle(b,1,0,3,2);e=SIMD.Float32x4.add(SIMD.Float32x4.mul(g,b),e);l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(f,b),l);b=SIMD.Float32x4.swizzle(b,2,3,0,1);e=SIMD.Float32x4.sub(SIMD.Float32x4.mul(g,b),e);l=SIMD.Float32x4.sub(l,
SIMD.Float32x4.mul(f,b));b=SIMD.Float32x4.mul(c,g);b=SIMD.Float32x4.swizzle(b,1,0,3,2);h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(f,b));e=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,b),e);b=SIMD.Float32x4.swizzle(b,2,3,0,1);h=SIMD.Float32x4.add(SIMD.Float32x4.mul(f,b),h);e=SIMD.Float32x4.sub(e,SIMD.Float32x4.mul(d,b));b=SIMD.Float32x4.mul(c,f);b=SIMD.Float32x4.swizzle(b,1,0,3,2);h=SIMD.Float32x4.add(SIMD.Float32x4.mul(g,b),h);l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(d,b));b=SIMD.Float32x4.swizzle(b,2,
3,0,1);h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(g,b));l=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,b),l);c=SIMD.Float32x4.mul(c,k);c=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(c,2,3,0,1),c);c=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(c,1,0,3,2),c);b=SIMD.Float32x4.reciprocalApproximation(c);c=SIMD.Float32x4.sub(SIMD.Float32x4.add(b,b),SIMD.Float32x4.mul(c,SIMD.Float32x4.mul(b,b)));c=SIMD.Float32x4.swizzle(c,0,0,0,0);if(!c)return null;SIMD.Float32x4.store(a,0,SIMD.Float32x4.mul(c,k));SIMD.Float32x4.store(a,
4,SIMD.Float32x4.mul(c,h));SIMD.Float32x4.store(a,8,SIMD.Float32x4.mul(c,e));SIMD.Float32x4.store(a,12,SIMD.Float32x4.mul(c,l));return a};e.invert=m.USE_SIMD?e.SIMD.invert:e.scalar.invert;e.scalar.adjoint=function(a,b){var c=b[0],d=b[1],f=b[2],g=b[3],k=b[4],h=b[5],e=b[6],l=b[7],p=b[8],q=b[9],v=b[10],r=b[11],u=b[12],t=b[13],m=b[14];b=b[15];a[0]=h*(v*b-r*m)-q*(e*b-l*m)+t*(e*r-l*v);a[1]=-(d*(v*b-r*m)-q*(f*b-g*m)+t*(f*r-g*v));a[2]=d*(e*b-l*m)-h*(f*b-g*m)+t*(f*l-g*e);a[3]=-(d*(e*r-l*v)-h*(f*r-g*v)+q*(f*
l-g*e));a[4]=-(k*(v*b-r*m)-p*(e*b-l*m)+u*(e*r-l*v));a[5]=c*(v*b-r*m)-p*(f*b-g*m)+u*(f*r-g*v);a[6]=-(c*(e*b-l*m)-k*(f*b-g*m)+u*(f*l-g*e));a[7]=c*(e*r-l*v)-k*(f*r-g*v)+p*(f*l-g*e);a[8]=k*(q*b-r*t)-p*(h*b-l*t)+u*(h*r-l*q);a[9]=-(c*(q*b-r*t)-p*(d*b-g*t)+u*(d*r-g*q));a[10]=c*(h*b-l*t)-k*(d*b-g*t)+u*(d*l-g*h);a[11]=-(c*(h*r-l*q)-k*(d*r-g*q)+p*(d*l-g*h));a[12]=-(k*(q*m-v*t)-p*(h*m-e*t)+u*(h*v-e*q));a[13]=c*(q*m-v*t)-p*(d*m-f*t)+u*(d*v-f*q);a[14]=-(c*(h*m-e*t)-k*(d*m-f*t)+u*(d*e-f*h));a[15]=c*(h*v-e*q)-k*
(d*v-f*q)+p*(d*e-f*h);return a};e.SIMD.adjoint=function(a,b){var c,d,f,g,k,h,e,l;c=SIMD.Float32x4.load(b,0);d=SIMD.Float32x4.load(b,4);f=SIMD.Float32x4.load(b,8);g=SIMD.Float32x4.load(b,12);h=SIMD.Float32x4.shuffle(c,d,0,1,4,5);k=SIMD.Float32x4.shuffle(f,g,0,1,4,5);b=SIMD.Float32x4.shuffle(h,k,0,2,4,6);k=SIMD.Float32x4.shuffle(k,h,1,3,5,7);h=SIMD.Float32x4.shuffle(c,d,2,3,6,7);d=SIMD.Float32x4.shuffle(f,g,2,3,6,7);c=SIMD.Float32x4.shuffle(h,d,0,2,4,6);d=SIMD.Float32x4.shuffle(d,h,1,3,5,7);h=SIMD.Float32x4.mul(c,
d);h=SIMD.Float32x4.swizzle(h,1,0,3,2);f=SIMD.Float32x4.mul(k,h);g=SIMD.Float32x4.mul(b,h);h=SIMD.Float32x4.swizzle(h,2,3,0,1);f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(k,h),f);g=SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,h),g);g=SIMD.Float32x4.swizzle(g,2,3,0,1);h=SIMD.Float32x4.mul(k,c);h=SIMD.Float32x4.swizzle(h,1,0,3,2);f=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,h),f);l=SIMD.Float32x4.mul(b,h);h=SIMD.Float32x4.swizzle(h,2,3,0,1);f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(d,h));l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,
h),l);l=SIMD.Float32x4.swizzle(l,2,3,0,1);h=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(k,2,3,0,1),d);h=SIMD.Float32x4.swizzle(h,1,0,3,2);c=SIMD.Float32x4.swizzle(c,2,3,0,1);f=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,h),f);e=SIMD.Float32x4.mul(b,h);h=SIMD.Float32x4.swizzle(h,2,3,0,1);f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(c,h));e=SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,h),e);e=SIMD.Float32x4.swizzle(e,2,3,0,1);h=SIMD.Float32x4.mul(b,k);h=SIMD.Float32x4.swizzle(h,1,0,3,2);e=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,
h),e);l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,h),l);h=SIMD.Float32x4.swizzle(h,2,3,0,1);e=SIMD.Float32x4.sub(SIMD.Float32x4.mul(d,h),e);l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(c,h));h=SIMD.Float32x4.mul(b,d);h=SIMD.Float32x4.swizzle(h,1,0,3,2);g=SIMD.Float32x4.sub(g,SIMD.Float32x4.mul(c,h));e=SIMD.Float32x4.add(SIMD.Float32x4.mul(k,h),e);h=SIMD.Float32x4.swizzle(h,2,3,0,1);g=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,h),g);e=SIMD.Float32x4.sub(e,SIMD.Float32x4.mul(k,h));h=SIMD.Float32x4.mul(b,c);
h=SIMD.Float32x4.swizzle(h,1,0,3,2);g=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,h),g);l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(k,h));h=SIMD.Float32x4.swizzle(h,2,3,0,1);g=SIMD.Float32x4.sub(g,SIMD.Float32x4.mul(d,h));l=SIMD.Float32x4.add(SIMD.Float32x4.mul(k,h),l);SIMD.Float32x4.store(a,0,f);SIMD.Float32x4.store(a,4,g);SIMD.Float32x4.store(a,8,e);SIMD.Float32x4.store(a,12,l);return a};e.adjoint=m.USE_SIMD?e.SIMD.adjoint:e.scalar.adjoint;e.determinant=function(a){var b=a[0],c=a[1],d=a[2],f=a[3],g=a[4],
k=a[5],h=a[6],e=a[7],l=a[8],p=a[9],q=a[10],v=a[11],r=a[12],u=a[13],m=a[14];a=a[15];return(b*k-c*g)*(q*a-v*m)-(b*h-d*g)*(p*a-v*u)+(b*e-f*g)*(p*m-q*u)+(c*h-d*k)*(l*a-v*r)-(c*e-f*k)*(l*m-q*r)+(d*e-f*h)*(l*u-p*r)};e.SIMD.multiply=function(a,b,c){var d=SIMD.Float32x4.load(b,0),f=SIMD.Float32x4.load(b,4),g=SIMD.Float32x4.load(b,8);b=SIMD.Float32x4.load(b,12);var k=SIMD.Float32x4.load(c,0),k=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(k,0,0,0,0),d),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(k,
1,1,1,1),f),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(k,2,2,2,2),g),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(k,3,3,3,3),b))));SIMD.Float32x4.store(a,0,k);k=SIMD.Float32x4.load(c,4);k=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(k,0,0,0,0),d),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(k,1,1,1,1),f),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(k,2,2,2,2),g),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(k,3,3,3,3),b))));SIMD.Float32x4.store(a,
4,k);k=SIMD.Float32x4.load(c,8);k=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(k,0,0,0,0),d),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(k,1,1,1,1),f),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(k,2,2,2,2),g),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(k,3,3,3,3),b))));SIMD.Float32x4.store(a,8,k);c=SIMD.Float32x4.load(c,12);d=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,0,0,0,0),d),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,
1,1,1,1),f),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,2,2,2,2),g),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,3,3,3,3),b))));SIMD.Float32x4.store(a,12,d);return a};e.scalar.multiply=function(a,b,c){var d=b[0],f=b[1],g=b[2],k=b[3],h=b[4],e=b[5],l=b[6],p=b[7],q=b[8],v=b[9],r=b[10],m=b[11],t=b[12],w=b[13],y=b[14];b=b[15];var x=c[0],A=c[1],z=c[2],C=c[3];a[0]=x*d+A*h+z*q+C*t;a[1]=x*f+A*e+z*v+C*w;a[2]=x*g+A*l+z*r+C*y;a[3]=x*k+A*p+z*m+C*b;x=c[4];A=c[5];z=c[6];C=c[7];a[4]=x*d+A*h+z*q+
C*t;a[5]=x*f+A*e+z*v+C*w;a[6]=x*g+A*l+z*r+C*y;a[7]=x*k+A*p+z*m+C*b;x=c[8];A=c[9];z=c[10];C=c[11];a[8]=x*d+A*h+z*q+C*t;a[9]=x*f+A*e+z*v+C*w;a[10]=x*g+A*l+z*r+C*y;a[11]=x*k+A*p+z*m+C*b;x=c[12];A=c[13];z=c[14];C=c[15];a[12]=x*d+A*h+z*q+C*t;a[13]=x*f+A*e+z*v+C*w;a[14]=x*g+A*l+z*r+C*y;a[15]=x*k+A*p+z*m+C*b;return a};e.multiply=m.USE_SIMD?e.SIMD.multiply:e.scalar.multiply;e.mul=e.multiply;e.scalar.translate=function(a,b,c){var d=c[0],f=c[1];c=c[2];var g,e,h,n,l,p,q,v,r,m,t,w;b===a?(a[12]=b[0]*d+b[4]*f+
b[8]*c+b[12],a[13]=b[1]*d+b[5]*f+b[9]*c+b[13],a[14]=b[2]*d+b[6]*f+b[10]*c+b[14],a[15]=b[3]*d+b[7]*f+b[11]*c+b[15]):(g=b[0],e=b[1],h=b[2],n=b[3],l=b[4],p=b[5],q=b[6],v=b[7],r=b[8],m=b[9],t=b[10],w=b[11],a[0]=g,a[1]=e,a[2]=h,a[3]=n,a[4]=l,a[5]=p,a[6]=q,a[7]=v,a[8]=r,a[9]=m,a[10]=t,a[11]=w,a[12]=g*d+l*f+r*c+b[12],a[13]=e*d+p*f+m*c+b[13],a[14]=h*d+q*f+t*c+b[14],a[15]=n*d+v*f+w*c+b[15]);return a};e.SIMD.translate=function(a,b,c){var d=SIMD.Float32x4.load(b,0),f=SIMD.Float32x4.load(b,4),g=SIMD.Float32x4.load(b,
8),e=SIMD.Float32x4.load(b,12);c=SIMD.Float32x4(c[0],c[1],c[2],0);b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11]);d=SIMD.Float32x4.mul(d,SIMD.Float32x4.swizzle(c,0,0,0,0));f=SIMD.Float32x4.mul(f,SIMD.Float32x4.swizzle(c,1,1,1,1));g=SIMD.Float32x4.mul(g,SIMD.Float32x4.swizzle(c,2,2,2,2));b=SIMD.Float32x4.add(d,SIMD.Float32x4.add(f,SIMD.Float32x4.add(g,e)));SIMD.Float32x4.store(a,12,b);return a};e.translate=m.USE_SIMD?
e.SIMD.translate:e.scalar.translate;e.scalar.scale=function(a,b,c){var d=c[0],f=c[1];c=c[2];a[0]=b[0]*d;a[1]=b[1]*d;a[2]=b[2]*d;a[3]=b[3]*d;a[4]=b[4]*f;a[5]=b[5]*f;a[6]=b[6]*f;a[7]=b[7]*f;a[8]=b[8]*c;a[9]=b[9]*c;a[10]=b[10]*c;a[11]=b[11]*c;a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a};e.SIMD.scale=function(a,b,c){var d;c=SIMD.Float32x4(c[0],c[1],c[2],0);d=SIMD.Float32x4.load(b,0);SIMD.Float32x4.store(a,0,SIMD.Float32x4.mul(d,SIMD.Float32x4.swizzle(c,0,0,0,0)));d=SIMD.Float32x4.load(b,
4);SIMD.Float32x4.store(a,4,SIMD.Float32x4.mul(d,SIMD.Float32x4.swizzle(c,1,1,1,1)));d=SIMD.Float32x4.load(b,8);SIMD.Float32x4.store(a,8,SIMD.Float32x4.mul(d,SIMD.Float32x4.swizzle(c,2,2,2,2)));a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a};e.scale=m.USE_SIMD?e.SIMD.scale:e.scalar.scale;e.rotate=function(a,b,c,d){var f=d[0],g=d[1];d=d[2];var e=Math.sqrt(f*f+g*g+d*d),h,n,l,p,q,v,r,u,t,w,y,x,A,z,C,F,G,B,D,H;if(Math.abs(e)<m.EPSILON)return null;e=1/e;f*=e;g*=e;d*=e;h=Math.sin(c);n=Math.cos(c);
l=1-n;c=b[0];e=b[1];p=b[2];q=b[3];v=b[4];r=b[5];u=b[6];t=b[7];w=b[8];y=b[9];x=b[10];A=b[11];z=f*f*l+n;C=g*f*l+d*h;F=d*f*l-g*h;G=f*g*l-d*h;B=g*g*l+n;D=d*g*l+f*h;H=f*d*l+g*h;f=g*d*l-f*h;g=d*d*l+n;a[0]=c*z+v*C+w*F;a[1]=e*z+r*C+y*F;a[2]=p*z+u*C+x*F;a[3]=q*z+t*C+A*F;a[4]=c*G+v*B+w*D;a[5]=e*G+r*B+y*D;a[6]=p*G+u*B+x*D;a[7]=q*G+t*B+A*D;a[8]=c*H+v*f+w*g;a[9]=e*H+r*f+y*g;a[10]=p*H+u*f+x*g;a[11]=q*H+t*f+A*g;b!==a&&(a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);return a};e.scalar.rotateX=function(a,b,c){var d=
Math.sin(c);c=Math.cos(c);var f=b[4],g=b[5],e=b[6],h=b[7],n=b[8],l=b[9],p=b[10],q=b[11];b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[4]=f*c+n*d;a[5]=g*c+l*d;a[6]=e*c+p*d;a[7]=h*c+q*d;a[8]=n*c-f*d;a[9]=l*c-g*d;a[10]=p*c-e*d;a[11]=q*c-h*d;return a};e.SIMD.rotateX=function(a,b,c){var d=SIMD.Float32x4.splat(Math.sin(c));c=SIMD.Float32x4.splat(Math.cos(c));b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);
var f=SIMD.Float32x4.load(b,4);b=SIMD.Float32x4.load(b,8);SIMD.Float32x4.store(a,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(f,c),SIMD.Float32x4.mul(b,d)));SIMD.Float32x4.store(a,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,c),SIMD.Float32x4.mul(f,d)));return a};e.rotateX=m.USE_SIMD?e.SIMD.rotateX:e.scalar.rotateX;e.scalar.rotateY=function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var f=b[0],g=b[1],e=b[2],h=b[3],n=b[8],l=b[9],p=b[10],q=b[11];b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=
b[13],a[14]=b[14],a[15]=b[15]);a[0]=f*c-n*d;a[1]=g*c-l*d;a[2]=e*c-p*d;a[3]=h*c-q*d;a[8]=f*d+n*c;a[9]=g*d+l*c;a[10]=e*d+p*c;a[11]=h*d+q*c;return a};e.SIMD.rotateY=function(a,b,c){var d=SIMD.Float32x4.splat(Math.sin(c));c=SIMD.Float32x4.splat(Math.cos(c));b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);var f=SIMD.Float32x4.load(b,0);b=SIMD.Float32x4.load(b,8);SIMD.Float32x4.store(a,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(f,c),SIMD.Float32x4.mul(b,d)));
SIMD.Float32x4.store(a,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(f,d),SIMD.Float32x4.mul(b,c)));return a};e.rotateY=m.USE_SIMD?e.SIMD.rotateY:e.scalar.rotateY;e.scalar.rotateZ=function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var f=b[0],g=b[1],e=b[2],h=b[3],n=b[4],l=b[5],p=b[6],q=b[7];b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=f*c+n*d;a[1]=g*c+l*d;a[2]=e*c+p*d;a[3]=h*c+q*d;a[4]=n*c-f*d;a[5]=l*c-g*d;a[6]=p*c-e*d;a[7]=q*c-h*d;return a};e.SIMD.rotateZ=
function(a,b,c){var d=SIMD.Float32x4.splat(Math.sin(c));c=SIMD.Float32x4.splat(Math.cos(c));b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);var f=SIMD.Float32x4.load(b,0);b=SIMD.Float32x4.load(b,4);SIMD.Float32x4.store(a,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(f,c),SIMD.Float32x4.mul(b,d)));SIMD.Float32x4.store(a,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,c),SIMD.Float32x4.mul(f,d)));return a};e.rotateZ=m.USE_SIMD?e.SIMD.rotateZ:e.scalar.rotateZ;
e.fromTranslation=function(a,b){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=b[0];a[13]=b[1];a[14]=b[2];a[15]=1;return a};e.fromScaling=function(a,b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b[1];a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=b[2];a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};e.fromRotation=function(a,b,c){var d=c[0],f=c[1];c=c[2];var g=Math.sqrt(d*d+f*f+c*c),e;if(Math.abs(g)<m.EPSILON)return null;g=1/g;d*=g;f*=g;c*=g;g=Math.sin(b);b=Math.cos(b);
e=1-b;a[0]=d*d*e+b;a[1]=f*d*e+c*g;a[2]=c*d*e-f*g;a[3]=0;a[4]=d*f*e-c*g;a[5]=f*f*e+b;a[6]=c*f*e+d*g;a[7]=0;a[8]=d*c*e+f*g;a[9]=f*c*e-d*g;a[10]=c*c*e+b;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};e.fromXRotation=function(a,b){var c=Math.sin(b);b=Math.cos(b);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=c;a[7]=0;a[8]=0;a[9]=-c;a[10]=b;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};e.fromYRotation=function(a,b){var c=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=0;a[2]=-c;a[3]=0;a[4]=0;a[5]=1;a[6]=
0;a[7]=0;a[8]=c;a[9]=0;a[10]=b;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};e.fromZRotation=function(a,b){var c=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=c;a[2]=0;a[3]=0;a[4]=-c;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};e.fromRotationTranslation=function(a,b,c){var d=b[0],f=b[1],g=b[2],e=b[3],h=d+d,n=f+f,l=g+g;b=d*h;var p=d*n,d=d*l,q=f*n,f=f*l,g=g*l,h=e*h,n=e*n,e=e*l;a[0]=1-(q+g);a[1]=p+e;a[2]=d-n;a[3]=0;a[4]=p-e;a[5]=1-(b+g);a[6]=f+h;a[7]=0;a[8]=
d+n;a[9]=f-h;a[10]=1-(b+q);a[11]=0;a[12]=c[0];a[13]=c[1];a[14]=c[2];a[15]=1;return a};e.getTranslation=function(a,b){a[0]=b[12];a[1]=b[13];a[2]=b[14];return a};e.getRotation=function(a,b){var c=b[0]+b[5]+b[10],d=0;0<c?(d=2*Math.sqrt(c+1),a[3]=.25*d,a[0]=(b[6]-b[9])/d,a[1]=(b[8]-b[2])/d,a[2]=(b[1]-b[4])/d):b[0]>b[5]&b[0]>b[10]?(d=2*Math.sqrt(1+b[0]-b[5]-b[10]),a[3]=(b[6]-b[9])/d,a[0]=.25*d,a[1]=(b[1]+b[4])/d,a[2]=(b[8]+b[2])/d):b[5]>b[10]?(d=2*Math.sqrt(1+b[5]-b[0]-b[10]),a[3]=(b[8]-b[2])/d,a[0]=(b[1]+
b[4])/d,a[1]=.25*d,a[2]=(b[6]+b[9])/d):(d=2*Math.sqrt(1+b[10]-b[0]-b[5]),a[3]=(b[1]-b[4])/d,a[0]=(b[8]+b[2])/d,a[1]=(b[6]+b[9])/d,a[2]=.25*d);return a};e.fromRotationTranslationScale=function(a,b,c,d){var f=b[0],g=b[1],e=b[2],h=b[3],n=f+f,l=g+g,p=e+e;b=f*n;var q=f*l,f=f*p,v=g*l,g=g*p,e=e*p,n=h*n,l=h*l,h=h*p,p=d[0],r=d[1];d=d[2];a[0]=(1-(v+e))*p;a[1]=(q+h)*p;a[2]=(f-l)*p;a[3]=0;a[4]=(q-h)*r;a[5]=(1-(b+e))*r;a[6]=(g+n)*r;a[7]=0;a[8]=(f+l)*d;a[9]=(g-n)*d;a[10]=(1-(b+v))*d;a[11]=0;a[12]=c[0];a[13]=c[1];
a[14]=c[2];a[15]=1;return a};e.fromRotationTranslationScaleOrigin=function(a,b,c,d,f){var g=b[0],e=b[1],h=b[2],n=b[3],l=g+g,p=e+e,q=h+h;b=g*l;var v=g*p,g=g*q,r=e*p,e=e*q,h=h*q,l=n*l,p=n*p,n=n*q,q=d[0],m=d[1];d=d[2];var t=f[0],w=f[1];f=f[2];a[0]=(1-(r+h))*q;a[1]=(v+n)*q;a[2]=(g-p)*q;a[3]=0;a[4]=(v-n)*m;a[5]=(1-(b+h))*m;a[6]=(e+l)*m;a[7]=0;a[8]=(g+p)*d;a[9]=(e-l)*d;a[10]=(1-(b+r))*d;a[11]=0;a[12]=c[0]+t-(a[0]*t+a[4]*w+a[8]*f);a[13]=c[1]+w-(a[1]*t+a[5]*w+a[9]*f);a[14]=c[2]+f-(a[2]*t+a[6]*w+a[10]*f);
a[15]=1;return a};e.fromQuat=function(a,b){var c=b[0],d=b[1],f=b[2];b=b[3];var g=c+c,e=d+d,h=f+f,c=c*g,n=d*g,d=d*e,l=f*g,p=f*e,f=f*h,g=b*g,e=b*e;b*=h;a[0]=1-d-f;a[1]=n+b;a[2]=l-e;a[3]=0;a[4]=n-b;a[5]=1-c-f;a[6]=p+g;a[7]=0;a[8]=l+e;a[9]=p-g;a[10]=1-c-d;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};e.frustum=function(a,b,c,d,f,g,e){var h=1/(c-b),k=1/(f-d),l=1/(g-e);a[0]=2*g*h;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=2*g*k;a[6]=0;a[7]=0;a[8]=(c+b)*h;a[9]=(f+d)*k;a[10]=(e+g)*l;a[11]=-1;a[12]=0;a[13]=0;a[14]=
e*g*2*l;a[15]=0;return a};e.perspective=function(a,b,c,d,f){b=1/Math.tan(b/2);var g=1/(d-f);a[0]=b/c;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=(f+d)*g;a[11]=-1;a[12]=0;a[13]=0;a[14]=2*f*d*g;a[15]=0;return a};e.perspectiveFromFieldOfView=function(a,b,c,d){var f=Math.tan(b.upDegrees*Math.PI/180),g=Math.tan(b.downDegrees*Math.PI/180),e=Math.tan(b.leftDegrees*Math.PI/180);b=Math.tan(b.rightDegrees*Math.PI/180);var h=2/(e+b),n=2/(f+g);a[0]=h;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=
n;a[6]=0;a[7]=0;a[8]=-((e-b)*h*.5);a[9]=(f-g)*n*.5;a[10]=d/(c-d);a[11]=-1;a[12]=0;a[13]=0;a[14]=d*c/(c-d);a[15]=0;return a};e.ortho=function(a,b,c,d,f,e,k){var g=1/(b-c),n=1/(d-f),l=1/(e-k);a[0]=-2*g;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=-2*n;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=2*l;a[11]=0;a[12]=(b+c)*g;a[13]=(f+d)*n;a[14]=(k+e)*l;a[15]=1;return a};e.lookAt=function(a,b,c,d){var f,g,k,h,n,l,p,q,v=b[0],r=b[1];b=b[2];k=d[0];h=d[1];g=d[2];p=c[0];d=c[1];f=c[2];if(Math.abs(v-p)<m.EPSILON&&Math.abs(r-d)<m.EPSILON&&
Math.abs(b-f)<m.EPSILON)return e.identity(a);c=v-p;d=r-d;p=b-f;q=1/Math.sqrt(c*c+d*d+p*p);c*=q;d*=q;p*=q;f=h*p-g*d;g=g*c-k*p;k=k*d-h*c;(q=Math.sqrt(f*f+g*g+k*k))?(q=1/q,f*=q,g*=q,k*=q):k=g=f=0;h=d*k-p*g;n=p*f-c*k;l=c*g-d*f;(q=Math.sqrt(h*h+n*n+l*l))?(q=1/q,h*=q,n*=q,l*=q):l=n=h=0;a[0]=f;a[1]=h;a[2]=c;a[3]=0;a[4]=g;a[5]=n;a[6]=d;a[7]=0;a[8]=k;a[9]=l;a[10]=p;a[11]=0;a[12]=-(f*v+g*r+k*b);a[13]=-(h*v+n*r+l*b);a[14]=-(c*v+d*r+p*b);a[15]=1;return a};e.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+
", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};e.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))};e.add=function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+
c[1];a[2]=b[2]+c[2];a[3]=b[3]+c[3];a[4]=b[4]+c[4];a[5]=b[5]+c[5];a[6]=b[6]+c[6];a[7]=b[7]+c[7];a[8]=b[8]+c[8];a[9]=b[9]+c[9];a[10]=b[10]+c[10];a[11]=b[11]+c[11];a[12]=b[12]+c[12];a[13]=b[13]+c[13];a[14]=b[14]+c[14];a[15]=b[15]+c[15];return a};e.subtract=function(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];a[3]=b[3]-c[3];a[4]=b[4]-c[4];a[5]=b[5]-c[5];a[6]=b[6]-c[6];a[7]=b[7]-c[7];a[8]=b[8]-c[8];a[9]=b[9]-c[9];a[10]=b[10]-c[10];a[11]=b[11]-c[11];a[12]=b[12]-c[12];a[13]=b[13]-c[13];a[14]=b[14]-
c[14];a[15]=b[15]-c[15];return a};e.sub=e.subtract;e.multiplyScalar=function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;a[4]=b[4]*c;a[5]=b[5]*c;a[6]=b[6]*c;a[7]=b[7]*c;a[8]=b[8]*c;a[9]=b[9]*c;a[10]=b[10]*c;a[11]=b[11]*c;a[12]=b[12]*c;a[13]=b[13]*c;a[14]=b[14]*c;a[15]=b[15]*c;return a};e.multiplyScalarAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;a[2]=b[2]+c[2]*d;a[3]=b[3]+c[3]*d;a[4]=b[4]+c[4]*d;a[5]=b[5]+c[5]*d;a[6]=b[6]+c[6]*d;a[7]=b[7]+c[7]*d;a[8]=b[8]+c[8]*d;a[9]=b[9]+
c[9]*d;a[10]=b[10]+c[10]*d;a[11]=b[11]+c[11]*d;a[12]=b[12]+c[12]*d;a[13]=b[13]+c[13]*d;a[14]=b[14]+c[14]*d;a[15]=b[15]+c[15]*d;return a};e.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]&&a[9]===b[9]&&a[10]===b[10]&&a[11]===b[11]&&a[12]===b[12]&&a[13]===b[13]&&a[14]===b[14]&&a[15]===b[15]};e.equals=function(a,b){var c=a[0],d=a[1],f=a[2],e=a[3],k=a[4],h=a[5],n=a[6],l=a[7],p=a[8],q=a[9],v=a[10],r=a[11],
u=a[12],t=a[13],w=a[14];a=a[15];var y=b[0],x=b[1],A=b[2],z=b[3],C=b[4],F=b[5],G=b[6],B=b[7],D=b[8],H=b[9],J=b[10],K=b[11],E=b[12],I=b[13],L=b[14];b=b[15];return Math.abs(c-y)<=m.EPSILON*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(d-x)<=m.EPSILON*Math.max(1,Math.abs(d),Math.abs(x))&&Math.abs(f-A)<=m.EPSILON*Math.max(1,Math.abs(f),Math.abs(A))&&Math.abs(e-z)<=m.EPSILON*Math.max(1,Math.abs(e),Math.abs(z))&&Math.abs(k-C)<=m.EPSILON*Math.max(1,Math.abs(k),Math.abs(C))&&Math.abs(h-F)<=m.EPSILON*Math.max(1,
Math.abs(h),Math.abs(F))&&Math.abs(n-G)<=m.EPSILON*Math.max(1,Math.abs(n),Math.abs(G))&&Math.abs(l-B)<=m.EPSILON*Math.max(1,Math.abs(l),Math.abs(B))&&Math.abs(p-D)<=m.EPSILON*Math.max(1,Math.abs(p),Math.abs(D))&&Math.abs(q-H)<=m.EPSILON*Math.max(1,Math.abs(q),Math.abs(H))&&Math.abs(v-J)<=m.EPSILON*Math.max(1,Math.abs(v),Math.abs(J))&&Math.abs(r-K)<=m.EPSILON*Math.max(1,Math.abs(r),Math.abs(K))&&Math.abs(u-E)<=m.EPSILON*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(t-I)<=m.EPSILON*Math.max(1,Math.abs(t),
Math.abs(I))&&Math.abs(w-L)<=m.EPSILON*Math.max(1,Math.abs(w),Math.abs(L))&&Math.abs(a-b)<=m.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))};return e})},"esri/views/vectorTiles/RenderBucket":function(){define(["require","exports","../../core/tsSupport/extendsHelper","../../core/tsSupport/decorateHelper"],function(m,e,a,b){m=function(){return function(a){this.type=a}}();e.RenderBucket=m;b=function(b){function c(){var a=b.call(this,2)||this;a.triangleElementStart=0;a.triangleElementCount=0;a.joinStart=
0;a.joinCount=0;return a}a(c,b);c.prototype.hasData=function(){return 0<this.triangleElementCount||0<this.joinCount};return c}(m);e.LineRenderBucket=b;b=function(b){function c(){var a=b.call(this,1)||this;a.triangleElementStart=0;a.triangleElementCount=0;a.outlineElementStart=0;a.outlineElementCount=0;return a}a(c,b);c.prototype.hasData=function(){return 0<this.triangleElementCount||0<this.outlineElementCount};return c}(m);e.FillRenderBucket=b;b=function(b){function c(){var a=b.call(this,3)||this;
a.markerPerPageElementsMap=new Map;a.textElementStart=0;a.textElementCount=0;a.isSDF=!1;return a}a(c,b);c.prototype.hasData=function(){return 0<this.markerPerPageElementsMap.size||0<this.textElementCount};return c}(m);e.SymbolRenderBucket=b;m=function(b){function c(){return b.call(this,0)||this}a(c,b);c.prototype.hasData=function(){return!0};return c}(m);e.BackgroundRenderBucket=m})},"esri/views/vectorTiles/VectorTileContainer":function(){define("require exports ../../core/tsSupport/extendsHelper dojo/has ../../core/libs/gl-matrix/vec3 ../../core/libs/gl-matrix/mat4 ../2d/engine/Container ./renderers/Renderer ./GeometryUtils ./StencilClipGenerator".split(" "),
function(m,e,a,b,c,d,f,g,k,h){return function(f){function e(){var a=f.call(this)||this;a.isInitialized=!1;a._displayWidth=0;a._displayHeight=0;a._clip=new h;a._tileCoordinateScale=c.create();a._orientationVec=c.create();a._displayScale=c.create();a._orientationVec.set([0,0,1]);a._defaultTransform=d.create();return a}a(e,f);e.prototype.initialize=function(a,b,c,d){this._renderer=new g;this._renderer.initialize(a,b);this._tileInfoView=d;this._tileInfo=c;this.isInitialized=!0};e.prototype.prepareChildrenRenderParameters=
function(a){var b=a.state;if(!b||!this._tileInfo||!this.isInitialized)return a;a.displayLevel=this._tileInfo.scaleToZoom(b.scale);a.requiredLevel=this._tileInfoView.getClosestInfoForScale(b.scale).level;a.renderer=this._renderer;return a};e.prototype.renderChildren=function(a){if(0!==this.children.length&&this.isInitialized&&a&&a.state){this.sortChildren(function(a,b){return b.resolution-a.resolution});this._clip.update(this.children);this._updateTilesTransform(a.state,this._tileInfoView.getClosestInfoForScale(a.state.scale).level);
var c=a.context;c.setDepthWriteEnabled(!0);this._renderer.setStateParams(a.state,a.devicePixelRatio,a.displayLevel);this._renderer.drawClippingMasks(c,this.children);c.setStencilWriteMask(0);c.setBlendFunctionSeparate(1,771,1,771);c.setStencilOp(7680,7680,7681);c.setDepthFunction(515);c.setBlendingEnabled(!1);c.setStencilTestEnabled(!0);c.setDepthTestEnabled(!0);c.setDepthWriteEnabled(!0);a.drawphase=0;f.prototype.renderChildren.call(this,a);c.setDepthWriteEnabled(!1);c.setBlendingEnabled(!0);a.drawphase=
1;f.prototype.renderChildren.call(this,a);a.drawphase=2;f.prototype.renderChildren.call(this,a);c.setStencilTestEnabled(!1);c.setDepthTestEnabled(!1);if(b("esri-vector-tiles-debug")){a=0;for(var d=this.children;a<d.length;a++){var e=d[a];e.attached&&e.visible&&this._renderer.renderTileInfo(c,e)}}this._renderer.needsRedraw()&&this.requestRender()}};e.prototype.attachChild=function(a,b){return a.attach(b)};e.prototype.detachChild=function(a,b){a.detach(b)};e.prototype.renderChild=function(a,b){a.render(b)};
e.prototype._updateTilesTransform=function(a,b){var c=1/a.width,d=1/a.height,f=[0,0];this._calculateRelativeViewProjMat(this._tileInfo.lods[b].resolution,a.resolution,a.rotation,this._tileInfo.size[1],4096,a.width,a.height,this._defaultTransform);for(var e=0,g=this.children;e<g.length;e++){var h=g[e];a.toScreen(f,h.coords);f[1]=a.height-f[1];h.tileTransform.displayCoord[0]=2*f[0]*c-1;h.tileTransform.displayCoord[1]=2*f[1]*d-1;h.key.level===b&&4096===h.coordRange?h.tileTransform.transform.set(this._defaultTransform):
this._calculateRelativeViewProjMat(this._tileInfo.lods[h.key.level].resolution,a.resolution,a.rotation,this._tileInfo.size[1],h.coordRange,a.width,a.height,h.tileTransform.transform)}};e.prototype._calculateRelativeViewProjMat=function(a,b,c,f,e,g,h,l){var p=.125;512!==f&&4096!==e&&(p=f/e);a=a/b*p;this._tileCoordinateScale.set([a,a,1]);if(g!==this._displayWidth||h!==this._displayHeight)this._displayScale.set([2/g,-2/h,1]),this._displayWidth=g,this._displayHeight=h;d.identity(l);d.scale(l,l,this._tileCoordinateScale);
d.rotate(l,l,-c*k.C_DEG_TO_RAD,this._orientationVec);d.scale(l,l,this._displayScale);d.transpose(l,l)};return e}(f)})},"esri/core/libs/gl-matrix/vec3":function(){define(["./common"],function(m){var e={create:function(){var a=new m.ARRAY_TYPE(3);a[0]=0;a[1]=0;a[2]=0;return a},clone:function(a){var b=new m.ARRAY_TYPE(3);b[0]=a[0];b[1]=a[1];b[2]=a[2];return b},fromValues:function(a,b,c){var d=new m.ARRAY_TYPE(3);d[0]=a;d[1]=b;d[2]=c;return d},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];return a},
set:function(a,b,c,d){a[0]=b;a[1]=c;a[2]=d;return a},add:function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];return a},subtract:function(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];return a}};e.sub=e.subtract;e.multiply=function(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];a[2]=b[2]*c[2];return a};e.mul=e.multiply;e.divide=function(a,b,c){a[0]=b[0]/c[0];a[1]=b[1]/c[1];a[2]=b[2]/c[2];return a};e.div=e.divide;e.ceil=function(a,b){a[0]=Math.ceil(b[0]);a[1]=Math.ceil(b[1]);a[2]=Math.ceil(b[2]);
return a};e.floor=function(a,b){a[0]=Math.floor(b[0]);a[1]=Math.floor(b[1]);a[2]=Math.floor(b[2]);return a};e.min=function(a,b,c){a[0]=Math.min(b[0],c[0]);a[1]=Math.min(b[1],c[1]);a[2]=Math.min(b[2],c[2]);return a};e.max=function(a,b,c){a[0]=Math.max(b[0],c[0]);a[1]=Math.max(b[1],c[1]);a[2]=Math.max(b[2],c[2]);return a};e.round=function(a,b){a[0]=Math.round(b[0]);a[1]=Math.round(b[1]);a[2]=Math.round(b[2]);return a};e.scale=function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;return a};e.scaleAndAdd=
function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;a[2]=b[2]+c[2]*d;return a};e.distance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];a=b[2]-a[2];return Math.sqrt(c*c+d*d+a*a)};e.dist=e.distance;e.squaredDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];a=b[2]-a[2];return c*c+d*d+a*a};e.sqrDist=e.squaredDistance;e.length=function(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)};e.len=e.length;e.squaredLength=function(a){var b=a[0],c=a[1];a=a[2];return b*b+c*c+a*a};e.sqrLen=e.squaredLength;
e.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];return a};e.inverse=function(a,b){a[0]=1/b[0];a[1]=1/b[1];a[2]=1/b[2];return a};e.normalize=function(a,b){var c=b[0],d=b[1],f=b[2],c=c*c+d*d+f*f;0<c&&(c=1/Math.sqrt(c),a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*c);return a};e.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};e.cross=function(a,b,c){var d=b[0],f=b[1];b=b[2];var e=c[0],k=c[1];c=c[2];a[0]=f*c-b*k;a[1]=b*e-d*c;a[2]=d*k-f*e;return a};e.lerp=function(a,b,c,d){var f=b[0],e=b[1];b=b[2];
a[0]=f+d*(c[0]-f);a[1]=e+d*(c[1]-e);a[2]=b+d*(c[2]-b);return a};e.hermite=function(a,b,c,d,f,e){var g=e*e,h=g*(2*e-3)+1,n=g*(e-2)+e,l=g*(e-1);e=g*(3-2*e);a[0]=b[0]*h+c[0]*n+d[0]*l+f[0]*e;a[1]=b[1]*h+c[1]*n+d[1]*l+f[1]*e;a[2]=b[2]*h+c[2]*n+d[2]*l+f[2]*e;return a};e.bezier=function(a,b,c,d,f,e){var g=1-e,h=g*g,n=e*e,l=h*g,h=3*e*h,g=3*n*g;e*=n;a[0]=b[0]*l+c[0]*h+d[0]*g+f[0]*e;a[1]=b[1]*l+c[1]*h+d[1]*g+f[1]*e;a[2]=b[2]*l+c[2]*h+d[2]*g+f[2]*e;return a};e.random=function(a,b){b=b||1;var c=2*m.RANDOM()*
Math.PI,d=2*m.RANDOM()-1,f=Math.sqrt(1-d*d)*b;a[0]=Math.cos(c)*f;a[1]=Math.sin(c)*f;a[2]=d*b;return a};e.transformMat4=function(a,b,c){var d=b[0],f=b[1];b=b[2];var e=c[3]*d+c[7]*f+c[11]*b+c[15],e=e||1;a[0]=(c[0]*d+c[4]*f+c[8]*b+c[12])/e;a[1]=(c[1]*d+c[5]*f+c[9]*b+c[13])/e;a[2]=(c[2]*d+c[6]*f+c[10]*b+c[14])/e;return a};e.transformMat3=function(a,b,c){var d=b[0],f=b[1];b=b[2];a[0]=d*c[0]+f*c[3]+b*c[6];a[1]=d*c[1]+f*c[4]+b*c[7];a[2]=d*c[2]+f*c[5]+b*c[8];return a};e.transformQuat=function(a,b,c){var d=
b[0],f=b[1],e=b[2];b=c[0];var k=c[1],h=c[2];c=c[3];var n=c*d+k*e-h*f,l=c*f+h*d-b*e,p=c*e+b*f-k*d,d=-b*d-k*f-h*e;a[0]=n*c+d*-b+l*-h-p*-k;a[1]=l*c+d*-k+p*-b-n*-h;a[2]=p*c+d*-h+n*-k-l*-b;return a};e.rotateX=function(a,b,c,d){var f=[],e=[];f[0]=b[0]-c[0];f[1]=b[1]-c[1];f[2]=b[2]-c[2];e[0]=f[0];e[1]=f[1]*Math.cos(d)-f[2]*Math.sin(d);e[2]=f[1]*Math.sin(d)+f[2]*Math.cos(d);a[0]=e[0]+c[0];a[1]=e[1]+c[1];a[2]=e[2]+c[2];return a};e.rotateY=function(a,b,c,d){var f=[],e=[];f[0]=b[0]-c[0];f[1]=b[1]-c[1];f[2]=
b[2]-c[2];e[0]=f[2]*Math.sin(d)+f[0]*Math.cos(d);e[1]=f[1];e[2]=f[2]*Math.cos(d)-f[0]*Math.sin(d);a[0]=e[0]+c[0];a[1]=e[1]+c[1];a[2]=e[2]+c[2];return a};e.rotateZ=function(a,b,c,d){var f=[],e=[];f[0]=b[0]-c[0];f[1]=b[1]-c[1];f[2]=b[2]-c[2];e[0]=f[0]*Math.cos(d)-f[1]*Math.sin(d);e[1]=f[0]*Math.sin(d)+f[1]*Math.cos(d);e[2]=f[2];a[0]=e[0]+c[0];a[1]=e[1]+c[1];a[2]=e[2]+c[2];return a};e.forEach=function(){var a=e.create();return function(b,c,d,f,e,k){c||(c=3);d||(d=0);for(f=f?Math.min(f*c+d,b.length):
b.length;d<f;d+=c)a[0]=b[d],a[1]=b[d+1],a[2]=b[d+2],e(a,a,k),b[d]=a[0],b[d+1]=a[1],b[d+2]=a[2];return b}}();e.angle=function(a,b){a=e.fromValues(a[0],a[1],a[2]);b=e.fromValues(b[0],b[1],b[2]);e.normalize(a,a);e.normalize(b,b);b=e.dot(a,b);return 1<b?0:Math.acos(b)};e.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"};e.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]};e.equals=function(a,b){var c=a[0],d=a[1];a=a[2];var f=b[0],e=b[1];b=b[2];return Math.abs(c-f)<=m.EPSILON*
Math.max(1,Math.abs(c),Math.abs(f))&&Math.abs(d-e)<=m.EPSILON*Math.max(1,Math.abs(d),Math.abs(e))&&Math.abs(a-b)<=m.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))};return e})},"esri/views/vectorTiles/renderers/Renderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../GeometryUtils ./BackgroundRenderer ./LineRenderer ./FillRenderer ./SymbolRenderer ./TileInfoRenderer ./FadeRecorder".split(" "),function(m,e,a,b,c,d,f,g,k,h){return function(){function e(){this._extrudeRotateVector=
new Float32Array([0,0,1]);this._extrudeScaleVector=new Float32Array([1,1,1]);this._state={rotation:0,width:0,height:0};this._cachedRotation=this._cachedHeight=this._cachedWidth=0;this._pixelRatio=1}e.prototype.initialize=function(a,b,e){void 0===e&&(e=!0);this._SpriteMosaic=a;this._glyphMosaic=b;this._ignoreSpeed=!e;this._backgroundRenderer=new c;this._lineRenderer=new d;this._fillRenderer=new f;this._symbolRenderer=new g;this._tileInfoRenderer=new k;this._fadeRecorder=new h.FadeRecorder(300);this._extrudeMatrix=
new Float32Array(16);this._extrudeNoRotationMatrix=new Float32Array(16);this._backgroundColor=new Float32Array([1,0,0,1])};e.prototype.setStateParams=function(c,d,f){this._pixelRatio=d;this._fadeRecorder.recordLevel(f);this._state=c;if(this._state.width!==this._cachedWidth||this._state.height!==this._cachedHeight||this._state.rotation!==this._cachedRotation)this._extrudeScaleVector[0]=2/c.width,this._extrudeScaleVector[1]=-2/c.height,a.identity(this._extrudeMatrix),a.rotate(this._extrudeMatrix,this._extrudeMatrix,
-c.rotation*b.C_DEG_TO_RAD,this._extrudeRotateVector),a.scale(this._extrudeMatrix,this._extrudeMatrix,this._extrudeScaleVector),a.transpose(this._extrudeMatrix,this._extrudeMatrix),a.identity(this._extrudeNoRotationMatrix),a.scale(this._extrudeNoRotationMatrix,this._extrudeNoRotationMatrix,this._extrudeScaleVector),a.transpose(this._extrudeNoRotationMatrix,this._extrudeNoRotationMatrix),this._cachedWidth=this._state.width,this._cachedHeight=this._state.height,this._cachedRotation=this._state.rotation};
e.prototype.drawClippingMasks=function(a,b){if(0!==b.length){a.setDepthWriteEnabled(!1);a.setDepthTestEnabled(!1);a.setStencilTestEnabled(!0);a.setBlendingEnabled(!1);a.setColorMask(!1,!1,!1,!1);a.setStencilOp(7680,7680,7681);a.setClearStencil(0);a.clear(a.gl.STENCIL_BUFFER_BIT);for(var c=0;c<b.length;c++){var d=b[c];d.attached&&d.visible&&(a.setStencilFunctionSeparate(1032,519,d.stencilData.reference,d.stencilData.mask),a.setStencilWriteMask(d.stencilData.mask),this._backgroundRenderer.renderSolidColor(a,
{u_matrix:d.tileTransform.transform,u_normalized_origin:d.tileTransform.displayCoord,u_coord_range:d.coordRange,u_depth:0,u_color:this._backgroundColor}))}a.setColorMask(!0,!0,!0,!0);a.setBlendingEnabled(!0);a.setStencilWriteMask(255)}};e.prototype.renderDebug=function(a,b){var c=b.key;this._backgroundColor.set([c.col%2,c.row%2,0===c.col%2&&0===c.row%2?1:0,.5]);this._backgroundRenderer.renderSolidColor(a,{u_matrix:b.tileTransform.transform,u_normalized_origin:b.tileTransform.displayCoord,u_coord_range:b.coordRange,
u_depth:0,u_color:this._backgroundColor})};e.prototype.renderBucket=function(a,b,c,d,f,e,g,h){switch(b.type){case 0:2!==f&&this._renderBackground(a,c,f,e,g,h);break;case 1:2!==f&&this._renderFill(a,b,c,f,e,g,h);break;case 2:1===f&&this._renderLine(a,b,c,e,g,h);break;case 3:2===f&&this._renderSymbol(a,b,c,d,e,g,h)}};e.prototype.renderTileInfo=function(a,b){this._tileInfoRenderer.render(a,b)};e.prototype.needsRedraw=function(){return this._fadeRecorder.needsRedraw()};e.prototype._renderBackground=function(a,
b,c,d,f,e){this._backgroundRenderer.render(a,b,c,d,f,this._SpriteMosaic,this._SpriteMosaic.pixelRatio,e)};e.prototype._renderLine=function(a,b,c,d,f,e){this._lineRenderer.render(a,b,c,this._state,d,f,this._SpriteMosaic,this._extrudeMatrix,this._SpriteMosaic.pixelRatio,e)};e.prototype._renderFill=function(a,b,c,d,f,e,g){this._fillRenderer.render(a,b,c,this._state.rotation,d,f,e,this._SpriteMosaic,this._extrudeMatrix,this._SpriteMosaic.pixelRatio,g)};e.prototype._renderSymbol=function(a,b,c,d,f,e,g){var h=
!0;d===f.key.level&&(h=!1);a.setStencilTestEnabled(h);this._symbolRenderer.render(a,b,c,this._state.rotation,this._fadeRecorder.getFadeValues(this._ignoreSpeed),f,e,this._SpriteMosaic,this._glyphMosaic,this._extrudeMatrix,this._extrudeNoRotationMatrix,this._SpriteMosaic.pixelRatio,g)};return e}()})},"esri/views/vectorTiles/renderers/BackgroundRenderer":function(){define("require exports ../../../core/libs/gl-matrix/mat3 ../../../core/libs/gl-matrix/vec4 ../../webgl/Program ../../webgl/VertexArrayObject ../../webgl/BufferObject ./vtShaderSnippets".split(" "),
function(m,e,a,b,c,d,f,g){return function(){function e(){this._patternMatrix=a.create();this._color=b.create();this._initialized=!1}e.prototype.renderSolidColor=function(a,b){this._initialized||this._initialize(a);a.bindVAO(this._solidVertexArrayObject);a.bindProgram(this._solidProgram);this._solidProgram.setUniformMatrix4fv("u_transformMatrix",b.u_matrix);this._solidProgram.setUniform2fv("u_normalized_origin",b.u_normalized_origin);this._solidProgram.setUniform1f("u_coord_range",b.u_coord_range||
4096);this._solidProgram.setUniform1f("u_depth",b.u_depth||0);this._solidProgram.setUniform4fv("u_color",b.u_color||new Float32Array([1,0,0,1]));a.drawArrays(5,0,4);a.bindVAO()};e.prototype.render=function(b,c,d,f,e,g,k,m){this._initialized||this._initialize(b);var h=e.getPaintValue("background-color",c);m*=e.getPaintValue("background-opacity",c);var l=e.getPaintValue("background-pattern",c),n=void 0!==l,p=h[3]*m,q=n||1>p;if(!q||0!==d)if(q||1!==d){if(n){b.bindVAO(this._patternVertexArrayObject);b.bindProgram(this._patternProgram);
d=g.getMosaicItemPosition(l,!0);if(!d)return;c=f.coordRange/512/Math.pow(2,Math.floor(c)-f.key.level)/k;a.identity(this._patternMatrix);k=1/(d.size[1]*c);this._patternMatrix[0]=1/(d.size[0]*c);this._patternMatrix[4]=k;g.bind(b,9729,0);this._patternProgram.setUniformMatrix4fv("u_transformMatrix",f.tileTransform.transform);this._patternProgram.setUniform2fv("u_normalized_origin",f.tileTransform.displayCoord);this._patternProgram.setUniform1f("u_depth",e.z);this._patternProgram.setUniformMatrix3fv("u_pattern_matrix",
this._patternMatrix);this._patternProgram.setUniform1f("u_opacity",m);this._patternProgram.setUniform2f("u_pattern_tl",d.tl[0],d.tl[1]);this._patternProgram.setUniform2f("u_pattern_br",d.br[0],d.br[1]);this._patternProgram.setUniform1i("u_texture",0)}else this._color[0]=p*h[0],this._color[1]=p*h[1],this._color[2]=p*h[2],this._color[3]=p,b.bindVAO(this._solidVertexArrayObject),b.bindProgram(this._solidProgram),this._solidProgram.setUniformMatrix4fv("u_transformMatrix",f.tileTransform.transform),this._solidProgram.setUniform2fv("u_normalized_origin",
f.tileTransform.displayCoord),this._solidProgram.setUniform1f("u_coord_range",f.coordRange),this._solidProgram.setUniform1f("u_depth",e.z||0),this._solidProgram.setUniform4fv("u_color",this._color);b.drawArrays(5,0,4);b.bindVAO()}};e.prototype._initialize=function(a){if(this._initialized)return!0;var b={a_pos:0},e=new c(a,g.backgroundVS,g.backgroundFS,b);if(!e)return!1;var h=new c(a,g.patternFillShaderVS,g.patternFillShaderFS,b);if(!h)return!1;var k={geometry:[{name:"a_pos",count:2,type:5120,offset:0,
stride:2,normalized:!1,divisor:0}]},m=new Int8Array([0,0,1,0,0,1,1,1]),r=f.createVertex(a,35044,m),r=new d(a,b,k,{geometry:r}),m=new Int16Array([0,0,4096,0,0,4096,4096,4096]),m=f.createVertex(a,35044,m);a=new d(a,b,{geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}]},{geometry:m});this._solidProgram=e;this._patternProgram=h;this._vertexAttributes=k;this._solidVertexArrayObject=r;this._patternVertexArrayObject=a;return this._initialized=!0};return e}()})},"esri/core/libs/gl-matrix/mat3":function(){define(["./common"],
function(m){var e={create:function(){var a=new m.ARRAY_TYPE(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},fromMat4:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[4];a[4]=b[5];a[5]=b[6];a[6]=b[8];a[7]=b[9];a[8]=b[10];return a},clone:function(a){var b=new m.ARRAY_TYPE(9);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];
a[8]=b[8];return a},fromValues:function(a,b,c,d,f,e,k,h,n){var g=new m.ARRAY_TYPE(9);g[0]=a;g[1]=b;g[2]=c;g[3]=d;g[4]=f;g[5]=e;g[6]=k;g[7]=h;g[8]=n;return g},set:function(a,b,c,d,f,e,k,h,n,l){a[0]=b;a[1]=c;a[2]=d;a[3]=f;a[4]=e;a[5]=k;a[6]=h;a[7]=n;a[8]=l;return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},transpose:function(a,b){if(a===b){var c=b[1],d=b[2],f=b[5];a[1]=b[3];a[2]=b[6];a[3]=c;a[5]=b[7];a[6]=d;a[7]=f}else a[0]=b[0],a[1]=b[3],a[2]=b[6],
a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8];return a},invert:function(a,b){var c=b[0],d=b[1],f=b[2],e=b[3],k=b[4],h=b[5],n=b[6],l=b[7];b=b[8];var p=b*k-h*l,q=-b*e+h*n,m=l*e-k*n,r=c*p+d*q+f*m;if(!r)return null;r=1/r;a[0]=p*r;a[1]=(-b*d+f*l)*r;a[2]=(h*d-f*k)*r;a[3]=q*r;a[4]=(b*c-f*n)*r;a[5]=(-h*c+f*e)*r;a[6]=m*r;a[7]=(-l*c+d*n)*r;a[8]=(k*c-d*e)*r;return a},adjoint:function(a,b){var c=b[0],d=b[1],f=b[2],e=b[3],k=b[4],h=b[5],n=b[6],l=b[7];b=b[8];a[0]=k*b-h*l;a[1]=f*l-d*b;a[2]=d*h-f*k;
a[3]=h*n-e*b;a[4]=c*b-f*n;a[5]=f*e-c*h;a[6]=e*l-k*n;a[7]=d*n-c*l;a[8]=c*k-d*e;return a},determinant:function(a){var b=a[3],c=a[4],d=a[5],f=a[6],e=a[7],k=a[8];return a[0]*(k*c-d*e)+a[1]*(-k*b+d*f)+a[2]*(e*b-c*f)},multiply:function(a,b,c){var d=b[0],f=b[1],e=b[2],k=b[3],h=b[4],n=b[5],l=b[6],p=b[7];b=b[8];var q=c[0],m=c[1],r=c[2],u=c[3],t=c[4],w=c[5],y=c[6],x=c[7];c=c[8];a[0]=q*d+m*k+r*l;a[1]=q*f+m*h+r*p;a[2]=q*e+m*n+r*b;a[3]=u*d+t*k+w*l;a[4]=u*f+t*h+w*p;a[5]=u*e+t*n+w*b;a[6]=y*d+x*k+c*l;a[7]=y*f+x*
h+c*p;a[8]=y*e+x*n+c*b;return a}};e.mul=e.multiply;e.translate=function(a,b,c){var d=b[0],f=b[1],e=b[2],k=b[3],h=b[4],n=b[5],l=b[6],p=b[7];b=b[8];var q=c[0];c=c[1];a[0]=d;a[1]=f;a[2]=e;a[3]=k;a[4]=h;a[5]=n;a[6]=q*d+c*k+l;a[7]=q*f+c*h+p;a[8]=q*e+c*n+b;return a};e.rotate=function(a,b,c){var d=b[0],e=b[1],g=b[2],k=b[3],h=b[4],n=b[5],l=b[6],p=b[7];b=b[8];var q=Math.sin(c);c=Math.cos(c);a[0]=c*d+q*k;a[1]=c*e+q*h;a[2]=c*g+q*n;a[3]=c*k-q*d;a[4]=c*h-q*e;a[5]=c*n-q*g;a[6]=l;a[7]=p;a[8]=b;return a};e.scale=
function(a,b,c){var d=c[0];c=c[1];a[0]=d*b[0];a[1]=d*b[1];a[2]=d*b[2];a[3]=c*b[3];a[4]=c*b[4];a[5]=c*b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];return a};e.fromTranslation=function(a,b){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=b[0];a[7]=b[1];a[8]=1;return a};e.fromRotation=function(a,b){var c=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=c;a[2]=0;a[3]=-c;a[4]=b;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};e.fromScaling=function(a,b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=0;a[4]=b[1];a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};e.fromMat2d=
function(a,b){a[0]=b[0];a[1]=b[1];a[2]=0;a[3]=b[2];a[4]=b[3];a[5]=0;a[6]=b[4];a[7]=b[5];a[8]=1;return a};e.fromQuat=function(a,b){var c=b[0],d=b[1],e=b[2];b=b[3];var g=c+c,k=d+d,h=e+e,c=c*g,n=d*g,d=d*k,l=e*g,p=e*k,e=e*h,g=b*g,k=b*k;b*=h;a[0]=1-d-e;a[3]=n-b;a[6]=l+k;a[1]=n+b;a[4]=1-c-e;a[7]=p-g;a[2]=l-k;a[5]=p+g;a[8]=1-c-d;return a};e.normalFromMat4=function(a,b){var c=b[0],d=b[1],e=b[2],g=b[3],k=b[4],h=b[5],n=b[6],l=b[7],p=b[8],q=b[9],m=b[10],r=b[11],u=b[12],t=b[13],w=b[14];b=b[15];var y=c*h-d*k,
x=c*n-e*k,A=c*l-g*k,z=d*n-e*h,C=d*l-g*h,F=e*l-g*n,G=p*t-q*u,B=p*w-m*u,p=p*b-r*u,D=q*w-m*t,q=q*b-r*t,m=m*b-r*w,r=y*m-x*q+A*D+z*p-C*B+F*G;if(!r)return null;r=1/r;a[0]=(h*m-n*q+l*D)*r;a[1]=(n*p-k*m-l*B)*r;a[2]=(k*q-h*p+l*G)*r;a[3]=(e*q-d*m-g*D)*r;a[4]=(c*m-e*p+g*B)*r;a[5]=(d*p-c*q-g*G)*r;a[6]=(t*F-w*C+b*z)*r;a[7]=(w*A-u*F-b*x)*r;a[8]=(u*C-t*A+b*y)*r;return a};e.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};e.frob=function(a){return Math.sqrt(Math.pow(a[0],
2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))};e.add=function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];a[3]=b[3]+c[3];a[4]=b[4]+c[4];a[5]=b[5]+c[5];a[6]=b[6]+c[6];a[7]=b[7]+c[7];a[8]=b[8]+c[8];return a};e.subtract=function(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];a[3]=b[3]-c[3];a[4]=b[4]-c[4];a[5]=b[5]-c[5];a[6]=b[6]-c[6];a[7]=b[7]-c[7];a[8]=b[8]-c[8];return a};e.sub=e.subtract;e.multiplyScalar=
function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;a[4]=b[4]*c;a[5]=b[5]*c;a[6]=b[6]*c;a[7]=b[7]*c;a[8]=b[8]*c;return a};e.multiplyScalarAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;a[2]=b[2]+c[2]*d;a[3]=b[3]+c[3]*d;a[4]=b[4]+c[4]*d;a[5]=b[5]+c[5]*d;a[6]=b[6]+c[6]*d;a[7]=b[7]+c[7]*d;a[8]=b[8]+c[8]*d;return a};e.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]};e.equals=function(a,
b){var c=a[0],d=a[1],e=a[2],g=a[3],k=a[4],h=a[5],n=a[6],l=a[7],p=a[8],q=b[0],v=b[1],r=b[2],u=b[3],t=b[4],w=b[5];a=a[6];var y=b[7];b=b[8];return Math.abs(c-q)<=m.EPSILON*Math.max(1,Math.abs(c),Math.abs(q))&&Math.abs(d-v)<=m.EPSILON*Math.max(1,Math.abs(d),Math.abs(v))&&Math.abs(e-r)<=m.EPSILON*Math.max(1,Math.abs(e),Math.abs(r))&&Math.abs(g-u)<=m.EPSILON*Math.max(1,Math.abs(g),Math.abs(u))&&Math.abs(k-t)<=m.EPSILON*Math.max(1,Math.abs(k),Math.abs(t))&&Math.abs(h-w)<=m.EPSILON*Math.max(1,Math.abs(h),
Math.abs(w))&&Math.abs(n-a)<=m.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(l-y)<=m.EPSILON*Math.max(1,Math.abs(l),Math.abs(y))&&Math.abs(p-b)<=m.EPSILON*Math.max(1,Math.abs(p),Math.abs(b))};return e})},"esri/core/libs/gl-matrix/vec4":function(){define(["./common"],function(m){var e={create:function(){var a=new m.ARRAY_TYPE(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a},clone:function(a){var b=new m.ARRAY_TYPE(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b},fromValues:function(a,b,c,d){var e=
new m.ARRAY_TYPE(4);e[0]=a;e[1]=b;e[2]=c;e[3]=d;return e},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];return a},set:function(a,b,c,d,e){a[0]=b;a[1]=c;a[2]=d;a[3]=e;return a},add:function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];a[3]=b[3]+c[3];return a},subtract:function(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];a[3]=b[3]-c[3];return a}};e.sub=e.subtract;e.multiply=function(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];a[2]=b[2]*c[2];a[3]=b[3]*c[3];return a};e.mul=e.multiply;
e.divide=function(a,b,c){a[0]=b[0]/c[0];a[1]=b[1]/c[1];a[2]=b[2]/c[2];a[3]=b[3]/c[3];return a};e.div=e.divide;e.ceil=function(a,b){a[0]=Math.ceil(b[0]);a[1]=Math.ceil(b[1]);a[2]=Math.ceil(b[2]);a[3]=Math.ceil(b[3]);return a};e.floor=function(a,b){a[0]=Math.floor(b[0]);a[1]=Math.floor(b[1]);a[2]=Math.floor(b[2]);a[3]=Math.floor(b[3]);return a};e.min=function(a,b,c){a[0]=Math.min(b[0],c[0]);a[1]=Math.min(b[1],c[1]);a[2]=Math.min(b[2],c[2]);a[3]=Math.min(b[3],c[3]);return a};e.max=function(a,b,c){a[0]=
Math.max(b[0],c[0]);a[1]=Math.max(b[1],c[1]);a[2]=Math.max(b[2],c[2]);a[3]=Math.max(b[3],c[3]);return a};e.round=function(a,b){a[0]=Math.round(b[0]);a[1]=Math.round(b[1]);a[2]=Math.round(b[2]);a[3]=Math.round(b[3]);return a};e.scale=function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;return a};e.scaleAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;a[2]=b[2]+c[2]*d;a[3]=b[3]+c[3]*d;return a};e.distance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];a=b[3]-a[3];return Math.sqrt(c*
c+d*d+e*e+a*a)};e.dist=e.distance;e.squaredDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];a=b[3]-a[3];return c*c+d*d+e*e+a*a};e.sqrDist=e.squaredDistance;e.length=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];return Math.sqrt(b*b+c*c+d*d+a*a)};e.len=e.length;e.squaredLength=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];return b*b+c*c+d*d+a*a};e.sqrLen=e.squaredLength;e.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];a[3]=-b[3];return a};e.inverse=function(a,b){a[0]=1/b[0];a[1]=1/
b[1];a[2]=1/b[2];a[3]=1/b[3];return a};e.normalize=function(a,b){var c=b[0],d=b[1],e=b[2];b=b[3];var g=c*c+d*d+e*e+b*b;0<g&&(g=1/Math.sqrt(g),a[0]=c*g,a[1]=d*g,a[2]=e*g,a[3]=b*g);return a};e.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};e.lerp=function(a,b,c,d){var e=b[0],g=b[1],k=b[2];b=b[3];a[0]=e+d*(c[0]-e);a[1]=g+d*(c[1]-g);a[2]=k+d*(c[2]-k);a[3]=b+d*(c[3]-b);return a};e.random=function(a,b){b=b||1;a[0]=m.RANDOM();a[1]=m.RANDOM();a[2]=m.RANDOM();a[3]=m.RANDOM();e.normalize(a,
a);e.scale(a,a,b);return a};e.transformMat4=function(a,b,c){var d=b[0],e=b[1],g=b[2];b=b[3];a[0]=c[0]*d+c[4]*e+c[8]*g+c[12]*b;a[1]=c[1]*d+c[5]*e+c[9]*g+c[13]*b;a[2]=c[2]*d+c[6]*e+c[10]*g+c[14]*b;a[3]=c[3]*d+c[7]*e+c[11]*g+c[15]*b;return a};e.transformQuat=function(a,b,c){var d=b[0],e=b[1],g=b[2],k=c[0],h=c[1],n=c[2];c=c[3];var l=c*d+h*g-n*e,p=c*e+n*d-k*g,q=c*g+k*e-h*d,d=-k*d-h*e-n*g;a[0]=l*c+d*-k+p*-n-q*-h;a[1]=p*c+d*-h+q*-k-l*-n;a[2]=q*c+d*-n+l*-h-p*-k;a[3]=b[3];return a};e.forEach=function(){var a=
e.create();return function(b,c,d,e,g,k){c||(c=4);d||(d=0);for(e=e?Math.min(e*c+d,b.length):b.length;d<e;d+=c)a[0]=b[d],a[1]=b[d+1],a[2]=b[d+2],a[3]=b[d+3],g(a,a,k),b[d]=a[0],b[d+1]=a[1],b[d+2]=a[2],b[d+3]=a[3];return b}}();e.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};e.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]};e.equals=function(a,b){var c=a[0],d=a[1],e=a[2];a=a[3];var g=b[0],k=b[1],h=b[2];b=b[3];return Math.abs(c-g)<=m.EPSILON*
Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(d-k)<=m.EPSILON*Math.max(1,Math.abs(d),Math.abs(k))&&Math.abs(e-h)<=m.EPSILON*Math.max(1,Math.abs(e),Math.abs(h))&&Math.abs(a-b)<=m.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))};return e})},"esri/views/vectorTiles/renderers/vtShaderSnippets":function(){define("require exports ../../webgl/ShaderSnippets dojo/text!./Shaders.xml dojo/text!./shaders/background.vs.glsl dojo/text!./shaders/background.fs.glsl dojo/text!./shaders/lineShader.vs.glsl dojo/text!./shaders/lineShader.fs.glsl dojo/text!./shaders/patternLineShader.vs.glsl dojo/text!./shaders/patternLineShader.fs.glsl dojo/text!./shaders/lineJoinShader.vs.glsl dojo/text!./shaders/lineJoinShader.fs.glsl dojo/text!./shaders/lineJoinQuadShader.vs.glsl dojo/text!./shaders/lineJoinQuadShader.fs.glsl dojo/text!./shaders/solidFillShader.vs.glsl dojo/text!./shaders/solidFillShader.fs.glsl dojo/text!./shaders/patternFillShader.vs.glsl dojo/text!./shaders/patternFillShader.fs.glsl dojo/text!./shaders/fillOutlineShader.vs.glsl dojo/text!./shaders/fillOutlineShader.fs.glsl dojo/text!./shaders/iconShader.vs.glsl dojo/text!./shaders/iconShader.fs.glsl dojo/text!./shaders/sdfShader.vs.glsl dojo/text!./shaders/sdfShader.fs.glsl dojo/text!./shaders/tileInfo.vs.glsl dojo/text!./shaders/tileInfo.fs.glsl".split(" "),
function(m,e,a,b,c,d,f,g,k,h,n,l,p,q,v,r,u,t,w,y,x,A,z,C,F,G){function B(a,b){D+='\x3csnippet name\x3d"'+a+'"\x3e\x3c![CDATA[';D+=b;D+="]]\x3e\x3c/snippet\x3e"}var D="",D=D+'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e',D=D+"\x3csnippets\x3e";B("backgroundVS",c);B("backgroundFS",d);B("lineShaderVS",f);B("lineShaderFS",g);B("patternLineShaderVS",k);B("patternLineShaderFS",h);B("lineJoinShaderVS",n);B("lineJoinShaderFS",l);B("lineJoinQuadShaderVS",p);B("lineJoinQuadShaderFS",q);B("solidFillShaderVS",
v);B("solidFillShaderFS",r);B("patternFillShaderVS",u);B("patternFillShaderFS",t);B("fillOutlineShaderVS",w);B("fillOutlineShaderFS",y);B("iconShaderVS",x);B("iconShaderFS",A);B("sdfShaderVS",z);B("sdfShaderFS",C);B("tileInfoVS",F);B("tileInfoFS",G);D+="\x3c/snippets\x3e";m=new a;a.parse(D,m);a.parse(b,m);return m})},"esri/views/vectorTiles/renderers/LineRenderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../../../core/libs/gl-matrix/vec4 ../../../core/libs/gl-matrix/vec3 ../../../core/libs/gl-matrix/vec2 ../../webgl/Program ../../webgl/VertexArrayObject ../GeometryUtils ./vtShaderSnippets".split(" "),
function(m,e,a,b,c,d,f,g,k,h){return function(){function e(){this._triangleAttributeLocations={a_pos:0,a_offsetAndNormal:1,a_accumulatedDistance:2};this._initialized=!1;this._viewProjMat=a.create();this._offsetVector=c.create();this._screenSize=d.create();this._color=b.create();this._dashArray=d.create()}e.prototype.render=function(b,c,d,e,f,g,h,n,m,x){if(0!==c.triangleElementCount){this._initialized||this._initialize(b);var l=f.tileTransform.transform,p=f.coordRange/512,q=g.getPaintValue("line-translate",
d);if(0!==q[0]||0!==q[1]){a.copy(this._viewProjMat,f.tileTransform.transform);var l=q[0],q=q[1],r=0,v=0,v=(1<<f.key.level)/Math.pow(2,d)*p,r=e.rotation;if(1===g.getPaintValue("line-translate-anchor",d)){e=Math.sin(k.C_DEG_TO_RAD*-r);var u=Math.cos(k.C_DEG_TO_RAD*-r),r=v*(l*u-q*e),v=v*(l*e+q*u)}else r=v*l,v*=q;this._offsetVector[0]=r;this._offsetVector[1]=v;this._offsetVector[2]=0;a.translate(this._viewProjMat,this._viewProjMat,this._offsetVector);l=this._viewProjMat}e=g.getPaintValue("line-pattern",
d);r=void 0!==e;q=1/m;m=g.getPaintValue("line-blur",d)+q;v=g.getPaintValue("line-width",d);q=.5*(v+q);x*=g.getPaintValue("line-opacity",d);var u=g.getPaintValue("line-color",d),t=u[3]*x;this._color[0]=t*u[0];this._color[1]=t*u[1];this._color[2]=t*u[2];this._color[3]=t;if(u=this._getTrianglesVAO(b,f)){b.bindVAO(u);if(r){if(d=h.getMosaicItemPosition(e,!0))h.bind(b,9729,d.page,1),b.bindProgram(this._patternLineProgram),this._patternLineProgram.setUniformMatrix4fv("u_transformMatrix",l),this._patternLineProgram.setUniformMatrix4fv("u_extrudeMatrix",
n),this._patternLineProgram.setUniform2fv("u_normalized_origin",f.tileTransform.displayCoord),this._patternLineProgram.setUniform1f("u_depth",g.z),this._patternLineProgram.setUniform1f("u_lineHalfWidth",q),this._patternLineProgram.setUniform1f("u_blur",m),this._patternLineProgram.setUniform1f("u_opacity",x),this._patternLineProgram.setUniform2f("u_pattern_tl",d.tl[0],d.tl[1]),this._patternLineProgram.setUniform2f("u_pattern_br",d.br[0],d.br[1]),this._patternLineProgram.setUniform2f("u_spriteSize",
p*d.size[0],d.size[1]),this._patternLineProgram.setUniform1i("u_texture",1)}else h=g.getPaintValue("line-dasharray",d),2>h.length&&(h=[1,-1]),p*=v,this._dashArray[0]=p*h[0],this._dashArray[1]=p*h[1],b.bindProgram(this._triangleslProgram),this._triangleslProgram.setUniformMatrix4fv("u_transformMatrix",l),this._triangleslProgram.setUniformMatrix4fv("u_extrudeMatrix",n),this._triangleslProgram.setUniform2fv("u_normalized_origin",f.tileTransform.displayCoord),this._triangleslProgram.setUniform1f("u_depth",
g.z),this._triangleslProgram.setUniform4fv("u_color",this._color),this._triangleslProgram.setUniform1f("u_lineHalfWidth",q),this._triangleslProgram.setUniform2fv("u_dasharray",this._dashArray),this._triangleslProgram.setUniform1f("u_blur",m);b.drawElements(4,c.triangleElementCount,5125,12*c.triangleElementStart);b.bindVAO()}}};e.prototype._initialize=function(a){if(this._initialized)return!0;var b=new f(a,h.lineShaderVS,h.lineShaderFS,this._triangleAttributeLocations);a=new f(a,h.patternLineShaderVS,
h.patternLineShaderFS,this._triangleAttributeLocations);this._triangleslProgram=b;this._patternLineProgram=a;this._trianglesVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:12,normalized:!1,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:4,stride:12,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:1,type:5122,offset:8,stride:12,normalized:!1,divisor:0}]};return this._initialized=!0};e.prototype._getTrianglesVAO=function(a,b){if(b.lineTrianglesVertexArrayObject)return b.lineTrianglesVertexArrayObject;
var c=b.lineVertexBuffer,d=b.lineTrianglesIndexBuffer;if(!c||!d)return null;b.lineTrianglesVertexArrayObject=new g(a,this._triangleAttributeLocations,this._trianglesVertexAttributes,{geometry:c},d);return b.lineTrianglesVertexArrayObject};return e}()})},"esri/views/vectorTiles/renderers/FillRenderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../../../core/libs/gl-matrix/mat3 ../../../core/libs/gl-matrix/vec4 ../../../core/libs/gl-matrix/vec3 ../../webgl/Program ../../webgl/VertexArrayObject ../GeometryUtils ./vtShaderSnippets".split(" "),
function(m,e,a,b,c,d,f,g,k,h){var n=1/65536;return function(){function e(){this._outlineAttributeLocations={a_pos:0,a_offset:1,a_xnormal:2};this._fillAttributeLocations={a_pos:0};this._initialized=!1;this._viewProjMat=a.create();this._offsetVector=d.create();this._patternMatrix=b.create();this._color=c.create();this._outlineColor=c.create()}e.prototype.render=function(c,d,e,f,g,h,l,m,x,A,z){this._initialized||this._initialize(c);var p=l.getPaintValue("fill-pattern",e),q=void 0!==p;if(!q||0!==g){var r=
l.getPaintValue("fill-antialias",e)&&!q;z*=l.getPaintValue("fill-opacity",e);var u=l.getPaintValue("fill-color",e),v=!1;if(!q){var t=u[3]*z;1===t&&0===g&&(v=!0);1>t&&1===g&&(v=!0)}if(v||0!==g){var w=h.tileTransform.transform,t=h.coordRange/512,y=l.getPaintValue("fill-translate",e);if(0!==y[0]||0!==y[1]){a.copy(this._viewProjMat,h.tileTransform.transform);var w=y[0],y=y[1],E=0,I=0,t=(1<<h.key.level)/Math.pow(2,e)*t;1===l.getPaintValue("fill-translate-anchor",e)?(I=Math.sin(k.C_DEG_TO_RAD*-f),f=Math.cos(k.C_DEG_TO_RAD*
-f),E=t*(w*f-y*I),I=t*(w*I+y*f)):(E=t*w,I=t*y);this._offsetVector[0]=E;this._offsetVector[1]=I;this._offsetVector[2]=0;a.translate(this._viewProjMat,this._viewProjMat,this._offsetVector);w=this._viewProjMat}if(f=this._getTrianglesVAO(c,h))if(q?1===g&&(p=m.getMosaicItemPosition(p,!0))&&(t=h.coordRange/512/Math.pow(2,Math.round(e)-h.key.level)/A,b.identity(this._patternMatrix),q=1/(p.size[1]*t),this._patternMatrix[0]=1/(p.size[0]*t),this._patternMatrix[4]=q,c.bindVAO(f),m.bind(c,9729,p.page,1),c.bindProgram(this._patternFillProgram),
this._patternFillProgram.setUniformMatrix4fv("u_transformMatrix",w),this._patternFillProgram.setUniform2fv("u_normalized_origin",h.tileTransform.displayCoord),this._patternFillProgram.setUniform1f("u_depth",l.z),this._patternFillProgram.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix),this._patternFillProgram.setUniform1f("u_opacity",z),this._patternFillProgram.setUniform2f("u_pattern_tl",p.tl[0],p.tl[1]),this._patternFillProgram.setUniform2f("u_pattern_br",p.br[0],p.br[1]),this._patternFillProgram.setUniform1i("u_texture",
1),c.drawElements(4,d.triangleElementCount,5125,12*d.triangleElementStart),c.bindVAO()):v&&(t=u[3]*z,this._color[0]=t*u[0],this._color[1]=t*u[1],this._color[2]=t*u[2],this._color[3]=t,c.bindVAO(f),c.bindProgram(this._solidFillProgram),this._solidFillProgram.setUniformMatrix4fv("u_transformMatrix",w),this._solidFillProgram.setUniform2fv("u_normalized_origin",h.tileTransform.displayCoord),this._solidFillProgram.setUniform1f("u_depth",l.z+n),this._solidFillProgram.setUniform4fv("u_color",this._color),
c.drawElements(4,d.triangleElementCount,5125,12*d.triangleElementStart),c.bindVAO()),r&&0<d.outlineElementCount&&1===g){e=l.getPaintValue("fill-outline-color",e);if(0===e[3]){if(1!==this._color[3])return;e=u}A=.75/A;z*=e[3];this._outlineColor[0]=z*e[0];this._outlineColor[1]=z*e[1];this._outlineColor[2]=z*e[2];this._outlineColor[3]=z;if(z=this._getOutlineVAO(c,h))c.bindVAO(z),c.bindProgram(this._outlineProgram),this._outlineProgram.setUniformMatrix4fv("u_transformMatrix",w),this._outlineProgram.setUniformMatrix4fv("u_extrudeMatrix",
x),this._outlineProgram.setUniform2fv("u_normalized_origin",h.tileTransform.displayCoord),this._outlineProgram.setUniform1f("u_depth",l.z),this._outlineProgram.setUniform1f("u_outline_width",A),this._outlineProgram.setUniform4fv("u_color",this._outlineColor),c.drawElements(4,d.outlineElementCount,5125,12*d.outlineElementStart),c.bindVAO()}}}};e.prototype._initialize=function(a){if(this._initialized)return!0;var b=new f(a,h.solidFillShaderVS,h.solidFillShaderFS,{a_pos:0});if(!b)return!1;var c=new f(a,
h.patternFillShaderVS,h.patternFillShaderFS,this._fillAttributeLocations);if(!c)return!1;a=new f(a,h.fillOutlineShaderVS,h.fillOutlineShaderFS,this._outlineAttributeLocations);this._solidFillProgram=b;this._patternFillProgram=c;this._trianglesVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}]};this._outlineProgram=a;this._outlineVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_offset",
count:2,type:5120,offset:4,stride:8,normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:8,normalized:!1,divisor:0}]};return this._initialized=!0};e.prototype._getTrianglesVAO=function(a,b){if(b.polygonTrianglesVertexArrayObject)return b.polygonTrianglesVertexArrayObject;var c=b.polygonTrianglesVertexBuffer,d=b.polygonTrianglesIndexBuffer;if(!c||!d)return null;b.polygonTrianglesVertexArrayObject=new g(a,this._fillAttributeLocations,this._trianglesVertexAttributes,{geometry:c},
d);return b.polygonTrianglesVertexArrayObject};e.prototype._getOutlineVAO=function(a,b){if(b.polygonOutlineVertexArrayObject)return b.polygonOutlineVertexArrayObject;var c=b.polygonOutlinesVertexBuffer,d=b.polygonOutlinesIndexBuffer;if(!c||!d)return null;b.polygonOutlineVertexArrayObject=new g(a,this._outlineAttributeLocations,this._outlineVertexAttributes,{geometry:c},d);return b.polygonOutlineVertexArrayObject};return e}()})},"esri/views/vectorTiles/renderers/SymbolRenderer":function(){define(["require",
"exports","./IconRenderer","./SDFRenderer"],function(m,e,a,b){return function(){function c(){this._iconRenderer=new a;this._sdfRenderer=new b}c.prototype.render=function(a,b,c,e,h,n,l,m,q,v,r,u,t){b.hasData()&&(0<b.markerPerPageElementsMap.size&&!b.isSDF&&this._iconRenderer.render(a,b,c,e,h,n,l,m,v,r,t),0<b.textElementCount&&this._sdfRenderer.render(a,b,c,e,h,n,l,q,v,r,u,t))};return c}()})},"esri/views/vectorTiles/renderers/IconRenderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../../../core/libs/gl-matrix/vec3 ../../webgl/Program ../../webgl/VertexArrayObject ../GeometryUtils ./vtShaderSnippets".split(" "),
function(m,e,a,b,c,d,f,g){return function(){function e(){this._attributeLocations={a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3};this._spritesTextureSize=new Float32Array(2);this._initialized=!1;this._extrudeMat=a.create();this._scaleVec=b.create()}e.prototype.render=function(b,c,d,e,g,k,m,u,t,w,y){var h=this;this._initialized||this._initialize(b);y*=m.getPaintValue("icon-opacity",d);var l=m.getLayoutValue("icon-rotation-alignment",d);1===l&&(1!==m.getLayoutValue("symbol-placement",d)||m.hasLayoutProperty("icon-rotation-alignment")||
(l=0));var n=0===l,l=m.getLayoutValue("icon-keep-upright",d)&&n,p=m.getLayoutValue("icon-size",d);e=f.degToByte(e);n?a.copy(this._extrudeMat,t):a.copy(this._extrudeMat,w);1!==p&&(this._scaleVec[0]=p,this._scaleVec[1]=p,this._scaleVec[2]=1,a.scale(this._extrudeMat,this._extrudeMat,this._scaleVec));b.bindProgram(this._iconProgram);if(t=this._getIconVAO(b,k))b.bindVAO(t),this._iconProgram.setUniformMatrix4fv("u_transformMatrix",k.tileTransform.transform),this._iconProgram.setUniformMatrix4fv("u_extrudeMatrix",
this._extrudeMat),this._iconProgram.setUniform2fv("u_normalized_origin",k.tileTransform.displayCoord),this._iconProgram.setUniform1f("u_depth",m.z),this._iconProgram.setUniform1f("u_mapRotation",e),this._iconProgram.setUniform1f("u_keepUpright",l?1:0),this._iconProgram.setUniform1f("u_level",10*d),this._iconProgram.setUniform1f("u_fadeSpeed",10*g.fadeSpeed),this._iconProgram.setUniform1f("u_minfadeLevel",10*g.minfadeLevel),this._iconProgram.setUniform1f("u_maxfadeLevel",10*g.maxfadeLevel),this._iconProgram.setUniform1f("u_fadeChange",
10*(d+g.fadeChange)),this._iconProgram.setUniform1f("u_opacity",y),this._iconProgram.setUniform1i("u_texture",1),c.markerPerPageElementsMap.forEach(function(a,c){h._spritesTextureSize[0]=u.getWidth(c)/4;h._spritesTextureSize[1]=u.getHeight(c)/4;h._iconProgram.setUniform2fv("u_mosaicSize",h._spritesTextureSize);u.bind(b,9729,c,1);b.drawElements(4,a[1],5125,12*a[0])}),b.bindVAO()};e.prototype._initialize=function(a){if(this._initialized)return!0;this._iconProgram=new c(a,g.iconShaderVS,g.iconShaderFS,
this._attributeLocations);this._iconVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:16,normalized:!1,divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}]};return this._initialized=!0};e.prototype._getIconVAO=function(a,b){if(b.iconVertexArrayObject)return b.iconVertexArrayObject;
var c=b.iconVertexBuffer,e=b.iconIndexBuffer;if(!c||!e)return null;b.iconVertexArrayObject=new d(a,this._attributeLocations,this._iconVertexAttributes,{geometry:c},e);return b.iconVertexArrayObject};return e}()})},"esri/views/vectorTiles/renderers/SDFRenderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../../../core/libs/gl-matrix/vec4 ../../../core/libs/gl-matrix/vec3 ../../webgl/Program ../../webgl/VertexArrayObject ../GeometryUtils ./vtShaderSnippets".split(" "),function(m,
e,a,b,c,d,f,g,k){return function(){function e(){this._attributeLocations={a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3};this._initialized=!1;this._extrudeMat=a.create();this._haloColor=b.create();this._sdfColor=b.create();this._scaleVec=c.create()}e.prototype.render=function(b,c,d,e,f,h,k,m,w,y,x,A){this._initialized||this._initialize(b);var l=k.getLayoutValue("text-size",d),n=l/24;e=g.degToByte(e);var p=k.getLayoutValue("text-rotation-alignment",d);1===p&&(1!==k.getLayoutValue("symbol-placement",
d)||k.hasLayoutProperty("text-rotation-alignment")||(p=0));var q=0===p,p=k.getLayoutValue("text-keep-upright",d)&&q;x=.1*24/l/x;A*=k.getPaintValue("text-opacity",d);this._glyphTextureSize||(this._glyphTextureSize=new Float32Array([m.width/4,m.height/4]));q?a.copy(this._extrudeMat,w):a.copy(this._extrudeMat,y);this._scaleVec[0]=n;this._scaleVec[1]=n;this._scaleVec[2]=1;a.scale(this._extrudeMat,this._extrudeMat,this._scaleVec);m.bind(b,9729,0);b.bindProgram(this._sdfProgram);if(m=this._getSDFVAO(b,
h))b.bindVAO(m),this._sdfProgram.setUniformMatrix4fv("u_transformMatrix",h.tileTransform.transform),this._sdfProgram.setUniformMatrix4fv("u_extrudeMatrix",this._extrudeMat),this._sdfProgram.setUniform2fv("u_normalized_origin",h.tileTransform.displayCoord),this._sdfProgram.setUniform1f("u_depth",k.z),this._sdfProgram.setUniform2fv("u_mosaicSize",this._glyphTextureSize),this._sdfProgram.setUniform1f("u_mapRotation",e),this._sdfProgram.setUniform1f("u_keepUpright",p?1:0),this._sdfProgram.setUniform1f("u_level",
10*d),this._sdfProgram.setUniform1f("u_fadeSpeed",10*f.fadeSpeed),this._sdfProgram.setUniform1f("u_minfadeLevel",10*f.minfadeLevel),this._sdfProgram.setUniform1f("u_maxfadeLevel",10*f.maxfadeLevel),this._sdfProgram.setUniform1f("u_fadeChange",10*(d+f.fadeChange)),this._sdfProgram.setUniform1f("u_opacity",A),this._sdfProgram.setUniform1i("u_texture",0),f=k.getPaintValue("text-halo-color",d),0<f[3]&&(h=f[3]*A,this._haloColor[0]=h*f[0],this._haloColor[1]=h*f[1],this._haloColor[2]=h*f[2],this._haloColor[3]=
h,f=x+k.getPaintValue("text-halo-blur",d)/n/8,n=.75-k.getPaintValue("text-halo-width",d)/n/8,this._sdfProgram.setUniform4fv("u_color",this._haloColor),this._sdfProgram.setUniform1f("u_edgeDistance",n),this._sdfProgram.setUniform1f("u_edgeWidth",f),b.drawElements(4,c.textElementCount,5125,12*c.textElementStart)),d=k.getPaintValue("text-color",d),0<d[3]&&(k=d[3]*A,this._sdfColor[0]=k*d[0],this._sdfColor[1]=k*d[1],this._sdfColor[2]=k*d[2],this._sdfColor[3]=k,this._sdfProgram.setUniform4fv("u_color",
this._sdfColor),this._sdfProgram.setUniform1f("u_edgeDistance",.75),this._sdfProgram.setUniform1f("u_edgeWidth",x),b.drawElements(4,c.textElementCount,5125,12*c.textElementStart)),b.bindVAO()};e.prototype._initialize=function(a){if(this._initialized)return!0;this._sdfProgram=new d(a,k.sdfShaderVS,k.sdfShaderFS,this._attributeLocations);this._sdfVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,
stride:16,normalized:!1,divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}]};return this._initialized=!0};e.prototype._getSDFVAO=function(a,b){if(b.textVertexArrayObject)return b.textVertexArrayObject;var c=b.textVertexBuffer,d=b.textIndexBuffer;if(!c||!d)return null;b.textVertexArrayObject=new f(a,this._attributeLocations,this._sdfVertexAttributes,{geometry:c},d);return b.textVertexArrayObject};
return e}()})},"esri/views/vectorTiles/renderers/TileInfoRenderer":function(){define("require exports ../../webgl/Program ../../webgl/VertexArrayObject ../../webgl/BufferObject ../../webgl/Texture ../GeometryUtils ./vtShaderSnippets".split(" "),function(m,e,a,b,c,d,f,g){return function(){function e(){this._initialized=!1;this._maxWidth=0;this._color=new Float32Array([1,0,0,1])}e.prototype.render=function(a,b){this._initialized||this._initialize(a);a.bindVAO(this._outlineVertexArrayObject);a.bindProgram(this._outlineProgram);
this._outlineProgram.setUniformMatrix4fv("u_transformMatrix",b.tileTransform.transform);this._outlineProgram.setUniform2fv("u_normalized_origin",b.tileTransform.displayCoord);this._outlineProgram.setUniform1f("u_coord_range",b.coordRange);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",this._color);a.setLineWidth(2);a.drawArrays(3,0,4);a.bindVAO();var c=this._getTexture(a,b);c&&(a.bindVAO(this._tileInfoVertexArrayObject),a.bindProgram(this._tileInfoProgram),
a.bindTexture(c,0),this._tileInfoProgram.setUniformMatrix4fv("u_transformMatrix",b.tileTransform.transform),this._tileInfoProgram.setUniform2fv("u_normalized_origin",b.tileTransform.displayCoord),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform1f("u_coord_ratio",b.coordRange/512),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",c.descriptor.width,c.descriptor.height),a.drawArrays(5,0,4),a.bindVAO())};e.prototype._initialize=
function(d){if(this._initialized)return!0;var e={a_pos:0},f=new a(d,g.backgroundVS,g.backgroundFS,e),h=new a(d,g.tileInfoVS,g.tileInfoFS,e),k={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},m=new Int8Array([0,0,1,0,1,1,0,1]),m=c.createVertex(d,35044,m),m=new b(d,e,k,{geometry:m}),r=new Int8Array([0,0,1,0,0,1,1,1]),r=c.createVertex(d,35044,r);d=new b(d,e,k,{geometry:r});this._outlineProgram=f;this._tileInfoProgram=h;this._vertexAttributes=k;this._outlineVertexArrayObject=
m;this._tileInfoVertexArrayObject=d;return this._initialized=!0};e.prototype._getTexture=function(a,b){if(b.texture)return b.texture;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","canvas2d"),this._canvas.setAttribute("width","256"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));var c=b.key.id,e=this._canvas.getContext("2d");e.font="24px sans-serif";e.textAlign="left";e.textBaseline="middle";var g=e.measureText(c),
g=Math.pow(2,Math.ceil(f.log2(g.width+2)));g>this._maxWidth&&(this._maxWidth=g);e.clearRect(0,0,this._maxWidth,32);e.fillStyle=b.key.level>b.refKey.level?"red":"blue";e.fillText(c,0,16);b.texture=new d(a,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728},this._canvas);return b.texture};return e}()})},"esri/views/vectorTiles/renderers/FadeRecorder":function(){define(["require","exports","../../../core/now"],function(m,e,a){(function(){return function(a,c){this.level=a;this.now=c}})();m=
function(){return function(a,c,d,e){this.fadeSpeed=a;this.minfadeLevel=c;this.maxfadeLevel=d;this.fadeChange=e}}();e.FadeProperties=m;m=function(){function b(a){void 0===a&&(a=300);this._levelSnapshots=[];this._duration=a}b.prototype.recordLevel=function(b){var c=a(),e=this._levelSnapshots;0===e.length&&(e.push({level:b,now:0}),e.push({level:b,now:0}));2!==e.length&&e[0].level===b||e.push({level:b,now:c})};b.prototype.needsRedraw=function(){if(0===this._levelSnapshots.length)return!1;for(var a=this._duration,
b=this._levelSnapshots,e=b.length,g=b[e-1],k=-1;e>k+1&&b[k+1].now+a<g.now;)k++;for(0>k&&(k=0);k<e;k++)if(b[k].level!==g.level)return!0;return!1};b.prototype.getFadeValues=function(b){void 0===b&&(b=!1);for(var c=this._duration,e=a(),g=this._levelSnapshots;3<g.length&&g[1].now+c<e;)g.shift();g[1].now+c<e&&(g[0].level=g[1].level);var k=g[0].level,h=g[g.length-1],m=h.level,l=Math.min(k,m),k=Math.max(k,m),g=(h.level-g[1].level)/((h.now-g[1].now)/c);return b?{fadeSpeed:0,minfadeLevel:l,maxfadeLevel:k,
fadeChange:0}:{fadeSpeed:g,minfadeLevel:l,maxfadeLevel:k,fadeChange:(e-h.now)/c*g}};return b}();e.FadeRecorder=m})},"esri/views/vectorTiles/StencilClipGenerator":function(){define(["require","exports","./GeometryUtils"],function(m,e,a){var b=function(){function a(a){this.children=[];this.stageTile=a}a.prototype.tryAdd=function(b){if(a.isChildOf(b,this.stageTile.key)){for(var c=0,d=this.children;c<d.length;c++)if(a.isChildOf(b,d[c]))return;this.children.push(b)}};a.prototype.equals=function(a){if(this.stageTile.key.id!==
a.stageTile.key.id||this.children.length!==a.children.length)return!1;for(var b=0;b<this.children.length;b++)if(this.children[b].id!==a.children[b].id)return!1;return!0};a.isChildOf=function(a,b){if(a.level<=b.level)return!1;var c=a.level-b.level,d=a.col>>c;return a.row>>c===b.row&&d===b.col};return a}();return function(){function c(){this._tileGroups=[];this._bitOffset=0}c.prototype.update=function(c){this._tileGroups=[];this._bitOffset=0;if(0!==c.length){for(var d=[],e=c.length,k=0;k<e;k++)if(c[k].attached&&
c[k].visible){for(var h=new b(c[k]),m=k+1;m<e;m++)h.tryAdd(c[m].key);h.children.sort(function(a,b){return a.level<b.level?-1:1});this._reuseExisting(h)||d.push(h)}if(0<d.length){c=Math.ceil(a.log2(d.length+1));e=(1<<c)-1<<this._bitOffset;k=1;h=void 0;for(m=0;m<d.length;m++){var l=d[m],h=k++<<this._bitOffset;l.stageTile.stencilData.mask=e;l.stageTile.stencilData.reference=h}this._bitOffset+=c;this._tileGroups.push(d)}}};c.prototype._reuseExisting=function(a){for(var b=0,c=this._tileGroups;b<c.length;b++)for(var d=
0,e=c[b];d<e.length;d++){var m=e[d];if(m.equals(a)&&m.stageTile.stencilData.mask===a.stageTile.stencilData.mask&&m.stageTile.stencilData.reference===a.stageTile.stencilData.reference)return!0}return!1};return c}()})},"url:esri/views/vectorTiles/renderers/Shaders.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\x3c!--\r\n  Add your GLSL snippets to this file. You should start from\r\n  importing your old GLSL files. For instance, if you have a\r\n  file such as myShader.vs.glsl you should create a new \x3csnippet name\x3d"myShaderVS"\x3e\r\n  and then copy and paste the GLSL source as the content. You will then convert your\r\n  code to use the {@link module:esri/views/vectorTiles/renderers/vtShaderSnippets vtShaderSnippets}\r\n  instance to access the GLSL code, instead of importing it directly with require("dojo/text!...").\r\n--\x3e\r\n\x3csnippets\x3e\r\n\r\n  \x3csnippet name\x3d"foobarVS"\x3e\r\n  \x3c/snippet\x3e\r\n\r\n  \x3csnippet name\x3d"foobarFS"\x3e\r\n  \x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n\r\n',
"url:esri/views/vectorTiles/renderers/shaders/background.vs.glsl":"attribute vec2 a_pos;\r\n\r\nuniform highp mat4 u_transformMatrix;\r\nuniform mediump vec2 u_normalized_origin;\r\nuniform mediump float u_coord_range;\r\nuniform mediump float u_depth;\r\n\r\nvoid main() {\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(u_coord_range * a_pos, 0.0, 1.0);\r\n}\r\n","url:esri/views/vectorTiles/renderers/shaders/background.fs.glsl":"uniform lowp vec4 u_color;\r\nvoid main() {\r\n  gl_FragColor \x3d u_color;\r\n}",
"url:esri/views/vectorTiles/renderers/shaders/lineShader.vs.glsl":"/* The implementation of the renderer is based on the article and implementation of MB described here:\r\n* https://www.mapbox.com/blog/drawing-antialiased-lines/\r\n*/\r\n\r\nattribute vec2 a_pos;\r\nattribute vec4 a_offsetAndNormal;\r\nattribute float a_accumulatedDistance;\r\n\r\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\r\n// relative to the tile's upper left corner\r\n// the extrusion vector.\r\nuniform highp mat4 u_transformMatrix;\r\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\r\nuniform highp mat4 u_extrudeMatrix;\r\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\r\nuniform highp vec2 u_normalized_origin;\r\n// the z of the layer. Given by the order of the layers in the style\r\nuniform mediump float u_depth;\r\n// the inset and outset of the line\r\nuniform mediump float u_lineHalfWidth;\r\n// the interpolated normal to the line. the information is packed into the two LSBs of the vertex coordinate\r\nvarying mediump vec2 v_normal;\r\n// the accumulated distance along the line. We need this information in order to render the dashes.\r\nvarying highp float v_accumulatedDistance;\r\n\r\nconst float scale \x3d 1.0 / 31.0;\r\n\r\nvoid main()\r\n{\r\n  v_normal \x3d a_offsetAndNormal.zw;\r\n\r\n  // calculate the relative distance from the centerline to the edge of the line. Since offset is given in integers (for the\r\n  // sake of using less attribute memory, we need to scale it back to the original range of ~ 0: 1)\r\n  mediump vec2 dist \x3d u_lineHalfWidth * a_offsetAndNormal.xy * scale;\r\n\r\n  // transform the vertex\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * vec4(dist, 0.0, 0.0);\r\n\r\n  // the accumulated distance will be used to calculate the dashes (or the no-data...)\r\n  v_accumulatedDistance \x3d a_accumulatedDistance;\r\n}\r\n",
"url:esri/views/vectorTiles/renderers/shaders/lineShader.fs.glsl":"/* The implementation of the renderer is based on the article and implementation of MB described here:\r\n* https://www.mapbox.com/blog/drawing-antialiased-lines/\r\n*/\r\n\r\nuniform mediump float u_lineHalfWidth;\r\nuniform lowp vec4 u_color;\r\nuniform mediump vec2 u_dasharray;\r\nuniform lowp float u_blur;\r\n\r\nvarying mediump vec2 v_normal;\r\nvarying highp float v_accumulatedDistance;\r\n\r\nvoid main()\r\n{\r\n  // dist represent the distance of the fragment from the line. 1.0 or -1.0 will be the values on the edge of the line,\r\n  // and any value in between will be inside the line (the sign represent the direction - right or left).\r\n  // since u_linewidth.s (half line width) is represented in pixels, dist is also given in pixels\r\n  mediump float fragDist \x3d length(v_normal) * u_lineHalfWidth;\r\n\r\n  // calculate the alpha given the difference between the line-width and the distance of the fragment from the center-line.\r\n  // We need to count for both sides of the line.\r\n  lowp float alpha \x3d clamp( min(fragDist + u_blur + 1.0, u_lineHalfWidth - fragDist) / u_blur, 0.0, 1.0);\r\n\r\n  // now calculate the dashes given the accumulated distance of the line:\r\n  // start with calculating a normalized position along the line\r\n  lowp float dashPos \x3d  mod(v_accumulatedDistance, u_dasharray.x + u_dasharray.y);\r\n\r\n  // calculate the contribution to the alpha of the dash part. It is provided by the shortest portion of the position along the dash.\r\n  // we must clamp since the value might be bigger than 1 or smaller than zero (when over a dash).\r\n  //   | \x3c--- pos along the dash part\r\n  // -------_______-------_______\r\n  // when the dashPos is over the 'gap' part of the dash u_dasharray.x - dashPos is negative and therefore the alpha will\r\n  // get clamped to zero.\r\n  // when u_dasharray.x - dashPos is positive, or when dashPos is smaller than 1.0, it gives us a soft edge to each dash part.\r\n  // along the direction of the line.\r\n  lowp float dashAlpha \x3d clamp( min(dashPos, u_dasharray.x - dashPos), 0.0, 1.0);\r\n\r\n  // if we don't have a no-data part to the dash then it is a solid line\r\n  dashAlpha \x3d max(sign(-u_dasharray.y), dashAlpha); //sign(-u_dasharray.y) \x3e 0.0 ? 1.0 : dashAlpha;\r\n  // finally multiply the fragment's alpha by the calculated dash-alpha\r\n  alpha *\x3d dashAlpha;\r\n\r\n  // output the fragment color\r\n gl_FragColor \x3d alpha * u_color;\r\n}\r\n",
"url:esri/views/vectorTiles/renderers/shaders/patternLineShader.vs.glsl":"attribute vec2 a_pos;\r\nattribute vec4 a_offsetAndNormal;\r\nattribute float a_accumulatedDistance;\r\n\r\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\r\n// relative to the tile's upper left corner\r\n// the extrusion vector.\r\nuniform highp mat4 u_transformMatrix;\r\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\r\nuniform highp mat4 u_extrudeMatrix;\r\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\r\nuniform highp vec2 u_normalized_origin;\r\n// the z of the layer. Given by the order of the layers in the style\r\nuniform mediump float u_depth;\r\n// the inset and outset of the line\r\nuniform mediump float u_lineHalfWidth;\r\n// the interpolated normal to the line. the information is packed into the two LSBs of the vertex coordinate\r\nvarying mediump vec2 v_normal;\r\n// the accumulated distance along the line. We need this information in order to render the dashes.\r\nvarying highp float v_accumulatedDistance;\r\n\r\nconst float scale \x3d 1.0 / 31.0;\r\n\r\nvoid main()\r\n{\r\n  v_normal \x3d a_offsetAndNormal.zw;\r\n\r\n  // calculate the relative distance from the centerline to the edge of the line. Since offset is given in integers (for the\r\n  // sake of using less attribute memory, we need to scale it back to the original range of ~ 0: 1)\r\n  // sake of using less attribute memory, we need to scale it back to the original range of ~ 0: 1)\r\n  mediump vec2 dist \x3d u_lineHalfWidth * a_offsetAndNormal.xy * scale;\r\n\r\n  // transform the vertex\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * vec4(dist, 0.0, 0.0);\r\n\r\n  // the accumulated distance will be used to calculate the dashes (or the no-data...)\r\n  v_accumulatedDistance \x3d a_accumulatedDistance;\r\n}\r\n",
"url:esri/views/vectorTiles/renderers/shaders/patternLineShader.fs.glsl":"uniform mediump float u_lineHalfWidth;\r\nuniform lowp float u_blur;\r\nuniform lowp float u_opacity;\r\nuniform mediump vec2 u_pattern_tl;\r\nuniform mediump vec2 u_pattern_br;\r\nuniform mediump vec2 u_spriteSize;\r\nuniform sampler2D u_texture;\r\n\r\nvarying mediump vec2 v_normal;\r\nvarying highp float v_accumulatedDistance;\r\n\r\nvoid main()\r\n{\r\n  // dist represent the distance of the fragment from the line. 1.0 or -1.0 will be the values on the edge of the line,\r\n  // and any value in between will be inside the line (the sign represent the direction - right or left).\r\n  // since u_linewidth.s (half line width) is represented in pixels, dist is also given in pixels\r\n  mediump float fragDist \x3d length(v_normal) * u_lineHalfWidth;\r\n\r\n  // calculate the alpha given the difference between the line-width and the distance of the fragment from the center-line.\r\n  // We need to count for both sides of the line.\r\n  lowp float alpha \x3d clamp( min(fragDist + u_blur + 1.0, u_lineHalfWidth - fragDist) / u_blur, 0.0, 1.0);\r\n  // add the line's opacity to the alpha\r\n  alpha *\x3d u_opacity;\r\n\r\n  // we need to calculate the relative portion of the line texture along the line given the accumulated distance aliong the line\r\n  // The computed value should is anumber btween 0 and 1 which will later be used to interpolate btween the BR and TL values\r\n  mediump float relativeTexX \x3d mod(v_accumulatedDistance / u_spriteSize.x, 1.0);\r\n\r\n  // in order to calculate the texture coordinates prependicular to the line (Y axis), we use the interpolated normal values\r\n  // which range from -1.0 to 1.0. On the line's centerline, the value of the interpolated normal is 0.0, however the relative\r\n  // texture value shpould be 0.5 (given that at the bottom of the line, the texture coordinate must be equal to 0.0)\r\n  // (TL) ---------------------------      --\x3e left edge of line. Interpolatedf normal is 1.0\r\n  //              | -\x3e linwe-width / 2\r\n  //      - - - - - - - - - - - - - -\r\n  //              | -\x3e linwe-width / 2\r\n  //      ---------------------------- (BR)--\x3e right edge of line. Interpolatedf normal is -1.0\r\n\r\n  mediump float relativeTexY \x3d 0.5 + (v_normal.y * u_lineHalfWidth / (0.5 * u_spriteSize.y));\r\n\r\n  // claculate the actual texture coordinates by interpolating between the TL/BR pattern coordinates\r\n  mediump vec2 texCoord \x3d mix(u_pattern_tl, u_pattern_br, vec2(relativeTexX, relativeTexY));\r\n\r\n  // get the color from the texture\r\n  lowp vec4 color \x3d texture2D(u_texture, texCoord);\r\n\r\n  // 'un-premultiply' the color\r\n  lowp float inv_alpha \x3d (1.0 / clamp(color.a, 0.00390625, 1.0));\r\n  // finally write the fragment value\r\n  gl_FragColor \x3d alpha * color;\r\n}\r\n",
"url:esri/views/vectorTiles/renderers/shaders/lineJoinShader.vs.glsl":"attribute vec2 a_pos;\r\n\r\nuniform highp mat4 u_transformMatrix;\r\nuniform highp vec2 u_normalized_origin;\r\nuniform highp float u_depth;\r\nuniform highp vec2 u_screen;\r\nuniform mediump float u_size;\r\nuniform mediump float u_pixelRatio;\r\n\r\nvarying mediump vec2 v_vertexPosition;\r\n\r\nvoid main()\r\n{\r\n  gl_PointSize \x3d u_pixelRatio * u_size;\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0);\r\n\r\n  // calculate the vertex position in pixels (we need to add one in order to shift the origin from the center of the viewport)\r\n  v_vertexPosition \x3d (gl_Position.xy + 1.0) * u_screen;\r\n}\r\n",
"url:esri/views/vectorTiles/renderers/shaders/lineJoinShader.fs.glsl":"uniform lowp vec4 u_color;\r\nuniform mediump float u_lineHalfWidth;\r\nuniform mediump float u_oneOverPixelRatio;\r\n\r\nvarying mediump vec2 v_vertexPosition;\r\n\r\nvoid main()\r\n{\r\n  // get the distance of the current fragment from the actual vertex\r\n  mediump float fragDist \x3d length(v_vertexPosition - u_oneOverPixelRatio * gl_FragCoord.xy);\r\n\r\n  // rounding the quare: calculate the alpha given the difference between the line-width and the distance of the fragment\r\n  // from the center-line. We will end up with a nice round circle with a soft edge.\r\n  lowp float alpha \x3d clamp(u_lineHalfWidth - fragDist, 0.0, 1.0);\r\n\r\n  // finally output the fragment color\r\n  gl_FragColor \x3d alpha * u_color;\r\n}\r\n",
"url:esri/views/vectorTiles/renderers/shaders/lineJoinQuadShader.vs.glsl":"attribute vec2 a_pos;\r\nattribute vec2 a_vertexOffset;\r\n\r\nuniform highp mat4 u_transformMatrix;\r\nuniform highp mat4 u_extrudeMatrix;\r\nuniform highp vec2 u_normalized_origin;\r\nuniform highp float u_depth;\r\n// The width/height of the screen\r\nuniform mediump vec2 u_screen;\r\n// u_size is the diameter of the join in tile units\r\nuniform mediump float u_size;\r\n\r\nvarying mediump vec2 v_fragmentOffset;\r\n\r\nvoid main()\r\n{\r\n  // calculate the offset in pixels from the join's center to the vertex\r\n  highp vec2 dist \x3d u_size * a_vertexOffset;\r\n\r\n  // calculate the position of the join's center in normalized coordinates\r\n  highp vec4 center_pos \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0);\r\n\r\n  // offset in normalized display units\r\n  highp vec4 vertex_offset \x3d u_extrudeMatrix * vec4(dist, 0.0, 0.0);\r\n\r\n  // calculate the vertex offset in windows coordinates\r\n  v_fragmentOffset \x3d u_screen * vertex_offset.xy;\r\n\r\n  // finally calculate the vertex position\r\n  gl_Position \x3d center_pos + vertex_offset;\r\n}\r\n",
"url:esri/views/vectorTiles/renderers/shaders/lineJoinQuadShader.fs.glsl":"uniform lowp vec4 u_color;\r\nuniform mediump float u_lineHalfWidth;\r\n\r\nvarying mediump vec2 v_fragmentOffset;\r\n\r\nvoid main()\r\n{\r\n  // Calculate the antialiasing fade factor\r\n  lowp float alpha \x3d clamp(u_lineHalfWidth * u_lineHalfWidth - dot(v_fragmentOffset, v_fragmentOffset), 0.0, 1.0);\r\n  //lowp float alpha  \x3d 1.0 - smoothstep(u_lineHalfWidth - 0.25, u_lineHalfWidth + 0.25, dist);\r\n  // YF: if needed w can also use a smoothstep around the edge of the circle and use a single pixel or so as the edge width\r\n\r\n  // finally output the fragment color\r\n  gl_FragColor \x3d alpha * u_color;\r\n}\r\n",
"url:esri/views/vectorTiles/renderers/shaders/solidFillShader.vs.glsl":"attribute vec2 a_pos;\r\n\r\nuniform highp mat4 u_transformMatrix;\r\nuniform highp vec2 u_normalized_origin;\r\nuniform mediump float u_depth;\r\n\r\nvoid main()\r\n{\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0, 1.0);\r\n}\r\n","url:esri/views/vectorTiles/renderers/shaders/solidFillShader.fs.glsl":"uniform lowp vec4 u_color;\r\nvoid main()\r\n{\r\n  gl_FragColor \x3d u_color;\r\n}",
"url:esri/views/vectorTiles/renderers/shaders/patternFillShader.vs.glsl":"uniform highp mat4 u_transformMatrix;\r\nuniform highp vec2 u_normalized_origin;\r\nuniform mediump float u_depth;\r\nuniform mediump mat3 u_pattern_matrix; // can we use meduim precision??\r\n\r\nattribute vec2 a_pos;\r\n\r\nvarying mediump vec2 v_tileTextureCoord;\r\n\r\nvoid main()\r\n{\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0);\r\n  // calculate the texture coordinates of the current vertex. It will of course get interpolated.\r\n  // The pattern matrix is a 3x3 scale matrix which 'tiles' the texture inside the tile, translating from tile coordinates\r\n  // (-4k to 8k -1) to texture coordinates.\r\n  v_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\r\n}\r\n",
"url:esri/views/vectorTiles/renderers/shaders/patternFillShader.fs.glsl":"uniform lowp float u_opacity;\r\nuniform mediump vec2 u_pattern_tl;\r\nuniform mediump vec2 u_pattern_br;\r\nuniform sampler2D u_texture;\r\n\r\nvarying mediump vec2 v_tileTextureCoord;\r\n\r\nvoid main()\r\n{\r\n  // normalize the calculated texture coordinate such that it fits in the range of 0 to 1.\r\n  mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\r\n  // interpolate the image coordinate between the top-left and the bottom right to get the actual position to sample.\r\n  // after normalizing the position, we get a value ranging between 0 and 1 which refers to the entire texture, however\r\n  // we need to only sample from area that has our sprite in the mosaic.\r\n  mediump vec2 samplePos \x3d mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\r\n  // sample the sprite mosaic\r\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\r\n  gl_FragColor \x3d u_opacity * color;\r\n}\r\n",
"url:esri/views/vectorTiles/renderers/shaders/fillOutlineShader.vs.glsl":"attribute vec2 a_pos;\r\nattribute vec2 a_offset;\r\nattribute vec2 a_xnormal;\r\n\r\nuniform highp mat4 u_transformMatrix;\r\nuniform highp mat4 u_extrudeMatrix;\r\nuniform highp vec2 u_normalized_origin;\r\nuniform mediump float u_depth;\r\nuniform mediump float u_outline_width;\r\n\r\nvarying lowp vec2 v_normal;\r\n\r\nconst float scale \x3d 1.0 / 15.0;\r\n\r\nvoid main()\r\n{\r\n  v_normal \x3d a_xnormal;\r\n\r\n   // calculate the relative distance from the centerline to the edge of the line. Since offset is given in integers (for the\r\n    // sake of using less attribute memory, we need to scale it back to the original range of ~ 0: 1)\r\n  mediump vec4 dist \x3d vec4(u_outline_width * a_offset * scale, 0.0, 0.0);\r\n\r\n  // Remove the texture normal bit of the position before scaling it with the\r\n  // model/view matrix. Add the extrusion vector *after* the model/view matrix\r\n  // because we're extruding the line in pixel space, regardless of the current\r\n  // tile's zoom level.\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * dist;\r\n}\r\n",
"url:esri/views/vectorTiles/renderers/shaders/fillOutlineShader.fs.glsl":"uniform lowp vec4 u_color;\r\nvarying mediump vec2 v_normal;\r\n\r\nvoid main()\r\n{\r\n  // Calculate the distance of the pixel from the line in pixels.\r\n  lowp float dist \x3d abs(v_normal.y);\r\n\r\n  lowp float alpha \x3d smoothstep(1.0, 0.0, dist);\r\n  gl_FragColor \x3d alpha * u_color;\r\n}\r\n","url:esri/views/vectorTiles/renderers/shaders/iconShader.vs.glsl":"attribute vec2 a_pos;\r\nattribute vec2 a_vertexOffset;\r\nattribute vec4 a_tex;\r\nattribute vec4 a_levelInfo;\r\n\r\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\r\n// relative to the tile's upper left corner\r\n// the extrusion vector.\r\nuniform highp mat4 u_transformMatrix;\r\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\r\nuniform highp mat4 u_extrudeMatrix;\r\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\r\nuniform highp vec2 u_normalized_origin;\r\n// the size of the mosaic given in pixels\r\nuniform vec2 u_mosaicSize;\r\n// the z of the layer. Given by the order of the layers in the style\r\nuniform mediump float u_depth;\r\n// the map's rotation from the north\r\nuniform mediump float u_mapRotation;\r\nuniform mediump float u_level;\r\n// indicate whether the current set of iconst should be kept upright when the map is rotated\r\nuniform lowp float u_keepUpright;\r\n// the rate of the change in the opacity (fade) of the icons\r\nuniform mediump float u_fadeSpeed;\r\n// the low level we transition (to/from)\r\nuniform mediump float u_minfadeLevel;\r\n// the high level we transition (to/from)\r\nuniform mediump float u_maxfadeLevel;\r\n// the amount of fade given teh current time past the last recorded level\r\nuniform mediump float u_fadeChange;\r\n// the opacity of the layer given by the painter\r\nuniform mediump float u_opacity;\r\n// the interpolated texture coordinate value to be used by the fragment shader in order to sample the sprite texture\r\nvarying lowp vec2 v_tex;\r\n// the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\r\n// opacity of the layer given by the painter\r\nvarying lowp float v_transparency;\r\n\r\n// the vertex offsets are given in integers, therefore in order to maintain a reasonable precission we multiply the values\r\n// by 16 and then at the shader devide by the same number\r\nconst float offsetPrecision \x3d 1.0 / 32.0;\r\n\r\nvoid main()\r\n{\r\n  mediump float a_labelMinLevel \x3d a_levelInfo[0];\r\n  mediump float a_angle        \x3d a_levelInfo[1];\r\n  mediump float a_minLevel    \x3d a_levelInfo[2];\r\n  mediump float a_maxLevel    \x3d a_levelInfo[3];\r\n\r\n  // if the given vertex should not be visible simply clip it by adding it a value that will push it outside the clipping plane\r\n  mediump float delta_z \x3d 0.0;\r\n\r\n  // If the label rotates with the map, and if the rotated label is upside down, hide it\r\n  mediump float rotated \x3d mod(a_angle - u_mapRotation, 256.0);\r\n  delta_z +\x3d (1.0 - step(u_keepUpright,0.0)) * step(65.0,rotated) * (1.0 - step(193.0,rotated)); //ie. z +\x3d (flip \x3e 0) \x26\x26 (65 \x3c\x3d rotated) \x26\x26 (rotated \x3c 193)\r\n\r\n  // u_level is the current service level adjusted for the change in font size\r\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level); // Test if (level \x3c minLevel)\r\n  delta_z +\x3d step(a_maxLevel, u_level); // Test if (maxLevel \x3c\x3d level)\r\n\r\n  // calculate the alpha given the change in the fade and the fade-speed\r\n  lowp float alpha \x3d clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0);\r\n\r\n  // if the speed is positive we are zooming in and therefore we need to 'fade-in'. Else we need to 'fade-out'\r\n  v_transparency \x3d (u_fadeSpeed \x3e\x3d 0.0 ? alpha : 1.0 - alpha);\r\n\r\n  // now deal with the min/max fade-levels. If we exceeded the level we simply snap to 0 or 1\r\n  if (u_maxfadeLevel \x3c a_labelMinLevel)\r\n  {\r\n      v_transparency \x3d 0.0;\r\n  }\r\n  if (u_minfadeLevel \x3e\x3d a_labelMinLevel)\r\n  {\r\n      v_transparency \x3d 1.0;\r\n  }\r\n\r\n  // if label had been faded out, clip it\r\n  delta_z +\x3d step(v_transparency, 0.0);\r\n\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * vec4(offsetPrecision * a_vertexOffset, delta_z, 0.0);\r\n  v_tex \x3d a_tex.xy / u_mosaicSize;\r\n\r\n  v_transparency *\x3d u_opacity;\r\n}\r\n",
"url:esri/views/vectorTiles/renderers/shaders/iconShader.fs.glsl":"uniform lowp sampler2D u_texture;\r\nvarying lowp vec2 v_tex;\r\nvarying lowp float v_transparency;\r\n\r\nvoid main()\r\n{\r\n  lowp vec4 color \x3d texture2D(u_texture, v_tex);\r\n  gl_FragColor \x3d v_transparency * color;\r\n}\r\n","url:esri/views/vectorTiles/renderers/shaders/sdfShader.vs.glsl":"attribute vec2 a_pos;\r\nattribute vec2 a_vertexOffset;\r\nattribute vec4 a_tex;\r\nattribute vec4 a_levelInfo;\r\n\r\n// attribute bool a_visible; // --\x3e a one bit controlling the visibility of the vertex\r\n\r\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\r\n// relative to the tile's upper left corner\r\n// the extrusion vector.\r\nuniform highp mat4 u_transformMatrix;\r\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\r\nuniform highp mat4 u_extrudeMatrix;\r\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\r\nuniform highp vec2 u_normalized_origin;\r\n// the size of the mosaic given in pixels\r\nuniform vec2 u_mosaicSize;\r\n// the z of the layer. Given by the order of the layers in the style\r\nuniform mediump float u_depth;\r\n// the map's rotation from the north\r\nuniform mediump float u_mapRotation;\r\nuniform mediump float u_level;\r\n// indicate whether the current set of iconst should be kept upright when the map is rotated\r\nuniform lowp float u_keepUpright;\r\n// the rate of the change in the opacity (fade) of the icons\r\nuniform mediump float u_fadeSpeed;\r\n// the low level we transition (to/from)\r\nuniform mediump float u_minfadeLevel;\r\n// the high level we transition (to/from)\r\nuniform mediump float u_maxfadeLevel;\r\n// the amount of fade given teh current time past the last recorded level\r\nuniform mediump float u_fadeChange;\r\n// the opacity of the layer given by the painter\r\nuniform mediump float u_opacity;\r\n// the interpolated texture coordinate value to be used by the fragment shader in order to sample the sprite texture\r\nvarying lowp vec2 v_tex;\r\n// the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\r\n// opacity of the layer given by the painter\r\nvarying lowp float v_transparency;\r\n\r\n// the vertex offsets are given in integers, therefore in order to maintain a reasonable precission we multiply the values\r\n// by 16 and then at the shader devide by the same number\r\nconst float offsetPrecision \x3d 1.0 / 32.0;\r\n\r\nvoid main()\r\n{\r\n  mediump float a_labelMinLevel \x3d a_levelInfo[0];\r\n  mediump float a_angle        \x3d a_levelInfo[1];\r\n  mediump float a_minLevel    \x3d a_levelInfo[2];\r\n  mediump float a_maxLevel    \x3d a_levelInfo[3];\r\n\r\n  // if the given vertex should not be visible simply clip it by adding it a value that will push it outside the clipping plane\r\n  mediump float delta_z \x3d 0.0;\r\n\r\n  // TODO: force clipping the vertex in case that the vertex isn't visible\r\n  //delta_z +\x3d a_visible ? 0.0 : 1.0;\r\n\r\n  // If the label rotates with the map, and if the rotated label is upside down, hide it\r\n  mediump float rotated \x3d mod(a_angle - u_mapRotation, 256.0);\r\n  delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(65.0, rotated) * (1.0 - step(193.0, rotated)); //ie. z +\x3d (flip \x3e 0) \x26\x26 (65 \x3c\x3d rotated) \x26\x26 (rotated \x3c 193)\r\n\r\n  // u_level is the current service level adjusted for the change in font size\r\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level); // Test if (level \x3c minLevel)\r\n  delta_z +\x3d step(a_maxLevel, u_level); // Test if (maxLevel \x3c\x3d level)\r\n\r\n  // calculate the alpha given the change in the fade and the fade-speed\r\n  lowp float alpha \x3d clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0);\r\n\r\n  // if the speed is positive we are zooming in and therefore we need to 'fade-in'. Else we need to 'fade-out'\r\n  v_transparency \x3d (u_fadeSpeed \x3e\x3d 0.0 ? alpha : 1.0 - alpha);\r\n\r\n  // now deal with the min/max fade-levels. If we exceeded the level we simply snap to 0 or 1\r\n  if (u_maxfadeLevel \x3c a_labelMinLevel)\r\n  {\r\n      v_transparency \x3d 0.0;\r\n  }\r\n  if (u_minfadeLevel \x3e\x3d a_labelMinLevel)\r\n  {\r\n      v_transparency \x3d 1.0;\r\n  }\r\n\r\n  // if label has been faded out, clip it\r\n  delta_z +\x3d step(v_transparency, 0.0);\r\n\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * vec4(offsetPrecision * a_vertexOffset, delta_z, 0.0);\r\n  v_tex \x3d a_tex.xy / u_mosaicSize;\r\n\r\n  v_transparency *\x3d u_opacity;\r\n}\r\n",
"url:esri/views/vectorTiles/renderers/shaders/sdfShader.fs.glsl":"uniform lowp sampler2D u_texture;\r\nuniform lowp vec4 u_color;\r\nuniform mediump float u_edgeDistance;\r\nuniform mediump float u_edgeWidth;\r\n\r\nvarying lowp vec2 v_tex;\r\nvarying lowp float v_transparency;\r\n\r\n// this is taken from http://www.valvesoftware.com/publications/2007/SIGGRAPH2007_AlphaTestedMagnification.pdf\r\n// and https://www.mapbox.com/blog/text-signed-distance-fields/\r\n// http://metalbyexample.com/rendering-text-in-metal-with-signed-distance-fields/\r\n\r\nvoid main()\r\n{\r\n  // read the distance from the SDF texture\r\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\r\n  // use a smooth-step in order to calculate the geometry of the shape given by the distance field\r\n  mediump float alpha \x3d smoothstep(u_edgeDistance - u_edgeWidth, u_edgeDistance + u_edgeWidth, dist) * v_transparency;\r\n\r\n  gl_FragColor \x3d alpha * u_color;\r\n\r\n// YF: this code allow having both a fill and an outline colors combined in a single pass\r\n//  lowp float geometryAlpha \x3d smoothstep(0.75 - 0.21, 0.75 + 0.21, dist) * v_transparency;\r\n//  lowp vec4 geometryColor \x3d vec4(u_color.rgb, geometryAlpha * u_color.a);\r\n//\r\n//  if (true) {\r\n//    lowp float haloAlpha \x3d smoothstep(0.0 - 0.1, 0.0 + 0.1, dist) * v_transparency;\r\n//    lowp vec4 haloColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\r\n//    haloColor \x3d vec4(haloColor.rgb, haloAlpha);\r\n//\r\n//    // calculate the composite color\r\n//    lowp float compositeAlpha \x3d geometryColor.a + haloColor.a * (1.0 - geometryColor.a);\r\n//    lowp vec3 compositeColor \x3d vec3(geometryColor) * geometryColor.a + vec3(haloColor) * haloColor.a * (1.0 - geometryColor.a);\r\n//    compositeColor /\x3d compositeAlpha;\r\n//    gl_FragColor \x3d vec4(compositeColor, compositeAlpha);\r\n//  }\r\n//  else {\r\n//    gl_FragColor \x3d geometryColor;\r\n//  }\r\n}\r\n",
"url:esri/views/vectorTiles/renderers/shaders/tileInfo.vs.glsl":"attribute vec2 a_pos;\r\n\r\nuniform highp mat4 u_transformMatrix;\r\nuniform mediump vec2 u_normalized_origin;\r\nuniform mediump float u_depth;\r\nuniform mediump float u_coord_ratio;\r\nuniform mediump vec2 u_delta; // in tile coordinates\r\nuniform mediump vec2 u_dimensions; // in tile coordinates\r\n\r\nvarying mediump vec2 v_tex;\r\n\r\nvoid main() {\r\n  mediump vec2 offests \x3d u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(offests, 0.0, 1.0);\r\n\r\n  v_tex \x3d a_pos;\r\n}\r\n",
"url:esri/views/vectorTiles/renderers/shaders/tileInfo.fs.glsl":"uniform mediump sampler2D u_texture;\r\nvarying mediump vec2 v_tex;\r\n\r\nvoid main(void) {\r\n  lowp vec4 color \x3d texture2D(u_texture, v_tex);\r\n  gl_FragColor \x3d 0.75 * color;\r\n}\r\n","*noref":1}});
define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/HandleRegistry ./LayerView2D ../engine/StageGL ./support/TileInfoViewPOT ./support/TileStrategy ./support/TileKey ./support/TileQueue ../../../views/vectorTiles/TileHandler ../../../views/vectorTiles/VectorTileContainer".split(" "),function(m,e,a,b,c,d,f,g,k,h,n,l,p,q){m=function(b){function c(){var a=null!==b&&b.apply(this,arguments)||this;a._handles=
new d;a.container=new g;return a}a(c,b);c.prototype.hitTest=function(a,b){return null};c.prototype.update=function(a){var b=this;this._vectorTileContainer&&this._vectorTileContainer.isInitialized&&(a.devicePixelRatio!==this._tileHandler.devicePixelRatio?this._start():(this._tileStrategy.updateTiles(function(a,c){return b._tileHandler.updateTile(a,c)},a),this._tileQueue.pause(),this._tileQueue.state=a.state,this._tileStrategy.update(a),this._tileQueue.resume(),this.notifyChange("updating")))};c.prototype.attach=
function(){this._start()};c.prototype.detach=function(){this._stop()};c.prototype.moveStart=function(){this.requestUpdate()};c.prototype.viewChange=function(){this.requestUpdate()};c.prototype.moveEnd=function(){this.requestUpdate()};c.prototype.isUpdating=function(){return this.attached&&(this._tileStrategy.updating||this.updateRequested)};c.prototype._stop=function(){this._handles.removeAll();this._vectorTileContainer&&(this._vectorTileContainer.removeAllChildren(),this.container.removeChild(this._vectorTileContainer));
this._tileStrategy&&this._tileStrategy.destroy();this._tileHandler&&this._tileHandler.stop();this._vectorTileContainer=this._tileHandler=this._tileStrategy=this._tileInfoView=null};c.prototype._start=function(){var a=this;this._stop();this._handles.add(this.watch("layer.currentStyleInfo",function(){return a.attach()}));this._vectorTileContainer=new q;this.container.addChild(this._vectorTileContainer);this._tileInfoView=new k(this.layer.tileInfo,this.layer.fullExtent);this._tileQueue=new l({tileInfoView:this._tileInfoView,
process:function(b){return a._fetchTile(b)}});this._tileStrategy=new h({container:{addTile:function(b){return a._vectorTileContainer.addChild(b)},removeTile:function(b){return a._vectorTileContainer.removeChild(b)},removeAllTiles:function(){return a._vectorTileContainer.removeAllChildren()}},tileInfoView:this._tileInfoView,requestUpdate:function(){return a.requestUpdate()},fetchTile:function(b){return a._tileQueue.push(n.from(b))}});this._tileHandler=new p(this.layer,function(){return a.requestUpdate()},
window.devicePixelRatio||1,!0);this._tileHandler.updateTile=this._tileHandler.updateTile.bind(this._tileHandler);this._tileHandler.start().then(function(){a._vectorTileContainer.initialize(a._tileHandler.spriteMosaic,a._tileHandler.glyphMosaic,a.layer.tileInfo,a._tileInfoView);a.requestUpdate()})};c.prototype._fetchTile=function(a){return this._tileHandler.getVectorTile(a,this.updateParameters)};return c}(c.declared(f));return m=b([c.subclass("esri.views.2d.layers.VectorTileLayerView2D")],m)});