// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.3/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ./ElevationInfo ../../support/aaBoundingBox ../../support/aaBoundingRect ../../webgl-engine/Stage ../../webgl-engine/lib/Util".split(" "),function(m,w,x,p,q,r,h,t,k,u){var v=u.assert;m=function(){function b(a,c,d,g,b,e){this.graphics3DSymbolLayer=a;this.renderGeometries=c;this.uniqueMaterials=d;this.uniqueTextures=g;this.boundingBox=b;this.elevationInfo=
new r(e);this.stage=null;this._visibilityFlags={};this._shown=!1}b.prototype.initialize=function(a,c){this.stage=c;if(this.uniqueMaterials)for(a=0;a<this.uniqueMaterials.length;a++)c.add(k.ModelContentType.MATERIAL,this.uniqueMaterials[a]);if(this.uniqueTextures)for(a=0;a<this.uniqueTextures.length;a++)c.add(k.ModelContentType.TEXTURE,this.uniqueTextures[a])};b.prototype.isDraped=function(){return!0};b.prototype.areVisibilityFlagsSet=function(a,c){for(var d=!0,g=Object.keys(this._visibilityFlags),
b=0;b<g.length;b++){var e=g[b];if(e!==c){if(e===a)return this._visibilityFlags[e];d=d&&this._visibilityFlags[e]}}return d};b.prototype.setVisibilityFlag=function(a,c){this._visibilityFlags[a]=c;return this._calcAndSetVisibility()};b.prototype._calcAndSetVisibility=function(){var a=this.areVisibilityFlagsSet();return this._shown!==a?(this._shown=a,v(!!this.stage,"Graphics3DDrapedGraphicLayer must be initialized first"),this._shown?this.stage.getTextureGraphicsRenderer().addRenderGeometries(this.renderGeometries):
this.stage.getTextureGraphicsRenderer().removeRenderGeometries(this.renderGeometries),!0):!1};b.prototype.destroy=function(){if(this.stage){var a=this.stage;this._shown&&a.getTextureGraphicsRenderer().removeRenderGeometries(this.renderGeometries);this._shown=!1;if(this.uniqueMaterials)for(var c=0;c<this.uniqueMaterials.length;c++)a.remove(k.ModelContentType.MATERIAL,this.uniqueMaterials[c].getId());if(this.uniqueTextures)for(c=0;c<this.uniqueTextures.length;c++)a.remove(k.ModelContentType.TEXTURE,
this.uniqueTextures[c].getId());this.stage=null}};b.prototype.mustAlignToTerrain=function(){return!1};b.prototype.alignWithElevation=function(a,c){};b.prototype.setDrawOrder=function(a,c,b){var g=this;this.uniqueMaterials&&this.uniqueMaterials.forEach(function(b){b.setRenderPriority(a);g._shown&&(c[b.getId()]=!0)})};b.prototype.getBSRadius=function(){return this.renderGeometries.reduce(function(a,c){return Math.max(a,c.bsRadius)},0)};b.prototype.getCenterObjectSpace=function(){return[0,0,0]};b.prototype.getProjectedBoundingBox=
function(a,c,b){return q(this,void 0,void 0,function(){var g,f,e;return p(this,function(d){switch(d.label){case 0:h.set(b,h.NEGATIVE_INFINITY);for(g=0;g<this.renderGeometries.length;g++)f=this.renderGeometries[g],this._getRenderGeometryProjectedBoundingRect(f,n,a),h.expand(b,n);if(!c)return[3,5];h.center(b,l);e=void 0;d.label=1;case 1:return d.trys.push([1,3,,4]),[4,c.queryElevation(l[0],l[1])];case 2:return e=d.sent(),[3,4];case 3:return d.sent(),e=null,[3,4];case 4:null!=e&&(b[2]=Math.min(b[2],
e),b[5]=Math.max(b[5],e)),d.label=5;case 5:return[2,b]}})})};b.prototype._getRenderGeometryProjectedBoundingRect=function(a,b,d){if(this.boundingBox)h.set(f,this.boundingBox);else{var c=a.center;a=a.bsRadius;f[0]=c[0]-a;f[1]=c[1]-a;f[2]=c[2]-a;f[3]=c[0]+a;f[4]=c[1]+a;f[5]=c[2]+a}d(f,0,2);return h.toRect(f,b)};return b}();var n=t.create(),f=[0,0,0,0,0,0],l=[0,0,0];return m});