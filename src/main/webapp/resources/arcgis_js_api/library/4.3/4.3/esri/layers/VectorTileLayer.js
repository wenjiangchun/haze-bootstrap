// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.3/esri/copyright.txt for details.
//>>built
require({cache:{"esri/portal/support/jsonContext":function(){define(["require","exports","../Portal","../../core/urlUtils"],function(e,f,h,d){f.createForItem=function(b){return{origin:"portal-item",url:d.urlToObject(b.itemUrl),portal:b.portal||h.getDefault()}}})},"esri/layers/support/vectorTileLayerLoader":function(){define("require exports dojo/has dojo/_base/lang ../../core/promiseUtils ../../core/urlUtils ../../config ../../request".split(" "),function(e,f,h,d,b,a,c,k){function g(c){if(c){var b=
a.getOrigin(c);a.canUseXhr(b)||-1!==n.indexOf(b)||n.push(b);return c}}function q(c,b,d){if(null!=b.sources){d&&-1!==d.path.indexOf("root.json")&&(d.path=d.path.substr(0,d.path.indexOf("root.json")),c.styleUrl=d.path);var g=p(b,d),m=b.sprite,e=b.glyphs;g&&g.url&&(g=d&&d.path?d.path:g.url,b.sprite&&!a.isAbsolute(b.sprite)&&(m=a.join(g,b.sprite)),b.glyphs&&!a.isAbsolute(b.glyphs)&&(e=a.join(g,b.glyphs)));c.style=b;c.spriteUrl=m;c.glyphsUrl=e;return l(c,b,d)}if(b.hasOwnProperty("tileInfo"))return c.layerDefinition=
b,c.serviceUrl=d.path,t(c,b,d)}function t(b,c,d){c=c.defaultStyles;a.isAbsolute(c)?b.styleUrl=a.normalize(c):b.styleUrl=a.normalize(a.join(d.path,c));g(b.styleUrl);return k(a.join(b.styleUrl,"root.json"),{responseType:"json"}).then(function(c){var d=c.data.sprite,g=c.data.glyphs;d&&!a.isAbsolute(d)&&(d=a.join(b.styleUrl,d));g&&!a.isAbsolute(g)&&(g=a.join(b.styleUrl,g));b.spriteUrl=d;b.glyphsUrl=g;return b.style=c.data})}function l(c,d,e){(d=p(d,e))||b.reject("Source isn't available in the syle object!");
if(d.url)return c.serviceUrl=d.url,a.isAbsolute(c.serviceUrl)||(c.serviceUrl=a.join(e.path,c.serviceUrl)),g(c.serviceUrl),k(c.serviceUrl,{query:{f:"json"},responseType:"json"}).then(function(a){c.layerDefinition=r(a.data);return c});c.layerDefinition=r(d);return b.resolve(c)}function p(c,b){if(!c.sources)return null;var d=c.sources;c=null;if(d.esri)c=d.esri,b&&c.url&&!a.isAbsolute(c.url)&&(d=b.path.substring(0,b.path.lastIndexOf("/")),c.url=a.join(d,c.url));else{for(var g=0,e=Object.keys(d);g<e.length;g++)if(b=
e[g],-1!==b.toLocaleLowerCase().indexOf("street")&&"vector"===c.type){c=d[b];break}if(!c)for(g=0,e=Object.keys(d);g<e.length&&(b=e[g],c=d[b],"vector"!==c.type);g++);}return c}function r(a){if(a.hasOwnProperty("tileInfo"))return a;for(var c={xmin:-2.0037507067161843E7,ymin:-2.0037507067161843E7,xmax:2.0037507067161843E7,ymax:2.0037507067161843E7,spatialReference:{wkid:102100}},b=(c.xmax-c.xmin)/512,d=[],e=a.hasOwnProperty("minzoom")?parseFloat(a.minzoom):0,q=a.hasOwnProperty("maxzoom")?parseFloat(a.maxzoom):
16;e<q;e++){var k=b/Math.pow(2,e);d.push({level:e,scale:Math.floor(3779.527559055118*k),resolution:k})}a.tiles.forEach(g);return{capabilities:"TilesOnly",initialExtent:c,fullExtent:c,minScale:d[0].scale,maxScale:d[d.length-1].scale,tiles:a.tiles,tileInfo:{rows:512,cols:512,dpi:96,format:"pbf",origin:{x:-2.0037508342787E7,y:2.0037508342787E7},lods:d,spatialReference:{wkid:102100}}}}var n=c.defaults&&c.defaults.io.corsEnabledServers||c.request.corsEnabledServers;f.loadMetadata=function(c){if(!c)return b.reject("invalid input URL!");
var e={layerDefinition:null,parsedUrl:null,serviceUrl:null,style:null,styleUrl:null,url:null,spriteUrl:null,glyphsUrl:null};if("string"!==typeof c)return q(e,c,null).then(function(){return e});c=e.url=a.normalize(c);var h=e.parsedUrl=a.urlToObject(c);g(c);return k(h.path,{responseType:"json",query:d.mixin({f:"json"},h.query)}).then(function(a){return q(e,a.data,h)}).then(function(){return e})}})},"esri/views/vectorTiles/style/StyleRepository":function(){define(["require","exports","./StyleLayer"],
function(e,f,h){return function(){function d(b,a){this.styleJSON=b;this.version=parseFloat(b.version);this.sprite=a?a.spriteUrl:b.sprite;this.glyphs=a?a.glyphsUrl:b.glyphs;this.layers=(b.layers||[]).map(d._create);this._identifyRefLayers()}d.prototype._identifyRefLayers=function(){for(var b=[],a=[],c=0,d=this.layers;c<d.length;c++){var g=d[c];if(1===g.type){var e=g.sourceLayer,e=e+("|"+JSON.stringify(g.minzoom)),e=e+("|"+JSON.stringify(g.maxzoom)),e=e+("|"+JSON.stringify(g.filter));b.push({key:e,
layer:g})}2===g.type&&(e=g.sourceLayer,e+="|"+JSON.stringify(g.minzoom),e+="|"+JSON.stringify(g.maxzoom),e+="|"+JSON.stringify(g.filter),e+="|"+JSON.stringify(g.layout["line-cap"]),e+="|"+JSON.stringify(g.layout["line-join"]),a.push({key:e,layer:g}))}this._assignRefLayers(b);this._assignRefLayers(a)};d.prototype._assignRefLayers=function(b){b.sort(function(a,c){return a.key<c.key?-1:a.key>c.key?1:0});for(var a,c,d=b.length,e=0;e<d;e++){var h=b[e];if(h.key===a)h.layer.refLayerId=c;else if(a=h.key,
c=h.layer.id,1===h.layer.type&&!h.layer.hasPaintProperty("fill-outline-color"))for(var f=e+1;f<d;f++){var l=b[f];if(l.key===a){if(l.layer.hasPaintProperty("fill-outline-color")){b[e]=l;b[f]=h;c=l.layer.id;break}}else break}}};d._create=function(b,a,c){a=1-1/(c.length+1)*(1+a);switch(b.type){case "background":return new h.StyleLayer(0,b,a);case "fill":return new h.StyleLayer(1,b,a);case "line":return new h.StyleLayer(2,b,a);case "symbol":return new h.StyleLayer(3,b,a);case "raster":throw Error("Unsupported vector tile raster layer");
case "circle":throw Error("Unsupported vector tile circle layer");}throw Error("Unknown vector tile layer");};return d}()})},"esri/views/vectorTiles/style/StyleLayer":function(){define(["require","exports","./StyleDefinition","./StyleProperty","./Filter"],function(e,f,h,d,b){e=function(){function a(a,b,d){this.type=a;this.id=b.id;this.source=b.source;this.sourceLayer=b["source-layer"];this.minzoom=b.minzoom;this.maxzoom=b.maxzoom;this.filter=b.filter;this.layout=b.layout;this.paint=b.paint;this.z=
d;switch(a){case 0:this._layoutDefinition=h.StyleDefinition.backgroundLayoutDefinition;this._paintDefinition=h.StyleDefinition.backgroundPaintDefinition;break;case 1:this._layoutDefinition=h.StyleDefinition.fillLayoutDefinition;this._paintDefinition=h.StyleDefinition.fillPaintDefinition;break;case 2:this._layoutDefinition=h.StyleDefinition.lineLayoutDefinition;this._paintDefinition=h.StyleDefinition.linePaintDefinition;break;case 3:this._layoutDefinition=h.StyleDefinition.symbolLayoutDefinition,this._paintDefinition=
h.StyleDefinition.symbolPaintDefinition}this._layoutProperties=this._parseLayout(this.layout);this._paintProperties=this._parsePaint(this.paint)}a.prototype.getFeatureFilter=function(){return void 0!==this._featureFilter?this._featureFilter:this._featureFilter=b.createFilter(this.filter)};a.prototype.hasLayoutProperty=function(a){var c=this._layoutProperties;return c&&c[a]?!0:!1};a.prototype.hasPaintProperty=function(a){var c=this._paintProperties;return c?void 0!==c[a]:!1};a.prototype.getLayoutValue=
function(a,b){var c,d=this._layoutProperties;d&&(d=d[a])&&(c=d.getValue(b));a=this._layoutDefinition[a];void 0===c&&(c=a["default"]);"enum"===a.type&&(c=a.values.indexOf(c));return c};a.prototype.getPaintValue=function(a,b){var c,d=this._paintProperties;d&&(d=d[a])&&(c=d.getValue(b));a=this._paintDefinition[a];void 0===c&&(c=a["default"]);"enum"===a.type&&(c=a.values.indexOf(c));return c};a.prototype._parseLayout=function(a){var c={},b;for(b in a)c[b]=new d(this._layoutDefinition[b],a[b]);return c};
a.prototype._parsePaint=function(a){var c={},b;for(b in a)c[b]=new d(this._paintDefinition[b],a[b]);return c};return a}();f.StyleLayer=e;e=function(){return function(a,c){this.cap=a.getLayoutValue("line-cap",c);this.join=a.getLayoutValue("line-join",c);this.miterLimit=a.getLayoutValue("line-miter-limit",c);this.roundLimit=a.getLayoutValue("line-round-limit",c)}}();f.LineLayout=e;e=function(){return function(a,c,b){this.allowOverlap=a.getLayoutValue("icon-allow-overlap",c);this.ignorePlacement=a.getLayoutValue("icon-ignore-placement",
c);this.optional=a.getLayoutValue("icon-optional",c);this.rotationAlignment=a.getLayoutValue("icon-rotation-alignment",c);this.size=a.getLayoutValue("icon-size",c);this.rotate=a.getLayoutValue("icon-rotate",c);this.padding=a.getLayoutValue("icon-padding",c);this.keepUpright=a.getLayoutValue("icon-keep-upright",c);this.offset=a.getLayoutValue("icon-offset",c);b&&1===this.rotationAlignment&&!a.hasLayoutProperty("icon-rotation-alignment")&&(this.rotationAlignment=0)}}();f.IconLayout=e;e=function(){return function(a,
c,b){this.allowOverlap=a.getLayoutValue("text-allow-overlap",c);this.ignorePlacement=a.getLayoutValue("text-ignore-placement",c);this.optional=a.getLayoutValue("text-optional",c);this.rotationAlignment=a.getLayoutValue("text-rotation-alignment",c);this.font=a.getLayoutValue("text-font",c);this.maxWidth=a.getLayoutValue("text-max-width",c);this.lineHeight=a.getLayoutValue("text-line-height",c);this.letterSpacing=a.getLayoutValue("text-letter-spacing",c);this.justify=a.getLayoutValue("text-justify",
c);this.anchor=a.getLayoutValue("text-anchor",c);this.maxAngle=a.getLayoutValue("text-max-angle",c);this.size=a.getLayoutValue("text-size",c);this.rotate=a.getLayoutValue("text-rotate",c);this.padding=a.getLayoutValue("text-padding",c);this.keepUpright=a.getLayoutValue("text-keep-upright",c);this.transform=a.getLayoutValue("text-transform",c);this.offset=a.getLayoutValue("text-offset",c);b&&1===this.rotationAlignment&&!a.hasLayoutProperty("text-rotation-alignment")&&(this.rotationAlignment=0)}}();
f.TextLayout=e})},"esri/views/vectorTiles/style/StyleDefinition":function(){define(["require","exports"],function(e,f){e=function(){return function(){}}();e.backgroundLayoutDefinition={visibility:{type:"enum",values:["visible","none"],"default":"visible"}};e.fillLayoutDefinition={visibility:{type:"enum",values:["visible","none"],"default":"visible"}};e.lineLayoutDefinition={visibility:{type:"enum",values:["visible","none"],"default":"visible"},"line-cap":{type:"enum",values:["butt","round","square"],
"default":"butt"},"line-join":{type:"enum",values:["bevel","round","miter"],"default":"miter"},"line-miter-limit":{type:"number","default":2},"line-round-limit":{type:"number","default":1.05}};e.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],"default":"visible"},"symbol-placement":{type:"enum",values:["point","line"],"default":"point"},"symbol-spacing":{type:"number",minimum:1,"default":250},"symbol-avoid-edges":{type:"boolean","default":!1},"icon-image":{type:"string"},
"icon-allow-overlap":{type:"boolean","default":!1},"icon-ignore-placement":{type:"boolean","default":!1},"icon-optional":{type:"boolean","default":!1},"icon-rotation-alignment":{type:"enum",values:["map","viewport"],"default":"viewport"},"icon-size":{type:"number",minimum:0,"default":1},"icon-rotate":{type:"number","default":0},"icon-padding":{type:"number",minimum:0,"default":2},"icon-keep-upright":{type:"boolean","default":!0},"icon-offset":{type:"array",value:"number",length:2,"default":[0,0]},
"text-field":{type:"string"},"text-rotation-alignment":{type:"enum",values:["map","viewport"],"default":"viewport"},"text-font":{type:"array",value:"string","default":["Open Sans Regular","Arial Unicode MS Regular"]},"text-size":{type:"number",minimum:0,"default":16},"text-max-width":{type:"number",minimum:0,"default":10},"text-line-height":{type:"number","default":1.2},"text-letter-spacing":{type:"number","default":0},"text-justify":{type:"enum",values:["left","center","right"],"default":"center"},
"text-anchor":{type:"enum",values:"center left right top bottom top-left top-right bottom-left bottom-right".split(" "),"default":"center"},"text-max-angle":{type:"number",minimum:0,"default":45},"text-rotate":{type:"number","default":0},"text-padding":{type:"number",minimum:0,"default":2},"text-keep-upright":{type:"boolean","default":!0},"text-transform":{type:"enum",values:["none","uppercase","lowercase"],"default":"none"},"text-offset":{type:"array",value:"number",length:2,"default":[0,0]},"text-allow-overlap":{type:"boolean",
"default":!1},"text-ignore-placement":{type:"boolean","default":!1},"text-optional":{type:"boolean","default":!1}};e.backgroundPaintDefinition={"background-opacity":{type:"number",minimum:0,maximum:1,"default":1},"background-color":{type:"color","default":[0,0,0,1]},"background-pattern":{type:"string"}};e.fillPaintDefinition={"fill-opacity":{type:"number",minimum:0,maximum:1,"default":1},"fill-antialias":{type:"boolean","default":!0},"fill-color":{type:"color","default":[0,0,0,1]},"fill-outline-color":{type:"color",
"default":[0,0,0,0]},"fill-translate":{type:"array",value:"number",length:2,"default":[0,0]},"fill-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"},"fill-pattern":{type:"string"}};e.linePaintDefinition={"line-opacity":{type:"number",minimum:0,maximum:1,"default":1},"line-color":{type:"color","default":[0,0,0,1]},"line-translate":{type:"array",value:"number",length:2,"default":[0,0]},"line-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"},"line-width":{type:"number",
minimum:0,"default":1},"line-gap-width":{type:"number",minimum:0,"default":0},"line-offset":{type:"number","default":0},"line-blur":{type:"number",minimum:0,"default":0},"line-dasharray":{type:"array",value:"number","default":[]},"line-pattern":{type:"string"}};e.symbolPaintDefinition={"icon-opacity":{type:"number",minimum:0,maximum:1,"default":1},"icon-color":{type:"color","default":[0,0,0,1]},"icon-halo-color":{type:"color","default":[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,"default":0},
"icon-halo-blur":{type:"number",minimum:0,"default":0},"icon-translate":{type:"array",value:"number",length:2,"default":[0,0]},"icon-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"},"text-opacity":{type:"number",minimum:0,maximum:1,"default":1},"text-color":{type:"color","default":[0,0,0,1]},"text-halo-color":{type:"color","default":[0,0,0,0]},"text-halo-width":{type:"number",minimum:0,"default":0},"text-halo-blur":{type:"number",minimum:0,"default":0},"text-translate":{type:"array",
value:"number",length:2,"default":[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"}};e.rasterPaintDefinition={"raster-opacity":{type:"number",minimum:0,maximum:1,"default":1},"raster-hue-rotate":{type:"number","default":0},"raster-brightness-min":{type:"number",minimum:0,maximum:1,"default":0},"raster-brightness-max":{type:"number",minimum:0,maximum:1,"default":1},"raster-saturation":{type:"number",minimum:-1,maximum:1,"default":0},"raster-contrast":{type:"number",
minimum:-1,maximum:1,"default":0},"raster-fade-duration":{type:"number",minimum:0,"default":300}};e.circlePaintDefinition={"circle-opacity":{type:"number",minimum:0,maximum:1,"default":1},"circle-radius":{type:"number",minimum:0,"default":5},"circle-color":{type:"color","default":[0,0,0,1]},"circle-blur":{type:"number",minimum:0,"default":0},"circle-translate":{type:"array",value:"number",length:2,"default":[0,0]},"circle-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"}};
f.StyleDefinition=e})},"esri/views/vectorTiles/style/StyleProperty":function(){define(["require","exports","../../../Color","../GeometryUtils"],function(e,f,h,d){return function(){function b(a,c){switch(a.type){case "number":a=!0;break;case "color":a=!0;c=b._parseColor(c);break;case "array":a="number"===a.value;break;default:a=!1}this.getValue=a?this._interpolate(c):this._piecewise(c)}b.prototype._piecewise=function(a){var c=a.stops;return c?function(a){var b=c.length;if(0!==b){for(var d=0,e=0;e<
b;e++)if(c[e][0]<=a)d=e;else break;return c[d][1]}}:function(){return a}};b.prototype._interpolate=function(a){var b=a.stops;if(b){var e=a.base||1;return function(a){for(var c,h,g=b.length,f=0;f<g;f++){var k=b[f];if(k[0]<=a)c=k;else{h=k;break}}if(c&&h){f=h[0]-c[0];a-=c[0];a=1===e?a/f:(Math.pow(e,a)-1)/(Math.pow(e,f)-1);if(Array.isArray(c[1])){c=c[1];h=h[1];g=[];for(f=0;f<c.length;f++)g.push(d.interpolate(c[f],h[f],a));return g}return d.interpolate(c[1],h[1],a)}if(c)return c[1];if(h)return h[1]}}return function(){return a}};
b._parseColor=function(a){if(Array.isArray(a))return a;if("string"===typeof a)return a=new h(a),[a.r/255,a.g/255,a.b/255,a.a||1];if(a&&a.stops)return a.stops=a.stops.map(function(a){return[a[0],b._parseColor(a[1])]}),a;throw Error("Incorrect color definition "+a);};return b}()})},"esri/views/vectorTiles/GeometryUtils":function(){define(["require","exports"],function(e,f){function h(b,a){b%=a;return 0<=b?b:b+a}f.C_INFINITY=Number.POSITIVE_INFINITY;f.C_PI=Math.PI;f.C_2PI=2*f.C_PI;f.C_PI_BY_2=f.C_PI/
2;f.C_RAD_TO_256=128/f.C_PI;f.C_256_TO_RAD=f.C_PI/128;f.C_DEG_TO_256=256/360;f.C_DEG_TO_RAD=f.C_PI/180;f.C_SQRT2=1.414213562;f.C_SQRT2_INV=1/f.C_SQRT2;var d=1/Math.LN2;f.positiveMod=h;f.radToByte=function(b){return h(b*f.C_RAD_TO_256,256)};f.degToByte=function(b){return h(b*f.C_DEG_TO_256,256)};f.log2=function(b){return Math.log(b)*d};f.sqr=function(b){return b*b};f.clamp=function(b,a,c){return Math.min(Math.max(b,a),c)};f.interpolate=function(b,a,c){return b*(1-c)+a*c};f.between=function(b,a,c){return b>=
a&&b<=c||b>=c&&b<=a}})},"esri/views/vectorTiles/style/Filter":function(){define(["require","exports"],function(e,f){e=function(){function e(d,b,a){this._op=d;"$type"===b?(this._val=a instanceof Array?a.map(function(a){return e._types.indexOf(a)}):e._types.indexOf(a),this._op+=11):(this._key=b,this._val=a)}e.prototype.filter=function(d){switch(this._op){case 0:return this._val;case 1:return d.values[this._key]===this._val;case 2:return d.values[this._key]!==this._val;case 3:return d.values[this._key]<
this._val;case 4:return d.values[this._key]>this._val;case 5:return d.values[this._key]<=this._val;case 6:return d.values[this._key]>=this._val;case 7:return-1!==this._val.indexOf(d.values[this._key]);case 8:return-1===this._val.indexOf(d.values[this._key]);case 9:for(var b=0,a=this._val;b<a.length;b++){var c=a[b];if(c.filter(d))return!0}return!1;case 10:b=0;for(a=this._val;b<a.length;b++)if(c=a[b],!c.filter(d))return!1;return!0;case 11:b=0;for(a=this._val;b<a.length;b++)if(c=a[b],c.filter(d))return!1;
return!0;case 12:return d.type===this._val;case 13:return d.type!==this._val;case 14:return d.type<this._val;case 15:return d.type>this._val;case 16:return d.type>=this._val;case 17:return d.type<=this._val;case 18:return-1!==this._val.indexOf(d.type);case 19:return-1===this._val.indexOf(d.type)}};e.createFilter=function(d){if(!d)return new e(0,void 0,!0);var b=d[0];if(1>=d.length)return new e(0,void 0,"any"!==b);switch(b){case "\x3d\x3d":return new e(1,d[1],d[2]);case "!\x3d":return new e(2,d[1],
d[2]);case "\x3e":return new e(4,d[1],d[2]);case "\x3c":return new e(3,d[1],d[2]);case "\x3e\x3d":return new e(6,d[1],d[2]);case "\x3c\x3d":return new e(5,d[1],d[2]);case "in":return new e(7,d[1],d.slice(2));case "!in":return new e(8,d[1],d.slice(2));case "any":return new e(9,void 0,d.slice(1).map(e.createFilter.bind(this)));case "all":return new e(10,void 0,d.slice(1).map(e.createFilter.bind(this)));case "none":return new e(11,void 0,d.slice(1).map(e.createFilter.bind(this)));default:throw Error("invalid operator: "+
b);}};return e}();e._types=["Unknown","Point","LineString","Polygon"];return e})},"esri/views/vectorTiles/SchemaHelper":function(){define(["require","exports","../../core/Error"],function(e,f,h){return function(){function d(b){this.lockedSchemaPixelSize=b}d.prototype.getCompatibleLevelRowCol=function(b){var a=b[0],c=b[1];b=b[2];if(256===this.lockedSchemaPixelSize&&0<a)a--,c>>=1,b>>=1;else if(0!==a&&512!==this.lockedSchemaPixelSize)throw new h("Cannot get a compatible tile key for the locked tiling scheme!");
return[a,c,b]};d.prototype.getSchemaShift=function(b,a){var c=0,d=0;256===this.lockedSchemaPixelSize&&(b[2]%2&&(c=2*a),b[1]%2&&(d=2*a));return[c,d]};d.prototype.adjustLevel=function(b){return 256===this.lockedSchemaPixelSize?0<b?b-1:0:b};d.create256x256CompatibleTileInfo=function(b){if(!b)return null;if(256===b.rows&&256===b.cols)return b;for(var a=b.format,c=b.compressionQuality,d=b.dpi,e=b.origin,f=b.spatialReference,h=[],l,p,r=b.lods.length,n=0;n<r;n++){var m=b.lods[n];l=m.scale;p=2*m.resolution;
h.push({level:m.level,scale:l,resolution:p})}return{rows:256,cols:256,dpi:d,format:a,compressionQuality:c,origin:e,spatialReference:f,lods:h}};return d}()})},"*noref":1}});
define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/_base/lang ../core/accessorSupport/decorators ../core/Error ../core/MultiOriginJSONSupport ../core/urlUtils ../core/promiseUtils ../core/lang ../request ../geometry/Extent ../geometry/SpatialReference ../portal/support/jsonContext ./TiledLayer ./mixins/OperationalLayer ./mixins/PortalLayer ./mixins/ScaleRangeLayer ./mixins/ArcGISCachedService ./support/TileInfo ./support/vectorTileLayerLoader ../views/vectorTiles/style/StyleRepository ../views/vectorTiles/SchemaHelper".split(" "),function(e,
f,h,d,b,a,c,k,g,q,t,l,p,r,n,m,v,w,x,y,u,z,A,B){e=function(a){function d(b,c){b=a.call(this)||this;b.currentStyleInfo=null;b.fullExtent=null;b.operationalLayerType="VectorTileLayer";b.tileInfo=null;b.type="vector-tile";b.url=null;return b}h(d,a);d.prototype.normalizeCtorArgs=function(a,c){return"string"===typeof a?b.mixin({},{url:a},c):a};d.prototype.load=function(){var a=this,b=this.loadFromPortal({supportedTypes:["Vector Tile Service"],supportsData:!1}).then(function(){if(a.portalItem&&a.portalItem.id){var b=
a.portalItem.itemUrl+"/resources/styles/root.json";return l(b,{query:{f:"json"}}).then(function(c){c.data&&a.read({url:b},n.createForItem(a.portalItem))})}}).always(function(){return a.loadStyle()});this.addResolvingPromise(b);return this};Object.defineProperty(d.prototype,"attributionDataUrl",{get:function(){var a=this.currentStyleInfo;return(a=a&&a.serviceUrl&&g.urlToObject(a.serviceUrl))?this._getDefaultAttribution(a.path):null},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,
"serviceUrl",{get:function(){return this.currentStyleInfo&&this.currentStyleInfo.serviceUrl||null},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"spatialReference",{get:function(){return this.tileInfo&&this.tileInfo.spatialReference||null},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"styleUrl",{get:function(){return this.currentStyleInfo&&this.currentStyleInfo.styleUrl||null},enumerable:!0,configurable:!0});d.prototype.writeStyleUrl=function(a,b){a&&g.isProtocolRelative(a)&&
(a="https:"+a);a&&!t.endsWith(a,"root.json")&&(a=g.join(a,"root.json"));b.styleUrl=a};d.prototype.readTileIndexType=function(a,b){return b.type};d.prototype.readTileIndexUrl=function(a,b){return g.join(this.serviceUrl,b.tileMap)};d.prototype.readTileServers=function(a,b){var c=this;a=b.tiles;this.serviceUrl&&a.forEach(function(a,b,d){d[b]=g.join(c.serviceUrl,a)});return a};d.prototype.readVersion=function(a,b){return b.version?parseFloat(b.version):parseFloat(b.currentVersion)};d.prototype.readTileInfo256=
function(a,b){return new u(B.create256x256CompatibleTileInfo(this.tileInfo.toJSON()))};d.prototype.loadStyle=function(a){a=a||this.url;if(this._loadingPromise&&"string"===typeof a&&this.url===a)return this._loadingPromise;var b=this._loadingPromise;this._loadingPromise=this._getSourceAndStyle(a);b&&!b.isFulfilled()&&b.cancel();return this._loadingPromise};d.prototype.getTileUrl=function(a,b,c){var d=this.tileServers[b%this.tileServers.length];return d=d.replace(/\{z\}/gi,a.toString()).replace(/\{y\}/gi,
b.toString()).replace(/\{x\}/gi,c.toString())};d.prototype.write=function(a,b){return b&&b.origin&&!this.styleUrl?(b.messages&&b.messages.push(new c("vectortilelayer:unsupported","VectorTileLayer ("+this.title+", "+this.id+") with style defined by JSON only are not supported",{layer:this})),null):this.inherited(arguments,[a,b])};d.prototype._getSourceAndStyle=function(a){var b=this;return a?z.loadMetadata(a).then(function(a){b._set("currentStyleInfo",{serviceUrl:a.serviceUrl,styleUrl:a.styleUrl,spriteUrl:a.spriteUrl,
glyphsUrl:a.glyphsUrl,style:a.style,layerDefinition:a.layerDefinition});b._set("styleRepository",new A(a.style,a));b.read(a.layerDefinition)}):q.reject(Error("invalid style!"))};d.prototype._getDefaultAttribution=function(a){var b=a.match(/^https?:\/\/(basemaps|basemapsbeta)\.arcgis\.com(\/[^\/]+)?\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/vectortileserver/i);if(b&&(a=b[3]&&b[3].toLowerCase()))for(var b=b[2]||"",c=0,d=["World_Basemap"];c<d.length;c++){var e=d[c];if(-1<e.toLowerCase().indexOf(a))return g.normalize("//static.arcgis.com/attribution/Vector"+
b+"/"+e)}};return d}(a.declared(m,v,w,x,k,y));d([a.shared({"2d":"../views/2d/layers/VectorTileLayerView2D","3d":"../views/3d/layers/VectorTileLayerView3D"})],e.prototype,"viewModulePaths",void 0);d([a.property({readOnly:!0,dependsOn:["currentStyleInfo"]})],e.prototype,"attributionDataUrl",null);d([a.property({readOnly:!0})],e.prototype,"currentStyleInfo",void 0);d([a.property({type:p,readOnly:!0})],e.prototype,"fullExtent",void 0);d([a.property({readOnly:!0,dependsOn:["currentStyleInfo"]})],e.prototype,
"serviceUrl",null);d([a.property({type:r,dependsOn:["tileInfo"],readOnly:!0})],e.prototype,"spatialReference",null);d([a.property({readOnly:!0})],e.prototype,"styleRepository",void 0);d([a.property({readOnly:!0,dependsOn:["currentStyleInfo"],json:{write:{ignoreOrigin:!0}}})],e.prototype,"styleUrl",null);d([a.writer("styleUrl")],e.prototype,"writeStyleUrl",null);d([a.property({readOnly:!0})],e.prototype,"tileIndexType",void 0);d([a.reader("tileIndexType",["tileIndexType","type"])],e.prototype,"readTileIndexType",
null);d([a.property({readOnly:!0})],e.prototype,"tileIndexUrl",void 0);d([a.reader("tileIndexUrl",["tileIndexUrl","tileMap"])],e.prototype,"readTileIndexUrl",null);d([a.property({readOnly:!0,type:u})],e.prototype,"tileInfo",void 0);d([a.property({readOnly:!0})],e.prototype,"tileServers",void 0);d([a.reader("tileServers",["tiles"])],e.prototype,"readTileServers",null);d([a.property({json:{read:!1}})],e.prototype,"type",void 0);d([a.property({json:{origins:{webDocument:{read:{source:"styleUrl"}},portalItem:{read:{source:"url"}}},
write:!1,read:!1}})],e.prototype,"url",void 0);d([a.property({readOnly:!0})],e.prototype,"version",void 0);d([a.reader("version",["version","currentVersion"])],e.prototype,"readVersion",null);d([a.property({readOnly:!0})],e.prototype,"tileInfo256",void 0);d([a.reader("tileInfo256",["tileInfo"])],e.prototype,"readTileInfo256",null);return e=d([a.subclass("esri.layers.VectorTileLayer")],e)});