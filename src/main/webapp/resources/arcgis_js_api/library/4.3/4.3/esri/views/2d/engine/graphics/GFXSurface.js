// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.3/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/tsSupport/extendsHelper dojo/_base/lang ../../math/mat2d ../../math/common ../../viewpointUtils ../Container ./Projector ./gfx ../cssUtils".split(" "),function(v,w,m,n,f,g,p,q,r,t,h){function l(c){return{xx:c[0],yx:c[1],xy:c[2],yy:c[3],dx:c[4],dy:c[5]}}var u=l([1,0,0,1,0,0]);return function(c){function b(){var a=null!==c&&c.apply(this,arguments)||this;a._transform=f.create();a._projector=new r;return a}m(b,c);b.prototype.createElement=function(){var a=document.createElement("div");
a.setAttribute("class","esri-display-object");return a};b.prototype.setElement=function(a){this.surface&&(this.surface.destroy(),this.surface=null);if(this.element=a)this.surface=t.createSurface(this.element,400,400)};b.prototype.render=function(a){var d=this.element.style;if(this.visible){d.display="block";d.opacity=""+this.opacity;var b=this._transform,e=a.state;if(a.stationary)p.getMatrix(b,e.center,e.size,e.resolution,g.toRadian(e.rotation)),this.surface.setDimensions(e.size[0],e.size[1]),this._projector.update(b,
e.resolution),this.children.forEach(function(a){a.g&&a.g.setTransform(u)}),c.prototype.render.call(this,a);else{var k=f.invert(f.create(),b);f.multiply(k,e.transform,k);this.children.forEach(function(a){a.g&&a.g.setTransform(l(k))})}h.clip(d,e.clipRect);d.transform=h.cssMatrix3d(f.fromRotation(f.create(),g.toRadian(e.rotation)));this.surface.rawNode.style.transform=h.cssMatrix(f.fromRotation(f.create(),g.toRadian(-e.rotation)))}else d.display="none"};b.prototype.hitTest=function(a,b){if(!this.attached)return null;
var d=this.surface.rawNode,d=d.parentElement||d.parentNode;d.style.zIndex="9000";a=document.elementFromPoint(a,b);d.style.zIndex="";return a&&a.gfxObject||null};b.prototype.prepareChildrenRenderParameters=function(a){return n.mixin({},a,{projector:this._projector,surface:this.surface})};b.prototype.beforeRenderChildren=function(a,b){this.surface.openBatch()};b.prototype.attachChild=function(a,b){return a.attach(b)};b.prototype.detachChild=function(a,b){return a.detach()};b.prototype.renderChild=function(a,
b){return a.render(b)};b.prototype.afterRenderChildren=function(a,b){this.surface.closeBatch()};return b}(q)});