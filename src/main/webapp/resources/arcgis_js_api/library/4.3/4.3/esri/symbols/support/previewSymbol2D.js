// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.3/esri/copyright.txt for details.
//>>built
define("require exports dojox/gfx/_base ../SimpleMarkerSymbol ../../core/promiseUtils ../../core/Error ../../core/screenUtils ./renderUtils ./previewUtils ./gfxUtils".split(" "),function(z,u,v,m,q,w,n,x,y,r){u.previewSymbol2D=function(b,h){var g=h&&h.size?n.pt2px(h.size):null,k=h&&h.maxSize?n.pt2px(h.maxSize):null,c=r.getStroke(b),f={shape:null,fill:r.getFill(b),stroke:c};c&&c.width&&(c.width=Math.min(c.width,80));var a=0,d=0,p=c&&c.width||0,t=!1,l=null;switch(b.type){case "simple-marker-symbol":a=
m.defaultProps;c=b.style;d=a=g=Math.min(g||n.pt2px(b.size||a.size),k||120);switch(c){case m.STYLE_CIRCLE:f.shape={type:"circle",cx:0,cy:0,r:.5*g};break;case m.STYLE_CROSS:f.shape={type:"path",path:[{command:"M",values:[0,.5*d]},{command:"L",values:[a,.5*d]},{command:"M",values:[.5*a,0]},{command:"L",values:[.5*a,d]},{command:"E",values:[]}]};break;case m.STYLE_DIAMOND:f.shape={type:"path",path:[{command:"M",values:[0,.5*d]},{command:"L",values:[.5*a,0]},{command:"L",values:[a,.5*d]},{command:"L",
values:[.5*a,d]},{command:"Z",values:[]}]};break;case m.STYLE_SQUARE:f.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[a,0]},{command:"L",values:[a,d]},{command:"L",values:[0,d]},{command:"Z",values:[]}]};break;case m.STYLE_X:f.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[a,d]},{command:"M",values:[a,0]},{command:"L",values:[0,d]},{command:"E",values:[]}]};break;case m.STYLE_PATH:t=!0,f.shape={type:"path",path:b.path||""}}break;case "simple-line-symbol":b=
Math.min(g||p,k||80);a=22<b?2*b:40;d=b;c.width=b;p=0;f.shape={type:"path",path:[{command:"M",values:[0,.5*d]},{command:"L",values:[a,.5*d]},{command:"E",values:[]}]};break;case "picture-fill-symbol":case "simple-fill-symbol":f.shape=y.shapes.fill[0];break;case "picture-marker-symbol":var l=k||120,c=n.pt2px(b.width),e=n.pt2px(b.height),l=Math.min(g||Math.max(c,e),l),a=c/e,c=1>=a?Math.ceil(l*a):l,e=1>=a?l:Math.ceil(l/a),a=c,d=e,l=h.opacity;f.shape={type:"image",x:-Math.round(c/2),y:-Math.round(e/2),
width:c,height:e,src:b.get("source.imageData")?"data:"+b.source.contentType+";base64,"+b.source.imageData:b.url||""};break;case "text-symbol":c=b.text||"Aa";e=b.font;g=Math.min(g||n.pt2px(e.size),k||120);for(d=a=0;d<c.length;d++)k=c.charAt(d),k=k===k.toUpperCase()?.7:.5,a+=g*k;d=g;f.shape={type:"text",text:c,x:0,y:.25*v.normalizedLength((e?g:0).toString()),align:"middle",decoration:b.decoration||e&&e.decoration,rotated:b.rotated,kerning:b.kerning};f.font=e&&{size:g,style:e.style,variant:e.variant,
decoration:e.decoration,weight:e.weight,family:e.family}}return f.shape?q.resolve(x.renderSymbol([[f]],[(a||22)+2*p,(d||22)+2*p],{node:h&&h.node,scale:t,opacity:l})):q.reject(new w("symbolPreview: renderPreviewHTML2D","symbol not supported."))}});