// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.3/esri/copyright.txt for details.
//>>built
define("../../../geometry/SpatialReference ../../../geometry/Point ./mathUtils ./earthUtils ../lib/glMatrix ../webgl-engine/lib/BufferVectorMath".split(" "),function(t,B,q,y,z,C){var u=z.vec3d,r=z.mat4d,D=C.Vec3Compact,c=u.create(),h=u.create(),m=u.create(),k=q.deg2rad(1),v=q.rad2deg(1),A=new t({wkt:'\r\n      GEOCCS["Spherical geocentric",\r\n        DATUM["Not specified",\r\n          SPHEROID["Sphere",'+y.earthRadius+',0]],\r\n        PRIMEM["Greenwich",0.0,\r\n          AUTHORITY["EPSG","8901"]],\r\n        UNIT["m",1.0],\r\n        AXIS["Geocentric X",OTHER],\r\n        AXIS["Geocentric Y",EAST],\r\n        AXIS["Geocentric Z",NORTH]\r\n      ]\r\n    '}),
g=y.earthRadius,n=function(a){return a===A?1:a.isWGS84?2:a.isWebMercator?3:0};t=function(a,d,b,e){b[e++]=a[d++];b[e++]=a[d++];b[e]=a[d]};var w=function(a,d,b,e){var c=.4999999*Math.PI,f=k*a[d+1],f=q.clamp(f,-c,c),c=Math.sin(f);b[e++]=k*a[d]*g;b[e++]=g/2*Math.log((1+c)/(1-c));b[e]=a[d+2]},x=function(a,d,b,e){var c=g+a[d+2],f=k*a[d+1];a=k*a[d];d=Math.cos(f);b[e++]=Math.cos(a)*d*c;b[e++]=Math.sin(a)*d*c;b[e]=Math.sin(f)*c},E=[void 0,x,t,w],p=[void 0,function(a,d,b,e){var c=D.length(a,d),f=q.asin(a[d+
2]/c);a=(0<a[d+1]?1:-1)*q.acos(a[d]/(Math.cos(f)*c));b[e++]=v*a;b[e++]=v*f;b[e]=c-g},t,function(a,d,b,e){b[e++]=v*(a[d++]/g);b[e++]=v*(Math.PI/2-2*Math.atan(Math.exp(-1*a[d++]/g)));b[e]=a[d]}];return{SphericalRenderSpatialReference:A,vectorToVector:function(a,d,b,e){2===a.length?(c[0]=a[0],c[1]=a[1],c[2]=0,a=c):a===b&&(u.set(a,c),a=c);return this.bufferToBuffer(a,d,0,b,e,0,1)},pointToVector:function(a,d,b){c[0]=a.x;c[1]=a.y;c[2]=a.z||0;return this.bufferToBuffer(c,a.spatialReference,0,d,b,0,1)},vectorToPoint:function(a,
d,b,e){"esri.SpatialReference"===b.declaredClass?(e=b,b=new B({spatialReference:e})):e=e||b.spatialReference;return this.bufferToBuffer(a,d,0,c,e,0,1)?(b.x=c[0],b.y=c[1],b.z=c[2],b.spatialReference=e,b):null},xyzToVector:function(a,d,b,e,l,f){c[0]=a;c[1]=d;c[2]=b;return this.bufferToBuffer(c,e,0,l,f,0,1)},bufferToBuffer:function(a,d,b,e,c,f,g){g=g||1;var l=n(d),k=n(c);g=b+3*g;if(l!==k||0===l&&!d.equals(c))if(0<l&&0<k)if(2!==k)if(c=E[k],2!==l)for(l=p[l];b<g;b+=3,f+=3)l(a,b,h,0,d.wkid),c(h,0,e,f);else for(;b<
g;b+=3,f+=3)c(a,b,e,f);else for(l=p[l];b<g;b+=3,f+=3)l(a,b,e,f,d.wkid);else return!1;else if(e!==a||b!==f)for(;b<g;b++,f++)e[f]=a[b];return!0},computeLinearTransformation:function(a,d,b,e){var c=n(a),f=n(e);if(c===f&&(0!==c||a.equals(e)))return r.identity(b),r.translate(b,d),!0;if(1===f){if(e=p[c])return e(d,0,h,0,a.wkid),x(h,0,m,0),e=k*h[0],d=k*h[1],a=Math.sin(e),e=Math.cos(e),c=Math.sin(d),d=Math.cos(d),b[0]=-a,b[4]=-c*e,b[8]=d*e,b[12]=m[0],b[1]=e,b[5]=-c*a,b[9]=d*a,b[13]=m[1],b[2]=0,b[6]=d,b[10]=
c,b[14]=m[2],b[3]=0,b[7]=0,b[11]=0,b[15]=1,!0}else if(3===f&&(2===c||1===c))return p[c](d,0,h,0,a.wkid),a=k*h[1],w(h,0,m,0),r.identity(b),r.translate(b,m),a=1/Math.cos(a),r.scale(b,[a,a,1]),!0;return!1},mbsToMbs:function(a,d,b,c){var e=n(d),f=n(c);if(e===f&&(0!==e||d.equals(c)))return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],!0;if(1===f){if(c=p[e])return c(a,0,h,0,d.wkid),x(h,0,b,0),b[3]=a[3],!0}else if(3===f&&(2===e||1===e))return p[e](a,0,h,0,d.wkid),d=k*h[1],d=Math.abs(d)+Math.asin(a[3]/(g+a[2])),
w(h,0,b,0),b[3]=d>.9999*Math.PI?Number.MAX_VALUE:1/Math.cos(d)*a[3],!0;return!1},extentToBoundingBox:function(a,d,b){if(null==a)return!1;var e;c[0]=null!=a.xmin?a.xmin:0;c[1]=null!=a.ymin?a.ymin:0;c[2]=null!=a.zmin?a.zmin:0;e=this.bufferToBuffer(c,a.spatialReference,0,d,b,0,1);c[0]=null!=a.xmax?a.xmax:0;c[1]=null!=a.ymax?a.ymax:0;c[2]=null!=a.zmax?a.zmax:0;e=e&&this.bufferToBuffer(c,a.spatialReference,0,d,b,3,1);null==a.xmin&&(d[0]=-Infinity);null==a.ymin&&(d[1]=-Infinity);null==a.zmin&&(d[2]=-Infinity);
null==a.xmax&&(d[3]=Infinity);null==a.ymax&&(d[4]=Infinity);null==a.zmax&&(d[5]=Infinity);return e},extentToBoundingRect:function(a,d,b){if(null==a)return!1;var e;c[0]=null!=a.xmin?a.xmin:0;c[1]=null!=a.ymin?a.ymin:0;c[2]=null!=a.zmin?a.zmin:0;e=this.bufferToBuffer(c,a.spatialReference,0,c,b,0,1);d[0]=c[0];d[1]=c[1];c[0]=null!=a.xmax?a.xmax:0;c[1]=null!=a.ymax?a.ymax:0;c[2]=null!=a.zmax?a.zmax:0;e=e&&this.bufferToBuffer(c,a.spatialReference,0,c,b,0,1);d[2]=c[0];d[3]=c[1];null==a.xmin&&(d[0]=-Infinity);
null==a.ymin&&(d[1]=-Infinity);null==a.xmax&&(d[2]=Infinity);null==a.ymax&&(d[3]=Infinity);return e},webMercator:{x2lon:function(a){return a/g},y2lat:function(a){return Math.PI/2-2*Math.atan(Math.exp(-1*a/g))},lon2x:function(a){return a*g},lat2y:function(a){a=Math.sin(a);return g/2*Math.log((1+a)/(1-a))}}}});