// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.3/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper dojo/Deferred dojo/_base/lang ../../../../core/Scheduler ../../../../geometry/Multipoint".split(" "),function(e,l,h,f,m,n,p,q){e=function(){function b(a,d,c){this.spatialReference=a;this._getElevationQueryProvider=d;this._queries=[];this._isScheduled=!1;this._queryOptions=n.mixin({},c,{ignoreInvisibleLayers:!0})}b.prototype.queryElevation=function(a,d){return f(this,void 0,void 0,function(){var c;
return h(this,function(b){c=new m;this._queries.push({x:a,y:d,result:c});this._scheduleDoQuery();return[2,c.promise]})})};b.prototype._scheduleDoQuery=function(){var a=this;this._isScheduled||(p.schedule(function(){return a._doQuery()}),this._isScheduled=!0)};b.prototype._doQuery=function(){return f(this,void 0,void 0,function(){var a,d,c,b,e,f,k;return h(this,function(g){switch(g.label){case 0:this._isScheduled=!1;a=this._queries;this._queries=[];d=a.map(function(a){return[a.x,a.y]});c=new q({points:d,
spatialReference:this.spatialReference});b=this._getElevationQueryProvider();if(!b)return a.forEach(function(a,b){return a.result.reject()}),[2];g.label=1;case 1:return g.trys.push([1,3,,4]),[4,b.queryElevation(c,this._queryOptions)];case 2:return e=g.sent(),[3,4];case 3:return f=g.sent(),a.forEach(function(a){return a.result.reject(f)}),[2];case 4:return k=e.geometry.points,a.forEach(function(a,b){return a.result.resolve(k[b][2])}),[2]}})})};return b}();l.ElevationQuery=e});